<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>【WeDetect】论文阅读 | 且离且安的碎碎念</title><meta name="author" content="lian"><meta name="copyright" content="lian"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#fdfcf8"><meta name="description" content="系列文章   &#x2F;   开放词汇检测 &#x2F; WeDetect  Abstract Abstract.1 本小节概论 这篇论文在做一件事：让“开放词表目标检测”（你给一句文本，模型就去图里找对应目标）变得又快又强。 作者观察到：很多“快”的开放词表检测器都走一种思路——把检测当成“检索”：  图像里每个候选区域（region&#x2F;box）提一个向量（embedding） 文本提示（比如 “dog”“r">
<meta property="og:type" content="article">
<meta property="og:title" content="【WeDetect】论文阅读">
<meta property="og:url" content="https://qieliqiean.github.io/blog/2026/01/21/%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E6%A3%80%E6%B5%8B/WeDetect/%E3%80%90WeDetect%E3%80%91%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/index.html">
<meta property="og:site_name" content="且离且安的碎碎念">
<meta property="og:description" content="系列文章   &#x2F;   开放词汇检测 &#x2F; WeDetect  Abstract Abstract.1 本小节概论 这篇论文在做一件事：让“开放词表目标检测”（你给一句文本，模型就去图里找对应目标）变得又快又强。 作者观察到：很多“快”的开放词表检测器都走一种思路——把检测当成“检索”：  图像里每个候选区域（region&#x2F;box）提一个向量（embedding） 文本提示（比如 “dog”“r">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://qieliqiean.github.io/blog/image/cover/9.jpg">
<meta property="article:published_time" content="2026-01-21T01:41:58.000Z">
<meta property="article:modified_time" content="2026-02-18T11:59:46.438Z">
<meta property="article:author" content="lian">
<meta property="article:tag" content="WeDetect">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://qieliqiean.github.io/blog/image/cover/9.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "【WeDetect】论文阅读",
  "url": "https://qieliqiean.github.io/blog/2026/01/21/%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E6%A3%80%E6%B5%8B/WeDetect/%E3%80%90WeDetect%E3%80%91%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/",
  "image": "https://qieliqiean.github.io/blog/image/cover/9.jpg",
  "datePublished": "2026-01-21T01:41:58.000Z",
  "dateModified": "2026-02-18T11:59:46.438Z",
  "author": [
    {
      "@type": "Person",
      "name": "lian",
      "url": "https://qieliqiean.github.io/blog/"
    }
  ]
}</script><link rel="shortcut icon" href="/blog/image/1.jpg"><link rel="canonical" href="https://qieliqiean.github.io/blog/2026/01/21/%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E6%A3%80%E6%B5%8B/WeDetect/%E3%80%90WeDetect%E3%80%91%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="stylesheet" href="/blog/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0f172a')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fdfcf8')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const mediaQueryDark = window.matchMedia('(prefers-color-scheme: dark)')
          const mediaQueryLight = window.matchMedia('(prefers-color-scheme: light)')
          
          if (theme === undefined) {
            if (mediaQueryLight.matches) activateLightMode()
            else if (mediaQueryDark.matches) activateDarkMode()
            else {
              const hour = new Date().getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            mediaQueryDark.addEventListener('change', () => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else {
            theme === 'light' ? activateLightMode() : activateDarkMode()
          }
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6b5d1303d19816191830cd73eccfdb1e";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
btf.addGlobalFn('pjaxComplete', () => {
  _hmt.push(['_trackPageview',window.location.pathname])
}, 'baidu_analytics')
</script><script>const GLOBAL_CONFIG = {
  root: '/blog/',
  algolia: undefined,
  localSearch: {"path":"/blog/search.xml","preload":false,"top_n_per_article":3,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":230,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '【WeDetect】论文阅读',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&family=LXGW+WenKai:wght@400;700&family=Noto+Serif+SC:wght@400;600;700&display=swap" rel="stylesheet"><link rel="stylesheet" href="/blog/css/custom.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/blog/image/IMG_20250131_155849.jpg" onerror="this.onerror=null;this.src='/blog/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/blog/archives/"><div class="headline">文章</div><div class="length-num">43</div></a><a href="/blog/tags/"><div class="headline">标签</div><div class="length-num">21</div></a><a href="/blog/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/blog/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/blog/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/blog/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/blog/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/blog/easter-egg/"><i class="fa-fw fas fa-egg"></i><span> 彩蛋</span></a></div><div class="menus_item"><a class="site-page" href="/blog/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url(/image/cover/9.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/blog/"><img class="site-icon" src="/blog/image/background1.png" alt="Logo"><span class="site-name">且离且安的碎碎念</span></a><a class="nav-page-title" href="/blog/"><span class="site-name">【WeDetect】论文阅读</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/blog/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/blog/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/blog/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/blog/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/blog/easter-egg/"><i class="fa-fw fas fa-egg"></i><span> 彩蛋</span></a></div><div class="menus_item"><a class="site-page" href="/blog/about/"><i class="fa-fw fas fa-user"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">【WeDetect】论文阅读</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2026-01-21T01:41:58.000Z" title="发表于 2026-01-21 09:41:58">2026-01-21</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2026-02-18T11:59:46.438Z" title="更新于 2026-02-18 19:59:46">2026-02-18</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/blog/categories/%E5%AD%A6%E4%B9%A0/">学习</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">31.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>137分钟</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><nav class="series-breadcrumb" aria-label="系列导航">
  <a href="/blog/series/">系列文章</a>
  <span class="series-breadcrumb__sep">/</span>
  <a href="/blog/series/5byA5pS-6K-N5rGH5qOA5rWLIC8gV2VEZXRlY3Q/">开放词汇检测 / WeDetect</a>
</nav>
<h1 id="Abstract"><a class="header-anchor" href="#Abstract"></a>Abstract</h1>
<h2 id="Abstract-1-本小节概论"><a class="header-anchor" href="#Abstract-1-本小节概论"></a>Abstract.1 本小节概论</h2>
<p>这篇论文在做一件事：<strong>让“开放词表目标检测”（你给一句文本，模型就去图里找对应目标）变得又快又强</strong>。</p>
<p>作者观察到：很多“快”的开放词表检测器都走一种思路——<strong>把检测当成“检索”</strong>：</p>
<ul>
<li>图像里每个候选区域（region/box）提一个向量（embedding）</li>
<li>文本提示（比如 “dog”“red car”）也提一个向量</li>
<li>最后用<strong>相似度匹配</strong>（比如点积）来决定哪个框最像这个词</li>
</ul>
<p>于是作者把这套“检索哲学”彻底做到底，做成一个家族 <strong>WeDetect</strong>，不仅能做检测，还能做：</p>
<ol>
<li><strong>实时开放词表检测（WeDetect）</strong>：不靠复杂跨模态融合层，也能做到 SOTA + 快</li>
<li><strong>通用候选框生成 + 历史数据回溯检索（WeDetect-Uni）</strong>：先把海量图片的“候选框向量”缓存起来，以后搜任何物体都很快</li>
<li><strong>把大模型当分类器做REC（WeDetect-Ref）</strong>：处理复杂指代表达（“左边穿7号球衣的那个人”）时，不用慢吞吞的逐词生成，而是一把并行判别</li>
</ol>
<hr>
<h2 id="Abstract-2-关键概念-符号表"><a class="header-anchor" href="#Abstract-2-关键概念-符号表"></a>Abstract.2 关键概念/符号表</h2>
<table>
<thead>
<tr>
<th><strong>概念/术语</strong></th>
<th><strong>解释</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Open-vocabulary Object Detection</strong></td>
<td>开放词汇目标检测，指通过文本提示（Text Prompts）检测任意类别的目标，不局限于预定义的类别集合。</td>
</tr>
<tr>
<td><strong>Non-fusion (Non-Cross-Modal Fusion)</strong></td>
<td>非融合架构，指视觉和文本特征在提取过程中没有深度的交叉融合，通常采用双塔结构（Dual-tower），推理速度更快。</td>
</tr>
<tr>
<td><strong>Retrieval Philosophy</strong></td>
<td>检索哲学，即将识别问题视为在共享嵌入空间中将图像区域与文本查询进行匹配的检索问题。</td>
</tr>
<tr>
<td><strong>WeDetect</strong></td>
<td>本文提出的实时检测器，采用双塔架构，通过高质量数据和充分训练建立了强大的开放词汇基础。</td>
</tr>
<tr>
<td><strong>WeDetect-Uni</strong></td>
<td>基于 WeDetect 的通用候选框生成器（Proposal Generator），支持对历史数据的快速回溯和对象检索。</td>
</tr>
<tr>
<td><strong>WeDetect-Ref</strong></td>
<td>基于大一型多模态模型（LMM）的指代表达理解（REC）模型，用于处理复杂的文本描述，采用单次前向传递（Single Forward Pass）而非逐词预测。</td>
</tr>
<tr>
<td><strong>REC (Referring Expression Comprehension)</strong></td>
<td>指代性表达理解，旨在根据自然语言描述在图像中定位特定目标。</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="Abstract-3-关键公式-算法"><a class="header-anchor" href="#Abstract-3-关键公式-算法"></a>Abstract.3 关键公式/算法</h2>
<p>摘要里没有直接给公式；核心计算可以理解为：</p>
<ul>
<li><strong>文本向量</strong> vs <strong>区域向量</strong> 做相似度（点积/余弦）→ 得分越高越像</li>
</ul>
<hr>
<h2 id="Abstract-4-本小节全部内容讲解"><a class="header-anchor" href="#Abstract-4-本小节全部内容讲解"></a>Abstract.4 本小节全部内容讲解</h2>
<h3 id="1）为什么要“去融合层”？"><a class="header-anchor" href="#1）为什么要“去融合层”？"></a>1）为什么要“去融合层”？</h3>
<p>很多强的开放词表检测器会把文本和视觉特征在网络里反复融合（fusion layers）。这样做往往更准，但代价是：</p>
<ul>
<li><strong>慢</strong>：计算量大</li>
<li><strong>不方便复用</strong>：不同文本提示会让视觉特征“变成针对该提示的”，你换一批类别就得重复跑很多次（论文里提到在 LVIS 这种 1203 类数据上会很麻烦）</li>
</ul>
<p>作者主张：干脆别在网络里做深度融合，走<strong>双塔检索</strong>路线，速度天然快。</p>
<hr>
<h3 id="2）WeDetect：把检测当检索，但要做到“又快又准”"><a class="header-anchor" href="#2）WeDetect：把检测当检索，但要做到“又快又准”"></a>2）WeDetect：把检测当检索，但要做到“又快又准”</h3>
<p>WeDetect 的核心就是：</p>
<ul>
<li>文本编码器：把类别名/短语编码成向量</li>
<li>视觉编码器：提多尺度特征（对检测友好）</li>
<li>分类：直接做<strong>点积匹配</strong>，不做昂贵的跨模态融合</li>
</ul>
<p>为了让这种“看起来更简单”的结构也能很强，作者强调三点（摘要里最关键的“成功要素”）：</p>
<ul>
<li><strong>强预训练</strong>：从强 CLIP 初始化，继承开放词表能力</li>
<li><strong>更适合检测的视觉骨干</strong>：他们预训练了带 <strong>ConvNeXt</strong> 的 CLIP 变体，更自然地产生多尺度特征（检测更需要这一点）</li>
<li><strong>高质量大规模数据</strong>：做了数据引擎，构建 <strong>15M 图 + 3.3亿框</strong>，并且标签有多粒度（例如同一只狗标成 “animal / dog / a yellow dog”）</li>
</ul>
<p>你可以把它理解成：</p>
<blockquote>
<p>“简单架构要赢过复杂架构，靠的是更强的底座（预训练）+ 更对口的结构（多尺度）+ 更好的数据（大而且标得细）。”</p>
</blockquote>
<hr>
<h3 id="3）WeDetect-Uni：把“检测器”变成“通用提案器”，还能做历史数据回溯"><a class="header-anchor" href="#3）WeDetect-Uni：把“检测器”变成“通用提案器”，还能做历史数据回溯"></a>3）WeDetect-Uni：把“检测器”变成“通用提案器”，还能做历史数据回溯</h3>
<p>Uni 的做法很巧：</p>
<ul>
<li><strong>冻结整个检测器</strong>（参数不动）</li>
<li>只学一个“objectness prompt”（类似一个“这是不是物体”的可学习向量）</li>
<li>这样就能生成跨类别的候选框（proposal）</li>
</ul>
<p>重点来了：作者强调这些 proposal 的<strong>框向量仍然带类别信息（class-specific）</strong>。
于是可以搞一个新应用：<strong>object retrieval（局部目标检索）</strong>。</p>
<p>举个例子：</p>
<ul>
<li>你有一个“历史图库/监控库”，里面很多图</li>
<li>传统 CLIP 做“整图检索”，擅长找“整体语义”（比如“海边日落”）</li>
<li>但你想找“很小的东西”，比如“cigarette butts（烟头）”
<ul>
<li>整图语义可能不明显，CLIP容易漏</li>
</ul>
</li>
<li>WeDetect-Uni 可以把每张图的若干候选框向量缓存起来
<ul>
<li>你搜“烟头”时，只需要把文本向量和这些框向量做点积，就能把包含烟头的图检索出来</li>
</ul>
</li>
</ul>
<hr>
<h3 id="4）WeDetect-Ref：用大模型做REC，但不用慢的逐词生成"><a class="header-anchor" href="#4）WeDetect-Ref：用大模型做REC，但不用慢的逐词生成"></a>4）WeDetect-Ref：用大模型做REC，但不用慢的逐词生成</h3>
<p>REC 常见输入是复杂表达，比如：</p>
<ul>
<li>“穿红衣服、站在左边、拿着球的那个人”</li>
</ul>
<p>很多大模型做定位会用“生成式”方式输出坐标，问题是：</p>
<ul>
<li>坐标是数字，生成起来不稳定（回归不如专门的检测回归）</li>
<li>生成是<strong>逐token</strong>的，推理慢</li>
</ul>
<p>作者改成：</p>
<ul>
<li>先用 WeDetect-Uni 给出候选框列表</li>
<li>再把这些候选框对应的对象特征喂给大模型</li>
<li><strong>大模型不负责生成框</strong>，只负责对每个候选框做“是不是目标”的二分类</li>
<li>并且是<strong>一次前向并行处理所有候选框</strong>，速度提升很大</li>
</ul>
<hr>
<h2 id="Abstract-5-重点内容梳理"><a class="header-anchor" href="#Abstract-5-重点内容梳理"></a>Abstract.5 重点内容梳理</h2>
<ol>
<li><strong>核心思想一句话</strong>：把开放词表检测彻底做成“检索问题”，用双塔结构用点积匹配，实现快和可复用。</li>
<li><strong>WeDetect 家族三件套</strong>：
<ul>
<li>WeDetect：实时开放词表检测基础模型</li>
<li>WeDetect-Uni：通用提案 + 缓存框向量 → 支持“历史数据里的局部目标检索”</li>
<li>WeDetect-Ref：REC 里用大模型做并行分类，不走慢生成</li>
</ul>
</li>
<li><strong>为什么能强</strong>：强预训练 + 更适合检测的多尺度视觉骨干 + 超大且高质量、多粒度标注数据。</li>
<li><strong>你要记住的“应用亮点”</strong>：不仅检测，还能做“局部对象检索”（尤其适合小目标、细粒度查找）和高效 REC。</li>
</ol>
<hr>
<p>好的，我们继续进行论文精读。现在进入 <strong>1. Introduction（引言）</strong> 部分。</p>
<hr>
<h1 id="1-Introduction"><a class="header-anchor" href="#1-Introduction"></a>**1. Introduction **</h1>
<h2 id="1-本小节概论"><a class="header-anchor" href="#1-本小节概论"></a><strong>1. 本小节概论</strong></h2>
<p>引言部分首先回顾了计算机视觉识别任务的发展历程，从闭集分类到开放词汇检索。接着，重点指出了当前开放词汇目标检测（OVOD）领域中，为了追求高性能而广泛采用的“深度跨模态融合（deep cross-modal fusion）”架构所带来的效率瓶颈。基于此，作者提出了本文的核心洞察：将非融合（non-fusion）范式的识别过程视为“检索（Retrieval）”问题。基于这一哲学，作者介绍了 <strong>WeDetect</strong> 模型家族（WeDetect, WeDetect-Uni, WeDetect-Ref），它们在保持极高推理速度的同时，实现了最先进的性能。</p>
<h2 id="2-关键概念-符号表"><a class="header-anchor" href="#2-关键概念-符号表"></a><strong>2. 关键概念/符号表</strong></h2>
<table>
<thead>
<tr>
<th><strong>概念/术语</strong></th>
<th><strong>解释</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Closed-set vs. Open-vocabulary</strong></td>
<td><strong>闭集</strong>：模型只能识别训练时预定义好的固定类别；<strong>开放词汇</strong>：模型可以识别和定位由任意文本提示指定的类别，无需针对特定任务重新训练。</td>
</tr>
<tr>
<td><strong>Cross-modal Fusion (Fusion)</strong></td>
<td><strong>跨模态融合</strong>：在模型深层将视觉特征和文本特征进行交互混合。优点是精度高，缺点是计算量大、速度慢，且特征与查询（Query）强耦合。</td>
</tr>
<tr>
<td><strong>Query-specific Features</strong></td>
<td><strong>查询特定特征</strong>：在融合架构中，视觉特征会随着输入的文本提示不同而改变，导致无法在不同查询间共享视觉特征，必须针对每个查询重新计算。</td>
</tr>
<tr>
<td><strong>Non-fusion (Dual-tower)</strong></td>
<td><strong>非融合（双塔）</strong>：视觉和文本分别通过独立的编码器提取特征，仅在最后通过点积等方式计算相似度。优点是特征可预计算、可复用，推理速度快。</td>
</tr>
<tr>
<td><strong>Object Retrieval</strong></td>
<td><strong>对象检索</strong>：本文提出的新应用，旨在从数据库中检索包含用户指定对象（甚至是细粒度的小物体，如“烟头”）的图像，不同于传统的基于图像整体语义的检索。</td>
</tr>
</tbody>
</table>
<h2 id="3-关键公式-算法"><a class="header-anchor" href="#3-关键公式-算法"></a><strong>3. 关键公式/算法</strong></h2>
<p>引言部分主要阐述设计理念，未涉及具体数学公式，但通过一个对比案例量化了算法效率差异：</p>
<ul>
<li>
<p><strong>效率对比算法逻辑</strong>：</p>
<ul>
<li>
<p><strong>Fusion 方法（如 Grounding-DINO）</strong>：在 LVIS 数据集（1203 类）上评估时，如果 Chunk size 为 40，需要进行 
    <span id="mjx-af9f6e4">
      <style>
      #mjx-af9f6e4{
        display:contents;
        mjx-assistive-mml {
          user-select: text !important;
          clip: auto !important;
          color: rgba(0,0,0,0);
        }
        
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

      }
      </style>
      <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="13.198ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 5833.6 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" transform="translate(500,0)"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1000,0)"></path><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z" transform="translate(1500,0)"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(2000,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"></path></g></g><g data-mml-node="mn" transform="translate(2500,0)"><path data-c="34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)"></path></g><g data-mml-node="mo" transform="translate(3777.8,0)"><path data-c="2248" d="M55 319Q55 360 72 393T114 444T163 472T205 482Q207 482 213 482T223 483Q262 483 296 468T393 413L443 381Q502 346 553 346Q609 346 649 375T694 454Q694 465 698 474T708 483Q722 483 722 452Q722 386 675 338T555 289Q514 289 468 310T388 357T308 404T224 426Q164 426 125 393T83 318Q81 289 69 289Q55 289 55 319ZM55 85Q55 126 72 159T114 210T163 238T205 248Q207 248 213 248T223 249Q262 249 296 234T393 179L443 147Q502 112 553 112Q609 112 649 141T694 220Q694 249 708 249T722 217Q722 153 675 104T555 55Q514 55 468 76T388 123T308 170T224 192Q164 192 125 159T83 84Q80 55 69 55Q55 55 55 85Z"></path></g><g data-mml-node="mn" transform="translate(4833.6,0)"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" transform="translate(500,0)"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1203</mn><mrow data-mjx-texclass="ORD"><mo>/</mo></mrow><mn>40</mn><mo>≈</mo><mn>31</mn></math></mjx-assistive-mml></mjx-container>
    </span>
   次独立的前向传播（Forward Passes），导致单张图片延迟数秒 1。</p>
</li>
<li>
<p><strong>Non-fusion 方法（WeDetect）</strong>：视觉特征只需提取一次，与所有类别的文本嵌入进行匹配，实现实时推理。</p>
</li>
</ul>
</li>
</ul>
<h2 id="4-本小节全部内容讲解"><a class="header-anchor" href="#4-本小节全部内容讲解"></a><strong>4. 本小节全部内容讲解</strong></h2>
<p>引言的逻辑推演非常清晰，可以分为以下四个部分：</p>
<ol>
<li>
<p><strong>从闭集到开放词汇的演进</strong></p>
<ul>
<li>计算机视觉的核心是识别。图像层面的任务已从闭集分类发展为基于 CLIP 等大规模图文对比学习的开放词汇检索。</li>
<li>平行地，目标检测也扩展到了开放词汇设置（Open-Vocabulary Object Detection），允许通过文本提示对任意类别进行定位和识别，通过对齐区域特征（Region Features）和文本嵌入（Text Embeddings）实现零样本（Zero-shot）识别。</li>
</ul>
</li>
<li>
<p><strong>现有方法的痛点：融合层的代价</strong></p>
<ul>
<li>为了提高视觉-语言对齐的效果，最近的 OVOD 模型（如 LLMDet, Grounding-DINO）使用了各种深度的跨模态融合机制。</li>
<li><strong>核心问题</strong>：虽然精度高，但计算密集型的融合层严重降低了推理效率。更致命的是，融合使得视觉特征变成了“查询特定（Query-specific）”的，无法在不同文本提示间共享。</li>
<li><strong>案例</strong>：Grounding-DINO 在 LVIS 数据集上需要运行 31 次前向传播才能完成一张图片的检测，无法满足实时部署需求。</li>
</ul>
</li>
<li>
<p><strong>核心洞察：检测即检索</strong></p>
<ul>
<li>非融合方法（双塔架构）速度快，作者注意到其识别过程本质上类似于“检索”问题：在共享嵌入空间中匹配图像区域和文本查询。</li>
<li>基于这一洞察，作者提出了 <strong>WeDetect</strong> 模型家族，旨在充分挖掘“检索”哲学的效率和通用性优势。</li>
</ul>
</li>
<li>
<p><strong>WeDetect 家族成员详解</strong></p>
<ul>
<li><strong>(1) WeDetect（检测基础）</strong>：
<ul>
<li><strong>定位</strong>：实时、高性能的开放词汇检测器。</li>
<li><strong>技术路线</strong>：不依赖深度融合，而是通过三大支柱实现 SOTA：① <strong>模型预训练</strong>（基于 CLIP 微调）；② <strong>模型架构</strong>（使用 ConvNeXt 骨干网替代 ViT，更适合检测）；③ <strong>训练数据</strong>（构建了包含 15M 图片、3.3亿边界框的高质量数据集，具有平衡的概念和多粒度标签）。</li>
</ul>
</li>
<li><strong>(2) WeDetect-Uni（通用提案生成与对象检索）</strong>：
<ul>
<li><strong>定位</strong>：支持历史数据快速回溯的通用 Proposal 生成器。</li>
<li><strong>机制</strong>：冻结整个检测器，仅微调一个“物体性（objectness）”提示。</li>
<li><strong>新应用</strong>：生成的 Proposal 嵌入是类别特异的（class-specific），缓存这些嵌入后，可通过简单的点积实现“对象检索”（如在海量历史数据中找特定物体），这是 CLIP 这种图像级检索做不到的精细度。</li>
</ul>
</li>
<li><strong>(3) WeDetect-Ref（LMM 基 REC 模型）</strong>：
<ul>
<li><strong>定位</strong>：处理复杂指代性表达（REC）。</li>
<li><strong>创新</strong>：将 LMM 用作分类器而非生成器。从 WeDetect-Uni 获取候选框，通过单次前向传播（Single forward pass）并行分类所有对象，摒弃了缓慢的逐词（Next-token）预测。</li>
</ul>
</li>
<li><strong>成果</strong>：WeDetect-Tiny 在 LVIS 上超越 YOLO-World-L 且速度更快；WeDetect-Large 超越 LLMDet；WeDetect-Ref 在 RefCOCO 上超越 Qwen3-VL 且速度快 13 倍。</li>
</ul>
</li>
</ol>
<h2 id="5-重点内容梳理"><a class="header-anchor" href="#5-重点内容梳理"></a><strong>5. 重点内容梳理</strong></h2>
<ul>
<li><strong>非融合的胜利</strong>：本文最有力的论点是，通过优质的数据和合理的架构设计（ConvNeXt + CLIP Pretraining），简单的双塔（Non-fusion）架构完全可以在性能上击败复杂的融合（Fusion）架构，同时保留巨大的速度优势。</li>
<li><strong>&quot;Object Retrieval&quot;（对象检索）</strong>：这是一个非常有价值的新任务定义。传统的图像检索（如 CLIP）只能搜“有狗的图”，但 WeDetect-Uni 提出的对象检索可以搜“图中的哪只狗”或者极小的物体（如“烟头”），并且支持对已处理过的历史视频/图像数据进行快速回溯搜索（因为特征已缓存）。</li>
<li><strong>LMM 的加速范式</strong>：WeDetect-Ref 对大模型的使用方式非常有启发性——不让 LMM 生成坐标（回归问题，难且慢），也不让它生成文本标签（序列预测，慢），而是直接让它做选择题（分类问题，快且准），利用其理解能力从候选框中挑出目标。</li>
</ul>
<hr>
<h1 id="2-Related-Work"><a class="header-anchor" href="#2-Related-Work"></a>2.Related Work</h1>
<hr>
<h2 id="2-1-Open-Vocabulary-Object-Detection-开放词汇目标检测"><a class="header-anchor" href="#2-1-Open-Vocabulary-Object-Detection-开放词汇目标检测"></a><strong>2.1. Open-Vocabulary Object Detection (开放词汇目标检测)</strong></h2>
<h3 id="1-本小节概论-2"><a class="header-anchor" href="#1-本小节概论-2"></a><strong>1. 本小节概论</strong></h3>
<p>本小节系统回顾了开放词汇目标检测（OVOD）领域的现有研究。</p>
<blockquote>
<p>OVD 的难点是：<strong>既要“框出位置”，又要“懂文本语义”</strong>，因此核心是做到<strong>细粒度的图文对齐</strong></p>
</blockquote>
<p>作者将构建统一视觉-语言空间的方法归纳为四个主要方向：<strong>训练数据构建</strong>、<strong>训练目标设计</strong>、<strong>视觉-语言融合层</strong>以及<strong>模型蒸馏</strong>。最后，作者指出了现有深度融合（Deep Fusion）方法的效率缺陷，从而引出本文提出的基于“检索”方法论的非融合（Non-fusion）架构。</p>
<h3 id="2-关键概念-符号表-2"><a class="header-anchor" href="#2-关键概念-符号表-2"></a><strong>2. 关键概念/符号表</strong></h3>
<table>
<thead>
<tr>
<th><strong>概念/术语</strong></th>
<th><strong>解释</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Region-word Contrastive Pre-training</strong></td>
<td><strong>区域-词汇对比预训练</strong>：GLIP 提出的方法，通过对比学习将图像区域特征与对应的文本词汇特征对齐，是实现零样本检测的关键技术。</td>
</tr>
<tr>
<td><strong>Hard Negative Samples</strong></td>
<td><strong>困难负样本</strong>：指那些很难被模型区分的负例（例如与目标物体外观相似但非目标的区域）。构建这些样本可以提供更丰富的监督信号，提升细粒度对齐能力。</td>
</tr>
<tr>
<td><strong>Vision-Language Fusion Layers</strong></td>
<td><strong>视觉-语言融合层</strong>：指在模型网络深层将视觉特征和文本特征进行交互和混合的模块。虽然能提升精度，但计算成本高昂。</td>
</tr>
<tr>
<td><strong>Model Distillation</strong></td>
<td><strong>模型蒸馏</strong>：一种将大型基础模型（Foundation Models，如 CLIP）中包含的开放词汇知识迁移（Distill）到较小目标检测器中的方法。</td>
</tr>
</tbody>
</table>
<h3 id="3-本小节全部内容讲解"><a class="header-anchor" href="#3-本小节全部内容讲解"></a><strong>3. 本小节全部内容讲解</strong></h3>
<p>作者将现有工作如何构建统一的视觉-语言空间分为了四个维度进行综述：</p>
<ol>
<li>
<p><strong>训练数据构建 (Training data constructions)</strong></p>
<ul>
<li><strong>核心思想</strong>：利用海量数据建立鲁棒的视觉-语言空间。</li>
<li><strong>代表工作</strong>：<strong>GLIP</strong> [40] 首次通过“区域-词汇对比预训练”统一了目标检测和短语定位（Phrase Grounding）任务。这使得模型可以利用网络上大规模的图像-文本对（Image-text pairs）进行训练。</li>
<li><strong>进阶策略</strong>：网络规模的数据提供了巨大的词汇量；构建<strong>困难负样本（Hard negative samples）</strong> [39, 77, 78, 89] 可以提供更强的监督信号，实现更精细的对齐。通过扩大数据和计算规模 [55, 78]，模型可以实现令人印象深刻的零样本性能</li>
</ul>
<blockquote>
<p>通俗例子：
只教模型“这张图有狗”太粗糙；GLIP 这类方法更像教它“这个框对应 ‘dog’ 这个词”，而且还给它很多“很像但不是”的干扰项（难负样本），逼它学精细差别。</p>
</blockquote>
</li>
<li>
<p><strong>训练目标 (Training objective)</strong></p>
<ul>
<li><strong>核心思想</strong>：除了基础的区域-词汇对比学习，引入其他语言任务来丰富视觉表征。</li>
<li><strong>具体方法</strong>：包括掩码语言建模（Mask Language Modeling）[86]、密集描述（Dense Captioning）[50, 79]，以及与大语言模型（LLM）联合训练（Co-training）[17]。这些方法通过引入语言知识增强了视觉特征，创造了更强的开放词汇检测器。</li>
</ul>
</li>
<li>
<p><strong>视觉-语言融合层 (Vision-language fusion layers)</strong></p>
<ul>
<li><strong>核心思想</strong>：在网络内部联合整合视觉和文本特征。</li>
</ul>
</li>
</ol>
<ul>
<li><strong>优势</strong>：深度的融合层 [13, 19, 40, 48, 68] 可以进一步改善视觉-语言的对齐效果，通常能获得更高的准确率。
<ul>
<li><strong>缺陷（本文切入点）</strong>：</li>
<li><strong>效率低</strong>：计算密集型的融合层大大降低了推理速度。
<ul>
<li><strong>无法共享</strong>：提取的视觉特征变成了“特定于查询的（Query-specific）”，无法在不同查询之间共享。</li>
</ul>
</li>
</ul>
</li>
</ul>
<ol start="4">
<li>
<p><strong>模型蒸馏 (Model distillation)</strong></p>
<ul>
<li><strong>核心思想</strong>：将其他基础模型（如 CLIP）的开放词汇知识蒸馏到检测器中 [15, 16, 18, 70]，使检测器具备识别未见类别的能力。</li>
</ul>
</li>
</ol>
<p><strong>作者的定位 ：</strong></p>
<blockquote>
<p>在总结了上述工作后，作者明确了本文的立场：</p>
<p>重新审视深度融合架构，并反其道而行之，遵循<strong>检索</strong>（Retrieval）方法论，提出了一系列具有“朴素（Plain）”架构的模型。这意味着作者将放弃复杂的深层融合，回归到更高效的双塔结构。</p>
</blockquote>
<h3 id="4-重点内容梳理"><a class="header-anchor" href="#4-重点内容梳理"></a><strong>4. 重点内容梳理</strong></h3>
<ul>
<li><strong>主流趋势 vs. 本文反思</strong>：现有主流方法（如 Grounding-DINO, GLIP 等）倾向于设计复杂的融合层或引入更多辅助任务来提升性能。但作者指出，这种对精度的追求牺牲了实际部署中的推理效率（Inference Efficiency）。</li>
<li><strong>效率瓶颈的根源</strong>：明确指出了“融合层”是导致速度慢和特征无法复用的罪魁祸首。</li>
<li><strong>WeDetect 的设计动机</strong>：本文并非忽略前人的成果（如大规模数据、困难负样本挖掘等），而是吸收了数据构建和训练目标的优势，但在架构上坚决摒弃了深度融合，转而探索“检索”范式的极限。</li>
</ul>
<hr>
<h2 id="2-2-Large-Vision-Language-Model-大型视觉-语言模型"><a class="header-anchor" href="#2-2-Large-Vision-Language-Model-大型视觉-语言模型"></a><strong>2.2. Large Vision-Language Model (大型视觉-语言模型)</strong></h2>
<h3 id="1-本小节概论-3"><a class="header-anchor" href="#1-本小节概论-3"></a><strong>1. 本小节概论</strong></h3>
<p>本小节探讨了大型视觉-语言模型（LVLMs）在开放词汇感知方面的潜力与局限性。</p>
<p>作者指出，虽然 LVLMs 具备强大的世界知识和推理能力，但现有的将其扩展到区域感知（Region Perception）的方法面临两个主要挑战：<strong>回归缺陷（Regression drawback）<strong>和</strong>推理速度慢（Slow inference speed）</strong>。</p>
<p>这为本文提出的 WeDetect-Ref 奠定了理论基础——即摒弃传统的“下一个词预测（Next-token prediction）”机制，转而采用检索式分类范式。</p>
<h3 id="2-关键概念-符号表-3"><a class="header-anchor" href="#2-关键概念-符号表-3"></a><strong>2. 关键概念/符号表</strong></h3>
<table>
<thead>
<tr>
<th>概念/术语</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>LVLMs (Large Vision-Language Models)</strong></td>
<td><strong>大型视觉-语言模型</strong>：如 Qwen-VL 等，在海量语料上预训练，具备卓越的视觉感知和推理能力。</td>
</tr>
<tr>
<td><strong>Region Perception</strong></td>
<td><strong>区域感知</strong>：指模型不仅能理解整张图片，还能定位和理解图片中特定区域（物体）的能力。</td>
</tr>
<tr>
<td><strong>Language Modeling Mechanism</strong></td>
<td><strong>语言建模机制</strong>：LLM 的核心工作方式，即预测序列中的下一个 token。</td>
</tr>
<tr>
<td><strong>Regression Drawback</strong></td>
<td><strong>回归缺陷</strong>：在传统 LLM 中，坐标数字被编码为离散的 token 并通过交叉熵损失优化，这种方式不适合精确的边界框回归（Bounding Box Regression）。</td>
</tr>
<tr>
<td><strong>Next-token Prediction</strong></td>
<td><strong>下一个词预测</strong>：LLM 生成输出的方式，需要按顺序逐个生成 token。对于包含多个物体的检测任务，这意味着极高的延迟。</td>
</tr>
</tbody>
</table>
<h3 id="3-本小节全部内容讲解-2"><a class="header-anchor" href="#3-本小节全部内容讲解-2"></a><strong>3. 本小节全部内容讲解</strong></h3>
<p>作者对 LVLM 在目标检测领域的应用进行了如下分析：</p>
<ol>
<li><strong>LVLM 的优势</strong></li>
</ol>
<ul>
<li>LVLM 在海量语料库上预训练，不仅展示了专业的<strong>世界知识（World Knowledge）<strong>和</strong>推理能力（Reasoning Ability）</strong>，还具备卓越的视觉感知和理解能力。</li>
<li>因此，LVLM 在开放词汇感知任务上表现出色。</li>
</ul>
<hr>
<ol start="2">
<li><strong>现有扩展方法的局限性</strong></li>
</ol>
<ul>
<li>为了赋予 LVLM 区域感知能力 [41, 82, 83, 87]，通常的做法是将每个对象编码为特殊的 token。</li>
<li><strong>缺陷一：定位精度受限（Regression Drawback）</strong>。由于语言建模机制的限制，边界框的坐标数字被编码为独立的离散 token，并通过交叉熵损失进行优化。这种分类式的优化目标并不适合通过回归来精确定位物体。</li>
</ul>
<blockquote>
<p>例子：
让 LLM 输出 <code>x=103, y=57, w=46, h=80</code>，它其实是在“拼字符串”，不是在做连续空间里的回归；坐标差 2~3 像素，对字符串训练来说没那么“连续可微地敏感”。</p>
</blockquote>
<hr>
<ol start="3">
<li><strong>改进尝试及其遗留问题</strong></li>
</ol>
<ul>
<li><strong>尝试消除回归缺陷</strong>：一些方法 [34, 65, 66] 尝试使用额外的解码器（Decoder）来解码对象 token；另一些方法 [24, 26, 47, 88] 则预先提取一些候选框（Proposals）供 LLM 参考。</li>
<li><strong>缺陷二：推理速度慢（Inference Speed）</strong>。尽管有上述改进，这些方法仍然遵循**下一个词预测（Next-token prediction）**机制。这意味着物体必须被按顺序逐个解码。</li>
<li><strong>后果</strong>：推理速度受到极大限制。</li>
</ul>
<blockquote>
<p>例子：
图里有 20 个候选框，你让模型“一个个说：第 1 个是不是？第 2 个是不是？…”，这就是串行；串行再强也快不起来。</p>
</blockquote>
<hr>
<ol start="4">
<li></li>
</ol>
<p>本文的解决方案</p>
<ul>
<li>针对上述问题，本文遵循<strong>检索（Retrieval）方法论</strong>。</li>
<li>核心策略是利用 LLM 作为**分类器（Classifier）**而非生成器，并行处理所有对象，从而规避了序列生成的低效问题。</li>
</ul>
<h3 id="4-重点内容梳理-2"><a class="header-anchor" href="#4-重点内容梳理-2"></a><strong>4. 重点内容梳理</strong></h3>
<ul>
<li><strong>LLM 做检测的“两宗罪”</strong>：</li>
</ul>
<ol>
<li><strong>不准</strong>：用生成文本的方式生成坐标（比如生成 &quot;[&quot;, &quot;0&quot;, &quot;.&quot;, &quot;5&quot;, &quot;]&quot; ），这种离散的分类任务很难学好连续的坐标回归。</li>
<li><strong>太慢</strong>：如果有 10 个物体，传统 LLM 需要一个接一个地生成它们的标签和坐标，时间复杂度随着物体数量线性增加。</li>
</ol>
<ul>
<li><strong>WeDetect-Ref 的破局之道</strong>：作者在这里埋下了伏笔，WeDetect-Ref 将不让 LLM 生成坐标（直接复用 Proposal 的坐标），也不让它逐个生成文字，而是直接对所有 Proposal 并行做“是/否”的二分类判断，最大化利用了 LLM 的理解能力并规避了其生成短板。</li>
</ul>
<hr>
<h1 id="3-WeDetect-A-Strong-Detection-Foundation"><a class="header-anchor" href="#3-WeDetect-A-Strong-Detection-Foundation"></a>3. WeDetect: A Strong Detection Foundation</h1>
<h2 id="3-1-Model-Architecture-模型架构"><a class="header-anchor" href="#3-1-Model-Architecture-模型架构"></a><strong>3.1. Model Architecture (模型架构)</strong></h2>
<h3 id="1-本小节概论-4"><a class="header-anchor" href="#1-本小节概论-4"></a><strong>1. 本小节概论</strong></h3>
<p>本小节详细介绍了 WeDetect 的网络结构。不同于追求复杂交互的融合模型，WeDetect 采用了经典的<strong>双塔架构（Dual-tower Architecture）</strong>。左侧是文本编码器，右侧是视觉编码器，两者并行处理，互不干扰，仅在最后通过点积计算相似度。这种设计最大化了推理速度，并使得特征具备独立性和复用性。</p>
<h3 id="2-关键概念-符号表-4"><a class="header-anchor" href="#2-关键概念-符号表-4"></a><strong>2. 关键概念/符号表</strong></h3>
<table>
<thead>
<tr>
<th>概念/术语</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Dual-tower Architecture</strong></td>
<td><strong>双塔架构</strong>：一种模型设计模式，包含两个独立的神经网络分支（“塔”），分别处理两种模态（如图像和文本），直到输出层才进行交互。</td>
</tr>
<tr>
<td><strong>XLM-RoBERTa</strong></td>
<td><strong>文本编码器基座</strong>：一种强大的多语言预训练语言模型。WeDetect 使用它来初始化文本编码器，以支持丰富的词汇和多语言能力。</td>
</tr>
<tr>
<td><strong>ConvNeXt</strong></td>
<td><strong>视觉骨干网 (Backbone)</strong>：一种现代化的卷积神经网络，设计上借鉴了 Vision Transformer (ViT) 的优点，天然适合生成多尺度特征，比 ViT 更适合目标检测任务。</td>
</tr>
<tr>
<td><strong>CSPRepBiFPAN</strong></td>
<td><strong>颈部网络 (Neck)</strong>：用于特征融合的网络层（Feature Pyramid Network 的变体），负责整合不同尺度的特征图，增强对大小物体的检测能力。</td>
</tr>
<tr>
<td><strong>Non-fusion Neck</strong></td>
<td><strong>非融合颈部</strong>：特指在 Feature Pyramid 阶段，<strong>不</strong>引入任何文本特征进行跨模态交互，这是 WeDetect 与 YOLO-World 等模型的关键区别。</td>
</tr>
</tbody>
</table>
<h3 id="3-本小节全部内容讲解-3"><a class="header-anchor" href="#3-本小节全部内容讲解-3"></a><strong>3. 本小节全部内容讲解</strong></h3>
<p><img src="/blog/2026/01/21/%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E6%A3%80%E6%B5%8B/WeDetect/%E3%80%90WeDetect%E3%80%91%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/image-20260121144632613.png" alt="image-20260121144632613"></p>
<p>结合文中描述  和 Figure 1(a)，我们将模型拆解为三个部分：</p>
<p><strong>A. 整体架构设计</strong></p>
<ul>
<li>
<p><strong>双塔结构</strong>：如图 1(a) 所示，WeDetect 是一个纯粹的双塔架构。</p>
</li>
<li>
<p><strong>文本塔 (Text Tower)</strong>：负责编码类别名称（Class Names）。</p>
</li>
<li>
<p><strong>视觉塔 (Vision Tower)</strong>：负责提取图像特征。</p>
</li>
<li>
<p><strong>交互方式</strong>：摒弃了先前工作（如 Grounding-DINO, YOLO-World）中常见的“颈部融合（Fusion in Neck）”。分类仅仅通过图像网格特征与类别文本嵌入之间的**点积（Dot Product）**来完成 。</p>
</li>
</ul>
<p><strong>B. 具体的组件选择</strong></p>
<ol>
<li></li>
</ol>
<p>语言编码器 (Text Encoder) ：</p>
<ul>
<li>初始化自 <strong>XLM-RoBERTa</strong> [8]。这赋予了模型强大的语言理解能力，且支持多语言。</li>
</ul>
<ol start="2">
<li></li>
</ol>
<p>视觉编码器 (Vision Encoder) ：</p>
<ul>
<li>遵循 <strong>YOLO-like</strong> 的架构风格。</li>
<li><strong>Backbone (骨干)</strong>：使用 <strong>ConvNeXt</strong> [49]。作者特别选择它而不是 CLIP 常用的 ViT，因为 ConvNeXt 是卷积网络，天然能产生多尺度特征金字塔，这对于检测不同大小的物体至关重要。</li>
<li></li>
</ul>
<p><strong>Neck (颈部)</strong>：使用 <strong>CSPRepBiFPAN</strong> [37]。这是一个高效的特征金字塔网络，用于聚合多尺度特征。<strong>关键点</strong>：这里<strong>没有任何</strong>跨模态融合层 。</p>
<ul>
<li><strong>Head (头部)</strong>：使用 <strong>YOLO-World</strong> [7] 的对比头（Contrastive Head）。</li>
</ul>
<p><strong>C. 损失函数与训练配置</strong></p>
<ul>
<li>
<p><strong>损失函数</strong>：沿用 YOLO-World 的策略，包括：</p>
</li>
<li>
<p><strong>区域-文本对比损失 (Region-text contrastive loss)</strong>：用于分类。</p>
</li>
<li>
<p><strong>边界框回归损失 (Box regression loss)</strong>：用于定位（通常包含 IoU Loss 和 L1 Loss）。</p>
</li>
<li>
<p><strong>标签分配 (Label Assignment)</strong>：同样沿用 YOLO-World 的策略。</p>
</li>
</ul>
<p><strong>D.数据流动</strong></p>
<p>文本这条路：Text Encoder（左下角）</p>
<ul>
<li>输入：类别名/短语，比如 <code>[&quot;dog&quot;, &quot;red car&quot;, &quot;streetlight&quot;]</code></li>
<li>输出：每个类别一个<strong>文本 embedding</strong></li>
<li>初始化：语言编码器来自 <strong>XLM-RoBERTa</strong>（论文里明确写了）Fu 等 - 2025 - WeDetect Fast Ope…</li>
</ul>
<blockquote>
<p>直观理解：
Text Encoder 就像“把关键词做成搜索向量”。</p>
</blockquote>
<hr>
<p>图像这条路：YOLO-like Vision Encoder（左下角另一块）</p>
<ul>
<li>backbone 用 <strong>ConvNeXt</strong>：产出多尺度特征（例如 1/8、1/16、1/32 尺度那类感觉）Fu 等 - 2025 - WeDetect Fast Ope…</li>
<li>neck 用 <strong>CSPRepBiFPAN</strong>：把多尺度信息“上上下下传一遍”，让每个尺度都更强Fu 等 - 2025 - WeDetect Fast Ope…</li>
<li>head 用 <strong>YOLO-World contrastive head</strong>：在各个网格位置上产生用于对比/匹配的特征Fu 等 - 2025 - WeDetect Fast Ope…</li>
</ul>
<blockquote>
<p>直观理解：
这整条视觉分支就是“实时检测器的经典配方”，只不过最后的分类方式换成了“和文本向量对比”。</p>
</blockquote>
<h3 id="4-重点内容梳理-3"><a class="header-anchor" href="#4-重点内容梳理-3"></a><strong>4. 重点内容梳理</strong></h3>
<ul>
<li>
<p><strong>极简即极速</strong>：WeDetect 的核心哲学是“做减法”。它去掉了所有中间层的 Vision-Language Fusion。这意味着：</p>
</li>
<li>
<p><strong>特征解耦</strong>：视觉特征不再依赖于输入的文本（Query-agnostic）。</p>
</li>
<li>
<p><strong>一次提取，多次复用</strong>：对于同一张图片，视觉特征只需要计算一次，就可以和任意数量、任意内容的文本 Prompt 进行匹配（点积）。这正是它实现实时推理和“对象检索”功能的物理基础。</p>
</li>
<li>
<p><strong>ConvNeXt 的上位</strong>：作者指出了标准 CLIP (ViT) 在检测任务上的水土不服（缺乏多尺度），因此换用了 ConvNeXt。这说明在做 OVOD（开放词汇检测）时，直接照搬 CLIP 的 Image Encoder 并非最优解。</p>
</li>
</ul>
<hr>
<h2 id="3-2-Dataset-Construction-数据集构建"><a class="header-anchor" href="#3-2-Dataset-Construction-数据集构建"></a><strong>3.2. Dataset Construction (数据集构建)</strong></h2>
<h3 id="1-本小节概论-5"><a class="header-anchor" href="#1-本小节概论-5"></a><strong>1. 本小节概论</strong></h3>
<p>本小节详细描述了作者如何构建一个包含 1500 万（15M）张图像和 3.3 亿（330M）个边界框（Bounding Boxes）的高质量开放词汇目标检测数据集。</p>
<p>作者指出，现有的开源数据集（如 GoldG）在规模、多样性和标注完整性上存在局限。为此，作者提出了一套<strong>自动数据引擎（Automatic Data Engine）</strong>，通过结合通用物体检测器和现代大模型（Qwen2.5-VL），生成了具有**多粒度（Multi-granularity）<strong>和</strong>实例特定（Instance-specific）**标签的高质量标注。</p>
<h3 id="2-关键概念-符号表-5"><a class="header-anchor" href="#2-关键概念-符号表-5"></a><strong>2. 关键概念/符号表</strong></h3>
<table>
<thead>
<tr>
<th>概念/术语</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Data Engine</strong></td>
<td><strong>数据引擎</strong>：指作者设计的一套自动化流程，用于从海量原始图片中自动生成高质量的目标检测标注（边界框+类别文本）。</td>
</tr>
<tr>
<td><strong>Objectness Detector</strong></td>
<td><strong>物体性检测器</strong>：一个经过训练的检测器，旨在找出图中“所有像物体”的区域，而不关注具体类别。这确保了标注的完整性（Recall）。</td>
</tr>
<tr>
<td><strong>Hierarchical Labels</strong></td>
<td><strong>层级标签</strong>：指对同一个物体提供从粗到细的多种描述。例如，一只狗被标注为 <code>[animal, dog, a yellow dog]</code>（动物 -&gt; 狗 -&gt; 一只黄狗）。</td>
</tr>
<tr>
<td><strong>Structural Output</strong></td>
<td><strong>结构化输出</strong>：要求 LMM（大模型）按照固定的模板格式输出标签，先输出粗粒度，再输出细粒度，便于解析和使用。</td>
</tr>
<tr>
<td><strong>Rejecting Recognition</strong></td>
<td><strong>拒绝识别</strong>：指 LMM 具备判断能力，如果检测器提供的候选框其实不是物体或质量很差，LMM 选择不生成标签，直接丢弃该框，起到过滤作用。</td>
</tr>
<tr>
<td><strong>SAM (Segment Anything Model)</strong></td>
<td><strong>分割一切模型</strong>：Meta 提出的图像分割模型。作者利用 SAM 生成的掩码（Mask）作为辅助输入，帮助 LMM 更精准地感知物体边界。</td>
</tr>
</tbody>
</table>
<h3 id="3-关键算法流程-自动标注数据引擎"><a class="header-anchor" href="#3-关键算法流程-自动标注数据引擎"></a><strong>3. 关键算法流程 (自动标注数据引擎)</strong></h3>
<p>作者在文中（Figure 2）展示了数据引擎的两个核心步骤：</p>
<p><img src="/blog/2026/01/21/%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E6%A3%80%E6%B5%8B/WeDetect/%E3%80%90WeDetect%E3%80%91%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/image-20260121145945496.png" alt="image-20260121145945496"></p>
<ul>
<li>
<p><strong>Step 1: 召回所有物体 (Recall)</strong></p>
</li>
<li>
<p>使用一个在所有可用检测数据集上训练的<strong>物体性检测器（Objectness Detector）</strong>，检测图像中所有感兴趣的区域（Proposals）。</p>
</li>
<li>
<p>目标：确保不漏掉任何潜在物体（High Recall）。</p>
</li>
<li>
<p><strong>Step 2: 生成多粒度标签 (Labeling)</strong></p>
</li>
<li>
<p>利用多模态大模型 <strong>Qwen2.5-VL 7B</strong> 为每个检测到的区域生成标签。</p>
</li>
<li>
<p><strong>输入增强</strong>：为了让 Qwen2.5-VL 看得更准，不仅输入框的坐标，还利用 <strong>SAM</strong> 生成物体的掩码（Mask）并在原图上高亮显示物体边界。</p>
</li>
<li>
<p><strong>模型微调 (SFT)</strong>：作者使用人工标注的数据对 Qwen2.5-VL 进行了微调（SFT），使其具备“结构化输出”和“拒绝识别”的能力。</p>
</li>
</ul>
<h3 id="4-本小节全部内容讲解-2"><a class="header-anchor" href="#4-本小节全部内容讲解-2"></a><strong>4. 本小节全部内容讲解</strong></h3>
<p>结合文中描述 ，数据集构建过程分为三个层面：</p>
<p><strong>A. 源图像采样 (Source image sampling)</strong></p>
<ul>
<li><strong>来源</strong>：图像来自多个数据集，包括 SAM-1B [31], LAION [62], CC12M [4], Zero [74] 以及从授权网站自行爬取的数据。</li>
<li><strong>策略</strong>：为了解决长尾问题（Long-tail distribution），作者利用原始的图像描述文本（Caption）来筛选稀有对应的图像，从而<strong>平衡概念（Balance the concepts）</strong>。</li>
<li><strong>规模</strong>：总共收集了 <strong>15M</strong> 张涵盖广泛领域的图像。</li>
</ul>
<p><strong>B. 自动标注流水线 (Box annotation pipeline)</strong></p>
<ul>
<li><strong>问题</strong>：开源数据集（如 GoldG）虽然文本多样，但图片多样性和标注完整性不足。</li>
<li><strong>解决方案</strong>：</li>
</ul>
<ol>
<li><strong>通用检测</strong>：先用一个强力的物体性检测器把图里能找到的东西都框出来，保证<strong>完整性（Integrity）</strong>。</li>
<li><strong>LMM 标注</strong>：用 Qwen2.5-VL 生成标签。这里有一个创新点——<strong>层级标签（Hierarchical labels）</strong>。</li>
</ol>
<ul>
<li><em>例子</em>：对于一只狗，生成的标签不是单纯的 &quot;dog&quot;，而是 <code>[&quot;animal&quot;, &quot;dog&quot;, &quot;a yellow dog&quot;]</code>。</li>
<li><em>作用</em>：这种多粒度的标签极大地丰富了文本的多样性，对训练开放词汇能力至关重要。</li>
</ul>
<ol start="3">
<li><strong>LMM 微调</strong>：为了保证质量，作者专门微调了标注用的 Qwen 模型。微调后的模型能做两件事：</li>
</ol>
<ul>
<li><strong>按格式说话</strong>：先粗后细，结构化输出。</li>
<li><strong>懂得拒绝</strong>：如果第一步检测出来的框是错的（比如框了一片空气），LMM 会拒绝生成标签，这个框就会被丢弃。这相当于对第一步的检测结果做了一次验证（Validation）。</li>
</ul>
<p><strong>C. 数据集总览</strong></p>
<ul>
<li><strong>自建数据</strong>：15M 图像，330M 边界框。</li>
<li><strong>开源数据融合</strong>：除了自建的，训练时还加入了一系列高质量的开源检测/定位数据集，包括 OpenImages V6, Objects365 V2, V3Det, ImageNetBox 和 GoldG。</li>
</ul>
<h3 id="5-重点内容梳理-2"><a class="header-anchor" href="#5-重点内容梳理-2"></a><strong>5. 重点内容梳理</strong></h3>
<ul>
<li>
<p><strong>&quot;多粒度&quot;是核心</strong>：WeDetect 之所以能听懂各种 Prompt（从类别名到具体描述），很大程度上归功于这里的“层级标签”策略。模型在训练时既见过 &quot;animal&quot; 也见过 &quot;a yellow dog&quot; 对应同一个框，这建立了强大的跨层级对齐能力。</p>
</li>
<li>
<p><strong>以大模型养小模型</strong>：这是一个典型的数据飞轮案例。利用强大的慢速模型（Qwen2.5-VL）生成高质量数据，用来训练快速的小模型（WeDetect），从而将大模型的知识“蒸馏”进检测器的数据分布中。</p>
</li>
<li>
<p><strong>质量控制</strong>：通过微调标注模型来实现“拒绝识别”，有效地清洗了自动生成的噪声数据，这是自动标注大规模数据集时保证质量的关键一环。</p>
</li>
</ul>
<h2 id="3-3-Model-Training-模型训练"><a class="header-anchor" href="#3-3-Model-Training-模型训练"></a>3.3. Model Training (模型训练)</h2>
<h3 id="1-本小节概论-6"><a class="header-anchor" href="#1-本小节概论-6"></a><strong>1. 本小节概论</strong></h3>
<p>本小节详细阐述了 WeDetect 的训练策略。为了让双塔架构（Dual-tower）具备强大的开放词汇能力，作者采用了**分阶段训练（Staged-wise training）<strong>方法，从图像级预训练逐步过渡到全参数微调。此外，为了充分利用自建数据集中的层级标签，作者提出了一种</strong>多粒度标签采样（Multi-granularity label sampling）**策略，作为一种数据增强手段，极大丰富了训练时的负样本多样性。</p>
<h3 id="2-关键概念-符号表-6"><a class="header-anchor" href="#2-关键概念-符号表-6"></a><strong>2. 关键概念/符号表</strong></h3>
<table>
<thead>
<tr>
<th>概念/术语</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Staged-wise Training</strong></td>
<td><strong>分阶段训练</strong>：将训练过程分为多个步骤（预训练 -&gt; 冻结骨干训练颈/头 -&gt; 全参数微调），以稳定地迁移预训练知识。</td>
</tr>
<tr>
<td><strong>End-to-end Manner</strong></td>
<td><strong>端到端方式</strong>：指在最后阶段，解冻所有参数（包括 Backbone, Neck, Head），让整个网络一起更新，以达到全局最优。</td>
</tr>
<tr>
<td><strong>Multi-granularity Label Sampling</strong></td>
<td><strong>多粒度标签采样</strong>：在训练时，对于同一个物体，不固定使用某一个标签，而是从其对应的层级标签列表（如 <code>[animal, dog, yellow dog]</code>）中随机采样一个作为当前的 Ground Truth。</td>
</tr>
<tr>
<td><strong>Training-time-specific Vocabulary</strong></td>
<td><strong>训练时特定词汇表</strong>：由于每个 batch 中采样的标签都在变化，这使得每个 batch 构建的负样本集合（Negative Samples）都是动态且多样的，有助于模型学习更鲁棒的特征。</td>
</tr>
</tbody>
</table>
<h3 id="3-关键算法流程-训练策略"><a class="header-anchor" href="#3-关键算法流程-训练策略"></a><strong>3. 关键算法流程 (训练策略)</strong></h3>
<p><strong>A. 分阶段训练策略 (Staged-wise training method)</strong></p>
<ul>
<li>
<p><strong>Step 1: 图像级预训练 (Pretraining)</strong></p>
</li>
<li>
<p>目标：获得基础的开放词汇能力。</p>
</li>
<li>
<p>做法：在海量图文数据集上进行 CLIP 式的<strong>图像级</strong>对比学习预训练。</p>
</li>
<li>
<p>结果：得到预训练权重，用于初始化 WeDetect 的<strong>视觉骨干（Visual Backbone）<strong>和</strong>语言编码器（Language Encoder）</strong>。</p>
</li>
<li>
<p><strong>Step 2: 颈部与头部预热 (Neck &amp; Head Warm-up)</strong></p>
</li>
<li>
<p>背景：此时 Neck 和 Head 是随机初始化的，若直接全量训练会破坏 Backbone 的预训练特征。</p>
</li>
<li>
<p>做法：<strong>冻结</strong>视觉骨干和语言编码器，<strong>仅训练</strong>剩下的组件（Neck 和 Head）。</p>
</li>
<li>
<p><strong>Step 3: 端到端微调 (End-to-end Finetuning)</strong></p>
</li>
<li>
<p>做法：解冻所有参数，进行全量训练。</p>
</li>
<li>
<p>意义：将从图像级学到的知识完全迁移并适配到区域级（Region-level）任务上。</p>
</li>
</ul>
<p><strong>B. 多粒度标签采样 (Multi-granularity label sampling)</strong></p>
<ul>
<li><strong>机制</strong>：对于每个物体，独立地从其候选标签列表（由 3.2 节所述数据引擎生成）中采样一个标签。</li>
<li><strong>效果</strong>：</li>
</ul>
<ol>
<li><strong>单体监督</strong>：为单个物体提供了精细且多样的文本描述监督。</li>
<li><strong>群体负样本</strong>：构建了一个多样化的、随训练迭代变化的词汇表。这意味着在计算对比损失时，模型面对的负样本（Batch 内的其他标签）更加丰富，从而提升了判别能力。</li>
</ol>
<h3 id="4-本小节全部内容讲解-3"><a class="header-anchor" href="#4-本小节全部内容讲解-3"></a><strong>4. 本小节全部内容讲解</strong></h3>
<p>结合文中描述 ，我们深入剖析：</p>
<ol>
<li><strong>为什么要分阶段？</strong>
作者非常清楚，WeDetect 的核心优势在于利用了大规模数据的预训练知识（CLIP-style）。但检测任务（Region-level）和预训练任务（Image-level）有 gap。如果上来就全参数狂练，随机初始化的检测头（Head）会产生巨大的梯度噪声，把 Backbone 辛辛苦苦学好的通用特征给“带偏”了。因此，<strong>Step 2</strong> 是一个关键的保护性过渡，先让 Head 学会怎么配合 Backbone，再让大家一起进步（<strong>Step 3</strong>）。</li>
<li><strong>数据增强的智慧：标签采样</strong>
在 3.2 节我们知道，一只狗可能被标记为 <code>[&quot;animal&quot;, &quot;dog&quot;, &quot;a yellow dog&quot;]</code>。</li>
</ol>
<ul>
<li><strong>传统做法</strong>：可能固定选最细粒度的 &quot;a yellow dog&quot;，或者最常见的 &quot;dog&quot;。</li>
<li><strong>WeDetect 做法</strong>：这次迭代选 &quot;dog&quot;，下次迭代可能选 &quot;animal&quot;。</li>
<li><strong>妙处</strong>：这不仅让模型学会了这三个词都对应这个物体（层级理解），更重要的是，在对比学习（Contrastive Learning）中，同一个 Batch 里其他物体的标签构成了负样本。如果标签总是变的，那么负样本的分布就是极其丰富多样的。这实际上是在文本模态上做了一种强大的数据增强（Data Augmentation）。</li>
</ul>
<h3 id="5-重点内容梳理-3"><a class="header-anchor" href="#5-重点内容梳理-3"></a><strong>5. 重点内容梳理</strong></h3>
<ul>
<li><strong>保护预训练知识</strong>：分阶段训练的核心逻辑是“由粗到细、由冻结到解冻”，防止下游任务的随机初始化参数破坏上游的预训练特征。</li>
<li><strong>动态词汇表</strong>：多粒度标签采样不仅仅是让模型看懂不同的词，更重要的是它构建了一个动态变化的负样本池，这对于对比学习（Contrastive Learning）的效果至关重要。</li>
</ul>
<hr>
<p>好的，我们继续进行论文精读。现在进入 <strong>4. WeDetect-Uni: A Universal Proposal Generator（WeDetect-Uni：通用候选框生成器）</strong> 章节。</p>
<p>这一节介绍了如何基于 WeDetect 构建一个通用的候选框生成器，并开启了一个极具应用价值的新任务——<strong>对象检索（Object Retrieval）</strong>，这是 WeDetect 家族“检索哲学”的集中体现。</p>
<hr>
<h1 id="4-WeDetect-Uni-A-Universal-Proposal-Generator"><a class="header-anchor" href="#4-WeDetect-Uni-A-Universal-Proposal-Generator"></a>4. WeDetect-Uni: A Universal Proposal Generator</h1>
<p>(WeDetect-Uni: 通用候选框生成器)</p>
<h2 id="1-本小节概论-7"><a class="header-anchor" href="#1-本小节概论-7"></a><strong>1. 本小节概论</strong></h2>
<ul>
<li>本小节介绍了 <strong>WeDetect-Uni</strong>。</li>
<li>这是一个基于 WeDetect 的变体，旨在不依赖用户提供的特定文本提示，就能自动提取图像中所有潜在的物体（Universal Proposals）。</li>
<li>作者通过冻结整个检测器并仅微调一个“通用物体性提示（Universal Objectness Prompt）”来实现这一点。更重要的是，生成的候选框嵌入（Embeddings）保留了类别特征，这使得作者能够定义一种新的**对象检索（Object Retrieval）**任务——即在数据库中检索包含特定细粒度物体的图像（如检索“烟头”），这是传统 CLIP 图像级检索难以做到的。</li>
</ul>
<h2 id="2-关键概念-符号表-7"><a class="header-anchor" href="#2-关键概念-符号表-7"></a><strong>2. 关键概念/符号表</strong></h2>
<table>
<thead>
<tr>
<th>概念/术语</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>WeDetect-Uni</strong></td>
<td><strong>通用候选框生成器</strong>：WeDetect 家族成员，通过通用提示找出图中的所有物体，不局限于特定类别。</td>
</tr>
<tr>
<td><strong>Universal Objectness Prompt</strong></td>
<td><strong>通用物体性提示</strong>：一个可学习的文本提示（Learnable Prompt），用于替代具体的类别名称，指示模型“找出所有物体”。</td>
</tr>
<tr>
<td><strong>Linear Probing Finetuning</strong></td>
<td><strong>线性探测微调</strong>：一种训练策略，保持骨干网络冻结，仅训练分类头或（在本例中）特定的提示向量。</td>
</tr>
<tr>
<td><strong>Class-specific Embeddings</strong></td>
<td><strong>类别特定嵌入</strong>：尽管使用通用提示提取框，但这些框对应的视觉嵌入（Box Embeddings）仍然保留了丰富的语义信息，可用于后续的分类或检索。</td>
</tr>
<tr>
<td><strong>Object Retrieval</strong></td>
<td><strong>对象检索</strong>：本文提出的新任务。目标是从数据库中检索包含用户指定物体（特别是小物体或局部细节）的图像，关注局部语义而非全局语义。</td>
</tr>
</tbody>
</table>
<h2 id="3-关键算法流程"><a class="header-anchor" href="#3-关键算法流程"></a><strong>3. 关键算法流程</strong></h2>
<p>结合文中 Figure 1(b) 和 Figure 3，核心流程如下：</p>
<p><img src="/blog/2026/01/21/%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E6%A3%80%E6%B5%8B/WeDetect/%E3%80%90WeDetect%E3%80%91%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/image-20260121144632613.png" alt="image-20260121144632613"></p>
<p><strong>A. 模型转换 (从 WeDetect 到 WeDetect-Uni)</strong></p>
<ul>
<li>
<p><strong>冻结参数</strong>：完全冻结 WeDetect 的视觉编码器和文本编码器参数 。</p>
</li>
<li>
<p><strong>微调提示</strong>：仅训练一个通用的、可学习的 <strong>Objectness Prompt</strong> 。</p>
</li>
<li>
<p><strong>推理</strong>：将这个通用提示作为文本输入，模型输出所有置信度高的候选框（Proposals）。</p>
</li>
</ul>
<p><img src="/blog/2026/01/21/%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E6%A3%80%E6%B5%8B/WeDetect/%E3%80%90WeDetect%E3%80%91%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/image-20260121154950585.png" alt="image-20260121154950585"></p>
<p><strong>B. 对象检索流程 (Object Retrieval Pipeline)</strong></p>
<ol>
<li><strong>离线索引 (Offline Indexing)</strong>：</li>
</ol>
<ul>
<li>使用 WeDetect-Uni 处理所有图像。</li>
<li>提取得分最高的 Top-K 个候选框。</li>
<li><strong>缓存 (Cache)</strong>：保存这些候选框对应的<strong>视觉嵌入（Box Embeddings）</strong>，作为图像的特征表示（每张图对应一组向量）。</li>
</ul>
<ol start="2">
<li><strong>在线检索 (Online Retrieval)</strong>：</li>
</ol>
<ul>
<li>
<p>用户输入查询文本（如 &quot;red car&quot;）。</p>
</li>
<li>
<p>将查询文本编码为文本嵌入。</p>
</li>
<li>
<p><strong>点积匹配</strong>：将文本嵌入与数据库中缓存的所有 Box Embeddings 进行点积计算相似度 。</p>
</li>
<li>
<p>返回包含最高相似度物体的图像。</p>
</li>
</ul>
<h2 id="4-本小节全部内容讲解-4"><a class="header-anchor" href="#4-本小节全部内容讲解-4"></a><strong>4. 本小节全部内容讲解</strong></h2>
<p>本节内容层层递进，主要包含三个部分：</p>
<ol>
<li><strong>通过通用物体性提示提取任意物体</strong></li>
</ol>
<ul>
<li><strong>目的</strong>：摆脱“必须先知道找什么（Prompt）才能检测”的限制，实现类似 RPN（区域建议网络）的功能，但更强大。</li>
<li><strong>方法</strong>：这是一种类似线性探测（Linear Probing）的微调。由于 WeDetect 的特征已经足够强（Discriminative），只需要训练一个简单的 Prompt 告诉模型“把所有像物体的东西挑出来”即可，而不需要重新训练网络。</li>
<li><strong>关键特性</strong>：不同于传统的类无关（Class-agnostic）网络（通常只输出坐标），WeDetect-Uni 输出的候选框对应的特征向量（Embeddings）依然是**类别特定（Class-specific）**的。这意味着这些特征不仅知道“这里有个东西”，还隐含了“这是个什么东西”的信息。</li>
</ul>
<hr>
<ol start="2">
<li><strong>新任务：局部对象检索 (Object Retrieval)</strong></li>
</ol>
<ul>
<li>
<p><strong>定义</strong>：检索所有包含用户指定对象类别的图像。</p>
</li>
<li>
<p><strong>与 CLIP 的区别</strong>：</p>
</li>
<li>
<p><strong>CLIP (Image-text Retrieval)</strong>：关注全局语义（Global Semantics）。适合搜“海滩风景”、“一群人在聚会”。不适合搜小物体（如“地上的烟头”）。</p>
</li>
<li>
<p><strong>WeDetect-Uni (Object Retrieval)</strong>：关注局部语义（Local Semantics）。适合精细化感知，是对 CLIP 的有力补充。</p>
</li>
<li>
<p><strong>应用场景</strong>：关键词图片检索、内容审查（如鉴黄鉴暴中的特定标志）、安防监控等。</p>
</li>
</ul>
<hr>
<ol start="3">
<li><strong>应用 WeDetect-Uni 进行对象检索</strong></li>
</ol>
<ul>
<li><strong>表示差异</strong>：CLIP 用一个向量代表一张图；WeDetect-Uni 用一组对象向量（Set of object embeddings）代表一张图。</li>
<li><strong>速度优势</strong>：一旦图像被处理并缓存了 Box Embeddings，新的查询只需进行简单的矩阵乘法（点积），速度极快，无需重新运行图像编码器。这使得“快速回溯历史数据”成为可能（比如在几个月前的监控视频中搜“红色书包”）。</li>
</ul>
<h2 id="5-重点内容梳理-4"><a class="header-anchor" href="#5-重点内容梳理-4"></a><strong>5. 重点内容梳理</strong></h2>
<ul>
<li><strong>&quot;Fast Backtrack&quot;（快速回溯）</strong>：这是 WeDetect-Uni 最具工业价值的亮点。在实际业务中（如相册搜索、视频分析），用户需求是多变的。如果每换一个词都要重跑一遍模型，成本不可接受。WeDetect-Uni 允许先用通用 Prompt 把所有可能的物体特征存下来（结构化），以后用户搜什么，直接查特征库即可，实现了<strong>一次推理，无限次检索</strong>。</li>
<li><strong>双重身份</strong>：WeDetect-Uni 既是一个候选框生成器（为下一节的 WeDetect-Ref 打辅助），又是一个独立的检索引擎（Object Retrieval），充分体现了作者对双塔架构特征复用性的挖掘。</li>
</ul>
<hr>
<h1 id="5-WeDetect-Ref-An-LLM-Based-REC-Model"><a class="header-anchor" href="#5-WeDetect-Ref-An-LLM-Based-REC-Model"></a><strong>5. WeDetect-Ref: An LLM-Based REC Model</strong></h1>
<h2 id="5-1-Formulating-REC-as-Retrieval-将指代理解建模为检索"><a class="header-anchor" href="#5-1-Formulating-REC-as-Retrieval-将指代理解建模为检索"></a><strong>5.1. Formulating REC as Retrieval (将指代理解建模为检索)</strong></h2>
<h3 id="1-本小节概论-8"><a class="header-anchor" href="#1-本小节概论-8"></a><strong>1. 本小节概论</strong></h3>
<ul>
<li>本小节提出了 WeDetect-Ref 的核心设计理念。</li>
<li>作者首先指出了直接使用大模型（LMM）进行目标检测面临的两大挑战：<strong>回归缺陷（Regression Drawback）</strong>（语言模型不擅长生成精确坐标）和<strong>推理延迟（Latency）</strong>（逐词预测速度太慢）。</li>
<li>为了解决这些问题，作者提出将指代理解（REC）任务重新建模为<strong>检索任务</strong>：利用 WeDetect-Uni 预先生成候选框，然后让 LMM 作为一个二分类器，并行地判断哪些候选框符合用户的文本描述，从而在单次前向传播中完成检测。</li>
</ul>
<h3 id="2-关键概念-符号表-8"><a class="header-anchor" href="#2-关键概念-符号表-8"></a><strong>2. 关键概念/符号表</strong></h3>
<table>
<thead>
<tr>
<th>概念/术语</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>REC (Referring Expression Comprehension)</strong></td>
<td><strong>指代性表达理解</strong>：根据自然语言描述（如“左边那个穿着红衣服的人”）在图像中定位特定目标。</td>
</tr>
<tr>
<td><strong>Regression Drawback</strong></td>
<td><strong>回归缺陷</strong>：LLM 本质上是处理离散 token 的概率模型，强行让它生成连续的坐标数值（通过分类损失优化），效果往往不如专门的回归模型。</td>
</tr>
<tr>
<td><strong>Next-token Prediction</strong></td>
<td><strong>下一个词预测</strong>：传统 LLM 的生成模式，必须串行地一个接一个生成 token。如果要检测 10 个物体，就需要极长的生成过程，导致推理慢。</td>
</tr>
<tr>
<td><strong>Retrieval-based Paradigm</strong></td>
<td><strong>基于检索的范式</strong>：本文提出的方法。不让 LLM 生成框，而是给它一堆备选框，让它从中“挑”出正确的。</td>
</tr>
<tr>
<td><strong>RoI 特征 / RoIAlign</strong></td>
<td>对每个候选框，从视觉编码器的多尺度特征里抠出该区域特征（更聚焦这个物体）。</td>
</tr>
<tr>
<td><strong>对象 token
    <span id="mjx-800cec2">
      <style>
      #mjx-800cec2{
        display:contents;
        mjx-assistive-mml {
          user-select: text !important;
          clip: auto !important;
          color: rgba(0,0,0,0);
        }
        
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

      }
      </style>
      <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="4.099ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 1812 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="7B" d="M434 -231Q434 -244 428 -250H410Q281 -250 230 -184Q225 -177 222 -172T217 -161T213 -148T211 -133T210 -111T209 -84T209 -47T209 0Q209 21 209 53Q208 142 204 153Q203 154 203 155Q189 191 153 211T82 231Q71 231 68 234T65 250T68 266T82 269Q116 269 152 289T203 345Q208 356 208 377T209 529V579Q209 634 215 656T244 698Q270 724 324 740Q361 748 377 749Q379 749 390 749T408 750H428Q434 744 434 732Q434 719 431 716Q429 713 415 713Q362 710 332 689T296 647Q291 634 291 499V417Q291 370 288 353T271 314Q240 271 184 255L170 250L184 245Q202 239 220 230T262 196T290 137Q291 131 291 1Q291 -134 296 -147Q306 -174 339 -192T415 -213Q429 -213 431 -216Q434 -219 434 -231Z"></path></g><g data-mml-node="msub" transform="translate(500,0)"><g data-mml-node="mi"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(518,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(1312,0)"><path data-c="7D" d="M65 731Q65 745 68 747T88 750Q171 750 216 725T279 670Q288 649 289 635T291 501Q292 362 293 357Q306 312 345 291T417 269Q428 269 431 266T434 250T431 234T417 231Q380 231 345 210T298 157Q293 143 292 121T291 -28V-79Q291 -134 285 -156T256 -198Q202 -250 89 -250Q71 -250 68 -247T65 -230Q65 -224 65 -223T66 -218T69 -214T77 -213Q91 -213 108 -210T146 -200T183 -177T207 -139Q208 -134 209 3L210 139Q223 196 280 230Q315 247 330 250Q305 257 280 270Q225 304 212 352L210 362L209 498Q208 635 207 640Q195 680 154 696T77 713Q68 713 67 716T65 731Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><msub><mi>o</mi><mi>i</mi></msub><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml></mjx-container>
    </span>
  </strong></td>
<td>把每个候选框的 RoI 特征通过线性投影压成<strong>一个 token</strong>（论文里叫 object projector）。</td>
</tr>
<tr>
<td><strong>Object Projector</strong></td>
<td><strong>对象投影器</strong>：一个线性层，用于将提取出的物体视觉特征压缩成一个单一的 token，以便输入给 LLM。</td>
</tr>
<tr>
<td><strong>Binary Classification Head</strong></td>
<td><strong>二分类头</strong>：加在 LLM 输出层的简单分类器，用于对每个对象 token 输出 0 到 1 的概率（是目标/不是目标）。</td>
</tr>
</tbody>
</table>
<h3 id="3-关键公式-算法-2"><a class="header-anchor" href="#3-关键公式-算法-2"></a><strong>3. 关键公式/算法</strong></h3>
<p>作者定义了全新的推理流程：</p>
<ol>
<li>
<p><strong>候选生成</strong>：首先利用 WeDetect-Uni 提取 
    <span id="mjx-426b5e9">
      <style>
      #mjx-426b5e9{
        display:contents;
        mjx-assistive-mml {
          user-select: text !important;
          clip: auto !important;
          color: rgba(0,0,0,0);
        }
        
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

      }
      </style>
      <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="1.357ex" height="1.025ex" role="img" focusable="false" viewBox="0 -442 600 453" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></mjx-assistive-mml></mjx-container>
    </span>
   个候选对象 
    <span id="mjx-23c41a5">
      <style>
      #mjx-23c41a5{
        display:contents;
        mjx-assistive-mml {
          user-select: text !important;
          clip: auto !important;
          color: rgba(0,0,0,0);
        }
        
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

      }
      </style>
      <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg style="vertical-align: -0.8ex;" xmlns="http://www.w3.org/2000/svg" width="7.504ex" height="2.497ex" role="img" focusable="false" viewBox="0 -750 3316.6 1103.7" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="7B" d="M434 -231Q434 -244 428 -250H410Q281 -250 230 -184Q225 -177 222 -172T217 -161T213 -148T211 -133T210 -111T209 -84T209 -47T209 0Q209 21 209 53Q208 142 204 153Q203 154 203 155Q189 191 153 211T82 231Q71 231 68 234T65 250T68 266T82 269Q116 269 152 289T203 345Q208 356 208 377T209 529V579Q209 634 215 656T244 698Q270 724 324 740Q361 748 377 749Q379 749 390 749T408 750H428Q434 744 434 732Q434 719 431 716Q429 713 415 713Q362 710 332 689T296 647Q291 634 291 499V417Q291 370 288 353T271 314Q240 271 184 255L170 250L184 245Q202 239 220 230T262 196T290 137Q291 131 291 1Q291 -134 296 -147Q306 -174 339 -192T415 -213Q429 -213 431 -216Q434 -219 434 -231Z"></path></g><g data-mml-node="msub" transform="translate(500,0)"><g data-mml-node="mi"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g><g data-mml-node="mi" transform="translate(792,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="msubsup" transform="translate(1586,0)"><g data-mml-node="mo"><path data-c="7D" d="M65 731Q65 745 68 747T88 750Q171 750 216 725T279 670Q288 649 289 635T291 501Q292 362 293 357Q306 312 345 291T417 269Q428 269 431 266T434 250T431 234T417 231Q380 231 345 210T298 157Q293 143 292 121T291 -28V-79Q291 -134 285 -156T256 -198Q202 -250 89 -250Q71 -250 68 -247T65 -230Q65 -224 65 -223T66 -218T69 -214T77 -213Q91 -213 108 -210T146 -200T183 -177T207 -139Q208 -134 209 3L210 139Q223 196 280 230Q315 247 330 250Q305 257 280 270Q225 304 212 352L210 362L209 498Q208 635 207 640Q195 680 154 696T77 713Q68 713 67 716T65 731Z"></path></g><g data-mml-node="mi" transform="translate(533,363) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="TeXAtom" transform="translate(533,-295.7) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(345,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(1123,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><msub><mi>B</mi><mi>i</mi></msub><msubsup><mo fence="false" stretchy="false">}</mo><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup></math></mjx-assistive-mml></mjx-container>
    </span>
  。</p>
</li>
<li>
<p><strong>特征压缩</strong>：提取每个对象的 RoI 特征，并压缩为单 token 
    <span id="mjx-0b0f5dd">
      <style>
      #mjx-0b0f5dd{
        display:contents;
        mjx-assistive-mml {
          user-select: text !important;
          clip: auto !important;
          color: rgba(0,0,0,0);
        }
        
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

      }
      </style>
      <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg style="vertical-align: -0.8ex;" xmlns="http://www.w3.org/2000/svg" width="6.884ex" height="2.497ex" role="img" focusable="false" viewBox="0 -750 3042.6 1103.7" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="7B" d="M434 -231Q434 -244 428 -250H410Q281 -250 230 -184Q225 -177 222 -172T217 -161T213 -148T211 -133T210 -111T209 -84T209 -47T209 0Q209 21 209 53Q208 142 204 153Q203 154 203 155Q189 191 153 211T82 231Q71 231 68 234T65 250T68 266T82 269Q116 269 152 289T203 345Q208 356 208 377T209 529V579Q209 634 215 656T244 698Q270 724 324 740Q361 748 377 749Q379 749 390 749T408 750H428Q434 744 434 732Q434 719 431 716Q429 713 415 713Q362 710 332 689T296 647Q291 634 291 499V417Q291 370 288 353T271 314Q240 271 184 255L170 250L184 245Q202 239 220 230T262 196T290 137Q291 131 291 1Q291 -134 296 -147Q306 -174 339 -192T415 -213Q429 -213 431 -216Q434 -219 434 -231Z"></path></g><g data-mml-node="msub" transform="translate(500,0)"><g data-mml-node="mi"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(518,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="msubsup" transform="translate(1312,0)"><g data-mml-node="mo"><path data-c="7D" d="M65 731Q65 745 68 747T88 750Q171 750 216 725T279 670Q288 649 289 635T291 501Q292 362 293 357Q306 312 345 291T417 269Q428 269 431 266T434 250T431 234T417 231Q380 231 345 210T298 157Q293 143 292 121T291 -28V-79Q291 -134 285 -156T256 -198Q202 -250 89 -250Q71 -250 68 -247T65 -230Q65 -224 65 -223T66 -218T69 -214T77 -213Q91 -213 108 -210T146 -200T183 -177T207 -139Q208 -134 209 3L210 139Q223 196 280 230Q315 247 330 250Q305 257 280 270Q225 304 212 352L210 362L209 498Q208 635 207 640Q195 680 154 696T77 713Q68 713 67 716T65 731Z"></path></g><g data-mml-node="mi" transform="translate(533,363) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="TeXAtom" transform="translate(533,-295.7) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(345,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(1123,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><msub><mi>o</mi><mi>i</mi></msub><msubsup><mo fence="false" stretchy="false">}</mo><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup></math></mjx-assistive-mml></mjx-container>
    </span>
  。</p>
</li>
<li>
<p><strong>LLM 输入</strong>：将全图特征 
    <span id="mjx-c06dcf2">
      <style>
      #mjx-c06dcf2{
        display:contents;
        mjx-assistive-mml {
          user-select: text !important;
          clip: auto !important;
          color: rgba(0,0,0,0);
        }
        
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

      }
      </style>
      <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.14ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 504 683" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D43C" d="M43 1Q26 1 26 10Q26 12 29 24Q34 43 39 45Q42 46 54 46H60Q120 46 136 53Q137 53 138 54Q143 56 149 77T198 273Q210 318 216 344Q286 624 286 626Q284 630 284 631Q274 637 213 637H193Q184 643 189 662Q193 677 195 680T209 683H213Q285 681 359 681Q481 681 487 683H497Q504 676 504 672T501 655T494 639Q491 637 471 637Q440 637 407 634Q393 631 388 623Q381 609 337 432Q326 385 315 341Q245 65 245 59Q245 52 255 50T307 46H339Q345 38 345 37T342 19Q338 6 332 0H316Q279 2 179 2Q143 2 113 2T65 2T43 1Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi></math></mjx-assistive-mml></mjx-container>
    </span>
  、用户查询 
    <span id="mjx-e685986">
      <style>
      #mjx-e685986{
        display:contents;
        mjx-assistive-mml {
          user-select: text !important;
          clip: auto !important;
          color: rgba(0,0,0,0);
        }
        
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

      }
      </style>
      <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="1.041ex" height="1.439ex" role="img" focusable="false" viewBox="0 -442 460 636" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></mjx-assistive-mml></mjx-container>
    </span>
   和所有对象 token 
    <span id="mjx-d68d462">
      <style>
      #mjx-d68d462{
        display:contents;
        mjx-assistive-mml {
          user-select: text !important;
          clip: auto !important;
          color: rgba(0,0,0,0);
        }
        
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

      }
      </style>
      <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg style="vertical-align: -0.8ex;" xmlns="http://www.w3.org/2000/svg" width="6.884ex" height="2.497ex" role="img" focusable="false" viewBox="0 -750 3042.6 1103.7" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="7B" d="M434 -231Q434 -244 428 -250H410Q281 -250 230 -184Q225 -177 222 -172T217 -161T213 -148T211 -133T210 -111T209 -84T209 -47T209 0Q209 21 209 53Q208 142 204 153Q203 154 203 155Q189 191 153 211T82 231Q71 231 68 234T65 250T68 266T82 269Q116 269 152 289T203 345Q208 356 208 377T209 529V579Q209 634 215 656T244 698Q270 724 324 740Q361 748 377 749Q379 749 390 749T408 750H428Q434 744 434 732Q434 719 431 716Q429 713 415 713Q362 710 332 689T296 647Q291 634 291 499V417Q291 370 288 353T271 314Q240 271 184 255L170 250L184 245Q202 239 220 230T262 196T290 137Q291 131 291 1Q291 -134 296 -147Q306 -174 339 -192T415 -213Q429 -213 431 -216Q434 -219 434 -231Z"></path></g><g data-mml-node="msub" transform="translate(500,0)"><g data-mml-node="mi"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(518,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="msubsup" transform="translate(1312,0)"><g data-mml-node="mo"><path data-c="7D" d="M65 731Q65 745 68 747T88 750Q171 750 216 725T279 670Q288 649 289 635T291 501Q292 362 293 357Q306 312 345 291T417 269Q428 269 431 266T434 250T431 234T417 231Q380 231 345 210T298 157Q293 143 292 121T291 -28V-79Q291 -134 285 -156T256 -198Q202 -250 89 -250Q71 -250 68 -247T65 -230Q65 -224 65 -223T66 -218T69 -214T77 -213Q91 -213 108 -210T146 -200T183 -177T207 -139Q208 -134 209 3L210 139Q223 196 280 230Q315 247 330 250Q305 257 280 270Q225 304 212 352L210 362L209 498Q208 635 207 640Q195 680 154 696T77 713Q68 713 67 716T65 731Z"></path></g><g data-mml-node="mi" transform="translate(533,363) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="TeXAtom" transform="translate(533,-295.7) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(345,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(1123,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><msub><mi>o</mi><mi>i</mi></msub><msubsup><mo fence="false" stretchy="false">}</mo><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup></math></mjx-assistive-mml></mjx-container>
    </span>
   拼接。</p>
</li>
<li>
<p>并行分类：</p>

    <span id="mjx-0f9f1fb">
      <style>
      #mjx-0f9f1fb{
        display:contents;
        mjx-assistive-mml {
          user-select: text !important;
          clip: auto !important;
          color: rgba(0,0,0,0);
        }
        
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

      }
      </style>
      <mjx-container class="MathJax" jax="SVG" display="true" style="position: relative;"><svg style="vertical-align: -0.69ex;" xmlns="http://www.w3.org/2000/svg" width="28.403ex" height="2.387ex" role="img" focusable="false" viewBox="0 -750 12554.1 1055" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="7B" d="M434 -231Q434 -244 428 -250H410Q281 -250 230 -184Q225 -177 222 -172T217 -161T213 -148T211 -133T210 -111T209 -84T209 -47T209 0Q209 21 209 53Q208 142 204 153Q203 154 203 155Q189 191 153 211T82 231Q71 231 68 234T65 250T68 266T82 269Q116 269 152 289T203 345Q208 356 208 377T209 529V579Q209 634 215 656T244 698Q270 724 324 740Q361 748 377 749Q379 749 390 749T408 750H428Q434 744 434 732Q434 719 431 716Q429 713 415 713Q362 710 332 689T296 647Q291 634 291 499V417Q291 370 288 353T271 314Q240 271 184 255L170 250L184 245Q202 239 220 230T262 196T290 137Q291 131 291 1Q291 -134 296 -147Q306 -174 339 -192T415 -213Q429 -213 431 -216Q434 -219 434 -231Z"></path></g><g data-mml-node="msub" transform="translate(500,0)"><g data-mml-node="mi"><path data-c="210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path></g><g data-mml-node="mi" transform="translate(609,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="msubsup" transform="translate(1403,0)"><g data-mml-node="mo"><path data-c="7D" d="M65 731Q65 745 68 747T88 750Q171 750 216 725T279 670Q288 649 289 635T291 501Q292 362 293 357Q306 312 345 291T417 269Q428 269 431 266T434 250T431 234T417 231Q380 231 345 210T298 157Q293 143 292 121T291 -28V-79Q291 -134 285 -156T256 -198Q202 -250 89 -250Q71 -250 68 -247T65 -230Q65 -224 65 -223T66 -218T69 -214T77 -213Q91 -213 108 -210T146 -200T183 -177T207 -139Q208 -134 209 3L210 139Q223 196 280 230Q315 247 330 250Q305 257 280 270Q225 304 212 352L210 362L209 498Q208 635 207 640Q195 680 154 696T77 713Q68 713 67 716T65 731Z"></path></g><g data-mml-node="mi" transform="translate(533,413) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="TeXAtom" transform="translate(533,-247) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(345,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(1123,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g><g data-mml-node="mo" transform="translate(3411.4,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(4467.1,0)"><path data-c="1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path></g><g data-mml-node="mi" transform="translate(5148.1,0)"><path data-c="1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path></g><g data-mml-node="mi" transform="translate(5829.1,0)"><path data-c="1D440" d="M289 629Q289 635 232 637Q208 637 201 638T194 648Q194 649 196 659Q197 662 198 666T199 671T201 676T203 679T207 681T212 683T220 683T232 684Q238 684 262 684T307 683Q386 683 398 683T414 678Q415 674 451 396L487 117L510 154Q534 190 574 254T662 394Q837 673 839 675Q840 676 842 678T846 681L852 683H948Q965 683 988 683T1017 684Q1051 684 1051 673Q1051 668 1048 656T1045 643Q1041 637 1008 637Q968 636 957 634T939 623Q936 618 867 340T797 59Q797 55 798 54T805 50T822 48T855 46H886Q892 37 892 35Q892 19 885 5Q880 0 869 0Q864 0 828 1T736 2Q675 2 644 2T609 1Q592 1 592 11Q592 13 594 25Q598 41 602 43T625 46Q652 46 685 49Q699 52 704 61Q706 65 742 207T813 490T848 631L654 322Q458 10 453 5Q451 4 449 3Q444 0 433 0Q418 0 415 7Q413 11 374 317L335 624L267 354Q200 88 200 79Q206 46 272 46H282Q288 41 289 37T286 19Q282 3 278 1Q274 0 267 0Q265 0 255 0T221 1T157 2Q127 2 95 1T58 0Q43 0 39 2T35 11Q35 13 38 25T43 40Q45 46 65 46Q135 46 154 86Q158 92 223 354T289 629Z"></path></g><g data-mml-node="mo" transform="translate(6880.1,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(7269.1,0)"><path data-c="1D43C" d="M43 1Q26 1 26 10Q26 12 29 24Q34 43 39 45Q42 46 54 46H60Q120 46 136 53Q137 53 138 54Q143 56 149 77T198 273Q210 318 216 344Q286 624 286 626Q284 630 284 631Q274 637 213 637H193Q184 643 189 662Q193 677 195 680T209 683H213Q285 681 359 681Q481 681 487 683H497Q504 676 504 672T501 655T494 639Q491 637 471 637Q440 637 407 634Q393 631 388 623Q381 609 337 432Q326 385 315 341Q245 65 245 59Q245 52 255 50T307 46H339Q345 38 345 37T342 19Q338 6 332 0H316Q279 2 179 2Q143 2 113 2T65 2T43 1Z"></path></g><g data-mml-node="mo" transform="translate(7773.1,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(8217.8,0)"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mo" transform="translate(8677.8,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mo" transform="translate(9122.5,0)"><path data-c="7B" d="M434 -231Q434 -244 428 -250H410Q281 -250 230 -184Q225 -177 222 -172T217 -161T213 -148T211 -133T210 -111T209 -84T209 -47T209 0Q209 21 209 53Q208 142 204 153Q203 154 203 155Q189 191 153 211T82 231Q71 231 68 234T65 250T68 266T82 269Q116 269 152 289T203 345Q208 356 208 377T209 529V579Q209 634 215 656T244 698Q270 724 324 740Q361 748 377 749Q379 749 390 749T408 750H428Q434 744 434 732Q434 719 431 716Q429 713 415 713Q362 710 332 689T296 647Q291 634 291 499V417Q291 370 288 353T271 314Q240 271 184 255L170 250L184 245Q202 239 220 230T262 196T290 137Q291 131 291 1Q291 -134 296 -147Q306 -174 339 -192T415 -213Q429 -213 431 -216Q434 -219 434 -231Z"></path></g><g data-mml-node="msub" transform="translate(9622.5,0)"><g data-mml-node="mi"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(518,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="msubsup" transform="translate(10434.4,0)"><g data-mml-node="mo"><path data-c="7D" d="M65 731Q65 745 68 747T88 750Q171 750 216 725T279 670Q288 649 289 635T291 501Q292 362 293 357Q306 312 345 291T417 269Q428 269 431 266T434 250T431 234T417 231Q380 231 345 210T298 157Q293 143 292 121T291 -28V-79Q291 -134 285 -156T256 -198Q202 -250 89 -250Q71 -250 68 -247T65 -230Q65 -224 65 -223T66 -218T69 -214T77 -213Q91 -213 108 -210T146 -200T183 -177T207 -139Q208 -134 209 3L210 139Q223 196 280 230Q315 247 330 250Q305 257 280 270Q225 304 212 352L210 362L209 498Q208 635 207 640Q195 680 154 696T77 713Q68 713 67 716T65 731Z"></path></g><g data-mml-node="mi" transform="translate(533,413) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="TeXAtom" transform="translate(533,-247) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(345,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(1123,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g><g data-mml-node="mo" transform="translate(12165.1,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo fence="false" stretchy="false">{</mo><msub><mi>h</mi><mi>i</mi></msub><msubsup><mo fence="false" stretchy="false">}</mo><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mo>=</mo><mi>L</mi><mi>L</mi><mi>M</mi><mo stretchy="false">(</mo><mi>I</mi><mo>,</mo><mi>q</mi><mo>,</mo><mo fence="false" stretchy="false">{</mo><msub><mi>o</mi><mi>i</mi></msub><msubsup><mo fence="false" stretchy="false">}</mo><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>
    </span>
  
    <span id="mjx-1f07bd4">
      <style>
      #mjx-1f07bd4{
        display:contents;
        mjx-assistive-mml {
          user-select: text !important;
          clip: auto !important;
          color: rgba(0,0,0,0);
        }
        
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

      }
      </style>
      <mjx-container class="MathJax" jax="SVG" display="true" style="position: relative;"><svg style="vertical-align: -0.69ex;" xmlns="http://www.w3.org/2000/svg" width="37.413ex" height="2.387ex" role="img" focusable="false" viewBox="0 -750 16536.7 1055" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="7B" d="M434 -231Q434 -244 428 -250H410Q281 -250 230 -184Q225 -177 222 -172T217 -161T213 -148T211 -133T210 -111T209 -84T209 -47T209 0Q209 21 209 53Q208 142 204 153Q203 154 203 155Q189 191 153 211T82 231Q71 231 68 234T65 250T68 266T82 269Q116 269 152 289T203 345Q208 356 208 377T209 529V579Q209 634 215 656T244 698Q270 724 324 740Q361 748 377 749Q379 749 390 749T408 750H428Q434 744 434 732Q434 719 431 716Q429 713 415 713Q362 710 332 689T296 647Q291 634 291 499V417Q291 370 288 353T271 314Q240 271 184 255L170 250L184 245Q202 239 220 230T262 196T290 137Q291 131 291 1Q291 -134 296 -147Q306 -174 339 -192T415 -213Q429 -213 431 -216Q434 -219 434 -231Z"></path></g><g data-mml-node="msub" transform="translate(500,0)"><g data-mml-node="mi"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mi" transform="translate(502,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="msubsup" transform="translate(1296,0)"><g data-mml-node="mo"><path data-c="7D" d="M65 731Q65 745 68 747T88 750Q171 750 216 725T279 670Q288 649 289 635T291 501Q292 362 293 357Q306 312 345 291T417 269Q428 269 431 266T434 250T431 234T417 231Q380 231 345 210T298 157Q293 143 292 121T291 -28V-79Q291 -134 285 -156T256 -198Q202 -250 89 -250Q71 -250 68 -247T65 -230Q65 -224 65 -223T66 -218T69 -214T77 -213Q91 -213 108 -210T146 -200T183 -177T207 -139Q208 -134 209 3L210 139Q223 196 280 230Q315 247 330 250Q305 257 280 270Q225 304 212 352L210 362L209 498Q208 635 207 640Q195 680 154 696T77 713Q68 713 67 716T65 731Z"></path></g><g data-mml-node="mi" transform="translate(533,413) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="TeXAtom" transform="translate(533,-247) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(345,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(1123,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g><g data-mml-node="mo" transform="translate(3304.4,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mtext" transform="translate(4360.1,0)"><path data-c="53" d="M55 507Q55 590 112 647T243 704H257Q342 704 405 641L426 672Q431 679 436 687T446 700L449 704Q450 704 453 704T459 705H463Q466 705 472 699V462L466 456H448Q437 456 435 459T430 479Q413 605 329 646Q292 662 254 662Q201 662 168 626T135 542Q135 508 152 480T200 435Q210 431 286 412T370 389Q427 367 463 314T500 191Q500 110 448 45T301 -21Q245 -21 201 -4T140 27L122 41Q118 36 107 21T87 -7T78 -21Q76 -22 68 -22H64Q61 -22 55 -16V101Q55 220 56 222Q58 227 76 227H89Q95 221 95 214Q95 182 105 151T139 90T205 42T305 24Q352 24 386 62T420 155Q420 198 398 233T340 281Q284 295 266 300Q261 301 239 306T206 314T174 325T141 343T112 367T85 402Q55 451 55 507Z"></path><path data-c="69" d="M69 609Q69 637 87 653T131 669Q154 667 171 652T188 609Q188 579 171 564T129 549Q104 549 87 564T69 609ZM247 0Q232 3 143 3Q132 3 106 3T56 1L34 0H26V46H42Q70 46 91 49Q100 53 102 60T104 102V205V293Q104 345 102 359T88 378Q74 385 41 385H30V408Q30 431 32 431L42 432Q52 433 70 434T106 436Q123 437 142 438T171 441T182 442H185V62Q190 52 197 50T232 46H255V0H247Z" transform="translate(556,0)"></path><path data-c="67" d="M329 409Q373 453 429 453Q459 453 472 434T485 396Q485 382 476 371T449 360Q416 360 412 390Q410 404 415 411Q415 412 416 414V415Q388 412 363 393Q355 388 355 386Q355 385 359 381T368 369T379 351T388 325T392 292Q392 230 343 187T222 143Q172 143 123 171Q112 153 112 133Q112 98 138 81Q147 75 155 75T227 73Q311 72 335 67Q396 58 431 26Q470 -13 470 -72Q470 -139 392 -175Q332 -206 250 -206Q167 -206 107 -175Q29 -140 29 -75Q29 -39 50 -15T92 18L103 24Q67 55 67 108Q67 155 96 193Q52 237 52 292Q52 355 102 398T223 442Q274 442 318 416L329 409ZM299 343Q294 371 273 387T221 404Q192 404 171 388T145 343Q142 326 142 292Q142 248 149 227T179 192Q196 182 222 182Q244 182 260 189T283 207T294 227T299 242Q302 258 302 292T299 343ZM403 -75Q403 -50 389 -34T348 -11T299 -2T245 0H218Q151 0 138 -6Q118 -15 107 -34T95 -74Q95 -84 101 -97T122 -127T170 -155T250 -167Q319 -167 361 -139T403 -75Z" transform="translate(834,0)"></path><path data-c="6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z" transform="translate(1334,0)"></path><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z" transform="translate(2167,0)"></path><path data-c="69" d="M69 609Q69 637 87 653T131 669Q154 667 171 652T188 609Q188 579 171 564T129 549Q104 549 87 564T69 609ZM247 0Q232 3 143 3Q132 3 106 3T56 1L34 0H26V46H42Q70 46 91 49Q100 53 102 60T104 102V205V293Q104 345 102 359T88 378Q74 385 41 385H30V408Q30 431 32 431L42 432Q52 433 70 434T106 436Q123 437 142 438T171 441T182 442H185V62Q190 52 197 50T232 46H255V0H247Z" transform="translate(2667,0)"></path><path data-c="64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693T454 694H457V390Q457 84 458 81Q461 61 472 55T517 46H535V0Q533 0 459 -5T380 -11H373V44L365 37Q307 -11 235 -11Q158 -11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405Q211 405 173 369Q146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26Q322 26 373 103V342Z" transform="translate(2945,0)"></path></g><g data-mml-node="mo" transform="translate(7861.1,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mtext" transform="translate(8250.1,0)"><path data-c="43" d="M56 342Q56 428 89 500T174 615T283 681T391 705Q394 705 400 705T408 704Q499 704 569 636L582 624L612 663Q639 700 643 704Q644 704 647 704T653 705H657Q660 705 666 699V419L660 413H626Q620 419 619 430Q610 512 571 572T476 651Q457 658 426 658Q322 658 252 588Q173 509 173 342Q173 221 211 151Q232 111 263 84T328 45T384 29T428 24Q517 24 571 93T626 244Q626 251 632 257H660L666 251V236Q661 133 590 56T403 -21Q262 -21 159 83T56 342Z"></path><path data-c="6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124T104 167T104 217T104 272T104 329Q104 366 104 407T104 482T104 542T103 586T103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693T182 694H185V379Q185 62 186 60Q190 52 198 49Q219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3T107 3T57 1L34 0H26V46H42Z" transform="translate(722,0)"></path><path data-c="61" d="M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z" transform="translate(1000,0)"></path><path data-c="73" d="M295 316Q295 356 268 385T190 414Q154 414 128 401Q98 382 98 349Q97 344 98 336T114 312T157 287Q175 282 201 278T245 269T277 256Q294 248 310 236T342 195T359 133Q359 71 321 31T198 -10H190Q138 -10 94 26L86 19L77 10Q71 4 65 -1L54 -11H46H42Q39 -11 33 -5V74V132Q33 153 35 157T45 162H54Q66 162 70 158T75 146T82 119T101 77Q136 26 198 26Q295 26 295 104Q295 133 277 151Q257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424T143 442T187 447H198Q238 447 268 432L283 424L292 431Q302 440 314 448H322H326Q329 448 335 442V310L329 304H301Q295 310 295 316Z" transform="translate(1500,0)"></path><path data-c="73" d="M295 316Q295 356 268 385T190 414Q154 414 128 401Q98 382 98 349Q97 344 98 336T114 312T157 287Q175 282 201 278T245 269T277 256Q294 248 310 236T342 195T359 133Q359 71 321 31T198 -10H190Q138 -10 94 26L86 19L77 10Q71 4 65 -1L54 -11H46H42Q39 -11 33 -5V74V132Q33 153 35 157T45 162H54Q66 162 70 158T75 146T82 119T101 77Q136 26 198 26Q295 26 295 104Q295 133 277 151Q257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424T143 442T187 447H198Q238 447 268 432L283 424L292 431Q302 440 314 448H322H326Q329 448 335 442V310L329 304H301Q295 310 295 316Z" transform="translate(1894,0)"></path><path data-c="69" d="M69 609Q69 637 87 653T131 669Q154 667 171 652T188 609Q188 579 171 564T129 549Q104 549 87 564T69 609ZM247 0Q232 3 143 3Q132 3 106 3T56 1L34 0H26V46H42Q70 46 91 49Q100 53 102 60T104 102V205V293Q104 345 102 359T88 378Q74 385 41 385H30V408Q30 431 32 431L42 432Q52 433 70 434T106 436Q123 437 142 438T171 441T182 442H185V62Q190 52 197 50T232 46H255V0H247Z" transform="translate(2288,0)"></path><path data-c="66" d="M273 0Q255 3 146 3Q43 3 34 0H26V46H42Q70 46 91 49Q99 52 103 60Q104 62 104 224V385H33V431H104V497L105 564L107 574Q126 639 171 668T266 704Q267 704 275 704T289 705Q330 702 351 679T372 627Q372 604 358 590T321 576T284 590T270 627Q270 647 288 667H284Q280 668 273 668Q245 668 223 647T189 592Q183 572 182 497V431H293V385H185V225Q185 63 186 61T189 57T194 54T199 51T206 49T213 48T222 47T231 47T241 46T251 46H282V0H273Z" transform="translate(2566,0)"></path><path data-c="69" d="M69 609Q69 637 87 653T131 669Q154 667 171 652T188 609Q188 579 171 564T129 549Q104 549 87 564T69 609ZM247 0Q232 3 143 3Q132 3 106 3T56 1L34 0H26V46H42Q70 46 91 49Q100 53 102 60T104 102V205V293Q104 345 102 359T88 378Q74 385 41 385H30V408Q30 431 32 431L42 432Q52 433 70 434T106 436Q123 437 142 438T171 441T182 442H185V62Q190 52 197 50T232 46H255V0H247Z" transform="translate(2872,0)"></path><path data-c="65" d="M28 218Q28 273 48 318T98 391T163 433T229 448Q282 448 320 430T378 380T406 316T415 245Q415 238 408 231H126V216Q126 68 226 36Q246 30 270 30Q312 30 342 62Q359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121Q415 117 412 108Q393 53 349 21T250 -11Q155 -11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402T166 381T143 340T127 274V267H333V275Z" transform="translate(3150,0)"></path><path data-c="72" d="M36 46H50Q89 46 97 60V68Q97 77 97 91T98 122T98 161T98 203Q98 234 98 269T98 328L97 351Q94 370 83 376T38 385H20V408Q20 431 22 431L32 432Q42 433 60 434T96 436Q112 437 131 438T160 441T171 442H174V373Q213 441 271 441H277Q322 441 343 419T364 373Q364 352 351 337T313 322Q288 322 276 338T263 372Q263 381 265 388T270 400T273 405Q271 407 250 401Q234 393 226 386Q179 341 179 207V154Q179 141 179 127T179 101T180 81T180 66V61Q181 59 183 57T188 54T193 51T200 49T207 48T216 47T225 47T235 46T245 46H276V0H267Q249 3 140 3Q37 3 28 0H20V46H36Z" transform="translate(3594,0)"></path></g><g data-mml-node="mo" transform="translate(12236.1,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mo" transform="translate(12625.1,0)"><path data-c="7B" d="M434 -231Q434 -244 428 -250H410Q281 -250 230 -184Q225 -177 222 -172T217 -161T213 -148T211 -133T210 -111T209 -84T209 -47T209 0Q209 21 209 53Q208 142 204 153Q203 154 203 155Q189 191 153 211T82 231Q71 231 68 234T65 250T68 266T82 269Q116 269 152 289T203 345Q208 356 208 377T209 529V579Q209 634 215 656T244 698Q270 724 324 740Q361 748 377 749Q379 749 390 749T408 750H428Q434 744 434 732Q434 719 431 716Q429 713 415 713Q362 710 332 689T296 647Q291 634 291 499V417Q291 370 288 353T271 314Q240 271 184 255L170 250L184 245Q202 239 220 230T262 196T290 137Q291 131 291 1Q291 -134 296 -147Q306 -174 339 -192T415 -213Q429 -213 431 -216Q434 -219 434 -231Z"></path></g><g data-mml-node="msub" transform="translate(13125.1,0)"><g data-mml-node="mi"><path data-c="210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path></g><g data-mml-node="mi" transform="translate(609,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="msubsup" transform="translate(14028.1,0)"><g data-mml-node="mo"><path data-c="7D" d="M65 731Q65 745 68 747T88 750Q171 750 216 725T279 670Q288 649 289 635T291 501Q292 362 293 357Q306 312 345 291T417 269Q428 269 431 266T434 250T431 234T417 231Q380 231 345 210T298 157Q293 143 292 121T291 -28V-79Q291 -134 285 -156T256 -198Q202 -250 89 -250Q71 -250 68 -247T65 -230Q65 -224 65 -223T66 -218T69 -214T77 -213Q91 -213 108 -210T146 -200T183 -177T207 -139Q208 -134 209 3L210 139Q223 196 280 230Q315 247 330 250Q305 257 280 270Q225 304 212 352L210 362L209 498Q208 635 207 640Q195 680 154 696T77 713Q68 713 67 716T65 731Z"></path></g><g data-mml-node="mi" transform="translate(533,413) scale(0.707)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="TeXAtom" transform="translate(533,-247) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(345,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(1123,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g><g data-mml-node="mo" transform="translate(15758.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(16147.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo fence="false" stretchy="false">{</mo><msub><mi>s</mi><mi>i</mi></msub><msubsup><mo fence="false" stretchy="false">}</mo><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mo>=</mo><mtext>Sigmoid</mtext><mo stretchy="false">(</mo><mtext>Classifier</mtext><mo stretchy="false">(</mo><mo fence="false" stretchy="false">{</mo><msub><mi>h</mi><mi>i</mi></msub><msubsup><mo fence="false" stretchy="false">}</mo><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>
    </span>
  <p>其中，
    <span id="mjx-368b814">
      <style>
      #mjx-368b814{
        display:contents;
        mjx-assistive-mml {
          user-select: text !important;
          clip: auto !important;
          color: rgba(0,0,0,0);
        }
        
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

      }
      </style>
      <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg style="vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="1.801ex" height="1.357ex" role="img" focusable="false" viewBox="0 -442 796 599.8" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mi" transform="translate(502,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container>
    </span>
   是第 
    <span id="mjx-28d2554">
      <style>
      #mjx-28d2554{
        display:contents;
        mjx-assistive-mml {
          user-select: text !important;
          clip: auto !important;
          color: rgba(0,0,0,0);
        }
        
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

      }
      </style>
      <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="0.781ex" height="1.52ex" role="img" focusable="false" viewBox="0 -661 345 672" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></mjx-assistive-mml></mjx-container>
    </span>
   个对象属于查询 
    <span id="mjx-1a3e9f2">
      <style>
      #mjx-1a3e9f2{
        display:contents;
        mjx-assistive-mml {
          user-select: text !important;
          clip: auto !important;
          color: rgba(0,0,0,0);
        }
        
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

      }
      </style>
      <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="1.041ex" height="1.439ex" role="img" focusable="false" viewBox="0 -442 460 636" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></mjx-assistive-mml></mjx-container>
    </span>
   的概率分数。</p>
</li>
</ol>
<h3 id="4-本小节全部内容讲解-5"><a class="header-anchor" href="#4-本小节全部内容讲解-5"></a><strong>4. 本小节全部内容讲解</strong></h3>
<p>结合文中描述  和 Figure 1(c)，逻辑推演如下：</p>
<p><img src="/blog/2026/01/21/%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E6%A3%80%E6%B5%8B/WeDetect/%E3%80%90WeDetect%E3%80%91%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/image-20260121144632613.png" alt="image-20260121144632613"></p>
<p><strong>A. 挑战分析：LMM 做检测的痛点</strong></p>
<ul>
<li><strong>难定位（Regression Drawback）</strong>：LLM 的训练目标是语言建模（Language Modeling），优化的是离散 token 的交叉熵。而坐标是连续值，用 LLM 强行“生成”坐标数字，在精度上天然有劣势，对精确边界不敏感。</li>
<li><strong>慢（Next-token Prediction）</strong>：这是更致命的。传统方法如果图里有 5 个目标，LMM 就得按顺序把这 5 个目标的坐标、类别名一段段生成出来。这意味着要跑成百上千次前向传播，耗时极长。</li>
</ul>
<p><strong>B. 核心思路：REC as Retrieval</strong></p>
<ul>
<li><strong>灵感来源</strong>：受 VideoITG [456] 启发，作者决定不让 LLM “写”答案，而是让它做“选择题”。</li>
<li><strong>分工明确</strong>：</li>
<li><strong>WeDetect-Uni</strong>：负责“看哪里有东西”。它生成通用的候选框（Proposals），保证不漏掉物体（High Recall）。这一步利用了双塔模型的高速特性。</li>
<li><strong>LLM (WeDetect-Ref)</strong>：负责“理解是哪个”。它只负责读懂复杂的文本（比如“用来喝水的那个蓝色杯子”），然后从候选框里挑出符合描述的。</li>
</ul>
<p><strong>C. 具体实现机制</strong></p>
<p>你可以把它理解成“<strong>先列清单，再做筛选</strong>”。</p>
<p><strong>先“列清单”：用 WeDetect-Uni 给候选框</strong></p>
<ul>
<li>先用 WeDetect-Uni 在图里提一批“可能是物体”的框，形成候选列表 
    <span id="mjx-27c1693">
      <style>
      #mjx-27c1693{
        display:contents;
        mjx-assistive-mml {
          user-select: text !important;
          clip: auto !important;
          color: rgba(0,0,0,0);
        }
        
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

      }
      </style>
      <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="4.719ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 2086 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="7B" d="M434 -231Q434 -244 428 -250H410Q281 -250 230 -184Q225 -177 222 -172T217 -161T213 -148T211 -133T210 -111T209 -84T209 -47T209 0Q209 21 209 53Q208 142 204 153Q203 154 203 155Q189 191 153 211T82 231Q71 231 68 234T65 250T68 266T82 269Q116 269 152 289T203 345Q208 356 208 377T209 529V579Q209 634 215 656T244 698Q270 724 324 740Q361 748 377 749Q379 749 390 749T408 750H428Q434 744 434 732Q434 719 431 716Q429 713 415 713Q362 710 332 689T296 647Q291 634 291 499V417Q291 370 288 353T271 314Q240 271 184 255L170 250L184 245Q202 239 220 230T262 196T290 137Q291 131 291 1Q291 -134 296 -147Q306 -174 339 -192T415 -213Q429 -213 431 -216Q434 -219 434 -231Z"></path></g><g data-mml-node="msub" transform="translate(500,0)"><g data-mml-node="mi"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g><g data-mml-node="mi" transform="translate(792,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(1586,0)"><path data-c="7D" d="M65 731Q65 745 68 747T88 750Q171 750 216 725T279 670Q288 649 289 635T291 501Q292 362 293 357Q306 312 345 291T417 269Q428 269 431 266T434 250T431 234T417 231Q380 231 345 210T298 157Q293 143 292 121T291 -28V-79Q291 -134 285 -156T256 -198Q202 -250 89 -250Q71 -250 68 -247T65 -230Q65 -224 65 -223T66 -218T69 -214T77 -213Q91 -213 108 -210T146 -200T183 -177T207 -139Q208 -134 209 3L210 139Q223 196 280 230Q315 247 330 250Q305 257 280 270Q225 304 212 352L210 362L209 498Q208 635 207 640Q195 680 154 696T77 713Q68 713 67 716T65 731Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><msub><mi>B</mi><mi>i</mi></msub><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml></mjx-container>
    </span>
  。</li>
</ul>
<blockquote>
<p>类比：
先把图里所有“可能值得看”的物体都圈出来，相当于给 LLM 一个“候选答案列表”。</p>
</blockquote>
<hr>
<p><strong>再把每个候选框变成 LLM 看得懂的“对象 token”</strong></p>
<ul>
<li>对每个候选框  
    <span id="mjx-5e09884">
      <style>
      #mjx-5e09884{
        display:contents;
        mjx-assistive-mml {
          user-select: text !important;
          clip: auto !important;
          color: rgba(0,0,0,0);
        }
        
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

      }
      </style>
      <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="4.719ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 2086 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="7B" d="M434 -231Q434 -244 428 -250H410Q281 -250 230 -184Q225 -177 222 -172T217 -161T213 -148T211 -133T210 -111T209 -84T209 -47T209 0Q209 21 209 53Q208 142 204 153Q203 154 203 155Q189 191 153 211T82 231Q71 231 68 234T65 250T68 266T82 269Q116 269 152 289T203 345Q208 356 208 377T209 529V579Q209 634 215 656T244 698Q270 724 324 740Q361 748 377 749Q379 749 390 749T408 750H428Q434 744 434 732Q434 719 431 716Q429 713 415 713Q362 710 332 689T296 647Q291 634 291 499V417Q291 370 288 353T271 314Q240 271 184 255L170 250L184 245Q202 239 220 230T262 196T290 137Q291 131 291 1Q291 -134 296 -147Q306 -174 339 -192T415 -213Q429 -213 431 -216Q434 -219 434 -231Z"></path></g><g data-mml-node="msub" transform="translate(500,0)"><g data-mml-node="mi"><path data-c="1D435" d="M231 637Q204 637 199 638T194 649Q194 676 205 682Q206 683 335 683Q594 683 608 681Q671 671 713 636T756 544Q756 480 698 429T565 360L555 357Q619 348 660 311T702 219Q702 146 630 78T453 1Q446 0 242 0Q42 0 39 2Q35 5 35 10Q35 17 37 24Q42 43 47 45Q51 46 62 46H68Q95 46 128 49Q142 52 147 61Q150 65 219 339T288 628Q288 635 231 637ZM649 544Q649 574 634 600T585 634Q578 636 493 637Q473 637 451 637T416 636H403Q388 635 384 626Q382 622 352 506Q352 503 351 500L320 374H401Q482 374 494 376Q554 386 601 434T649 544ZM595 229Q595 273 572 302T512 336Q506 337 429 337Q311 337 310 336Q310 334 293 263T258 122L240 52Q240 48 252 48T333 46Q422 46 429 47Q491 54 543 105T595 229Z"></path></g><g data-mml-node="mi" transform="translate(792,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(1586,0)"><path data-c="7D" d="M65 731Q65 745 68 747T88 750Q171 750 216 725T279 670Q288 649 289 635T291 501Q292 362 293 357Q306 312 345 291T417 269Q428 269 431 266T434 250T431 234T417 231Q380 231 345 210T298 157Q293 143 292 121T291 -28V-79Q291 -134 285 -156T256 -198Q202 -250 89 -250Q71 -250 68 -247T65 -230Q65 -224 65 -223T66 -218T69 -214T77 -213Q91 -213 108 -210T146 -200T183 -177T207 -139Q208 -134 209 3L210 139Q223 196 280 230Q315 247 330 250Q305 257 280 270Q225 304 212 352L210 362L209 498Q208 635 207 640Q195 680 154 696T77 713Q68 713 67 716T65 731Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><msub><mi>B</mi><mi>i</mi></msub><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml></mjx-container>
    </span>
  ，从多尺度视觉特征里用 RoIAlign 抽 RoI 特征；</li>
<li>然后用线性 object projector 把 RoI 特征压成单个 token 
    <span id="mjx-5ffd9b6">
      <style>
      #mjx-5ffd9b6{
        display:contents;
        mjx-assistive-mml {
          user-select: text !important;
          clip: auto !important;
          color: rgba(0,0,0,0);
        }
        
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

      }
      </style>
      <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg style="vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="1.837ex" height="1.355ex" role="img" focusable="false" viewBox="0 -441 812 598.8" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(518,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>o</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container>
    </span>
  。</li>
</ul>
<blockquote>
<p>直观理解：
每个候选框被“浓缩成一句话的长度”（一个 token 的表示），这样才能一次塞进 LLM 里并行处理。</p>
</blockquote>
<hr>
<p><strong>把“整图 tokens + query + 所有对象 tokens”拼一起送进 LLM</strong></p>
<ul>
<li>输入给 LLM 的序列 =
    <span id="mjx-546db5a">
      <style>
      #mjx-546db5a{
        display:contents;
        mjx-assistive-mml {
          user-select: text !important;
          clip: auto !important;
          color: rgba(0,0,0,0);
        }
        
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

      }
      </style>
      <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.14ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 504 683" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D43C" d="M43 1Q26 1 26 10Q26 12 29 24Q34 43 39 45Q42 46 54 46H60Q120 46 136 53Q137 53 138 54Q143 56 149 77T198 273Q210 318 216 344Q286 624 286 626Q284 630 284 631Q274 637 213 637H193Q184 643 189 662Q193 677 195 680T209 683H213Q285 681 359 681Q481 681 487 683H497Q504 676 504 672T501 655T494 639Q491 637 471 637Q440 637 407 634Q393 631 388 623Q381 609 337 432Q326 385 315 341Q245 65 245 59Q245 52 255 50T307 46H339Q345 38 345 37T342 19Q338 6 332 0H316Q279 2 179 2Q143 2 113 2T65 2T43 1Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi></math></mjx-assistive-mml></mjx-container>
    </span>
  （整图视觉 tokens） +
    <span id="mjx-11b193c">
      <style>
      #mjx-11b193c{
        display:contents;
        mjx-assistive-mml {
          user-select: text !important;
          clip: auto !important;
          color: rgba(0,0,0,0);
        }
        
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

      }
      </style>
      <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="1.041ex" height="1.439ex" role="img" focusable="false" viewBox="0 -442 460 636" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>q</mi></math></mjx-assistive-mml></mjx-container>
    </span>
  （文本表达） + 
    <span id="mjx-ba3483e">
      <style>
      #mjx-ba3483e{
        display:contents;
        mjx-assistive-mml {
          user-select: text !important;
          clip: auto !important;
          color: rgba(0,0,0,0);
        }
        
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

      }
      </style>
      <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="4.099ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 1812 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="7B" d="M434 -231Q434 -244 428 -250H410Q281 -250 230 -184Q225 -177 222 -172T217 -161T213 -148T211 -133T210 -111T209 -84T209 -47T209 0Q209 21 209 53Q208 142 204 153Q203 154 203 155Q189 191 153 211T82 231Q71 231 68 234T65 250T68 266T82 269Q116 269 152 289T203 345Q208 356 208 377T209 529V579Q209 634 215 656T244 698Q270 724 324 740Q361 748 377 749Q379 749 390 749T408 750H428Q434 744 434 732Q434 719 431 716Q429 713 415 713Q362 710 332 689T296 647Q291 634 291 499V417Q291 370 288 353T271 314Q240 271 184 255L170 250L184 245Q202 239 220 230T262 196T290 137Q291 131 291 1Q291 -134 296 -147Q306 -174 339 -192T415 -213Q429 -213 431 -216Q434 -219 434 -231Z"></path></g><g data-mml-node="msub" transform="translate(500,0)"><g data-mml-node="mi"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(518,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="mo" transform="translate(1312,0)"><path data-c="7D" d="M65 731Q65 745 68 747T88 750Q171 750 216 725T279 670Q288 649 289 635T291 501Q292 362 293 357Q306 312 345 291T417 269Q428 269 431 266T434 250T431 234T417 231Q380 231 345 210T298 157Q293 143 292 121T291 -28V-79Q291 -134 285 -156T256 -198Q202 -250 89 -250Q71 -250 68 -247T65 -230Q65 -224 65 -223T66 -218T69 -214T77 -213Q91 -213 108 -210T146 -200T183 -177T207 -139Q208 -134 209 3L210 139Q223 196 280 230Q315 247 330 250Q305 257 280 270Q225 304 212 352L210 362L209 498Q208 635 207 640Q195 680 154 696T77 713Q68 713 67 716T65 731Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><msub><mi>o</mi><mi>i</mi></msub><mo fence="false" stretchy="false">}</mo></math></mjx-assistive-mml></mjx-container>
    </span>
  （候选物体 tokens）。</li>
</ul>
<hr>
<p><strong>LLM 不生成框，只做“并行二分类”</strong></p>
<ul>
<li>LLM 输出每个对象 token 的隐藏向量 
    <span id="mjx-5c819de">
      <style>
      #mjx-5c819de{
        display:contents;
        mjx-assistive-mml {
          user-select: text !important;
          clip: auto !important;
          color: rgba(0,0,0,0);
        }
        
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

      }
      </style>
      <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg style="vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="2.043ex" height="1.927ex" role="img" focusable="false" viewBox="0 -694 903 851.8" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path></g><g data-mml-node="mi" transform="translate(609,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container>
    </span>
  （Eq.1）</li>
<li>在这些 
    <span id="mjx-bbe055a">
      <style>
      #mjx-bbe055a{
        display:contents;
        mjx-assistive-mml {
          user-select: text !important;
          clip: auto !important;
          color: rgba(0,0,0,0);
        }
        
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

      }
      </style>
      <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg style="vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="2.043ex" height="1.927ex" role="img" focusable="false" viewBox="0 -694 903 851.8" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="210E" d="M137 683Q138 683 209 688T282 694Q294 694 294 685Q294 674 258 534Q220 386 220 383Q220 381 227 388Q288 442 357 442Q411 442 444 415T478 336Q478 285 440 178T402 50Q403 36 407 31T422 26Q450 26 474 56T513 138Q516 149 519 151T535 153Q555 153 555 145Q555 144 551 130Q535 71 500 33Q466 -10 419 -10H414Q367 -10 346 17T325 74Q325 90 361 192T398 345Q398 404 354 404H349Q266 404 205 306L198 293L164 158Q132 28 127 16Q114 -11 83 -11Q69 -11 59 -2T48 16Q48 30 121 320L195 616Q195 629 188 632T149 637H128Q122 643 122 645T124 664Q129 683 137 683Z"></path></g><g data-mml-node="mi" transform="translate(609,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>h</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container>
    </span>
  上加一个二分类 head，得到每个候选的分数 
    <span id="mjx-4f9733d">
      <style>
      #mjx-4f9733d{
        display:contents;
        mjx-assistive-mml {
          user-select: text !important;
          clip: auto !important;
          color: rgba(0,0,0,0);
        }
        
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

      }
      </style>
      <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg style="vertical-align: -0.357ex;" xmlns="http://www.w3.org/2000/svg" width="1.801ex" height="1.357ex" role="img" focusable="false" viewBox="0 -442 796 599.8" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mi" transform="translate(502,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>s</mi><mi>i</mi></msub></math></mjx-assistive-mml></mjx-container>
    </span>
  （Eq.2）</li>
</ul>
<blockquote>
<p>这就是“检索”的本质：
给定 query，算每个候选框的匹配分数，然后选分数最高的那些框。</p>
</blockquote>
<h3 id="5-重点内容梳理-5"><a class="header-anchor" href="#5-重点内容梳理-5"></a><strong>5. 重点内容梳理</strong></h3>
<ul>
<li><strong>范式转移</strong>：从 <strong>Generation (生成)</strong> 转向 <strong>Retrieval (检索/分类)</strong>。这是 WeDetect-Ref 能够在保持 LMM 强大理解能力的同时，速度比同类 LMM 快 13 倍的根本原因。</li>
<li><strong>并行计算</strong>：解决了“串行解码”的瓶颈。无论图里有多少候选框，推理时间几乎不变（并行处理），而传统方法的耗时会随物体数量线性增长。</li>
<li><strong>避短扬长</strong>：巧妙地规避了 LLM 不擅长回归坐标的短板（坐标直接复用 WeDetect-Uni 的高质量 Proposal），最大化利用了 LLM 擅长语义理解的长处。</li>
</ul>
<h2 id="5-2-A-Three-Stage-Training-Recipe-三阶段训练配方"><a class="header-anchor" href="#5-2-A-Three-Stage-Training-Recipe-三阶段训练配方"></a><strong>5.2. A Three-Stage Training Recipe (三阶段训练配方)</strong></h2>
<h3 id="1-本小节概论-9"><a class="header-anchor" href="#1-本小节概论-9"></a><strong>1. 本小节概论</strong></h3>
<p>本小节描述了训练 WeDetect-Ref 的三个关键阶段。</p>
<p>作者使用 <strong>Qwen3-VL</strong> 作为基座模型。训练的核心目标是让模型能够理解特殊的“对象 token”，并最终具备对这些 token 进行二分类的能力。</p>
<p>三个阶段分别是：<strong>区域投影器训练（对齐）</strong>、<strong>区域感知微调（理解）</strong>、<strong>区域分类微调（任务适配）</strong>。</p>
<h3 id="2-关键概念-符号表-9"><a class="header-anchor" href="#2-关键概念-符号表-9"></a><strong>2. 关键概念/符号表</strong></h3>
<table>
<thead>
<tr>
<th>概念/术语</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>(object) Token</strong></td>
<td><strong>对象占位符</strong>：在文本输入中引入的特殊 token，用于代表图像中的某个具体物体。在输入给 LLM 前，会被替换为实际的视觉特征嵌入。</td>
</tr>
<tr>
<td><strong>Region/ Object projector</strong></td>
<td><strong>区域投影器</strong>：一个线性层，负责将 RoIAlign 提取出的多尺度视觉特征压缩成一个单一的向量（Token），使其能被 LLM 理解。</td>
</tr>
<tr>
<td><strong>RoIAlign</strong></td>
<td><strong>感兴趣区域对齐</strong>：一种从特征图中提取特定区域特征的操作，保留了空间位置精度。</td>
</tr>
<tr>
<td><strong>Sigmoid Focal Loss</strong></td>
<td><strong>Sigmoid 焦点损失</strong>：第三阶段使用的损失函数，用于解决正负样本不平衡问题，替代了 LMM 原有的交叉熵损失（Language Modeling Loss）。</td>
</tr>
<tr>
<td><strong>Position embedding</strong></td>
<td><strong>（框的位置编码）</strong>：把候选框坐标编码成位置嵌入，加到 object token 上，让 LLM知道它在图里的位置。</td>
</tr>
<tr>
<td><strong>Discard LM head + Binary head</strong></td>
<td>最后丢掉原始语言建模头，改成二分类头，只在 object token 的隐藏向量上做分类。</td>
</tr>
</tbody>
</table>
<h3 id="3-关键算法流程-三阶段演进"><a class="header-anchor" href="#3-关键算法流程-三阶段演进"></a><strong>3. 关键算法流程 (三阶段演进)</strong></h3>
<ul>
<li>
<p><strong>Stage 1: 投影器预热 (Projector Warm-up)</strong></p>
<ul>
<li><strong>目标</strong>：让新增的“区域投影器”学会把视觉特征翻译成 LLM 能懂的语言。</li>
<li><strong>冻结参数</strong>：冻结视觉编码器和 LLM，<strong>仅训练投影器</strong>。</li>
<li><strong>数据</strong>：700k 图片/区域描述数据。</li>
</ul>
</li>
<li>
<p><strong>Stage 2: 感知对齐 (Perception Alignment)</strong></p>
<ul>
<li><strong>目标</strong>：让 LLM 学会理解和处理这些对象 token。</li>
<li><strong>冻结参数</strong>：冻结视觉编码器，<strong>训练 LLM + 投影器</strong>。</li>
<li><strong>数据</strong>：1.7M 指令微调数据。</li>
</ul>
</li>
<li>
<p><strong>Stage 3: 任务适配 (Classification Finetuning)</strong></p>
<ul>
<li><strong>目标</strong>：彻底改变模型行为，从“生成文本”变为“判断正负”。</li>
<li><strong>关键动作</strong>：丢弃原有的语言预测头（Language Head），换成<strong>二分类头（Binary Classification Head）</strong>。</li>
<li><strong>损失函数</strong>：改为 Sigmoid Focal Loss。</li>
<li><strong>数据</strong>：4M 检测与 REC 数据。</li>
</ul>
</li>
</ul>
<h3 id="4-本小节全部内容讲解-6"><a class="header-anchor" href="#4-本小节全部内容讲解-6"></a><strong>4. 本小节全部内容讲解</strong></h3>
<p>结合文中描述 ，我们详细拆解每个阶段：</p>
<p><strong>A. Stage 1: Region Projector Training (区域投影器训练)</strong></p>
<ul>
<li><strong>机制</strong>：</li>
</ul>
<ol>
<li>引入特殊字符 <code>(object)</code> 作为占位符。</li>
<li>对于每个物体，使用 RoIAlign 从视觉编码器的特征层提取多尺度特征。</li>
<li>使用线性投影器（Linear Projector）将这些特征压缩为一个 token。</li>
<li>将边界框坐标编码为位置嵌入（Position Embeddings）加到这个 token 上。</li>
<li>用这个视觉 token 替换文本中的 <code>(object)</code> 占位符。</li>
</ol>
<ul>
<li>
<p><strong>训练任务</strong>：简单的描述任务。</p>
</li>
<li>
<p><em>Input</em>: <code>user: (image) Describe the object (object) briefly.</code></p>
</li>
<li>
<p><em>Output</em>: <code>assistant: far right guy.</code></p>
</li>
<li>
<p><strong>意义</strong>：这是建立“视觉-语言”桥梁的第一步，确保压缩后的 token 携带了物体的信息。</p>
</li>
</ul>
<p><strong>B. Stage 2: Region Perception Finetuning (区域感知微调)</strong></p>
<ul>
<li><strong>机制</strong>：解冻 LLM，让大模型的大脑适应这种新的输入形式。</li>
<li><strong>数据增强</strong>：除了描述数据，还加入了很多区域级的指令微调数据。</li>
<li><strong>意义</strong>：这一阶段后，LLM 已经能非常精准地感知到 <code>(object)</code> token 代表的是图里的哪块肉、哪个人。</li>
</ul>
<p><strong>C. Stage 3: Region Classification Finetuning (区域分类微调)</strong></p>
<ul>
<li>
<p><strong>机制突变</strong>：这是最关键的一步。作者<strong>丢弃了</strong> LLM 用来生成下一个词的 Head。这意味着模型不再具备说话能力（在该任务下），而是变成了一个纯粹的判别器。</p>
</li>
<li>
<p><strong>并行处理</strong>(一次处理一堆候选框)：</p>
</li>
<li>
<p><em>Input Template</em>: <code>user: (image) Please detect the &quot;CLASSNAME&quot; in the image. assistant: (object) (object) ...</code></p>
</li>
<li>
<p>这里的 <code>(object)</code> 数量等于 Proposal 的数量（例如 100 个）。</p>
</li>
<li>
<p>模型一次性看这 100 个 token，然后二分类头对每个 token 输出 0 或 1。</p>
</li>
<li>
<p><strong>正负样本定义</strong>：用 <strong>sigmoid focal loss</strong>，并用 <strong>IoU 作为 soft label</strong>；只要某 proposal 与任意 GT 框 <strong>IoU &gt; 0.5</strong> 就算正样本</p>
</li>
<li>
<p><strong>意义</strong>：完成了从 LMM 到 WeDetect-Ref 的最终蜕变，实现了并行、高速的检索式检测。</p>
</li>
</ul>
<h3 id="5-重点内容梳理-6"><a class="header-anchor" href="#5-重点内容梳理-6"></a><strong>5. 重点内容梳理</strong></h3>
<blockquote>
<p><strong>核心结构点</strong>：⟨object⟩ 占位符 + RoIAlign 多尺度特征 + 线性 projector 压成单 token + 框坐标做位置嵌入。Fu 等 - 2025 - WeDetect Fast Ope…</p>
<p><strong>三阶段各自目的</strong>：</p>
<ul>
<li>Stage1 打通“框→token”表示（只训 projector）</li>
<li>Stage2 让 LLM 真正会用这些 token（训 LLM+projector，视觉冻结）</li>
<li>Stage3 抛弃生成，改成并行二分类（focal loss + IoU soft label）</li>
</ul>
<p><strong>最终落地形态</strong>：输入是一堆 proposals，对每个 ⟨object⟩ 输出一个匹配分数，从而实现“检索式 REC”。</p>
</blockquote>
<ul>
<li></li>
</ul>
<p><strong>特征压缩的极限</strong>：作者在文中提到 ，将每个物体压缩为<strong>单个 token</strong> 是极其大胆的设计（通常需要多个 token 描述细节）。这极大地节省了上下文长度，使得一次性处理大量 Proposal 成为可能。作者认为全局图像上下文已经保留了足够信息，单个对象 token 只需起到“索引”或“指针”的作用。</p>
<ul>
<li><strong>舍弃生成的决心</strong>：在 Stage 3 果断丢弃语言头（Language Head）是实现 13 倍加速的关键。如果不丢弃，依然走 Next-token prediction，速度就无法质变。</li>
<li><strong>IoU Soft Labels</strong>：虽然是分类任务，但使用 IoU 作为软标签（Soft Labels）进行训练，能让模型学到更细粒度的质量判断（IoU 0.9 的框比 IoU 0.6 的框得分更高）。</li>
</ul>
<hr>
<h1 id="6-Experiment-实验"><a class="header-anchor" href="#6-Experiment-实验"></a>6. Experiment (实验)</h1>
<p>这一节通过详实的实验数据，全方位展示了 WeDetect 家族在<strong>开放词汇检测、通用候选框生成、对象检索以及指代理解</strong>任务上的性能，并着重对比了其在推理速度上的巨大优势。</p>
<hr>
<h2 id="6-1-Main-Result-主要结果"><a class="header-anchor" href="#6-1-Main-Result-主要结果"></a><strong>6.1. Main Result (主要结果)</strong></h2>
<h3 id="1-本小节概论-10"><a class="header-anchor" href="#1-本小节概论-10"></a><strong>1. 本小节概论</strong></h3>
<p>本小节汇总了 WeDetect 模型家族在多个基准测试上的表现。</p>
<ul>
<li>
<p>首先，作者在 LVIS、COCO 等权威数据集上验证了 WeDetect 作为开放词汇检测器的 Zero-shot 性能，证明其在非融合架构下依然能超越主流融合模型（如 YOLO-World, Grounding-DINO）。</p>
</li>
<li>
<p>其次，评估了 WeDetect-Uni 在候选框生成和新任务“对象检索”上的表现。最后，展示了 WeDetect-Ref 在 REC 任务上如何以极少的参数量和极快的速度击败大型多模态模型（如 Qwen3-VL）。</p>
</li>
</ul>
<h3 id="2-关键概念-符号表-10"><a class="header-anchor" href="#2-关键概念-符号表-10"></a><strong>2. 关键概念/符号表</strong></h3>
<table>
<thead>
<tr>
<th>概念/术语</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>LVIS / minival</strong></td>
<td><strong>LVIS</strong>: 包含 1203 个类别的长尾分布数据集，是检验开放词汇能力的核心战场。<strong>minival</strong>: LVIS 的一个常用验证子集。</td>
</tr>
<tr>
<td><strong>COCO</strong></td>
<td>80 类日常物体</td>
</tr>
<tr>
<td><strong>COCO-O</strong></td>
<td>类别同 COCO，但跨 6 个域，专门测<strong>分布偏移/跨域泛化</strong>。</td>
</tr>
<tr>
<td><strong>ODinW</strong></td>
<td><strong>Object Detection in the Wild</strong>: 包含 35 个不同领域数据集的基准测试，用于评估模型的跨域迁移能力。</td>
</tr>
<tr>
<td><strong>Zero-shot</strong></td>
<td><strong>零样本</strong>：指模型在没有见过目标数据集（如 LVIS）训练数据的情况下，仅凭类别名称进行检测。</td>
</tr>
<tr>
<td><strong>FPS (Frames Per Second)</strong></td>
<td><strong>每秒帧数</strong>：衡量模型推理速度的关键指标。</td>
</tr>
<tr>
<td><strong>Recall (AR)</strong></td>
<td><strong>召回率</strong>：衡量候选框生成器是否“漏掉”了物体。</td>
</tr>
<tr>
<td><strong>APr / APc / APf</strong></td>
<td>分别对应 <strong>rare / common / frequent</strong> 三类频次子集的 AP（稀有/常见/高频）。</td>
</tr>
<tr>
<td><strong>F1 Score</strong></td>
<td><strong>F1 分数</strong>：在对象检索任务中，综合考量精确率（Precision）和召回率（Recall）的指标。</td>
</tr>
</tbody>
</table>
<h3 id="3-关键数据速览"><a class="header-anchor" href="#3-关键数据速览"></a><strong>3. 关键数据速览</strong></h3>
<ul>
<li></li>
</ul>
<p><strong>速度与精度双赢</strong>：WeDetect-Tiny 在 LVIS minival 上达到 <strong>37.4 AP</strong>，速度高达 <strong>62.5 FPS</strong>，比 YOLO-World-L 高 2.0 AP 且更快 。</p>
<ul>
<li></li>
</ul>
<p><strong>SOTA 性能</strong>：WeDetect-Large 在 LVIS 上达到 <strong>49.4 AP</strong>，超越了之前的 SOTA 模型 T-Rex2 。</p>
<ul>
<li></li>
</ul>
<p><strong>REC 统治力</strong>：WeDetect-Ref 4B 在 RefCOCO 系列数据集上平均得分 <strong>93.2</strong>，比 Qwen3-VL 4B 高 6.5 分，且推理速度快 <strong>13 倍</strong> 。</p>
<h3 id="4-本小节全部内容讲解-7"><a class="header-anchor" href="#4-本小节全部内容讲解-7"></a><strong>4. 本小节全部内容讲解</strong></h3>
<p>本节实验结果分为四个维度进行展示：</p>
<p><strong>A. 开放词汇目标检测：更快更强</strong></p>
<p><img src="/blog/2026/01/21/%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E6%A3%80%E6%B5%8B/WeDetect/%E3%80%90WeDetect%E3%80%91%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/image-20260121185439455.png" alt="image-20260121185439455"></p>
<ul>
<li><strong>基准测试</strong>：作者在 LVIS (1203类)、COCO (80类)、COCO-O (域偏移)、ODinW (35个数据集) 上进行了零样本评估。</li>
<li><strong>核心对比</strong>：
<ul>
<li><strong>WeDetect-Tiny vs. YOLO-World-L</strong>：WeDetect-Tiny 参数量更小（仅为 Tiny 版），但在 LVIS minival 上 AP 高出 2.0，在 COCO-O 上高出 6.1 AP，且运行速度更快（62.5 fps vs 54.6 fps）。这证明了非融合双塔架构的效率优势。</li>
<li><strong>WeDetect-Large vs. Grounding-DINO &amp; T-Rex2</strong>：在大模型赛道，WeDetect-Large 在 LVIS 上取得了 49.4 AP，大幅超越 LLMDet (+7.4 AP) 和 T-Rex2 (+3.6 AP)。</li>
<li><strong>推理效率</strong>：作者强调，WeDetect-Base 和 WeDetect-Large 的速度分别是 Grounding-DINO 的 <strong>6倍</strong> 和 <strong>3倍</strong>，因为它们完全省去了耗时的跨模态融合层。</li>
</ul>
</li>
</ul>
<hr>
<p><strong>B. WeDetect-Uni：通用候选框生成</strong></p>
<p><img src="/blog/2026/01/21/%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E6%A3%80%E6%B5%8B/WeDetect/%E3%80%90WeDetect%E3%80%91%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/image-20260121185651760.png" alt="image-20260121185651760"></p>
<ul>
<li><strong>实验设置</strong>：冻结检测器，只训练一个 Prompt。在 COCO, LVIS, PACO-LVIS 上测试召回率。</li>
<li><strong>结果</strong>：WeDetect-Large-Uni 取得了最高的召回率（Table 3）。值得注意的是，LVIS 和 PACO 包含大量细粒度物体，高召回率证明模型生成的特征具有极强的通用性和判别力。</li>
</ul>
<hr>
<p><strong>C. 对象检索：精细化感知的胜利</strong></p>
<p><img src="/blog/2026/01/21/%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E6%A3%80%E6%B5%8B/WeDetect/%E3%80%90WeDetect%E3%80%91%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/image-20260121185753931.png" alt="image-20260121185753931"></p>
<ul>
<li><strong>任务对比</strong>：对比了传统的图像-文本检索模型（OpenAI CLIP, HQ-CLIP, FG-CLIP2）和 WeDetect-Uni。</li>
<li><strong>结果</strong>：在检索特定物体（如 LVIS 类别）时，WeDetect-Large-Uni 的表现<strong>显著优于</strong> CLIP 系列（Table 4）。</li>
<li><em>原因分析</em>：CLIP 关注全局语义（Global Semantics），而 WeDetect-Uni 通过 Proposal 关注局部语义（Local Semantics），因此在找“图中的某样东西”时具有天然优势。这验证了对象检索任务与传统图像检索的互补性。</li>
</ul>
<hr>
<p><strong>D. WeDetect-Ref：LMM 的速度革命</strong></p>
<p><img src="/blog/2026/01/21/%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E6%A3%80%E6%B5%8B/WeDetect/%E3%80%90WeDetect%E3%80%91%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/image-20260121185940234.png" alt="image-20260121185940234"></p>
<ul>
<li><strong>REC 性能</strong>：在 RefCOCO/+/g 榜单上，WeDetect-Ref 4B 取得了 <strong>93.2</strong> 的平均分，大幅领先同量级的 Qwen3-VL 4B（86.6分）以及其他甚至更大参数的模型。</li>
<li><strong>速度优势</strong>：利用“检索式”并行分类，速度比 Qwen3-VL 快 <strong>13倍</strong>。</li>
<li><strong>常规检测逆袭</strong>：作者还让 WeDetect-Ref 去做 COCO 检测（通常 LMM 做不好这个）。</li>
<li><em>传统 LMM 困境</em>：Qwen2.5-VL 7B 在 COCO 上只有 17.7 AP（因为它容易漏检，且难以拒绝错误类别）。</li>
<li><em>WeDetect-Ref 突破</em>：达到了 <strong>54.7 AP</strong>，这是 LMM 首次在 COCO 上达到与传统检测器（如 DINO）相当的水平。这得益于其并行处理机制保证了高召回率。</li>
</ul>
<h3 id="5-重点内容梳理-7"><a class="header-anchor" href="#5-重点内容梳理-7"></a><strong>5. 重点内容梳理</strong></h3>
<ul>
<li><strong>打破“融合迷信”</strong>：实验数据有力地反驳了“只有深度融合才能做好开放词汇检测”的观点。WeDetect 证明，只要底子好（ConvNeXt + 高质量数据），双塔结构照样拿 SOTA，而且快得多。</li>
<li><strong>WeDetect-Ref 的“降维打击”</strong>：在 REC 任务上，WeDetect-Ref 不仅精度更高，其速度优势是数量级的（13x）。这表明将 LMM 视作“分类器”而非“生成器”是视觉定位任务中的高效解法。</li>
<li><strong>多面手能力</strong>：WeDetect 家族不仅在主业（检测）上强，在副业（对象检索、REC）上也开辟了新赛道，证明了其架构的通用性。</li>
</ul>
<hr>
<p>好的，我们继续进行论文精读。现在进入 <strong>6. Experiment (实验)</strong> 章节中的 <strong>6.2. Ablation Study (消融实验)</strong> 部分。</p>
<p>这一节通过控制变量法，深入剖析了 WeDetect 及其组件性能背后的关键因素，验证了之前章节提到的“多粒度标签”、“分阶段训练”以及 WeDetect-Ref 的独特设计选择的有效性。</p>
<hr>
<h2 id="6-2-Ablation-Study-消融实验"><a class="header-anchor" href="#6-2-Ablation-Study-消融实验"></a><strong>6.2. Ablation Study (消融实验)</strong></h2>
<h3 id="1-本小节概论-11"><a class="header-anchor" href="#1-本小节概论-11"></a><strong>1. 本小节概论</strong></h3>
<p>本小节分为两个部分：首先分析了训练策略对 <strong>WeDetect</strong> 基础检测器性能的影响，重点验证了多粒度标签采样和分阶段训练的重要性；其次探讨了 <strong>WeDetect-Ref</strong> 的设计选择，包括损失函数、负样本监督、对象 Token 数量以及候选框输入顺序对 REC 和检测性能的影响。</p>
<h3 id="2-关键概念-符号表-11"><a class="header-anchor" href="#2-关键概念-符号表-11"></a><strong>2. 关键概念/符号表</strong></h3>
<table>
<thead>
<tr>
<th>概念/术语</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Multi-granularity Labels</strong></td>
<td><strong>多粒度标签</strong>：指为同一物体提供从粗到细的多个标签（如 animal, dog, yellow dog）。实验证明这种多样性能显著提升对齐效果。</td>
</tr>
<tr>
<td><strong>Staged-wise Training</strong></td>
<td><strong>分阶段训练</strong>：指先冻结骨干网训练头颈部，再全量微调。实验表明这能有效保护预训练的特征不被破坏。</td>
</tr>
<tr>
<td><strong>Sigmoid Focal Loss</strong></td>
<td><strong>Sigmoid 焦点损失</strong>：一种解决正负样本不平衡的分类损失函数。相比二元交叉熵（BCE），它更适合 WeDetect-Ref 的检索式分类任务。</td>
</tr>
<tr>
<td><strong>Negative Detection Data</strong></td>
<td><strong>负检测数据</strong>：指在训练 WeDetect-Ref 时，故意加入一些图中不存在的类别作为查询（Query），强迫模型学会“拒绝识别”。</td>
</tr>
<tr>
<td><strong>Context Length</strong></td>
<td><strong>上下文长度</strong>：输入给大模型的 token 序列长度。减少每个对象的 token 数可以显著降低上下文长度，提升效率。</td>
</tr>
<tr>
<td><strong>Tokens per object</strong></td>
<td><strong>每个候选框用几个 token</strong>：作者默认“1 个 token/物体”保证效率，也测试了 25 token/物体。</td>
</tr>
</tbody>
</table>
<h3 id="3-关键实验对比-数据说话"><a class="header-anchor" href="#3-关键实验对比-数据说话"></a><strong>3. 关键实验对比 (数据说话)</strong></h3>
<p><strong>A. WeDetect 训练策略分析 (Table 6)</strong></p>
<p><img src="/blog/2026/01/21/%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E6%A3%80%E6%B5%8B/WeDetect/%E3%80%90WeDetect%E3%80%91%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/image-20260121194005769.png" alt="image-20260121194005769"></p>
<ul>
<li><strong>多粒度标签的影响</strong>：</li>
<li><strong>完整策略</strong>：47.3 AP（基准）。</li>
<li><strong>去掉细粒度 (w/o fine-grained)</strong>：45.1 AP (<strong>-2.2 AP</strong>)。这说明细粒度描述对提升整体检测能力至关重要。</li>
<li><strong>去掉粗粒度 (w/o coarse-grained)</strong>：46.4 AP (-0.9 AP)，且稀有类指标  下降 1.6。这说明粗粒度标签有助于泛化，特别是对稀有类别。</li>
</ul>
<blockquote>
<p>没有多粒度标签 → 文本多样性大幅下降 → 难做细粒度图文对齐</p>
</blockquote>
<ul>
<li><strong>分阶段训练的影响</strong>：</li>
<li><strong>不分阶段 (w/o staged-wise)</strong>：45.5 AP (<strong>-1.8 AP</strong>)。如果不先预热 Head 和 Neck，随机初始化的参数会干扰 CLIP 预训练的视觉特征。</li>
</ul>
<hr>
<p><strong>B. WeDetect-Ref 设计选择分析 (Table 7)</strong></p>
<p><img src="/blog/2026/01/21/%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E6%A3%80%E6%B5%8B/WeDetect/%E3%80%90WeDetect%E3%80%91%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/image-20260121194212352.png" alt="image-20260121194212352"></p>
<ul>
<li><strong>损失函数</strong>：用 BCE Loss 替换 Sigmoid Focal Loss，COCO AP 下降 4.4 点。</li>
<li><strong>负样本</strong>：如果不加负样本数据，COCO AP 暴跌 <strong>5.4 点</strong>。这证明让 LMM 学会“说不”对于降低误检率（False Positives）至关重要。</li>
<li><strong>Token 数量</strong>：将每个物体用 25 个 token 表示（vs 1个），AP 仅提升 0.1，但计算开销激增。证明 <strong>1 个 token</strong> 足以索引物体信息。</li>
<li><strong>顺序鲁棒性</strong>：打乱输入候选框的顺序，性能波动极小（±0.1 AP）。说明模型不依赖顺序信息，是真正的并行处理。</li>
</ul>
<h3 id="4-本小节全部内容讲解-8"><a class="header-anchor" href="#4-本小节全部内容讲解-8"></a><strong>4. 本小节全部内容讲解</strong></h3>
<p>结合文中描述 ，我们进行详细解读：</p>
<ol>
<li><strong>数据与训练策略的胜利 (WeDetect)</strong></li>
</ol>
<ul>
<li>作者通过实验证实，<strong>多粒度标签</strong>不仅是增加了文本量，更重要的是在训练中通过随机采样（Random Sampling）构建了动态的负样本池。这种“数据增强”极大地提升了视觉-语言对齐的精度。</li>
<li><strong>分阶段训练</strong>被证明是保护“大模型资产”的必要手段。直接在预训练好的 Backbone 上接一个随机初始化的 Head 进行端到端训练，往往会导致性能崩塌（Catastrophic Forgetting 的一种变体），先冻结 Backbone 是标准且有效的解法。</li>
</ul>
<ol start="2">
<li><strong>WeDetect-Ref 的极简哲学</strong></li>
</ol>
<ul>
<li><strong>损失函数</strong>：REC 任务本质上是极度不平衡的（一堆框里只有一个是对的），因此 Focal Loss 这种专门处理样本不平衡的损失函数显著优于普通的 BCE Loss。</li>
<li><strong>负样本即正义</strong>：大模型通常倾向于“讨好”用户，给什么都说“是”。引入负样本（问图中没有的东西）强迫模型抑制这种幻觉（Hallucination），这对检测任务的准确率（Precision）至关重要。</li>
<li><strong>单 Token 奇迹</strong>：作者发现，虽然物体细节很多，但只要有全局图像特征在，一个经过 RoIAlign 提取并压缩的 token 就像一个“指针”，足够让 LLM 建立起物体与全局语境的联系。这一发现极大地支撑了 WeDetect-Ref 的超高推理速度。</li>
<li><strong>无序即并行</strong>：由于 LLM 的 Self-Attention 是全连接的（在非 Causal Mask 区域），且训练时正样本位置随机，模型天然学会了忽略输入顺序，这完美契合了“并行检索”的设定。</li>
</ul>
<h3 id="5-重点内容梳理-8"><a class="header-anchor" href="#5-重点内容梳理-8"></a><strong>5. 重点内容梳理</strong></h3>
<ul>
<li><strong>负样本是 LMM 做检测的“解药”</strong>：实验数据表明，没有负样本训练，LMM 在检测任务上几乎不可用（误检率太高）。</li>
<li><strong>一字千金</strong>：一个 Object Token 就能代表一个物体，这打破了“需要丰富特征描述物体”的直觉，证明了 LMM 强大的上下文关联能力。</li>
<li><strong>细节决定成败</strong>：无论是标签的采样策略，还是训练的阶段划分，这些看似不起眼的工程细节（Tricks）实际上贡献了巨大的性能涨幅（累积数个 AP）。</li>
</ul>
<hr>
<h1 id="7-Conclusion-结论"><a class="header-anchor" href="#7-Conclusion-结论"></a><strong>7. Conclusion (结论)</strong></h1>
<h2 id="1-本小节概论-12"><a class="header-anchor" href="#1-本小节概论-12"></a><strong>1. 本小节概论</strong></h2>
<p>本小节总结了论文的核心工作：提出了一组遵循**“检索（Retrieval）”方法论**的开放词汇检测模型家族。作者重申了该方法论的设计原则——即摒弃计算密集的跨模态融合层，转而从候选列表中“挑选”目标。基于这一理念，论文实现了三个主要贡献：基础检测器 <strong>WeDetect</strong>、通用生成器 <strong>WeDetect-Uni</strong> 以及基于大模型的指代理解模型 <strong>WeDetect-Ref</strong>。这些模型在保证极高推理速度的同时，在 15 个基准测试中达到了 SOTA 水平。</p>
<h2 id="2-关键概念-符号表-12"><a class="header-anchor" href="#2-关键概念-符号表-12"></a><strong>2. 关键概念/符号表</strong></h2>
<table>
<thead>
<tr>
<th>概念/术语</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Retrieval Methodology</strong></td>
<td><strong>检索方法论</strong>：本文的核心哲学。即将检测视为从候选列表（Candidate List）中检索目标的过程，而不是生成特定于查询的临时候选列表或特征。</td>
</tr>
<tr>
<td><strong>WeDetect Family</strong></td>
<td><strong>WeDetect 家族</strong>：包含三个模型：WeDetect（基础检测）、WeDetect-Uni（对象检索）、WeDetect-Ref（指代理解）。</td>
</tr>
<tr>
<td><strong>Candidate List</strong></td>
<td><strong>候选列表</strong>：检索范式的基础。WeDetect-Uni 生成通用的候选框列表，后续任务只需从中筛选，无需重新生成。</td>
</tr>
</tbody>
</table>
<h2 id="3-本小节全部内容讲解-4"><a class="header-anchor" href="#3-本小节全部内容讲解-4"></a><strong>3. 本小节全部内容讲解</strong></h2>
<p>作者的总结逻辑非常清晰，回顾了从理论到实践的完整闭环 ：</p>
<ol>
<li><strong>核心理念回归</strong>：</li>
</ol>
<ul>
<li>论文提出了一种新的开放词汇检测范式，完全遵循<strong>检索方法论</strong>。</li>
<li><strong>区别</strong>：传统方法可能针对每个查询生成特定的特征或候选框，而本文的方法是从一个预先存在的、通用的候选列表中简单地“拾取（Pick up）”目标。</li>
<li><strong>优势</strong>：这种设计原则坚决不使用计算密集的跨模态融合层（Cross-modal fusion layers），从而确保了极高的推理速度。</li>
</ul>
<ol start="2">
<li><strong>三大支柱总结</strong>：</li>
</ol>
<ul>
<li><strong>(1) WeDetect</strong>：开放词汇目标检测的基础模型（Foundation），证明了双塔架构的潜力。</li>
<li><strong>(2) WeDetect-Uni</strong>：通用候选框生成器。它开启了一个全新的应用——<strong>对象检索（Object Retrieval）</strong>，允许在不重新推理图像的情况下检索特定物体。</li>
<li><strong>(3) WeDetect-Ref</strong>：基于 LLM 的 REC 模型。其核心突破在于<strong>摒弃了下一个词预测（Next-token Prediction）</strong>，利用检索式分类实现了数量级的速度提升。</li>
</ul>
<ol start="3">
<li><strong>最终成就</strong>：</li>
</ol>
<ul>
<li>WeDetect 模型家族在 <strong>15 个</strong> 不同的基准测试中均达到了最先进的性能（SOTA）。</li>
<li>这不仅证明了模型具有强大的泛化能力（Generalization Ability），更重要的是，所有这些高性能都是在**极快速度（Extremely fast speed）**下实现的。</li>
</ul>
<h2 id="4-重点内容梳理-4"><a class="header-anchor" href="#4-重点内容梳理-4"></a><strong>4. 重点内容梳理</strong></h2>
<ul>
<li><strong>大道至简</strong>：结论部分再次强调了“不融合（No Fusion）”和“检索（Retrieval）”的胜利。这提示我们，在多模态领域，有时候通过精巧的数据工程和任务建模（如把生成改分类），简单的架构也能打败复杂的架构。</li>
<li><strong>统一性</strong>：从检测到检索再到大模型理解，看似不同的任务被统一在了一个“生成候选 -&gt; 并行检索”的框架下，这为未来的多任务统一模型提供了新思路。</li>
</ul>
<hr>
<p>好的，我们继续进行论文精读。现在进入论文正文后的补充材料部分，首先是 <strong>8. Limitation（局限性）</strong>。</p>
<p>这一节非常诚恳地讨论了 WeDetect-Ref 在追求极致速度时所做的权衡（Trade-off）。</p>
<hr>
<h1 id="8-Limitation-局限性"><a class="header-anchor" href="#8-Limitation-局限性"></a><strong>8. Limitation (局限性)</strong></h1>
<h2 id="1-本小节概论-13"><a class="header-anchor" href="#1-本小节概论-13"></a><strong>1. 本小节概论</strong></h2>
<p>本小节指出了 WeDetect-Ref 的主要局限性：由于其被设计为**二分类模型（Binary Classification Model）**以实现并行检索，它不支持在单次前向传播中同时检测多个不同的查询（Queries）。相比之下，传统的 Next-token prediction 模型理论上可以生成包含多个类别的序列。为了解决多类别检测问题（如在 COCO 上检测 80 个类），WeDetect-Ref 需要对每个查询分别进行推理并合并结果。但作者强调，得益于其基础速度极快（13 倍加速），即使需要运行多次，在查询数量不极端庞大的情况下，其总效率依然优于或相当于传统 LMM。</p>
<h2 id="2-关键概念-符号表-13"><a class="header-anchor" href="#2-关键概念-符号表-13"></a><strong>2. 关键概念/符号表</strong></h2>
<table>
<thead>
<tr>
<th>概念/术语</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Binary Classification Model</strong></td>
<td><strong>二分类模型</strong>：WeDetect-Ref 的工作模式。它只回答“这个框是不是[查询物体]”，输出是/否。因此一次只能处理一个特定的查询文本。</td>
</tr>
<tr>
<td><strong>Single Forward Pass</strong></td>
<td><strong>单次前向传播</strong>：指数据流经神经网络一次。WeDetect-Ref 一次只能处理一个 Query，不能像某些模型那样一次输入 &quot;cat, dog, car&quot; 并同时输出所有类别的框。</td>
</tr>
<tr>
<td><strong>Next-token prediction</strong></td>
<td><strong>下一个词预测</strong>：传统 LMM 的模式。虽然慢，但它理论上可以生成 &quot;cat at [x], dog at [y]&quot; 这样的序列，涵盖多个类别。</td>
</tr>
<tr>
<td><strong>Merge Results</strong></td>
<td><strong>合并结果</strong>：处理多类别任务（如 LVIS/COCO）的标准后处理步骤。将针对 &quot;cat&quot;、&quot;dog&quot; 等不同查询的推理结果汇总到一张图上。</td>
</tr>
</tbody>
</table>
<h2 id="3-本小节全部内容讲解-5"><a class="header-anchor" href="#3-本小节全部内容讲解-5"></a><strong>3. 本小节全部内容讲解</strong></h2>
<p>结合文中描述 ，我们来解析这个局限性及其影响：</p>
<ol>
<li><strong>机制的代价：单查询限制</strong></li>
</ol>
<ul>
<li><strong>区别</strong>：其他 LMM（如 Qwen3-VL）采用 Next-token prediction，可以一次性生成一段包含多个物体的文本。而 WeDetect-Ref 是一个二分类器（Binary Classifier），它必须专注于判断候选框是否匹配当前的<strong>特定查询</strong>。</li>
<li><strong>后果</strong>：它不支持在单次前向传播（Single Forward Pass）中检测多个不同的查询。如果你想同时找“猫”和“狗”，不能只跑一次模型。</li>
</ul>
<ol start="2">
<li><strong>解决方案：多次推理 + 合并</strong></li>
</ol>
<ul>
<li><strong>策略</strong>：采用类似 <strong>Grounding-DINO</strong> 在 LVIS 数据集上的推理流水线。即：针对每个查询（或每组查询）运行一次模型，最后将所有结果<strong>合并（Merge）</strong>。</li>
<li><em>例子</em>：在 COCO 数据集上评估时，模型实际上运行了 80 次（针对 80 个类别），然后把结果拼起来。</li>
</ul>
<ol start="3">
<li><strong>效率辩护：依然很快</strong></li>
</ol>
<ul>
<li></li>
</ul>
<p><strong>数学账</strong>：虽然要跑多次，但因为 WeDetect-Ref 的单次推理速度比 Qwen3-VL 快 <strong>13 倍</strong> ，所以它有很大的“挥霍”空间。</p>
<ul>
<li><strong>结论</strong>：只要查询的数量不是特别巨大，WeDetect-Ref 的总耗时依然比跑一次极慢的 Qwen3-VL 要少，或者在同等时间内能处理更多的查询，同时保持更高的性能（如 Table 5 所示）。</li>
</ul>
<h2 id="4-重点内容梳理-5"><a class="header-anchor" href="#4-重点内容梳理-5"></a><strong>4. 重点内容梳理</strong></h2>
<ul>
<li><strong>速度与灵活性的权衡</strong>：WeDetect-Ref 选择了“极速的单任务处理能力”。这在实际应用中通常更实用，因为用户往往只搜特定的东西（如“红色的车”）。</li>
<li><strong>多类别检测是短板但可解</strong>：虽然在做全类检测（如 COCO 80 类扫描）时显得笨拙（要跑 80 遍），但由于单次速度够快，整体效率依然能打。</li>
<li><strong>设计哲学的延续</strong>：这种设计再次印证了“检索”的思想——你查什么，我给你找什么。而不是像生成式模型那样“我看到什么就说什么”。</li>
</ul>
<hr>
<p>好的，我们继续进行论文精读。现在进入补充材料中的 <strong>9. Implementation Details（实现细节）</strong>。</p>
<p>这一节提供了复现 WeDetect 和 WeDetect-Ref 所需的具体参数配置，对于理解模型的训练成本和工程技巧非常有价值。</p>
<hr>
<h1 id="9-Implementation-Details-实现细节"><a class="header-anchor" href="#9-Implementation-Details-实现细节"></a><strong>9. Implementation Details (实现细节)</strong></h1>
<h2 id="1-本小节概论-14"><a class="header-anchor" href="#1-本小节概论-14"></a><strong>1. 本小节概论</strong></h2>
<p>本小节详细列出了 WeDetect（基础检测器）和 WeDetect-Ref（REC 模型）的训练配置。</p>
<ul>
<li><strong>WeDetect</strong>：重点介绍了 20M 数据集的构成、两阶段训练的具体超参数（Epochs, Learning Rate, Batch Size）。</li>
<li><strong>WeDetect-Ref</strong>：重点介绍了如何构建**困难负样本（Hard Negatives）**来增强模型的判别能力，以及推理时如何处理输入图像尺寸和 Proposal 匹配。</li>
</ul>
<h2 id="2-关键参数-配置表"><a class="header-anchor" href="#2-关键参数-配置表"></a><strong>2. 关键参数/配置表</strong></h2>
<table>
<thead>
<tr>
<th><strong>模型组件</strong></th>
<th><strong>参数/策略</strong></th>
<th><strong>具体配置值</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>WeDetect</strong></td>
<td>训练数据量</td>
<td><strong>20M</strong> (15M 自建 + 5M 开源 [OpenImages, Objects365, etc.])</td>
</tr>
<tr>
<td></td>
<td>文本编码</td>
<td>每个类别名称被编码为<strong>单个嵌入（Single Embedding）</strong></td>
</tr>
<tr>
<td></td>
<td>Stage 1 (Head/Neck 预热)</td>
<td>20 Epochs, Learning Rate 
    <span id="mjx-1716dc3">
      <style>
      #mjx-1716dc3{
        display:contents;
        mjx-assistive-mml {
          user-select: text !important;
          clip: auto !important;
          color: rgba(0,0,0,0);
        }
        
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

      }
      </style>
      <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg style="vertical-align: -0.05ex;" xmlns="http://www.w3.org/2000/svg" width="4.418ex" height="1.954ex" role="img" focusable="false" viewBox="0 -841.7 1952.7 863.7" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path></g><g data-mml-node="msup" transform="translate(500,0)"><g data-mml-node="mi"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="TeXAtom" transform="translate(499,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(778,0)"><path data-c="34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"></path></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>5</mn><msup><mi>e</mi><mrow data-mjx-texclass="ORD"><mo>−</mo><mn>4</mn></mrow></msup></math></mjx-assistive-mml></mjx-container>
    </span>
  </td>
</tr>
<tr>
<td></td>
<td>Stage 2 (End-to-End)</td>
<td>30 Epochs, Learning Rate 
    <span id="mjx-6686d74">
      <style>
      #mjx-6686d74{
        display:contents;
        mjx-assistive-mml {
          user-select: text !important;
          clip: auto !important;
          color: rgba(0,0,0,0);
        }
        
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

      }
      </style>
      <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="4.418ex" height="1.912ex" role="img" focusable="false" viewBox="0 -833.9 1952.7 844.9" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="msup" transform="translate(500,0)"><g data-mml-node="mi"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="TeXAtom" transform="translate(499,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(778,0)"><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><msup><mi>e</mi><mrow data-mjx-texclass="ORD"><mo>−</mo><mn>5</mn></mrow></msup></math></mjx-assistive-mml></mjx-container>
    </span>
  </td>
</tr>
<tr>
<td></td>
<td>Batch Size</td>
<td>320</td>
</tr>
<tr>
<td><strong>WeDetect-Ref</strong></td>
<td>基座模型</td>
<td>Qwen3-VL</td>
</tr>
<tr>
<td></td>
<td>负样本策略</td>
<td>每张图选 <strong>3 个</strong>困难负类别（WeDetect 预测置信度最高的负类）</td>
</tr>
<tr>
<td></td>
<td>Proposal 来源</td>
<td>WeDetect-Base-Uni 生成的 <strong>Top 100</strong> Boxes</td>
</tr>
<tr>
<td></td>
<td>正样本保底</td>
<td>如果 GT Box 与所有 Proposal 无重叠，则强制将 GT 加入 Proposal 集合</td>
</tr>
<tr>
<td></td>
<td>输入图像尺寸</td>
<td>对应 <strong>900 - 1600</strong> 个视觉 Token (
    <span id="mjx-3409069">
      <style>
      #mjx-3409069{
        display:contents;
        mjx-assistive-mml {
          user-select: text !important;
          clip: auto !important;
          color: rgba(0,0,0,0);
        }
        
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

      }
      </style>
      <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg style="vertical-align: -0.05ex;" xmlns="http://www.w3.org/2000/svg" width="9.409ex" height="2.005ex" role="img" focusable="false" viewBox="0 -864 4159 886" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="39" d="M352 287Q304 211 232 211Q154 211 104 270T44 396Q42 412 42 436V444Q42 537 111 606Q171 666 243 666Q245 666 249 666T257 665H261Q273 665 286 663T323 651T370 619T413 560Q456 472 456 334Q456 194 396 97Q361 41 312 10T208 -22Q147 -22 108 7T68 93T121 149Q143 149 158 135T173 96Q173 78 164 65T148 49T135 44L131 43Q131 41 138 37T164 27T206 22H212Q272 22 313 86Q352 142 352 280V287ZM244 248Q292 248 321 297T351 430Q351 508 343 542Q341 552 337 562T323 588T293 615T246 625Q208 625 181 598Q160 576 154 546T147 441Q147 358 152 329T172 282Q197 248 244 248Z"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(500,0)"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1000,0)"></path></g><g data-mml-node="mo" transform="translate(1722.2,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="msup" transform="translate(2722.4,0)"><g data-mml-node="mn"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" transform="translate(500,0)"></path></g><g data-mml-node="mn" transform="translate(1033,393.1) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>900</mn><mo>×</mo><msup><mn>32</mn><mn>2</mn></msup></math></mjx-assistive-mml></mjx-container>
    </span>
   到 
    <span id="mjx-d300356">
      <style>
      #mjx-d300356{
        display:contents;
        mjx-assistive-mml {
          user-select: text !important;
          clip: auto !important;
          color: rgba(0,0,0,0);
        }
        
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

      }
      </style>
      <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg style="vertical-align: -0.05ex;" xmlns="http://www.w3.org/2000/svg" width="10.541ex" height="2.005ex" role="img" focusable="false" viewBox="0 -864 4659 886" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z" transform="translate(500,0)"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1000,0)"></path><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" transform="translate(1500,0)"></path></g><g data-mml-node="mo" transform="translate(2222.2,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="msup" transform="translate(3222.4,0)"><g data-mml-node="mn"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z"></path><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" transform="translate(500,0)"></path></g><g data-mml-node="mn" transform="translate(1033,393.1) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1600</mn><mo>×</mo><msup><mn>32</mn><mn>2</mn></msup></math></mjx-assistive-mml></mjx-container>
    </span>
  )</td>
</tr>
<tr>
<td></td>
<td>推理逻辑</td>
<td>单次处理 1 个 Query；COCO/LVIS 评估时需运行多次并合并结果</td>
</tr>
</tbody>
</table>
<h2 id="3-本小节全部内容讲解-6"><a class="header-anchor" href="#3-本小节全部内容讲解-6"></a><strong>3. 本小节全部内容讲解</strong></h2>
<p>结合文中描述 ，我们拆解为两个部分：</p>
<ul>
<li><strong>A. WeDetect 训练细节</strong>
<ul>
<li><strong>大规模数据吞吐</strong>：使用了 20M 样本进行训练。为了处理如此庞大的数据，作者采用了较大的 Batch Size (320)。</li>
<li><strong>精细的学习率控制</strong>：
<ul>
<li><strong>预热期</strong>（只训头和颈）：使用较大的学习率 (
    <span id="mjx-00ce564">
      <style>
      #mjx-00ce564{
        display:contents;
        mjx-assistive-mml {
          user-select: text !important;
          clip: auto !important;
          color: rgba(0,0,0,0);
        }
        
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

      }
      </style>
      <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg style="vertical-align: -0.05ex;" xmlns="http://www.w3.org/2000/svg" width="4.418ex" height="1.954ex" role="img" focusable="false" viewBox="0 -841.7 1952.7 863.7" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path></g><g data-mml-node="msup" transform="translate(500,0)"><g data-mml-node="mi"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="TeXAtom" transform="translate(499,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(778,0)"><path data-c="34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"></path></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>5</mn><msup><mi>e</mi><mrow data-mjx-texclass="ORD"><mo>−</mo><mn>4</mn></mrow></msup></math></mjx-assistive-mml></mjx-container>
    </span>
  ) 快速收敛随机初始化的参数。</li>
<li><strong>微调期</strong>（全量）：使用较小的学习率 (
    <span id="mjx-ca9de67">
      <style>
      #mjx-ca9de67{
        display:contents;
        mjx-assistive-mml {
          user-select: text !important;
          clip: auto !important;
          color: rgba(0,0,0,0);
        }
        
mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
  min-height: 1px;
  min-width: 1px;
}

mjx-container[jax="SVG"] > svg a {
  fill: blue;
  stroke: blue;
}

mjx-assistive-mml {
  position: absolute !important;
  top: 0px;
  left: 0px;
  clip: rect(1px, 1px, 1px, 1px);
  padding: 1px 0px 0px 0px !important;
  border: 0px !important;
  display: block !important;
  width: auto !important;
  overflow: hidden !important;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

mjx-assistive-mml[display="block"] {
  width: 100% !important;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][display="true"][width="full"] {
  display: flex;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line], svg[data-table] > g > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame], svg[data-table] > g > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed, svg[data-table] > g > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted, svg[data-table] > g > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > g > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

mjx-container[jax="SVG"] path[data-c], mjx-container[jax="SVG"] use[data-c] {
  stroke-width: 3;
}

g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

.MathJax g[data-mml-node="xypic"] path {
  stroke-width: inherit;
}

      }
      </style>
      <mjx-container class="MathJax" jax="SVG" style="position: relative;"><svg style="vertical-align: -0.025ex;" xmlns="http://www.w3.org/2000/svg" width="4.418ex" height="1.912ex" role="img" focusable="false" viewBox="0 -833.9 1952.7 844.9" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="msup" transform="translate(500,0)"><g data-mml-node="mi"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="TeXAtom" transform="translate(499,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(778,0)"><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z"></path></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><msup><mi>e</mi><mrow data-mjx-texclass="ORD"><mo>−</mo><mn>5</mn></mrow></msup></math></mjx-assistive-mml></mjx-container>
    </span>
  ) 小心翼翼地调整预训练好的 Backbone 和 Language Encoder，防止“灾难性遗忘”。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>B. WeDetect-Ref 训练细节</strong></p>
<ul>
<li>
<p><strong>“困难负样本”挖掘 (Hard Negative Mining)</strong>：</p>
</li>
<li>
<p>这是提升检测精度的关键 Trick。在训练时，作者不仅仅问模型“猫在哪里？”，还会问“狗在哪里？”（假设图里没有狗）。</p>
</li>
<li>
<p><strong>怎么选负样本？</strong> 作者不是随机选，而是用 WeDetect 先跑一遍，找出那些图里没有、但模型觉得“有点像”的前 3 个类别（Top-3 confidence predictions among negative classes）。这被称为“困难负样本”，能强迫 LMM 学会区分细微的特征差异。</p>
</li>
<li>
<p><strong>Proposal 策略</strong>：</p>
</li>
<li>
<p>使用 WeDetect-Base-Uni 提取前 100 个框。</p>
</li>
<li>
<p><strong>保底机制</strong>：检测器不可能 100% 召回所有物体。如果 WeDetect-Uni 漏掉了某个真值（GT），训练时会直接把 GT 塞进候选列表里。这保证了 LMM 的训练始终有正样本可用，避免“无效学习”。</p>
</li>
<li>
<p><strong>推理合并</strong>：再次确认了 Limitation 中提到的点，即在 COCO 上评估时，是针对每个类别运行一次推理（run 80 times per image），然后合并结果。</p>
</li>
</ul>
<h2 id="4-重点内容梳理-6"><a class="header-anchor" href="#4-重点内容梳理-6"></a><strong>4. 重点内容梳理</strong></h2>
<ul>
<li><strong>负样本构建的艺术</strong>：利用 WeDetect（小模型）的预测结果来为 WeDetect-Ref（大模型）挑选“错题集”（Hard Negatives），这是一种非常高效的 Model-in-the-loop 数据构建策略。</li>
<li><strong>学习率的差异</strong>：从  到  的跨度，体现了“分阶段训练”中对不同初始化状态模块的区别对待。</li>
<li><strong>鲁棒性设计</strong>：强制加入无重叠的 GT Box，防止了因为 Proposal 生成器偶尔的失误导致 LMM 无法训练的问题，解耦了两个阶段的错误级联。</li>
</ul>
<hr>
<p>好的，我们来快速浏览论文补充材料中的 <strong>10. More Experiment Results（更多实验结果）</strong> 和 <strong>11. Visualization（可视化）</strong> 部分，然后为您生成全篇论文的总结。</p>
<hr>
<h1 id="10-More-Experiment-Results-更多实验结果"><a class="header-anchor" href="#10-More-Experiment-Results-更多实验结果"></a><strong>10. More Experiment Results (更多实验结果)</strong></h1>
<p>本节提供了我们在主实验部分看到的汇总数据背后的详细分类指标，进一步证实了 WeDetect 在不同领域和场景下的稳健性。</p>
<ul>
<li>
<p><strong>COCO 详细结果 (Table 12)</strong> ：</p>
<p><img src="/blog/2026/01/21/%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E6%A3%80%E6%B5%8B/WeDetect/%E3%80%90WeDetect%E3%80%91%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/image-20260121203700529.png" alt="image-20260121203700529"></p>
<ul>
<li>
<p>展示了从 Tiny 到 Large 模型在 COCO 上的详细 AP 指标。</p>
</li>
<li>
<p><strong>WeDetect-Large</strong> 达到了 <strong>54.5 AP</strong>（ 高达 72.9），证明了其在常见物体检测上的绝对统治力。</p>
</li>
<li>
<p>即使是 <strong>WeDetect-Tiny</strong> 也有 <strong>44.9 AP</strong>，在保持极高速度的同时性能依然强劲。</p>
</li>
</ul>
</li>
<li>
<p><strong>ODinW35 详细结果 (Table 13)</strong> ：</p>
<p><img src="/blog/2026/01/21/%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E6%A3%80%E6%B5%8B/WeDetect/%E3%80%90WeDetect%E3%80%91%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/image-20260121203747434.png" alt="image-20260121203747434"></p>
<ul>
<li>
<p>列出了在 35 个不同领域数据集（如航拍、水族馆、棋子、野火烟雾等）上的具体表现。</p>
</li>
<li>
<p>模型在某些特定数据集上表现极佳（如 <strong>CottontailRabbits</strong> 达到 ~79 AP，<strong>Packages</strong> 达到 ~71 AP），但在某些极难数据集（如 <strong>BoggleBoards</strong> 拼字板）上表现较低。</p>
</li>
<li>
<p>总体平均分（Average）随模型增大稳步提升（21.1 -&gt; 24.6 -&gt; 25.8），验证了 Zero-shot 迁移能力的缩放定律。</p>
</li>
</ul>
</li>
<li>
<p><strong>COCO-O 域泛化结果 (Table 14)</strong> ：</p>
<p><img src="/blog/2026/01/21/%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E6%A3%80%E6%B5%8B/WeDetect/%E3%80%90WeDetect%E3%80%91%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/image-20260121203832385.png" alt="image-20260121203832385"></p>
<ul>
<li>
<p>测试了模型在 <strong>卡通 (Cartoon)、手绘 (Sketch)、油画 (Painting)、纹身 (Tattoo)</strong> 等 6 个不同艺术风格域上的表现。</p>
</li>
<li>
<p><strong>WeDetect-Large</strong> 在所有域上的平均 AP 达到 <strong>47.0</strong>，说明模型不仅认识“照片里的狗”，也认识“素描画里的狗”，视觉特征具有很强的鲁棒性。</p>
</li>
</ul>
</li>
</ul>
<hr>
<h1 id="11-Visualization-可视化"><a class="header-anchor" href="#11-Visualization-可视化"></a><strong>11. Visualization (可视化)</strong></h1>
<p>这一节通过直观的图片展示了 WeDetect 三大组件的实际效果。</p>
<h2 id="11-1-自建数据集可视化-Figure-4"><a class="header-anchor" href="#11-1-自建数据集可视化-Figure-4"></a><strong>11.1 自建数据集可视化 (Figure 4)</strong></h2>
<p><img src="/blog/2026/01/21/%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E6%A3%80%E6%B5%8B/WeDetect/%E3%80%90WeDetect%E3%80%91%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/image-20260121203902283.png" alt="image-20260121203902283"></p>
<ul>
<li>
<p><strong>层级标签展示</strong>：展示了数据引擎生成的标签质量。</p>
</li>
<li>
<p><em>例子</em>：路灯不仅仅被标记为 &quot;streetlight&quot;，而是被标记为层级链条：<code>[Urban facilities (城市设施), Lighting equipment (照明设备), streetlight (路灯)]</code> 。</p>
</li>
<li>
<p>这种标注让模型学会了概念之间的包含关系。</p>
</li>
</ul>
<h2 id="11-2-WeDetect-Uni-候选框可视化-Figure-5"><a class="header-anchor" href="#11-2-WeDetect-Uni-候选框可视化-Figure-5"></a><strong>11.2 WeDetect-Uni 候选框可视化 (Figure 5)</strong></h2>
<p><img src="/blog/2026/01/21/%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E6%A3%80%E6%B5%8B/WeDetect/%E3%80%90WeDetect%E3%80%91%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/image-20260121204000705.png" alt="image-20260121204000705"></p>
<ul>
<li></li>
</ul>
<p><strong>高召回率</strong>：展示了 WeDetect-Large-Uni 在不给定任何类别提示的情况下，利用通用 Objectness Prompt 提取的候选框 。</p>
<ul>
<li><strong>覆盖全面</strong>：图中密集的框覆盖了从大物体（卡车）到小物体（远处的行人）的各种目标，证明了其作为通用 Proposal 生成器的可靠性。</li>
</ul>
<h2 id="11-3-WeDetect-Ref-指代理解可视化-Figure-6"><a class="header-anchor" href="#11-3-WeDetect-Ref-指代理解可视化-Figure-6"></a><strong>11.3 WeDetect-Ref 指代理解可视化 (Figure 6)</strong></h2>
<ul>
<li>
<p>展示了 WeDetect-Ref 处理各种复杂 Query 的能力 ：</p>
</li>
<li>
<p><strong>(b) 空间方位</strong>：准确识别 &quot;the <strong>left</strong> shoe&quot;（左边的鞋）。</p>
</li>
<li>
<p><strong>(c) 语义推理</strong>：&quot;the player who <strong>controls the ball</strong>&quot;（正在控球的球员），这需要理解动作关系。</p>
</li>
<li>
<p><strong>(d) OCR 能力</strong>：&quot;the player wearing the <strong>number 7</strong> jersey&quot;（穿7号球衣的球员），模型能识别数字文本。</p>
</li>
<li>
<p><strong>(f) 多语言能力</strong>：虽然主要用英文训练，但能理解中文 Query &quot;<strong>心形的锁</strong>&quot;（lock with a heart shape），这得益于底层 Qwen3-VL 的多语言基座。</p>
</li>
</ul>
<p><img src="/blog/2026/01/21/%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E6%A3%80%E6%B5%8B/WeDetect/%E3%80%90WeDetect%E3%80%91%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/image-20260121204058557.png" alt="image-20260121204058557"></p>
<hr>
<h1 id="全篇论文总结-Summary"><a class="header-anchor" href="#全篇论文总结-Summary"></a><strong>全篇论文总结 (Summary)</strong></h1>
<p>至此，我们完成了对论文《WeDetect: Fast Open-Vocabulary Object Detection as Retrieval》的完整精读。以下是这篇论文的核心精华总结：</p>
<h2 id="1-核心问题与动机"><a class="header-anchor" href="#1-核心问题与动机"></a><strong>1. 核心问题与动机</strong></h2>
<ul>
<li><strong>痛点</strong>：现有的开放词汇检测器（如 Grounding-DINO）过度依赖“深度跨模态融合（Deep Fusion）”，导致推理速度慢，且特征无法复用。</li>
<li><strong>洞察</strong>：作者提出回归<strong>非融合（Non-fusion）双塔架构</strong>，将检测问题重新建模为高效的<strong>检索（Retrieval）问题</strong>——即在共享嵌入空间中，从候选列表中“挑选”目标，而非为每个查询“生成”结果。</li>
</ul>
<h2 id="2-解决方案：WeDetect-模型家族"><a class="header-anchor" href="#2-解决方案：WeDetect-模型家族"></a><strong>2. 解决方案：WeDetect 模型家族</strong></h2>
<p>论文提出了一个三位一体的模型家族，统一在“检索”范式下：</p>
<ul>
<li>
<p><strong>WeDetect (基础检测器)</strong>：</p>
</li>
<li>
<p><strong>架构</strong>：ConvNeXt (视觉) + XLM-RoBERTa (文本) 的双塔结构，无颈部融合。</p>
</li>
<li>
<p><strong>秘密武器</strong>：构建了 <strong>15M 图片 / 3.3亿 框</strong> 的高质量数据集，利用 LMM 生成<strong>多粒度层级标签</strong>（Multi-granularity Hierarchical Labels）。</p>
</li>
<li>
<p><strong>表现</strong>：在 LVIS 上超越融合模型（YOLO-World, T-Rex2），且速度快数倍（Tiny 版 &gt; 60 FPS）。</p>
</li>
<li>
<p><strong>WeDetect-Uni (通用生成器)</strong>：</p>
</li>
<li>
<p><strong>机制</strong>：冻结检测器，微调一个通用 Prompt。</p>
</li>
<li>
<p><strong>新应用</strong>：<strong>对象检索 (Object Retrieval)</strong>。支持对历史数据进行快速回溯检索（如“找图里的烟头”），弥补了 CLIP 只能搜全图的不足。</p>
</li>
<li>
<p><strong>WeDetect-Ref (LMM 加速器)</strong>：</p>
</li>
<li>
<p><strong>机制</strong>：将 REC 任务从 <strong>Next-token Generation</strong> 转变为 <strong>Parallel Retrieval</strong>。</p>
</li>
<li>
<p><strong>做法</strong>：利用 WeDetect-Uni 生成候选框 -&gt; 压缩为单 Token -&gt; LMM 并行二分类。</p>
</li>
<li>
<p><strong>战绩</strong>：在 RefCOCO 上 SOTA，推理速度比同级 LMM <strong>快 13 倍</strong>。</p>
</li>
</ul>
<h2 id="3-核心贡献-Takeaway"><a class="header-anchor" href="#3-核心贡献-Takeaway"></a><strong>3. 核心贡献 (Takeaway)</strong></h2>
<ol>
<li><strong>为“双塔”正名</strong>：证明了只要数据够好、训练策略得当（分阶段训练、负样本挖掘），简单的双塔模型完全可以打败复杂的融合模型。</li>
<li><strong>LMM 的正确打开方式</strong>：在视觉定位任务中，让大模型做“选择题”（分类）比做“简答题”（生成坐标）更准、更快。</li>
<li><strong>工业价值</strong>：WeDetect 家族极其注重<strong>推理效率</strong>和<strong>特征复用</strong>，非常适合实际的工业部署（如实时监控、相册搜索）。</li>
</ol>
<hr>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/blog/tags/WeDetect/">WeDetect</a></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/blog/2026/01/20/AI%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C/" title="AI使用手册"><img class="cover" src="/blog/image/cover/13.jpg" onerror="onerror=null;src='/blog/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">AI使用手册</div></div><div class="info-2"><div class="info-item-1">codex Codex 命令精简速查表 CLI 终端命令 以下列出 Codex CLI 在终端中常用的命令及其用途，每条附有用途说明和示例：    命令 简要说明 示例     codex (无子命令) 启动交互式 Codex 会话（可选地直接附带提示）。启动后可在终端与 Codex 聊天，Codex 将读取当前目录内容并生成方案。 codex &quot;解释这个代码库&quot; – 在终端快速询问一个问题，Codex...</div></div></div></a><a class="pagination-related" href="/blog/easter-egg/" title="彩蛋"><img class="cover" src="/blog/image/cover/IMG_20260217_201822.jpg" onerror="onerror=null;src='/blog/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">彩蛋</div></div><div class="info-2"><div class="info-item-1">  ...</div></div></div></a></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/blog/image/IMG_20250131_155849.jpg" onerror="this.onerror=null;this.src='/blog/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">lian</div><div class="author-info-description">读研，尝试新技术与记录生活。</div><div class="site-data"><a href="/blog/archives/"><div class="headline">文章</div><div class="length-num">43</div></a><a href="/blog/tags/"><div class="headline">标签</div><div class="length-num">21</div></a><a href="/blog/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/qieliqiean"><i class="fab fa-github"></i><span>访问 GitHub</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/qieliqiean" target="_blank" title="GitHub"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:2895014608@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎交流：2895014608@qq.com</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Abstract"><span class="toc-text">Abstract</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Abstract-1-%E6%9C%AC%E5%B0%8F%E8%8A%82%E6%A6%82%E8%AE%BA"><span class="toc-text">Abstract.1 本小节概论</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Abstract-2-%E5%85%B3%E9%94%AE%E6%A6%82%E5%BF%B5-%E7%AC%A6%E5%8F%B7%E8%A1%A8"><span class="toc-text">Abstract.2 关键概念&#x2F;符号表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Abstract-3-%E5%85%B3%E9%94%AE%E5%85%AC%E5%BC%8F-%E7%AE%97%E6%B3%95"><span class="toc-text">Abstract.3 关键公式&#x2F;算法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Abstract-4-%E6%9C%AC%E5%B0%8F%E8%8A%82%E5%85%A8%E9%83%A8%E5%86%85%E5%AE%B9%E8%AE%B2%E8%A7%A3"><span class="toc-text">Abstract.4 本小节全部内容讲解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%EF%BC%89%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E2%80%9C%E5%8E%BB%E8%9E%8D%E5%90%88%E5%B1%82%E2%80%9D%EF%BC%9F"><span class="toc-text">1）为什么要“去融合层”？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%EF%BC%89WeDetect%EF%BC%9A%E6%8A%8A%E6%A3%80%E6%B5%8B%E5%BD%93%E6%A3%80%E7%B4%A2%EF%BC%8C%E4%BD%86%E8%A6%81%E5%81%9A%E5%88%B0%E2%80%9C%E5%8F%88%E5%BF%AB%E5%8F%88%E5%87%86%E2%80%9D"><span class="toc-text">2）WeDetect：把检测当检索，但要做到“又快又准”</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%EF%BC%89WeDetect-Uni%EF%BC%9A%E6%8A%8A%E2%80%9C%E6%A3%80%E6%B5%8B%E5%99%A8%E2%80%9D%E5%8F%98%E6%88%90%E2%80%9C%E9%80%9A%E7%94%A8%E6%8F%90%E6%A1%88%E5%99%A8%E2%80%9D%EF%BC%8C%E8%BF%98%E8%83%BD%E5%81%9A%E5%8E%86%E5%8F%B2%E6%95%B0%E6%8D%AE%E5%9B%9E%E6%BA%AF"><span class="toc-text">3）WeDetect-Uni：把“检测器”变成“通用提案器”，还能做历史数据回溯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%EF%BC%89WeDetect-Ref%EF%BC%9A%E7%94%A8%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%81%9AREC%EF%BC%8C%E4%BD%86%E4%B8%8D%E7%94%A8%E6%85%A2%E7%9A%84%E9%80%90%E8%AF%8D%E7%94%9F%E6%88%90"><span class="toc-text">4）WeDetect-Ref：用大模型做REC，但不用慢的逐词生成</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Abstract-5-%E9%87%8D%E7%82%B9%E5%86%85%E5%AE%B9%E6%A2%B3%E7%90%86"><span class="toc-text">Abstract.5 重点内容梳理</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-Introduction"><span class="toc-text">**1. Introduction **</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%9C%AC%E5%B0%8F%E8%8A%82%E6%A6%82%E8%AE%BA"><span class="toc-text">1. 本小节概论</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%85%B3%E9%94%AE%E6%A6%82%E5%BF%B5-%E7%AC%A6%E5%8F%B7%E8%A1%A8"><span class="toc-text">2. 关键概念&#x2F;符号表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%85%B3%E9%94%AE%E5%85%AC%E5%BC%8F-%E7%AE%97%E6%B3%95"><span class="toc-text">3. 关键公式&#x2F;算法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%9C%AC%E5%B0%8F%E8%8A%82%E5%85%A8%E9%83%A8%E5%86%85%E5%AE%B9%E8%AE%B2%E8%A7%A3"><span class="toc-text">4. 本小节全部内容讲解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E9%87%8D%E7%82%B9%E5%86%85%E5%AE%B9%E6%A2%B3%E7%90%86"><span class="toc-text">5. 重点内容梳理</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-Related-Work"><span class="toc-text">2.Related Work</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-Open-Vocabulary-Object-Detection-%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B"><span class="toc-text">2.1. Open-Vocabulary Object Detection (开放词汇目标检测)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%9C%AC%E5%B0%8F%E8%8A%82%E6%A6%82%E8%AE%BA-2"><span class="toc-text">1. 本小节概论</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%85%B3%E9%94%AE%E6%A6%82%E5%BF%B5-%E7%AC%A6%E5%8F%B7%E8%A1%A8-2"><span class="toc-text">2. 关键概念&#x2F;符号表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%9C%AC%E5%B0%8F%E8%8A%82%E5%85%A8%E9%83%A8%E5%86%85%E5%AE%B9%E8%AE%B2%E8%A7%A3"><span class="toc-text">3. 本小节全部内容讲解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E9%87%8D%E7%82%B9%E5%86%85%E5%AE%B9%E6%A2%B3%E7%90%86"><span class="toc-text">4. 重点内容梳理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-Large-Vision-Language-Model-%E5%A4%A7%E5%9E%8B%E8%A7%86%E8%A7%89-%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B"><span class="toc-text">2.2. Large Vision-Language Model (大型视觉-语言模型)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%9C%AC%E5%B0%8F%E8%8A%82%E6%A6%82%E8%AE%BA-3"><span class="toc-text">1. 本小节概论</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%85%B3%E9%94%AE%E6%A6%82%E5%BF%B5-%E7%AC%A6%E5%8F%B7%E8%A1%A8-3"><span class="toc-text">2. 关键概念&#x2F;符号表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%9C%AC%E5%B0%8F%E8%8A%82%E5%85%A8%E9%83%A8%E5%86%85%E5%AE%B9%E8%AE%B2%E8%A7%A3-2"><span class="toc-text">3. 本小节全部内容讲解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E9%87%8D%E7%82%B9%E5%86%85%E5%AE%B9%E6%A2%B3%E7%90%86-2"><span class="toc-text">4. 重点内容梳理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-WeDetect-A-Strong-Detection-Foundation"><span class="toc-text">3. WeDetect: A Strong Detection Foundation</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-Model-Architecture-%E6%A8%A1%E5%9E%8B%E6%9E%B6%E6%9E%84"><span class="toc-text">3.1. Model Architecture (模型架构)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%9C%AC%E5%B0%8F%E8%8A%82%E6%A6%82%E8%AE%BA-4"><span class="toc-text">1. 本小节概论</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%85%B3%E9%94%AE%E6%A6%82%E5%BF%B5-%E7%AC%A6%E5%8F%B7%E8%A1%A8-4"><span class="toc-text">2. 关键概念&#x2F;符号表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%9C%AC%E5%B0%8F%E8%8A%82%E5%85%A8%E9%83%A8%E5%86%85%E5%AE%B9%E8%AE%B2%E8%A7%A3-3"><span class="toc-text">3. 本小节全部内容讲解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E9%87%8D%E7%82%B9%E5%86%85%E5%AE%B9%E6%A2%B3%E7%90%86-3"><span class="toc-text">4. 重点内容梳理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-Dataset-Construction-%E6%95%B0%E6%8D%AE%E9%9B%86%E6%9E%84%E5%BB%BA"><span class="toc-text">3.2. Dataset Construction (数据集构建)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%9C%AC%E5%B0%8F%E8%8A%82%E6%A6%82%E8%AE%BA-5"><span class="toc-text">1. 本小节概论</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%85%B3%E9%94%AE%E6%A6%82%E5%BF%B5-%E7%AC%A6%E5%8F%B7%E8%A1%A8-5"><span class="toc-text">2. 关键概念&#x2F;符号表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%85%B3%E9%94%AE%E7%AE%97%E6%B3%95%E6%B5%81%E7%A8%8B-%E8%87%AA%E5%8A%A8%E6%A0%87%E6%B3%A8%E6%95%B0%E6%8D%AE%E5%BC%95%E6%93%8E"><span class="toc-text">3. 关键算法流程 (自动标注数据引擎)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%9C%AC%E5%B0%8F%E8%8A%82%E5%85%A8%E9%83%A8%E5%86%85%E5%AE%B9%E8%AE%B2%E8%A7%A3-2"><span class="toc-text">4. 本小节全部内容讲解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E9%87%8D%E7%82%B9%E5%86%85%E5%AE%B9%E6%A2%B3%E7%90%86-2"><span class="toc-text">5. 重点内容梳理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-Model-Training-%E6%A8%A1%E5%9E%8B%E8%AE%AD%E7%BB%83"><span class="toc-text">3.3. Model Training (模型训练)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%9C%AC%E5%B0%8F%E8%8A%82%E6%A6%82%E8%AE%BA-6"><span class="toc-text">1. 本小节概论</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%85%B3%E9%94%AE%E6%A6%82%E5%BF%B5-%E7%AC%A6%E5%8F%B7%E8%A1%A8-6"><span class="toc-text">2. 关键概念&#x2F;符号表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%85%B3%E9%94%AE%E7%AE%97%E6%B3%95%E6%B5%81%E7%A8%8B-%E8%AE%AD%E7%BB%83%E7%AD%96%E7%95%A5"><span class="toc-text">3. 关键算法流程 (训练策略)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%9C%AC%E5%B0%8F%E8%8A%82%E5%85%A8%E9%83%A8%E5%86%85%E5%AE%B9%E8%AE%B2%E8%A7%A3-3"><span class="toc-text">4. 本小节全部内容讲解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E9%87%8D%E7%82%B9%E5%86%85%E5%AE%B9%E6%A2%B3%E7%90%86-3"><span class="toc-text">5. 重点内容梳理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-WeDetect-Uni-A-Universal-Proposal-Generator"><span class="toc-text">4. WeDetect-Uni: A Universal Proposal Generator</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%9C%AC%E5%B0%8F%E8%8A%82%E6%A6%82%E8%AE%BA-7"><span class="toc-text">1. 本小节概论</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%85%B3%E9%94%AE%E6%A6%82%E5%BF%B5-%E7%AC%A6%E5%8F%B7%E8%A1%A8-7"><span class="toc-text">2. 关键概念&#x2F;符号表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%85%B3%E9%94%AE%E7%AE%97%E6%B3%95%E6%B5%81%E7%A8%8B"><span class="toc-text">3. 关键算法流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%9C%AC%E5%B0%8F%E8%8A%82%E5%85%A8%E9%83%A8%E5%86%85%E5%AE%B9%E8%AE%B2%E8%A7%A3-4"><span class="toc-text">4. 本小节全部内容讲解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E9%87%8D%E7%82%B9%E5%86%85%E5%AE%B9%E6%A2%B3%E7%90%86-4"><span class="toc-text">5. 重点内容梳理</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-WeDetect-Ref-An-LLM-Based-REC-Model"><span class="toc-text">5. WeDetect-Ref: An LLM-Based REC Model</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-Formulating-REC-as-Retrieval-%E5%B0%86%E6%8C%87%E4%BB%A3%E7%90%86%E8%A7%A3%E5%BB%BA%E6%A8%A1%E4%B8%BA%E6%A3%80%E7%B4%A2"><span class="toc-text">5.1. Formulating REC as Retrieval (将指代理解建模为检索)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%9C%AC%E5%B0%8F%E8%8A%82%E6%A6%82%E8%AE%BA-8"><span class="toc-text">1. 本小节概论</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%85%B3%E9%94%AE%E6%A6%82%E5%BF%B5-%E7%AC%A6%E5%8F%B7%E8%A1%A8-8"><span class="toc-text">2. 关键概念&#x2F;符号表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%85%B3%E9%94%AE%E5%85%AC%E5%BC%8F-%E7%AE%97%E6%B3%95-2"><span class="toc-text">3. 关键公式&#x2F;算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%9C%AC%E5%B0%8F%E8%8A%82%E5%85%A8%E9%83%A8%E5%86%85%E5%AE%B9%E8%AE%B2%E8%A7%A3-5"><span class="toc-text">4. 本小节全部内容讲解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E9%87%8D%E7%82%B9%E5%86%85%E5%AE%B9%E6%A2%B3%E7%90%86-5"><span class="toc-text">5. 重点内容梳理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-A-Three-Stage-Training-Recipe-%E4%B8%89%E9%98%B6%E6%AE%B5%E8%AE%AD%E7%BB%83%E9%85%8D%E6%96%B9"><span class="toc-text">5.2. A Three-Stage Training Recipe (三阶段训练配方)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%9C%AC%E5%B0%8F%E8%8A%82%E6%A6%82%E8%AE%BA-9"><span class="toc-text">1. 本小节概论</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%85%B3%E9%94%AE%E6%A6%82%E5%BF%B5-%E7%AC%A6%E5%8F%B7%E8%A1%A8-9"><span class="toc-text">2. 关键概念&#x2F;符号表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%85%B3%E9%94%AE%E7%AE%97%E6%B3%95%E6%B5%81%E7%A8%8B-%E4%B8%89%E9%98%B6%E6%AE%B5%E6%BC%94%E8%BF%9B"><span class="toc-text">3. 关键算法流程 (三阶段演进)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%9C%AC%E5%B0%8F%E8%8A%82%E5%85%A8%E9%83%A8%E5%86%85%E5%AE%B9%E8%AE%B2%E8%A7%A3-6"><span class="toc-text">4. 本小节全部内容讲解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E9%87%8D%E7%82%B9%E5%86%85%E5%AE%B9%E6%A2%B3%E7%90%86-6"><span class="toc-text">5. 重点内容梳理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-Experiment-%E5%AE%9E%E9%AA%8C"><span class="toc-text">6. Experiment (实验)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1-Main-Result-%E4%B8%BB%E8%A6%81%E7%BB%93%E6%9E%9C"><span class="toc-text">6.1. Main Result (主要结果)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%9C%AC%E5%B0%8F%E8%8A%82%E6%A6%82%E8%AE%BA-10"><span class="toc-text">1. 本小节概论</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%85%B3%E9%94%AE%E6%A6%82%E5%BF%B5-%E7%AC%A6%E5%8F%B7%E8%A1%A8-10"><span class="toc-text">2. 关键概念&#x2F;符号表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%85%B3%E9%94%AE%E6%95%B0%E6%8D%AE%E9%80%9F%E8%A7%88"><span class="toc-text">3. 关键数据速览</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%9C%AC%E5%B0%8F%E8%8A%82%E5%85%A8%E9%83%A8%E5%86%85%E5%AE%B9%E8%AE%B2%E8%A7%A3-7"><span class="toc-text">4. 本小节全部内容讲解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E9%87%8D%E7%82%B9%E5%86%85%E5%AE%B9%E6%A2%B3%E7%90%86-7"><span class="toc-text">5. 重点内容梳理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2-Ablation-Study-%E6%B6%88%E8%9E%8D%E5%AE%9E%E9%AA%8C"><span class="toc-text">6.2. Ablation Study (消融实验)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%9C%AC%E5%B0%8F%E8%8A%82%E6%A6%82%E8%AE%BA-11"><span class="toc-text">1. 本小节概论</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%85%B3%E9%94%AE%E6%A6%82%E5%BF%B5-%E7%AC%A6%E5%8F%B7%E8%A1%A8-11"><span class="toc-text">2. 关键概念&#x2F;符号表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%85%B3%E9%94%AE%E5%AE%9E%E9%AA%8C%E5%AF%B9%E6%AF%94-%E6%95%B0%E6%8D%AE%E8%AF%B4%E8%AF%9D"><span class="toc-text">3. 关键实验对比 (数据说话)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%9C%AC%E5%B0%8F%E8%8A%82%E5%85%A8%E9%83%A8%E5%86%85%E5%AE%B9%E8%AE%B2%E8%A7%A3-8"><span class="toc-text">4. 本小节全部内容讲解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E9%87%8D%E7%82%B9%E5%86%85%E5%AE%B9%E6%A2%B3%E7%90%86-8"><span class="toc-text">5. 重点内容梳理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-Conclusion-%E7%BB%93%E8%AE%BA"><span class="toc-text">7. Conclusion (结论)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%9C%AC%E5%B0%8F%E8%8A%82%E6%A6%82%E8%AE%BA-12"><span class="toc-text">1. 本小节概论</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%85%B3%E9%94%AE%E6%A6%82%E5%BF%B5-%E7%AC%A6%E5%8F%B7%E8%A1%A8-12"><span class="toc-text">2. 关键概念&#x2F;符号表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%9C%AC%E5%B0%8F%E8%8A%82%E5%85%A8%E9%83%A8%E5%86%85%E5%AE%B9%E8%AE%B2%E8%A7%A3-4"><span class="toc-text">3. 本小节全部内容讲解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E9%87%8D%E7%82%B9%E5%86%85%E5%AE%B9%E6%A2%B3%E7%90%86-4"><span class="toc-text">4. 重点内容梳理</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#8-Limitation-%E5%B1%80%E9%99%90%E6%80%A7"><span class="toc-text">8. Limitation (局限性)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%9C%AC%E5%B0%8F%E8%8A%82%E6%A6%82%E8%AE%BA-13"><span class="toc-text">1. 本小节概论</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%85%B3%E9%94%AE%E6%A6%82%E5%BF%B5-%E7%AC%A6%E5%8F%B7%E8%A1%A8-13"><span class="toc-text">2. 关键概念&#x2F;符号表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%9C%AC%E5%B0%8F%E8%8A%82%E5%85%A8%E9%83%A8%E5%86%85%E5%AE%B9%E8%AE%B2%E8%A7%A3-5"><span class="toc-text">3. 本小节全部内容讲解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E9%87%8D%E7%82%B9%E5%86%85%E5%AE%B9%E6%A2%B3%E7%90%86-5"><span class="toc-text">4. 重点内容梳理</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#9-Implementation-Details-%E5%AE%9E%E7%8E%B0%E7%BB%86%E8%8A%82"><span class="toc-text">9. Implementation Details (实现细节)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%9C%AC%E5%B0%8F%E8%8A%82%E6%A6%82%E8%AE%BA-14"><span class="toc-text">1. 本小节概论</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%85%B3%E9%94%AE%E5%8F%82%E6%95%B0-%E9%85%8D%E7%BD%AE%E8%A1%A8"><span class="toc-text">2. 关键参数&#x2F;配置表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%9C%AC%E5%B0%8F%E8%8A%82%E5%85%A8%E9%83%A8%E5%86%85%E5%AE%B9%E8%AE%B2%E8%A7%A3-6"><span class="toc-text">3. 本小节全部内容讲解</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E9%87%8D%E7%82%B9%E5%86%85%E5%AE%B9%E6%A2%B3%E7%90%86-6"><span class="toc-text">4. 重点内容梳理</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#10-More-Experiment-Results-%E6%9B%B4%E5%A4%9A%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C"><span class="toc-text">10. More Experiment Results (更多实验结果)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#11-Visualization-%E5%8F%AF%E8%A7%86%E5%8C%96"><span class="toc-text">11. Visualization (可视化)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#11-1-%E8%87%AA%E5%BB%BA%E6%95%B0%E6%8D%AE%E9%9B%86%E5%8F%AF%E8%A7%86%E5%8C%96-Figure-4"><span class="toc-text">11.1 自建数据集可视化 (Figure 4)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-2-WeDetect-Uni-%E5%80%99%E9%80%89%E6%A1%86%E5%8F%AF%E8%A7%86%E5%8C%96-Figure-5"><span class="toc-text">11.2 WeDetect-Uni 候选框可视化 (Figure 5)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-3-WeDetect-Ref-%E6%8C%87%E4%BB%A3%E7%90%86%E8%A7%A3%E5%8F%AF%E8%A7%86%E5%8C%96-Figure-6"><span class="toc-text">11.3 WeDetect-Ref 指代理解可视化 (Figure 6)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%A8%E7%AF%87%E8%AE%BA%E6%96%87%E6%80%BB%E7%BB%93-Summary"><span class="toc-text">全篇论文总结 (Summary)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%A0%B8%E5%BF%83%E9%97%AE%E9%A2%98%E4%B8%8E%E5%8A%A8%E6%9C%BA"><span class="toc-text">1. 核心问题与动机</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%EF%BC%9AWeDetect-%E6%A8%A1%E5%9E%8B%E5%AE%B6%E6%97%8F"><span class="toc-text">2. 解决方案：WeDetect 模型家族</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%A0%B8%E5%BF%83%E8%B4%A1%E7%8C%AE-Takeaway"><span class="toc-text">3. 核心贡献 (Takeaway)</span></a></li></ol></li></ol></div></div><div class="card-widget card-post-series"><div class="item-headline"><i class="fa-solid fa-layer-group"></i><span>系列文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/blog/2026/01/21/%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E6%A3%80%E6%B5%8B/WeDetect/%E3%80%90WeDetect%E3%80%91%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/" title="【WeDetect】论文阅读"><img src="/blog/image/cover/9.jpg" onerror="this.onerror=null;this.src='/blog/img/404.jpg'" alt="【WeDetect】论文阅读"></a><div class="content"><a class="title" href="/blog/2026/01/21/%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E6%A3%80%E6%B5%8B/WeDetect/%E3%80%90WeDetect%E3%80%91%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/" title="【WeDetect】论文阅读">【WeDetect】论文阅读</a><time datetime="2026-01-21T01:41:58.000Z" title="发表于 2026-01-21 09:41:58">2026-01-21</time></div></div></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/blog/easter-egg/" title="彩蛋"><img src="/blog/image/cover/IMG_20260217_201822.jpg" onerror="this.onerror=null;this.src='/blog/img/404.jpg'" alt="彩蛋"/></a><div class="content"><a class="title" href="/blog/easter-egg/" title="彩蛋">彩蛋</a><time datetime="2026-02-18T05:09:03.000Z" title="发表于 2026-02-18 13:09:03">2026-02-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/2026/01/21/%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E6%A3%80%E6%B5%8B/WeDetect/%E3%80%90WeDetect%E3%80%91%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/" title="【WeDetect】论文阅读"><img src="/blog/image/cover/9.jpg" onerror="this.onerror=null;this.src='/blog/img/404.jpg'" alt="【WeDetect】论文阅读"/></a><div class="content"><a class="title" href="/blog/2026/01/21/%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E6%A3%80%E6%B5%8B/WeDetect/%E3%80%90WeDetect%E3%80%91%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/" title="【WeDetect】论文阅读">【WeDetect】论文阅读</a><time datetime="2026-01-21T01:41:58.000Z" title="发表于 2026-01-21 09:41:58">2026-01-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/2026/01/20/AI%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C/" title="AI使用手册"><img src="/blog/image/cover/13.jpg" onerror="this.onerror=null;this.src='/blog/img/404.jpg'" alt="AI使用手册"/></a><div class="content"><a class="title" href="/blog/2026/01/20/AI%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C/" title="AI使用手册">AI使用手册</a><time datetime="2026-01-20T01:21:48.000Z" title="发表于 2026-01-20 09:21:48">2026-01-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/2026/01/19/%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E6%A3%80%E6%B5%8B/OV-DQUO/%E3%80%90OV-DQUO%E3%80%91%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/" title="【OV-DQUO】论文阅读"><img src="/blog/image/cover/2.jpg" onerror="this.onerror=null;this.src='/blog/img/404.jpg'" alt="【OV-DQUO】论文阅读"/></a><div class="content"><a class="title" href="/blog/2026/01/19/%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E6%A3%80%E6%B5%8B/OV-DQUO/%E3%80%90OV-DQUO%E3%80%91%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/" title="【OV-DQUO】论文阅读">【OV-DQUO】论文阅读</a><time datetime="2026-01-19T07:59:50.000Z" title="发表于 2026-01-19 15:59:50">2026-01-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/2026/01/14/%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E6%A3%80%E6%B5%8B/YOLO-UniOW/%E3%80%90YOLO-UniOW%E3%80%91%E6%8C%87%E6%A0%87%E8%A7%A3%E9%87%8A/" title="YOLO-UniOW-指标解释"><img src="/blog/image/cover/6.jpeg" onerror="this.onerror=null;this.src='/blog/img/404.jpg'" alt="YOLO-UniOW-指标解释"/></a><div class="content"><a class="title" href="/blog/2026/01/14/%E5%BC%80%E6%94%BE%E8%AF%8D%E6%B1%87%E6%A3%80%E6%B5%8B/YOLO-UniOW/%E3%80%90YOLO-UniOW%E3%80%91%E6%8C%87%E6%A0%87%E8%A7%A3%E9%87%8A/" title="YOLO-UniOW-指标解释">YOLO-UniOW-指标解释</a><time datetime="2026-01-14T01:44:34.000Z" title="发表于 2026-01-14 09:44:34">2026-01-14</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2025 - 2026 By lian</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">岁岁平，岁岁安，岁岁平安</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/blog/js/utils.js"></script><script src="/blog/js/main.js"></script><script src="/blog/true"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'none',
        },
        chtml: {
          scale: 1.1
        },
        options: {
          enableMenu: true,
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }

      const script = document.createElement('script')
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getGiscusTheme = theme => theme === 'dark' ? 'dark_dimmed' : 'light'

  const createScriptElement = config => {
    const ele = document.createElement('script')
    Object.entries(config).forEach(([key, value]) => {
      ele.setAttribute(key, value)
    })
    return ele
  }

  const loadGiscus = (el = document, key) => {
    const mappingConfig = isShuoshuo
      ? { 'data-mapping': 'specific', 'data-term': key }
      : { 'data-mapping': (option && option['data-mapping']) || 'pathname' }

    const giscusConfig = {
      src: 'https://giscus.app/client.js',
      'data-repo': 'qieliqiean/blog',
      'data-repo-id': 'R_kgDONvpdYw',
      'data-category-id': 'DIC_kwDONvpdY84C1DqB',
      'data-theme': getGiscusTheme(document.documentElement.getAttribute('data-theme')),
      'data-reactions-enabled': '1',
      crossorigin: 'anonymous',
      async: true,
      ...option,
      ...mappingConfig
    }

    const scriptElement = createScriptElement(giscusConfig)

    el.querySelector('#giscus-wrap').appendChild(scriptElement)

    if (isShuoshuo) {
      window.shuoshuoComment.destroyGiscus = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }
  }

  const changeGiscusTheme = theme => {
    const iframe = document.querySelector('#giscus-wrap iframe')
    if (iframe) {
      const message = {
        giscus: {
          setConfig: {
            theme: getGiscusTheme(theme)
          }
        }
      }
      iframe.contentWindow.postMessage(message, 'https://giscus.app')
    }
  }

  btf.addGlobalFn('themeChange', changeGiscusTheme, 'giscus')

  if (isShuoshuo) {
    'Giscus' === 'Giscus'
      ? window.shuoshuoComment = { loadComment: loadGiscus }
      : window.loadOtherComment = loadGiscus
    return
  }

  if ('Giscus' === 'Giscus' || !true) {
    if (true) btf.loadComment(document.getElementById('giscus-wrap'), loadGiscus)
    else loadGiscus()
  } else {
    window.loadOtherComment = loadGiscus
  }
})()</script></div><script defer src="/blog/js/site.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/blog/js/search/local-search.js"></script></div></div></body></html>