<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>井中月</title>
    <url>/blog/2025/02/25/%E4%BA%95%E4%B8%AD%E6%9C%88/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script>]]></content>
      <categories>
        <category>想法</category>
      </categories>
      <tags>
        <tag>井中月</tag>
      </tags>
  </entry>
  <entry>
    <title>数值分析-QR分解</title>
    <url>/blog/2025/06/09/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90-QR%E5%88%86%E8%A7%A3/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="QR分解"><a href="#QR分解" class="headerlink" title="QR分解"></a>QR分解</h1><h2 id="例题1"><a href="#例题1" class="headerlink" title="例题1"></a>例题1</h2><p><img src="/blog/image/Snipaste_2025-06-09_18-39-23.png"></p>
<h2 id="例题2"><a href="#例题2" class="headerlink" title="例题2"></a>例题2</h2><p><img src="/blog/image/Snipaste_2025-06-09_19-07-12.png"></p>
<h2 id="例题3"><a href="#例题3" class="headerlink" title="例题3"></a>例题3</h2><p><img src="/blog/image/Snipaste_2025-06-10_09-32-14.png"></p>
<p><img src="/blog/image/Snipaste_2025-06-10_09-32-30.png"></p>
<h1 id="约化为对称三对角阵"><a href="#约化为对称三对角阵" class="headerlink" title="约化为对称三对角阵"></a>约化为对称三对角阵</h1><h2 id="例题1-1"><a href="#例题1-1" class="headerlink" title="例题1"></a>例题1</h2><p><img src="/blog/image/Snipaste_2025-06-09_20-19-03.png"></p>
<h2 id="例题2-1"><a href="#例题2-1" class="headerlink" title="例题2"></a>例题2</h2><p><img src="/blog/image/Snipaste_2025-06-09_20-19-16.png"></p>
<p><img src="/blog/image/Snipaste_2025-06-09_20-19-24.png"></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
  </entry>
  <entry>
    <title>数值分析-函数逼近</title>
    <url>/blog/2025/05/15/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90-%E5%87%BD%E6%95%B0%E9%80%BC%E8%BF%91/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="第三章-函数逼近"><a href="#第三章-函数逼近" class="headerlink" title="第三章 函数逼近"></a>第三章 函数逼近</h1><h2 id="范数与赋范线性空间"><a href="#范数与赋范线性空间" class="headerlink" title="范数与赋范线性空间"></a>范数与赋范线性空间</h2><p>设 $S$ 是实数域上的线性空间，$x \in S$，如果存在唯一实数 $||\cdot||$，满足以下条件：  </p>
<ol>
<li><p><strong>正定性</strong>：<br>$$<br>||x|| \geq 0，\quad \text{当且仅当} \ x &#x3D; 0 \ \text{时，} \ ||x|| &#x3D; 0<br>$$</p>
</li>
<li><p><strong>齐次性</strong>：<br>$$<br>|| \alpha x || &#x3D; |\alpha| \cdot ||x||，\quad \alpha \in \mathbb{R}<br>$$</p>
</li>
<li><p><strong>三角不等式</strong>：<br>$$<br>||x + y|| \leq ||x|| + ||y||，\quad x, y \in S<br>$$</p>
</li>
</ol>
<p>则称 $||\cdot||$ 为线性空间 $S$ 上的<strong>范数</strong>，$S$ 与 $||\cdot||$ 一起称为<strong>赋范线性空间</strong>，记为 $X$。</p>
<p><strong>常用范数定义</strong></p>
<h4 id="向量范数"><a href="#向量范数" class="headerlink" title="向量范数"></a>向量范数</h4><p>设 $x &#x3D; (x_1, \dots, x_n)^T \in \mathbb{R}^n$，定义以下三种常用范数：  </p>
<ol>
<li><p><strong>∞-范数（最大范数）</strong>：<br>$$<br>||x|| _ \infty &#x3D; \max_{1 \leq i \leq n} |x_i|<br>$$</p>
</li>
<li><p><strong>1-范数</strong>：<br>$$<br>||x|| _ 1 &#x3D; \sum_{i&#x3D;1}^n |x_i|<br>$$</p>
</li>
<li><p><strong>2-范数</strong>：<br>$$<br>||x|| _ 2 &#x3D; \left( \sum_{i&#x3D;1}^n x_i^2 \right)^{1&#x2F;2}<br>$$</p>
</li>
</ol>
<hr>
<h4 id="函数范数"><a href="#函数范数" class="headerlink" title="函数范数"></a>函数范数</h4><p>设 $f(x) \in C[a, b]$，定义以下三种常用范数：  </p>
<ol>
<li><p><strong>∞-范数</strong>：<br>$$<br>||f||_ \infty &#x3D; \max_{a \leq x \leq b} |f(x)|<br>$$</p>
</li>
<li><p><strong>1-范数</strong>：<br>$$<br>||f||_1 &#x3D; \int_a^b |f(x)| , dx<br>$$</p>
</li>
<li><p><strong>2-范数</strong>：<br>$$<br>||f||_2 &#x3D; \left( \int_a^b f^2(x) , dx \right)^{1&#x2F;2}<br>$$</p>
</li>
</ol>
<h2 id="内积与内积空间"><a href="#内积与内积空间" class="headerlink" title="内积与内积空间"></a>内积与内积空间</h2><h3 id="权函数的定义"><a href="#权函数的定义" class="headerlink" title="权函数的定义"></a>权函数的定义</h3><p>设 $[a, b]$ 是有限或无限区间，在 $[a, b]$ 上的<strong>非负</strong>函数 $\rho(x)$ 满足以下条件：  </p>
<ol>
<li><p><strong>积分存在性</strong>：<br>对任意非负整数 $k &#x3D; 0, 1, 2, \ldots$，积分<br>$$<br>\int_a^b x^k \rho(x)dx<br>$$<br>存在且为有限值。  </p>
</li>
<li><p><strong>非负连续性条件</strong>：<br>对 $[a, b]$ 上的任意非负连续函数 $g(x)$，若满足<br>$$<br>\int_a^b g(x)\rho(x) dx &#x3D; 0<br>$$<br>则必有 $g(x) \equiv 0$（即 $g(x)$ 在 $[a, b]$ 上恒为零）。</p>
</li>
</ol>
<p>满足上述条件的函数 $\rho(x)$ 称为 $[a, b]$ 上的一个<strong>权函数</strong>。</p>
<h3 id="向量内积"><a href="#向量内积" class="headerlink" title="向量内积"></a>向量内积</h3><p>在 $\mathbb{R}^n$ 中，向量 $x &#x3D; (x_1, x_2, \dots, x_n)^T$ 和 $y &#x3D; (y_1, y_2, \dots, y_n)^T$ 的内积定义为：<br>$$<br>(x, y) &#x3D; x_1 y_1 + x_2 y_2 + \dots + x_n y_n \tag{1.5}<br>$$</p>
<p>设 $X$ 是数域 $K$（实数域 $\mathbb{R}$ 或复数域 $\mathbb{C}$）上的线性空间。对任意 $u, v \in X$，有K中一个数与之对应，记为$(u,v)$，它满足以下条件：</p>
<ol>
<li><p><strong>共轭对称性</strong>：<br>$$<br>(u, v) &#x3D; \overline{(v, u)}<br>$$<br>其中 $\overline{(v, u)}$ 表示 $(v, u)$ 的复共轭。当 $K &#x3D; \mathbb{R}$ 时，简化为对称性 $(u, v) &#x3D; (v, u)$。  </p>
</li>
<li><p><strong>线性性</strong>：<br>$$<br>(\alpha u, v) &#x3D; \alpha (u, v), \quad \forall \alpha \in K<br>$$</p>
</li>
<li><p><strong>可加性</strong>：<br>$$<br>(u + v, w) &#x3D; (u, w) + (v, w), \quad \forall w \in X<br>$$</p>
</li>
<li><p><strong>正定性</strong>：<br>$$<br>(u, u) \geq 0<br>$$<br>当且仅当 $u &#x3D; 0$ 时，$(u, u) &#x3D; 0$。</p>
</li>
</ol>
<p>定义了内积的线性空间称为<strong>内积空间</strong>。</p>
<hr>
<h3 id="函数内积"><a href="#函数内积" class="headerlink" title="函数内积"></a>函数内积</h3><p>设 $f(x), g(x) \in C[a, b]$，$\rho(x)$ 是 $[a, b]$ 上的权函数，积分<br>$$<br>(f, g) &#x3D; \int_a^b \rho(x) f(x) g(x) , dx<br>$$<br>称为函数 $f(x)$ 与 $g(x)$ 在 $[a, b]$ 上的<strong>内积</strong>。</p>
<h3 id="函数范数与内积"><a href="#函数范数与内积" class="headerlink" title="函数范数与内积"></a>函数范数与内积</h3><blockquote>
<p><strong>向量模（范数）的定义</strong></p>
<p>设向量 $ f \in \mathbb{R}^n $，其模（范数）定义为：<br>$$<br>|| f ||_ 2 &#x3D; \left( \sum_{k&#x3D;1}^{n} f_k^2 \right)^{\frac{1}{2}}<br>$$<br>将此定义推广到任何内积空间中，就有以下定义。</p>
<hr>
<p>设函数 $ f(x) \in C[a, b] $，定义量<br>$$<br>|| f ||_2 &#x3D; \sqrt{ \int_a^b \rho(x) f^2(x) , dx } &#x3D; \sqrt{ (f, f) }<br>$$<br>$$<br>|| f ||_2^2&#x3D;(f, f)<br>$$</p>
<p>称为函数 $ f(x) $ 的<strong>欧氏范数</strong>。</p>
</blockquote>
<blockquote>
<p><strong>定理</strong>  </p>
<p>对任何 $ f, g \in C[a, b] $，下列结论成立：  </p>
<ol>
<li><strong>柯西-许瓦兹不等式</strong>：</li>
</ol>
<p>$$<br>|(f, g)| \leq ||f||_2 ||g||_2 \<br> 或 \quad |(f, g)|^2 \leq (f,f)(g,g)<br>$$</p>
<ol start="2">
<li><strong>三角不等式</strong>：</li>
</ol>
<p>$$<br>||f + g||_2 \leq ||f||_2 + ||g||_2<br>$$</p>
<ol start="3">
<li><strong>平行四边形定律</strong>：</li>
</ol>
<p>$$<br>||f + g||_2^2 + ||f - g||_2^2 &#x3D; 2 \left( ||f||_2^2 + ||g||_2^2 \right)<br>$$</p>
</blockquote>
<h3 id="线性无关相关概念与定理"><a href="#线性无关相关概念与定理" class="headerlink" title="线性无关相关概念与定理"></a>线性无关相关概念与定理</h3><p>设集合 $ S $ 是数域 $ P $ 上的线性空间，元素 $ x_1, x_2, \dots, x_n \in S $。如果存在不全为零的数 $ \alpha_1, \alpha_2, \dots, \alpha_n \in P $，使得<br>$$<br>\alpha_1 x_1 + \alpha_2 x_2 + \dots + \alpha_n x_n &#x3D; 0 \quad (1.1)<br>$$<br>则称 $ x_1, x_2, \dots, x_n $ <strong>线性相关</strong>。否则，若等式 (1.1) 只对<br>$$<br>\alpha_1 &#x3D; \alpha_2 &#x3D; \dots &#x3D; \alpha_n &#x3D; 0<br>$$<br>成立，则称 $ x_1, x_2, \dots, x_n $ <strong>线性无关</strong>。</p>
<hr>
<p><strong>基的定义</strong>  </p>
<p>若线性空间 $ S $ 是由 $ n $ 个线性无关元素 $ x_1, x_2, \dots, x_n $ 生成的，即对任意 $ x \in S $，都有<br>$$<br>x &#x3D; \alpha_1 x_1 + \alpha_2 x_2 + \dots + \alpha_n x_n,<br>$$<br>则 $ x_1, x_2, \dots, x_n $ 称为空间 $ S $ 的一组<strong>基</strong>，记为<br>$$<br>S &#x3D; \text{span}{x_1, x_2, \dots, x_n}.<br>$$<br>其中，系数 $ \alpha_1, \alpha_2, \dots, \alpha_n $ 称为 $ x $ 在基 $ x_1, x_2, \dots, x_n $ 下的<strong>坐标</strong>，记作 $ (\alpha_1, \alpha_2, \dots, \alpha_n) $。</p>
<hr>
<h3 id="无限维线性空间"><a href="#无限维线性空间" class="headerlink" title="无限维线性空间"></a><strong>无限维线性空间</strong></h3><p>如果 $ S $ 中有无限个线性无关元素 $ x_1, x_2, \dots, x_n, \dots $，则称 $ S $ 为<strong>无限维线性空间</strong>。</p>
<blockquote>
<p><strong>定理3</strong> </p>
<p>设 $ X $ 为一个内积空间，$ u_1, u_2, \dots, u_n \in X $，矩阵 $ G $ 定义为：  </p>
<span>
$$
G = \begin{pmatrix}
(u_1, u_1) & (u_2, u_1) & \cdots & (u_n, u_1) \\
(u_1, u_2) & (u_2, u_2) & \cdots & (u_n, u_2) \\
\vdots & \vdots & & \vdots \\
(u_1, u_n) & (u_2, u_n) & \cdots & (u_n, u_n)
\end{pmatrix}
$$
</span>

<p>矩阵 $ G $ 称为<strong>格拉姆(Gram)矩阵</strong>。矩阵 $ G $ 非奇异(<strong>等价与$detG≠0$</strong>)的充分必要条件是 $ u_1, u_2, \dots, u_n $ 线性无关。</p>
</blockquote>
<h2 id="函数的最佳平方逼近"><a href="#函数的最佳平方逼近" class="headerlink" title="函数的最佳平方逼近"></a>函数的最佳平方逼近</h2><p>设函数 $ f(x) \in C[a, b] $，用 $ n $ 次多项式<br>$$<br>s(x) &#x3D; \sum_{k&#x3D;0}^{n} a_k x^k<br>$$<br>作最佳平方逼近，就是要求得以 $ a_0^* , a_1^* , \dots, a_n^*  $ 为系数的多项式<br>$$<br>s^* (x) &#x3D; \sum_{k&#x3D;0}^{n} a_k^*  x^k<br>$$<br>使得<br>$$<br>|| f(x) - s^* (x) ||_2^2 &#x3D; \int_a^b [f(x) - s^* (x)]^2 dx<br>$$</p>
<p>$$<br>&#x3D;\min_{s(x) \in H_n} || f(x) - s(x) ||_2^2<br>$$<br>其中 $ H_n $ 表示所有 $ n $ 次多项式的集合。</p>
<hr>
<p><strong>推广到一般情况</strong></p>
<p>对于给定的权函数 $ \rho(x) $，要求得 $ a_k^* $（$ k &#x3D; 0, 1, \dots, n $）使得<br>$$<br>|| f(x) - s^* (x) ||_2^2 &#x3D; \int_a^b \rho(x) [f(x) - s^* (x)]^2 dx<br>$$</p>
<p>$$<br>&#x3D;\min_{s(x) \in H_n} || f(x) - s(x) ||_2^2<br>$$</p>
<p><strong>进一步推广</strong></p>
<p>$ n $ 次多项式<br>$$<br>s(x) &#x3D; \sum_{k&#x3D;0}^{n} a_k x^k<br>$$<br>是以 $ 1, x, \dots, x^n $ 为基函数的线性组合。</p>
<p>进一步推广可将 $ x^k $ 改为一般的线性无关的连续函数 $ \varphi_k(x) $，全体构成 $ C[a, b] $ 的子空间，即  </p>
<span>
$$
\Phi = \text{span}\{ \varphi_0, \varphi_1, \dots, \varphi_n \}
$$
</span>

<p>最佳平方逼近问题可叙述为：求 $ a_0^* , a_1^* , \dots, a_n^*  $ 使得   </p>
 <span>
$$
|| f(x) - s^* (x) ||_2^2 = || f(x) - \sum_ {k=0}^n a_k  \varphi _k (x) ||_2^2= \min_{s(x) \in \Phi} \| f(x) - s(x) \|_2^2
$$
</span>

<p>其中，$ \Phi &#x3D; \text{span}{ \varphi_0, \varphi_1, \dots, \varphi_n } $ 是由基函数 $ \varphi_k(x) $ 生成的函数空间。</p>
<p><strong>上述问题等价于求解多元函数</strong><br>$$<br>I(a_0, a_1, \dots, a_n) &#x3D; \int_a^b \rho(x) \left| f(x) - \sum_{k&#x3D;0}^n a_k \varphi_k(x) \right|^2 dx<br>$$<br>的最小值问题。</p>
<p>由多元函数极值存在的必要条件可得如下的法方程组：<br>$$<br>\sum_{j&#x3D;0}^{n} (\varphi_j, \varphi_k) a_j &#x3D; (f, \varphi_k), \quad (k &#x3D; 0, 1, \ldots, n)<br>$$</p>
<p>可证明方程组有唯一解 $ a_k &#x3D; a_k^* $（$ k &#x3D; 0, 1, \dots, n $），从而得到</p>
<p>$s^* (x) &#x3D; a_0^*  \varphi_0(x) + \cdots + a_n^*  \varphi_n(x)$</p>
<p>若令<br>$$<br>\delta(x) &#x3D; f(x) - S^* (x),<br>$$</p>
<h3 id="最佳平方逼近的误差"><a href="#最佳平方逼近的误差" class="headerlink" title="最佳平方逼近的误差"></a>最佳平方逼近的误差</h3><span>
$$
\|\delta(x)\|^2_2 = \left( f(x) - S^* (x), f(x) - S^* (x) \right) \\
= (f(x), f(x)) - (S^*(x), f(x)) = \|f(x)\|^2_2 - \sum_{k=0}^n a_k^* (\varphi_k(x), f(x)).
$$
</span>

<p><strong>PS</strong>:根据法方程可得$(S^* (x),\varphi_k)&#x3D;(f,\varphi_k)$,进一步得$(f-S^* (x),\varphi_k)&#x3D;0$，即$(f-S^* ,S^* )&#x3D;0$</p>
<blockquote>
<p>若取基函数<span style="color:#FF0000">（注意区间是$[0, 1]$，如果区间不对，不要乱套希尔伯特矩阵，老实用函数内积解题）  </span><br>$$<br>\varphi_k(x) &#x3D; x^k, \quad \rho(x) &#x3D; 1, \quad f(x) \in C[0, 1],<br>$$<br>则要在 $ H_n $ 中求 $ n $ 次最佳平方逼近多项式<br>$$<br>s^*(x) &#x3D; a_0 + a_1 x + \dots + a_n x^n.<br>$$</p>
<p>此时，内积定义为<br>$$<br>(\varphi_i(x), \varphi_j(x)) &#x3D; \int_0^1 x^{i+j} , dx &#x3D; \frac{1}{i + j + 1},<br>$$<br>而<br>$$<br>(f(x), \varphi_k(x)) &#x3D; \int_0^1 f(x) x^k , dx &#x3D; d_k.<br>$$</p>
<p>用 $ H $ 表示格拉姆矩阵 $ G_n &#x3D; G(1, x, \dots, x^n) $，即  </p>
<span>
$$
H = \begin{pmatrix}
1 & \frac{1}{2} & \cdots & \frac{1}{n+1} \\
\frac{1}{2} & \frac{1}{3} & \cdots & \frac{1}{n+2} \\
\vdots & \vdots & & \vdots \\
\frac{1}{n+1} & \frac{1}{n+2} & \cdots & \frac{1}{2n+1}
\end{pmatrix},
$$
<span>

<p>称 $ H $ 为<strong>希尔伯特(Hilbert)矩阵</strong>。记向量<br>$$<br>a &#x3D; (a_0, a_1, \dots, a_n)^T, \quad d &#x3D; (d_0, d_1, \dots, d_n)^T,<br>$$<br>则线性方程组<br>$$<br>H a &#x3D; d<br>$$<br>的解 $ a_k &#x3D; a_k^* $（$ k &#x3D; 0, 1, \dots, n $）即为所求。</p>
</blockquote>
<h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><blockquote>
<p>求$f(x)&#x3D;\ln x,x\in[1,2]$上的二次最佳平方逼近多项式及平方误差</p>
<p><strong>解</strong></p>
<p><img src="/blog/image/Snipaste_2025-05-31_09-54-07.png"></p>
</blockquote>
<blockquote>
<p><img src="/blog/image/Snipaste_2025-05-31_10-10-39.png"></p>
</blockquote>
<blockquote>
<p><img src="/blog/image/Snipaste_2025-06-01_09-49-41.png"></p>
</blockquote>
<blockquote>
<p><img src="/blog/image/vnmdisrni.jpg"></p>
<p><img src="/blog/image/Snipaste_2025-06-01_10-38-39.png"></p>
</blockquote>
<h2 id="用正交函数系作最佳平方逼近"><a href="#用正交函数系作最佳平方逼近" class="headerlink" title="用正交函数系作最佳平方逼近"></a>用正交函数系作最佳平方逼近</h2><p>若 ${g_k(x)}(k&#x3D;0,1,\dots,n)$ 是带权 $\rho(x)$ 正交的函数系，即满足：</p>
<p>$$<br>(g_k, g_j) &#x3D; \int_a^b \rho(x) g_k(x) g_j(x) , dx &#x3D; 0 \quad (k \neq j)<br>$$</p>
<p>通过法方程组 $\sum _{k&#x3D;0}^n  (g_k, g_j)a_j &#x3D; (f, g_j)$ 可以独立解得：</p>
<p>$$<br>a_j^* &#x3D; \frac{(f, g_j)}{(g_j, g_j)} &#x3D; \frac{\int_a^b \rho(x) f(x) g_j(x) , dx}{\int_a^b \rho(x) g_j^2(x) , dx} \quad (j&#x3D;0,1,\dots,n)<br>$$</p>
<blockquote>
<p>$a^*_j$与$n$无关</p>
</blockquote>
<h3 id="最佳平方逼近函数"><a href="#最佳平方逼近函数" class="headerlink" title="最佳平方逼近函数"></a>最佳平方逼近函数</h3><p>$$<br>s^* (x) &#x3D; \sum_{j&#x3D;0}^na_j^*  g_j(x) &#x3D; \sum_{j&#x3D;0}^n \frac{(f, g_j)}{(g_j, g_j)} g_j(x)<br>$$</p>
<h3 id="广义Fourier级数"><a href="#广义Fourier级数" class="headerlink" title="广义Fourier级数"></a>广义Fourier级数</h3><p>对于函数 $f(x) \in C[a, b]$ 与正交基函数系 ${g_k(x)}(k&#x3D;0,1,\dots,n)$，按公式逐个计算出 $a_j^*$ 后，可以得到一个级数：</p>
<p>$$<br> a_0^* g_0(x) + a_1^* g_1(x) + \dots + a_n^* g_n(x)<br>$$</p>
<p>这个级数称为 $f(x)$ 对应于基函数系 ${g_k(x)}(k&#x3D;0,1,\dots,n)$的广义Fourier级数。</p>
<p>系数 $ a_k^* $ 为广义Fourier系数，对任意固定的 $ n $，其部分和为：</p>
<p>$$<br>S_n(x) &#x3D; \sum_{k&#x3D;0}^n a_k^* g_k(x)<br>$$</p>
<p>$ S_n(x) $ 称为广义多项式，是所求的最佳平方逼近多项式。</p>
<h3 id="勒让德多项式作为基函数"><a href="#勒让德多项式作为基函数" class="headerlink" title="勒让德多项式作为基函数"></a>勒让德多项式作为基函数</h3><p>当 $ f(x) \in C[-1, 1] $ 时，可以用勒让德多项式 $ {P_k(x)} $ 作为基函数，即<span> $ {g_k(x)} &#x3D; {P_k(x)} $</span>。此时，最佳平方逼近多项式为：</p>
<span>
$$
s_n^*(x) = a_0^* P_0(x) + a_1^* P_1(x) + \dots + a_n^* P_n(x)
$$

</span>

<p>其中，系数 $ a_k^* $ 的计算公式为：<br>$$<br>a_k^* &#x3D; \frac{(P_k, f)}{(P_k, P_k)} &#x3D; \frac{2k+1}{2} \int_{-1}^1 f(x) P_k(x) , dx \quad(k&#x3D;0,1,\cdots,n)<br>$$</p>
<p>则 $ s_n^<em>(x) $ 是使 $ || f(x) - \sum _{k&#x3D;0}^n a_k^</em>  P_k(x) ||_2^2 $ 最小的最佳平方逼近多项式。</p>
<p><strong>此时的平方误差为</strong>：</p>
<span>
$$
\|\delta_n\|_2^2 = \int_{-1}^{1} [f(x)]^2 \, dx - \sum_{k=0}^{n} \frac{2}{2k+1} a_k^{*2}
$$

</span>

<h3 id="例题-1"><a href="#例题-1" class="headerlink" title="例题"></a>例题</h3><blockquote>
<p>求函数 $ f(x) &#x3D; e^x $ 在区间 $[-1, 1]$ 上的三次最佳平方逼近多项式，使用基函数 ${P_0, P_1, P_2, P_3}$。</p>
<ol>
<li><strong>计算内积 $(P_k, f)$：</strong></li>
</ol>
<p>$$<br>(P_0, f) &#x3D; \int_{-1}^{1} e^x , dx &#x3D; e - \frac{1}{e} \approx 2.3504<br>$$</p>
<p>$$<br>(P_1, f) &#x3D; \int_{-1}^{1} x e^x , dx &#x3D; 2e^{-1} \approx 0.7358<br>$$</p>
<p>$$<br>(P_2, f) &#x3D; \int_{-1}^{1} \left( \frac{3}{2} x^2 - \frac{1}{2} \right) e^x , dx \approx 0.02013<br>$$</p>
<p>$$<br>(P_3, f) &#x3D; \int_{-1}^{1} \left( \frac{5}{2} x^3 - \frac{3}{2} x \right) e^x , dx \approx 0.02013<br>$$</p>
<ol start="2">
<li><strong>计算系数</strong> $ a_k^*  $</li>
</ol>
<p>$$<br>a_0^* &#x3D; \frac{(P_0, f)}{2} \approx 1.1752 \<br>a_1^* &#x3D; \frac{3}{2} (P_1, f) \approx 1.1036 \<br>a_2^* &#x3D; \frac{5}{2} (P_2, f) \approx 0.3578 \<br>a_3^* &#x3D; \frac{7}{2} (P_3, f) \approx 0.07046<br>$$</p>
<ol start="3">
<li><strong>得到逼近多项式 $ S_3^*(x) $：</strong></li>
</ol>
<p>$$<br>S_3^*(x) &#x3D; 0.9963 + 0.9979x + 0.5367x^2 + 0.1761x^3<br>$$</p>
<ol start="4">
<li><strong>计算平方误差：</strong></li>
</ol>
<span>
$$
\left|| \delta_3 \right||_2^2 = \left|| e^x - s_3^* (x) \right||_2^2 = \int_{-1}^{1} e^{2x} \, dx - \sum_{k=0}^{3} \frac{2}{2k+1} {a_k^* }^2 = 0.88 \times 10^{-4}
$$

</span>


<p><u>如果所给的区间不是 $[-1, 1]$，而是一般的有限区间 $[a, b]$，可以通过变量置换将其转化为区间 $[-1, 1]$ 上的情形来处理</u>。</p>
<p>变量置换公式</p>
<p>通过以下变量置换公式，将区间 $[a, b]$ 转化为 $[-1, 1]$：</p>
<p>$$<br>x &#x3D; \frac{a + b}{2} + \frac{b - a}{2} t<br>$$</p>
<p>其中：</p>
<ul>
<li>$ x $ 为原区间 $[a, b]$ 上的变量；</li>
<li>$ t $ 为转化后的区间 $[-1, 1]$ 上的变量。</li>
</ul>
<p><strong>例题：求函数 $ f(x) &#x3D; \sqrt{x} $ 在区间 $[0, 1]$ 上的一次最佳平方逼近多项式</strong></p>
<ol>
<li><p><strong>变量变换</strong>：<br>令 $ x &#x3D; \frac{1}{2}(1 + t) $，则 $ t \in [-1, 1] $，且：<br>$$<br>f(x) &#x3D; \sqrt{x} &#x3D; \sqrt{\frac{1}{2}(1 + t)} &#x3D; \frac{1}{\sqrt{2}} \sqrt{1 + t} &#x3D; \varphi(t)<br>$$</p>
</li>
<li><p><strong>求解 $ \varphi(t) $ 的一次最佳平方逼近多项式 $ q_1(t) $</strong>：<br>使用勒让德多项式 $ {P_0, P_1} $ 作为基函数，计算系数 $ a_0 $ 和 $ a_1 $：<br>$$<br>a_0^* &#x3D; \frac{1}{2} (\varphi, P_0) &#x3D; \frac{1}{2} \int_{-1}^{1} \frac{1}{\sqrt{2}} \sqrt{1 + t} \cdot 1 , dt &#x3D; \frac{2}{3} \<br>a_1^* &#x3D; \frac{3}{2} (\varphi, P_1) &#x3D; \frac{3}{2} \int_{-1}^{1} \frac{1}{\sqrt{2}} \sqrt{1 + t} \cdot t , dt &#x3D; \frac{6}{15}<br>$$<br>因此，一次最佳平方逼近多项式为：<br>$$<br>q_1(t) &#x3D; a_0 P_0(t) + a_1 P_1(t) &#x3D; \frac{2}{3} + \frac{6}{15} t<br>$$</p>
</li>
<li><p><strong>将 $ t &#x3D; 2x - 1 $ 代入 $ q_1(t) $</strong>：<br>得到 $ \sqrt{x} $ 在区间 $[0, 1]$ 上的一次最佳平方逼近多项式：<br>$$<br>s_1(x) &#x3D; \frac{2}{3} + \frac{6}{15} (2x - 1) &#x3D; \frac{4}{15} + \frac{12}{15} x<br>$$</p>
</li>
</ol>
</blockquote>
<blockquote>
<p><img src="/blog/image/IMG_0145.jpg"></p>
</blockquote>
<h2 id="正交多项式"><a href="#正交多项式" class="headerlink" title="正交多项式"></a>正交多项式</h2><h3 id="正交函数族"><a href="#正交函数族" class="headerlink" title="正交函数族"></a>正交函数族</h3><p>若 $ f(x), g(x) \in C[a, b] $，$ \rho(x) \in C[a, b] $，且 $ \rho(x) $ 为 $[a, b]$ 上的权函数，且<br>$$<br>(f, g) &#x3D; \int_a^b \rho(x) f(x) g(x) , dx &#x3D; 0<br>$$<br>则称 $ f(x) $ 与 $ g(x) $ 在 $[a, b]$ 上<strong>带权 $ \rho(x) $ 正交</strong>。  </p>
<p>设在 $[a, b]$ 给定函数族 $ {\varphi_n(x)} $，且满足  </p>
<span>
$$
(\varphi_i, \varphi_k) = \int_a^b \rho(x) \varphi_i(x) \varphi_k(x) \, dx = 
\begin{cases} 
0, & i \neq k, \\ 
c_k, & i = k 
\end{cases} \quad (i, k = 0, 1, 2, \dots),
$$
</span>

<p>则称函数族 $ {\varphi_n(x)} $ 为 $[a, b]$ 上带权 $ \rho(x) $ 的正交函数族。<br>特别地，当 $ c_k &#x3D; 1 $ 时，则该函数族称为<strong>标准正交函数族</strong>。  </p>
<hr>
<p>设 $ p_n(x) $ 是 $[a, b]$ 上首项系数 $ a_n \neq 0 $ 的 $ n $ 次多项式，$ \rho(x) $ 为 $[a, b]$ 上的权函数。</p>
<p>若多项式序列 ${p_n(x)}_0^\infty$ 满足正交性，则称 ${p_n(x)}_0^\infty$ 为以 $ \rho(x) $ 为权函数的 $[a, b]$ 上的<strong>正交多项式序列</strong>，并称 $ p_n(x) $ 为以 $ \rho(x) $ 为权函数的 $[a, b]$ 上的 $ n $ 次<strong>正交多项式</strong>。</p>
<h3 id="正交多项式序列"><a href="#正交多项式序列" class="headerlink" title="正交多项式序列"></a>正交多项式序列</h3><p>只要给定 $[a, b]$ 上的权函数 $ \rho(x) $，由 $ {1, x, \dots, x^n, \dots} $，利用逐个正交化手续，可构造<strong>正交多项式</strong>序列：<br>$$<br>P_0(x) &#x3D; 1, \quad P_n(x) &#x3D; x^n - \sum_{j&#x3D;0}^{n-1} \frac{(x^n, P_j)}{(P_j, P_j)} P_j(x), \quad n &#x3D; 1, 2, \dots. \quad (2.3)<br>$$</p>
<h3 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h3><ol>
<li><p><strong>首项系数为1</strong>：<br>$ P_n(x) $ 的首项系数为 1。  </p>
</li>
<li><p><strong>表示性</strong>：<br>任意 $ Q_n(x) \in H_n $ 均可表示为 $ P_0(x), P_1(x), \dots, P_n(x) $ 的线性组合。  </p>
</li>
<li><p><strong>正交性</strong>：<br>当 $ i \neq j $ 时，$ (P_i, P_j) &#x3D; 0 $，且 $ P_n(x) $ 与任意次数小于 $ n $ 的多项式正交。 </p>
<hr>
<p><strong>递推关系</strong></p>
<p>  设 ${\varphi_n(x)}_{0}^{\infty}$ 是 $[a, b]$ 上带权 $\rho(x)$ 的正交多项式，对 $n \geq 0$ 成立递推关系</p>
<p>$$<br>\varphi_{n+1}(x) &#x3D; (x - \alpha_n) \varphi_n(x) - \beta_n \varphi_{n-1}(x), \quad n &#x3D; 0, 1, \dots<br>$$<br>其中<br>$$<br>\varphi_0(x) &#x3D; 1, \quad \varphi_{-1}(x) &#x3D; 0,<br>$$</p>
<p>$$<br>\alpha_n &#x3D; \frac{(x \varphi_n, \varphi_n)}{(\varphi_n, \varphi_n)}, \quad n &#x3D; 0, 1, \dots,<br>$$</p>
<p>$$<br>\beta_n &#x3D; \frac{(\varphi_n, \varphi_{n})}{(\varphi_{n-1}, \varphi_{n-1})}, \quad n &#x3D; 1, 2, \dots,<br>$$</p>
<p><strong>零点性质</strong>：<br>  设 ${ \varphi_n(x) }^{\infty}_0$ 是 $[a, b]$ 上带权 $\rho(x)$ 的正交多项式，则 $\varphi_n(x)$（$n \geq 1$）在区间 $(a, b)$ 内有 $n$ 个不同的零点。<u>（零点都是实的、单重的）</u></p>
</li>
</ol>
<h2 id="勒让德（Legendre）多项式"><a href="#勒让德（Legendre）多项式" class="headerlink" title="勒让德（Legendre）多项式"></a>勒让德（Legendre）多项式</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>勒让德多项式由 <strong>Rodrigues公式</strong> 定义：<br>$$<br>P_n(x) &#x3D; \frac{1}{2^n n!} \frac{d^n}{dx^n}(x^2-1)^n<br>$$</p>
<p>最高项系数为1的勒让德多项式为<br>$$<br>\widetilde{P}_n(x) &#x3D; \frac{n!}{(2n)!} \cdot \frac{d^n}{dx^n}  (x^2 - 1)^n<br>$$</p>
<ul>
<li>$ P_0(x) &#x3D; 1 $</li>
<li>$ P_1(x) &#x3D; x $</li>
<li>$ P_2(x) &#x3D; \frac{1}{2}(3x^2 - 1)$</li>
<li>$P3(x)&#x3D;\frac{1}{2}(5x^3 - 3x)$</li>
</ul>
<hr>
<h3 id="重要性质"><a href="#重要性质" class="headerlink" title="重要性质"></a>重要性质</h3><h4 id="性质1：正交性"><a href="#性质1：正交性" class="headerlink" title="性质1：正交性"></a>性质1：正交性</h4><p>在区间 $[-1, 1]$ 上满足正交性：<br>$$<br>\int_{-1}^1 P_n(x) P_m(x) , dx &#x3D;<br>\begin{cases}<br>0, &amp; m \neq n \<br>\frac{2}{2n+1}, &amp; m &#x3D; n<br>\end{cases}<br>$$</p>
<h4 id="性质2：奇偶性"><a href="#性质2：奇偶性" class="headerlink" title="性质2：奇偶性"></a>性质2：奇偶性</h4><p>满足奇偶对称性：<br>$$<br>P_n(-x) &#x3D; (-1)^n P_n(x)<br>$$</p>
<h4 id="性质3：最小平方误差"><a href="#性质3：最小平方误差" class="headerlink" title="性质3：最小平方误差"></a>性质3：最小平方误差</h4><p>在所有<strong>最高项系数为1的n次多项式</strong>中，勒让德多项式 $ P_n(x) $ 在 $[-1, 1]$ 上与零的平方误差最小。</p>
<h4 id="性质4：实零点"><a href="#性质4：实零点" class="headerlink" title="性质4：实零点"></a>性质4：实零点</h4><p>$ P_n(x) $ 在区间 $[-1, 1]$ 内有 $ n $ 个不同的实零点（可用反证法证明）。</p>
<h4 id="性质5：递推关系"><a href="#性质5：递推关系" class="headerlink" title="性质5：递推关系"></a>性质5：递推关系</h4><p>当 $ n \geq 1 $ 时，满足递推公式：<br>$$<br>(n+1)P_{n+1}(x) &#x3D; (2n+1)xP_n(x) - nP_{n-1}(x)<br>$$</p>
<h2 id="切比雪夫Chebyshev多项式"><a href="#切比雪夫Chebyshev多项式" class="headerlink" title="切比雪夫Chebyshev多项式"></a>切比雪夫Chebyshev多项式</h2><p>当区间为 $[-1, 1]$，权函数 $\rho(x) &#x3D; \dfrac{1}{\sqrt{1 - x^2}}$ 时，由序列 ${1, x, \cdots, x^n, \cdots}$ 正交化得到的正交多项式就是 Chebyshev 多项式，它可表为：</p>
<p>$$<br>T_n(x) &#x3D; \cos(n \arccos x) \quad |x| \leq 1<br>$$<br>若令 $x &#x3D; \cos\theta$，则 $T_n(x) &#x3D; \cos n\theta$，$0 \leq \theta \leq \pi$。</p>
<h3 id="Chebyshev-多项式重要性质"><a href="#Chebyshev-多项式重要性质" class="headerlink" title="Chebyshev 多项式重要性质"></a>Chebyshev 多项式重要性质</h3><p><strong>性质 1</strong>  </p>
<p>Chebyshev 多项式 ${T_n(x)}$ 在区间 $[-1, 1]$ 上带权 $\rho(x) &#x3D; \dfrac{1}{\sqrt{1 - x^2}}$ 正交，且：</p>
<span>
$$
\int_{-1}^{1} \dfrac{T_n(x)T_m(x)}{\sqrt{1 - x^2}} \, dx = 
\begin{cases} 
0, & n \neq m \\
\dfrac{\pi}{2}, & n = m \neq 0 \\
\pi, & n = m = 0 
\end{cases}
$$

</span>

<p><strong>性质 2 递推关系</strong>  </p>
<span>
$$
\begin{cases}
T_{n+1}(x) = 2xT_n(x) - T_{n-1}(x) & (n = 1, 2, \cdots), \\
T_0(x) = 1, \\
T_1(x) = x.
\end{cases}
$$

</span>

<p>由递推关系可得：</p>
<span>
$$
T_0(x)= 1 \quad \\
T_1(x)= x \quad  \\
T_2(x)= 2x^2 - 1 \quad \\
T_3(x)= 4x^3 - 3x \quad \\
T_4(x) = 8x^4 - 8x^2 + 1 \quad \\
T_5(x) = 16x^5 - 20x^3 + 5x
$$

</span>

<p><strong>性质 3</strong>  </p>
<p>$T_{2k}(x)$ 只含 $x$ 的偶次方，$T_{2k+1}(x)$ 只含 $x$ 的奇次方，这一性质由递推关系可直接得到。</p>
<p><strong>性质 4</strong>  </p>
<p>$T_n(x)$ 在区间 $[-1, 1]$ 上有 $n$ 个零点：</p>
<p>$$x_k &#x3D; \cos \dfrac{2k + 1}{2n}\pi, \quad k &#x3D; 0, 1, \cdots, n - 1$$</p>
<p><strong>性质5</strong></p>
<p>$T_n(x)$的首项$x^n$的系数为$2^{n-1}(n&#x3D;1,2…)$</p>
<h2 id="最小二乘拟合"><a href="#最小二乘拟合" class="headerlink" title="最小二乘拟合"></a>最小二乘拟合</h2><p>对于给定的数据 $(x_i, y_i)$（$i&#x3D;1,2,\ldots,N$），选取线性无关的函数族 $\varphi_0, \varphi_1, \ldots, \varphi_m$ 及权函数 $\omega(x)$，要求在函数类 $\Phi &#x3D; \text{Span}{\varphi_0, \varphi_1, \ldots, \varphi_m}$ 中寻找一个函数</p>
<p>$$<br>\varphi^* (x) &#x3D; a_0^*  \varphi_0 + a_1^*  \varphi_1 + \cdots + a_m^*  \varphi_m \quad （m &lt; N）<br>$$</p>
<p>使</p>
<p>$$<br>I &#x3D; \sum_{i&#x3D;1}^N \omega(x_i) [y_i - \varphi(x_i)]^2<br>$$</p>
<p>达到极小。显然上式是 $m+1$ 个变量 $a_0, a_1, \ldots, a_m$ 的二次函数：</p>
<p>$$<br>I(a_0, a_1, \ldots, a_m) &#x3D; \sum_{i&#x3D;1}^N \omega(x_i) \left[ y_i - \sum_{k&#x3D;0}^m a_k \varphi_k(x_i) \right]^2<br>$$</p>
<p>根据多元函数极值条件<br>$$<br>\frac{1}{2} \frac{\partial I}{\partial a_j} &#x3D; \sum_{i&#x3D;1}^N \omega(x_i) \varphi_j(x_i) \left[ y_i - \sum_{k&#x3D;0}^m a_k \varphi_k(x_i) \right] &#x3D; 0 \quad （j&#x3D;0,1,\ldots,m）<br>$$</p>
<blockquote>
<p><strong>引入内积：</strong></p>
<span>
$$
(f, g) = 
\begin{cases} 
\sum ^{N} _{i=1} \omega(x_i) f(x_i) g(x_i) & \text{离散型} \\
\int_{a}^{b} \rho(x) f(x) g(x) \, dx & \text{连续型}
\end{cases}
$$

</span></blockquote>
<p>方程组：</p>
<p>$$<br>\sum_{i&#x3D;1}^{N} \omega(x_i) \left[ y_i - \sum_{k&#x3D;0}^{m} a_k \varphi_k(x_i) \right] \varphi_j(x_i) &#x3D; 0 \quad (j &#x3D; 0, 1, \ldots, m)<br>$$</p>
<p>可以表示为：</p>
<p>$$<br>a_0 (\varphi_j, \varphi_0) + a_1 (\varphi_j, \varphi_1) + \cdots + a_m (\varphi_j, \varphi_m) &#x3D; (\varphi_j, y)  \quad (j &#x3D; 0, 1, \ldots, m)<br>$$</p>
<p>这个方程组称为<strong>法方程</strong>或<strong>正规方程组</strong>。若用 ${\varphi_0, \varphi_1, \ldots, \varphi_m}$ 构成一个 $N \times (m+1)$ 的矩阵 $A$，即：</p>
<span>
$$
A = 
\begin{bmatrix}
\varphi_0(x_1) & \varphi_1(x_1) & \cdots & \varphi_m(x_1) \\
\varphi_0(x_2) & \varphi_1(x_2) & \cdots & \varphi_m(x_2) \\
\vdots & \vdots & \ddots & \vdots \\
\varphi_0(x_N) & \varphi_1(x_N) & \cdots & \varphi_m(x_N)
\end{bmatrix}
$$

</span>

<p>引入向量：</p>
<p>$$<br>\alpha &#x3D; (a_0, a_1, \ldots, a_m)^T, \quad Y &#x3D; (y_1, y_2, \ldots, y_N)^T<br>$$</p>
<p>法方程组可以写成以下矩阵形式：(权w&#x3D;1)</p>
<p>$$<br>A^T A \alpha &#x3D; A^T Y<br>$$</p>
<p>由于 $\varphi_0, \varphi_1, \ldots, \varphi_m$ 线性无关，法方程组存在唯一解：</p>
<p>$$<br>\alpha &#x3D; (a_0^* , a_1^* , \ldots, a_m^* )^T<br>$$</p>
<p>从而得到函数：</p>
<p>$$<br>\varphi^* (x) &#x3D; a_0^*  \varphi_0 + a_1^*  \varphi_1 + \cdots + a_m^*  \varphi_m<br>$$</p>
<p>最小平方误差为：</p>
<p>$$<br>\delta^2 &#x3D; || y - \varphi^*  ||^2_2 &#x3D; (y - \varphi^* , y - \varphi^* ) &#x3D; || y ||^2_2 - \sum_{j&#x3D;0}^m a_j^*  (\varphi_j, y)<br>$$</p>
<h3 id="代数多项式拟合"><a href="#代数多项式拟合" class="headerlink" title="代数多项式拟合"></a>代数多项式拟合</h3><p>若取基函数 $\varphi_0 &#x3D; 1, \varphi_1 &#x3D; x, \ldots, \varphi_m &#x3D; x^m$，则相应的法方程组为：</p>
<span>
$$
\begin{bmatrix}
\sum_{i=1}^{N} \omega_i & \sum_{i=1}^{N} \omega_i x_i & \cdots & \sum_{i=1}^{N} \omega_i x_i^m \\
\sum_{i=1}^{N} \omega_i x_i & \sum_{i=1}^{N} \omega_i x_i^2 & \cdots & \sum_{i=1}^{N} \omega_i x_i^{m+1} \\
\vdots & \vdots & \ddots & \vdots \\
\sum_{i=1}^{N} \omega_i x_i^m & \sum_{i=1}^{N} \omega_i x_i^{m+1} & \cdots & \sum_{i=1}^{N} \omega_i x_i^{2m}
\end{bmatrix}
\begin{bmatrix}
a_0 \\
a_1 \\
\vdots \\
a_m
\end{bmatrix}
=
\begin{bmatrix}
\sum_{i=1}^{N} \omega_i y_i \\
\sum_{i=1}^{N} \omega_i x_i y_i \\
\vdots \\
\sum_{i=1}^{N} \omega_i x_i^m y_i
\end{bmatrix}
$$

</span>

<p>即<br>$$<br>A^T\omega A\alpha&#x3D;A^T\omega Y<br>$$<br><span><br>$$<br>A &#x3D;<br>\begin{bmatrix}<br>1 &amp; x_1 &amp; \cdots &amp; x_1^m \<br>1 &amp; x_2 &amp; \cdots &amp; x_2^m  \<br>1 &amp; x_3 &amp; \cdots &amp; x_3^m  \<br>\vdots &amp; \vdots &amp; \ddots &amp; \vdots \<br>1 &amp; x_N &amp; \cdots &amp; x_N^m<br>\end{bmatrix}<br>$$</p>
</span>   
$$
\omega =\begin{bmatrix}
\omega_1& &  &  \\
 & \omega _2 &  &   \\
 &  & \omega_3 &   \\
 &  &  & \ddots \\
 &  &  &  & \omega _n
\end{bmatrix}
$$


<p>求出法方程组的解 $a_0, a_1, \ldots, a_m$，即可得到拟合多项式：<br>$$<br>\varphi(x) &#x3D; a_0 + a_1 x + \cdots + a_m x^m<br>$$<br><span style="color:#FF0000">PS:当$n\geq3$时候，求解法方程时将出现系数矩阵为病态的问题</span></p>
<h3 id="例题-2"><a href="#例题-2" class="headerlink" title="例题"></a>例题</h3><blockquote>
<p>已知函数值表（见表3-1），试用二次多项式 $y &#x3D; c_{0} + c_{1}x + c_{2}x^{2}$ 按最小二乘原理拟合这组数据。  </p>
<p>表3-1  </p>
<table>
<thead>
<tr>
<th>$x$</th>
<th>$-2$</th>
<th>$-1$</th>
<th>$0$</th>
<th>$1$</th>
<th>$2$</th>
</tr>
</thead>
<tbody><tr>
<td>$y$</td>
<td>$0$</td>
<td>$1$</td>
<td>$2$</td>
<td>$1$</td>
<td>$0$</td>
</tr>
</tbody></table>
<p><strong>解</strong>：  </p>
<p>系数矩阵为</p>
<span>
$$
A = 
\begin{bmatrix}
1 & -2 & 4 \\
1 & -1 & 1  \\
1 & 0 & 0  \\
1& 1 & 1 \\
1 & 2 & 4
\end{bmatrix}
$$

</span>

<p>计算$A^TA$与$A^Ty$为</p>
<p>步骤略</p>
<p>解方程组$A^T A \alpha &#x3D; A^T y$</p>
<span>
$$
\begin{cases}
5c_0 + 10c_2 = 4 \\  
10c_1 = 0  \\  
10c_0 + 34c_2 = 2  
\end{cases}
$$

</span>
$$
c_0 = \frac{58}{35}, \quad c_1=0, \quad c_2 = -\frac{3}{7}.
$$

<ul>
<li><strong>最终拟合多项式</strong>：<br>$$<br>y &#x3D; \frac{58}{35} - \frac{3}{7}x^2<br>$$</li>
</ul>
</blockquote>
<blockquote>
<p>已知实测数据表：</p>
<table>
<thead>
<tr>
<th>$x_i$</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
</tr>
</thead>
<tbody><tr>
<td>$y_i$</td>
<td>4</td>
<td>4.5</td>
<td>6</td>
<td>8</td>
<td>8.5</td>
</tr>
<tr>
<td>$\omega_i$</td>
<td>2</td>
<td>1</td>
<td>3</td>
<td>1</td>
<td>1</td>
</tr>
</tbody></table>
<p>试用最小二乘法求多项式曲线与此数据组拟合。</p>
<p><strong>解</strong>（线性拟合版本）：  </p>
<ol>
<li><strong>构造加权设计矩阵</strong>：<br> 设一次多项式为 $y &#x3D; c_0 + c_1x$，设计矩阵和权重矩阵为：</li>
</ol>
<span>
$$
A = 
\begin{bmatrix}
1 & 1 \\
1 & 2 \\
1 & 3 \\
1 & 4 \\
1 & 5
\end{bmatrix}, \quad
W = 
\begin{bmatrix}
2 & 0 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 & 0 \\
0 & 0 & 3 & 0 & 0 \\
0 & 0 & 0 & 1 & 0 \\
0 & 0 & 0 & 0 & 1
\end{bmatrix}
$$

</span>

<ol start="2">
<li><p>计算$A^T\omega A$与$A^T\omega y$</p>
</li>
<li><p><strong>计算正规方程</strong>：<br>方程组 $A^T \omega  A C &#x3D; A^T \omega  Y$ 展开为：</p>
</li>
</ol>
<span>

<p>$$<br>\begin{cases}<br>8c_0 + 22c_1 &#x3D; 47 \<br>22c_0 + 74c_1 &#x3D; 145.5<br>\end{cases}<br>$$<br></span></p>
<ol start="4">
<li><strong>解方程</strong>：</li>
</ol>
<ul>
<li>消元得：<br>$$<br>c_0 &#x3D; 2.5648 \quad c_1&#x3D;1.2037<br>$$</li>
<li><strong>最终拟合多项式</strong>：<br>$$<br>y &#x3D; 2.5648 + 1.2037x<br>$$</li>
</ul>
</blockquote>
<blockquote>
<p>已知实测数据</p>
<table>
<thead>
<tr>
<th>$x_i$</th>
<th>1.00</th>
<th>1.25</th>
<th>1.50</th>
<th>1.75</th>
<th>2.00</th>
</tr>
</thead>
<tbody><tr>
<td>$y_i$</td>
<td>5.10</td>
<td>5.79</td>
<td>6.53</td>
<td>7.45</td>
<td>8.46</td>
</tr>
<tr>
<td>$ln y_i$</td>
<td>1.625</td>
<td>1.756</td>
<td>1.876</td>
<td>2.008</td>
<td>2.135</td>
</tr>
</tbody></table>
<p>试求它的最小二乘拟合</p>
<p><strong>解</strong></p>
<ol>
<li>模型设定:</li>
</ol>
<p>设 $y&#x3D;ae^{bx}$，取对数得 $z&#x3D;\ln y&#x3D;c_{0}+c_{1}x$（$c_{0}&#x3D;\ln a,c_{1}&#x3D;b$）。</p>
<ol start="2">
<li>构造矩阵:</li>
</ol>
<p>设计矩阵 $A$:</p>
<span>
$$
A = 
\begin{bmatrix}
1 & 1.00 \\
1 & 1.25 \\
1 & 1.50 \\
1 & 1.75 \\
1 & 2.00
\end{bmatrix}
$$
</span>

<p>观测向量 $Y$:</p>
<span>
$$
Y = 
\begin{bmatrix}
1.625\\
1.756\\
1.876\\
2.008\\
2.135
\end{bmatrix}
$$
</span>

<ol start="3">
<li>计算正规方程组系数:</li>
</ol>
<span>
$$
 A^{T}A=\begin{bmatrix}5&7.5\\7.5&11.875\end{bmatrix} 
$$
</span>

<p>计算</p>
<span>

<p>$$<br>A^{T}Y&#x3D;<br>\begin{bmatrix}<br>9.40\<br>14.418<br>\end{bmatrix}<br>$$</p>
</span>

<ol start="4">
<li>解正规方程组：</li>
</ol>
<span>

<p>$$<br>5c_{0}+7.5c_{1}&#x3D;9.40\<br>7.5c_{0}+11.875c_{1}&#x3D;14.418<br>$$<br></span></p>
<p>解得 $c_{1}&#x3D;0.5088,c_{0}&#x3D;1.1168$。</p>
<ol start="5">
<li>还原参数：</li>
</ol>
<p>$$ a&#x3D;e^{1.1168}\approx 3.055,b&#x3D;0.5088. $$</p>
<p>拟合曲线</p>
<p>$$ y&#x3D;3.055e^{0.5088x} $$</p>
</blockquote>
<blockquote>
<p><img src="/blog/image/Snipaste_2025-06-01_15-11-04.png"></p>
<p><img src="/blog/image/cvnbsiuev.jpg"></p>
</blockquote>
<blockquote>
<p><img src="/blog/image/Snipaste_2025-06-01_15-47-00.png"></p>
<p><img src="/blog/image/nvid.jpg"></p>
</blockquote>
<h3 id="用正交多项式拟合"><a href="#用正交多项式拟合" class="headerlink" title="用正交多项式拟合"></a>用正交多项式拟合</h3><p>用最小二乘法得到的法方程，其系数矩阵 $G$ 是病态的。但如果 $\varphi_0(x), \varphi_1(x), \ldots, \varphi_n(x)$ 是关于点集 ${x_i}$（$i &#x3D; 0, 1, \ldots, m$）带权 $\omega(x_i)$（$i &#x3D; 0, 1, \ldots, m$）正交的函数族，即：</p>
<p>$$<br>(\varphi_j, \varphi_k) &#x3D; \sum_{i&#x3D;0}^{m} \omega(x_i) \varphi_j(x_i) \varphi_k(x_i) &#x3D;<br>\begin{cases}<br>0, &amp; j \neq k, \<br>A_k &gt; 0, &amp; j &#x3D; k<br>\end{cases}<br>$$</p>
<p><span style="color:#FF0000"> $a_k^* $ 的表达式为：</span><br>$$<br>a_k^*  &#x3D; \frac{(f, \varphi_k)}{(\varphi_k, \varphi_k)} &#x3D; \frac{\sum_{i&#x3D;0}^{m} \omega(x_i) f(x_i) \varphi_k(x_i)}{\sum_{i&#x3D;0}^{m} \omega(x_i) \varphi_k^2(x_i)}, \quad k &#x3D; 0, 1, \ldots, n<br>$$</p>
<p><span style="color:#FF0000"> 平方误差的表达式为：</span></p>
<span>
$$
\| \delta \|_2^2 = \| f \|_2^2 - \sum_{k=0}^{n} A_k (a_k^* )^2
$$

</span>

<h3 id="正交多项式构造"><a href="#正交多项式构造" class="headerlink" title="正交多项式构造"></a>正交多项式构造</h3><p>根据给定节点 $x_0, x_1, \ldots, x_m$ 及权函数 $\omega(x) &gt; 0$，构造带权正交多项式 ${P_n(x)}$，其中 $n \leq m$，并用递推公式表示 $P_k(x)$。</p>
<p>定义首项系数为 1 的多项式 $P_k(x)$：</p>
<p>$$<br>P_0(x) &#x3D; 1 \<br>P_1(x) &#x3D; (x - \alpha_1)P_0(x) \<br>P_{k+1}(x) &#x3D; (x - \alpha_{k+1}) P_k(x) - \beta_k P_{k-1}(x) \quad k &#x3D; 1, 2, \ldots，n-1<br>$$</p>
<p>根据 $P_k(x)$ 的正交性，得：</p>
<p>$$<br>\alpha_{k+1} &#x3D; \frac{(x P_k, P_k)}{(P_k, P_k)}, \quad k &#x3D; 0, 1, \ldots, n-1<br>$$</p>
<p>$$<br>\beta_k &#x3D; \frac{(P_k, P_k)}{(P_{k-1}, P_{k-1})}, \quad k &#x3D; 1, 2, \ldots, n-1<br>$$</p>
<p>逐步把 $a_k^* P_k(x)$ 累加到 $S(x)$ 中去，最后就可得到所求的拟合曲线</p>
<p>$$<br>y &#x3D; S(x) &#x3D; a_0^* P_0(x) + a_1^* P_1(x) + \cdots + a_n^* P_n(x).<br>$$</p>
<h2 id="最佳一致逼近多项式"><a href="#最佳一致逼近多项式" class="headerlink" title="最佳一致逼近多项式"></a>最佳一致逼近多项式</h2><h3 id="最佳平方逼近"><a href="#最佳平方逼近" class="headerlink" title="最佳平方逼近"></a>最佳平方逼近</h3><p><strong>最佳平方逼近</strong>，即连续型 L-S 逼近，在 $||f||_2 &#x3D; \sqrt{(f, f)}$ 意义下，使得 $||P - y||_2$ 最小。</p>
<h3 id="最佳一致逼近"><a href="#最佳一致逼近" class="headerlink" title="最佳一致逼近"></a>最佳一致逼近</h3><p><strong>最佳一致逼近</strong>（Uniform Approximation），在 $||f||_ \infty &#x3D; \max_{x \in [a, b]} |f(x)|$ 意义下，使得 $||P - y||_\infty$ 最小，也称为 <strong>minimax problem</strong>。</p>
<h3 id="偏差"><a href="#偏差" class="headerlink" title="偏差"></a>偏差</h3><p>设 $ f \in C[a, b] $，$ p_n \in H_n &#x3D; \text{span}{1, x, \cdots, x^n} $，称</p>
<p>$$<br>\Delta(f, p_n) &#x3D; ||f - p_n||_ \infty &#x3D; \max_{a \leq x \leq b} |f(x) - p_n(x)|<br>$$</p>
<p>为 $ p_n $ 与 $ f $ 的<strong>偏差</strong>。</p>
<h3 id="偏差点"><a href="#偏差点" class="headerlink" title="偏差点"></a>偏差点</h3><p>设 $ f \in C[a, b] $，$ p \in H_n $，若存在 $ x_0 \in [a, b] $ 使得</p>
<p>$$<br>|f(x_0) - p(x_0)| &#x3D; \Delta(f, p) &#x3D; \max_{a \leq x \leq b} |f(x) - p(x)| &#x3D; \mu,<br>$$</p>
<p>则称 $ x_0 $ 是 $ p $ 关于 $ f $ 的<strong>偏差点</strong>。</p>
<ul>
<li>若 $ p(x_0) - f(x_0) &#x3D; \mu $，则称 $ x_0 $ 为<strong>正偏差点</strong>；</li>
<li>若 $ p(x_0) - f(x_0) &#x3D; -\mu $，则称 $ x_0 $ 为<strong>负偏差点</strong>。。</li>
</ul>
<h3 id="最小偏差"><a href="#最小偏差" class="headerlink" title="最小偏差"></a>最小偏差</h3><p>若</p>
<p>$$<br>E_n &#x3D; \inf_{p_n \in H_n} \Delta(f, p_n) &#x3D; \min_{p_n \in H_n} \Delta(f, p_n)<br>$$</p>
<p>则称 $ E_n $ 为 $ p_n $ 与 $ f $ 的 <strong>最小偏差</strong>。</p>
<h3 id="最佳一致逼近多项式-1"><a href="#最佳一致逼近多项式-1" class="headerlink" title="最佳一致逼近多项式"></a>最佳一致逼近多项式</h3><p>设 $ f \in C[a, b] $，若存在 $ p_n^* \in H_n $，使<br>$$<br>\Delta(f, p_n^*) &#x3D; E_n &#x3D; \min_{p_n \in H_n} \Delta(f, p_n)<br>$$</p>
<p>则称 $ p_n^* $ 为 $ f $ 在 $[a, b]$ 上的<strong>最佳一致逼近多项式</strong>，简称<strong>最佳逼近多项式</strong>。</p>
<blockquote>
<p><strong>定理：</strong></p>
<p>若 $ p^* (x) \in H_n $ 是 $ f(x) \in C[a, b] $ 的最佳逼近多项式，</p>
<p>则 $ p^*(x) $ 同时存在正、负偏差点。</p>
<p><strong>定理：</strong></p>
<p>若 $ f \in C[a, b] $，则存在 $ p_n^* \in H_n $，使得</p>
<p>$$<br>\Delta(f, p_n^*) &#x3D; E_n &#x3D; \min_{p_n \in H_n} \Delta(f, p_n)<br>$$<br>成立</p>
<p><strong>定理：</strong></p>
<p>$ p_n \in H_n $ 是 $ f \in C[a, b] $ 的最佳逼近多项式的充分必要条件是，在 $[a, b]$ 上至少有 <strong>$ n + 2 $</strong> 个轮流为正负的偏差点，即至少有 $ n + 2 $ 个点 $ a \leq x_1 &lt; x_2 &lt; \dots &lt; x_{n+2} \leq b $，使得</p>
<span>
$$
p_n^*(x_k) - f(x_k) = (-1)^k \sigma || f - p_n^* ||_\infty, \quad \sigma = \pm 1, \quad k = 1, 2, \cdots, n+2
$$

</span>

<p>上述点 ${x_k}_{1}^{n+2}$ 称为 <strong>Chebyshev 交错点组</strong>。</p>
<p><strong>推论1（唯一性定理）：</strong></p>
<p>设 $ f \in C[a, b] $，则在 $ H_n $ 中的最佳逼近多项式是唯一的。</p>
<p><strong>推论 2</strong>：</p>
<p>若 $ f \in C[a, b] $，则其最佳逼近多项式 $ p_n^*(x) \in H_n $ 是 $ f $ 的一个 <strong>Lagrange 插值多项式</strong>。</p>
</blockquote>
<h3 id="最佳一次一致逼近多项式的求法"><a href="#最佳一次一致逼近多项式的求法" class="headerlink" title="最佳一次一致逼近多项式的求法"></a>最佳一次一致逼近多项式的求法</h3><blockquote>
<p><strong>推导过程</strong></p>
<p>$ n &#x3D; 1 $ 时求 $ p_1(x) &#x3D; a_0 + a_1 x $ 的方法</p>
<p>设 $ f \in C^2[a, b] $ 且 $ f’’ $ 在 $[a, b]$ 上不变号，由上面的定理可知，存在点<br>$$<br>a \leq x_1 &lt; x_2 &lt; x_3 \leq b,<br>$$</p>
<p>使得</p>
<p>$$<br>p_1(x_k) - f(x_k) &#x3D; (-1)^k \sigma E_n, \quad k &#x3D; 1, 2, 3; \quad \sigma &#x3D; \pm 1.<br>$$</p>
<p>由于 $ f’’ $不变号，故 $ f’ $ 在 $[a, b]$ 上单调，于是 $ f’(x) - p_1’(x) &#x3D; f’(x) - a_1&#x3D;0 $ 只有一个根 $ x_2 $。因此，$ p_1 $ 对 $ f $ 的另两个偏差点只能在 $[a, b]$ 的端点，故有</p>
<p>$$<br>x_1 &#x3D; a, \quad x_3 &#x3D; b.<br>$$</p>
<p>由此可得</p>
<p>$$<br>p_1(a) - f(a) &#x3D; -\left[ p_1(x_2) - f(x_2) \right] &#x3D; p_1(b) - f(b),<br>$$</p>
<p>或</p>
<p>$$<br>a_0 + a_1 a - f(a) &#x3D; a_0 + a_1 b - f(b)<br>$$</p>
<p>$$<br>a_0 + a_1 a - f(a) &#x3D; -\left[ a_0 + a_1 x_2 - f(x_2) \right]<br>$$</p>
<p>通过上面两个公式可得<span style="color:#FF0000">（记住下面3个公式）</span></p>
<p>$$<br>a_1 &#x3D; \frac{f(b) - f(a)}{b - a}<br>$$</p>
<p>$$<br>a_0 &#x3D; \frac{1}{2} \left[ f(a) + f(x_2) \right] - \frac{a+x_2}{2} a_1\<br>f’(x_2) &#x3D; a_1<br>$$</p>
<p>由此得 $ f $ 在 $[a, b]$ 上的最佳一次逼近多项式</p>
<p>$$<br>p_1(x) &#x3D; a_0 + a_1 x.<br>$$</p>
</blockquote>
<h3 id="例题-3"><a href="#例题-3" class="headerlink" title="例题"></a>例题</h3><blockquote>
<p>求函数 $ f(x) &#x3D; \sqrt{x} $ 在区间 $[\frac{1}{4}, 1]$ 上的最佳一次一致逼近多项式。</p>
<ol>
<li>确定二阶导数不变号</li>
</ol>
<p>函数 $ f(x) &#x3D; \sqrt{x} $ 的二阶导数为：</p>
<p>$$<br>f’’(x) &#x3D; -\frac{1}{4} x^{-\frac{3}{2}}<br>$$</p>
<p>在区间 $\left(\frac{1}{4}, 1\right)$ 上，$ f’’(x) $ 不变号。</p>
<ol start="2">
<li>计算多项式系数</li>
</ol>
<p>根据最佳一次逼近多项式的性质，设 $ p_1(x) &#x3D; a_0 + a_1 x $</p>
<p>$$<br>a_1&#x3D;\frac {f(1)-f(\frac{1}{4})}{1-\frac{1}{4}}&#x3D;\frac{2}{3} \quad \<br>f’(x_2) &#x3D; \frac{1}{2\sqrt{x_2}} &#x3D; a_1 \quad \<br>x_2&#x3D;\frac{9}{16} \quad \<br>a_0 &#x3D; \frac{1}{2} \left[ f(a) + f(x_2) \right] - \frac{a+x_2}{2} \frac{f(b) - f(a)}{b - a}&#x3D;\frac{17}{48}<br>$$</p>
<p>最佳一次逼近多项式为：<br>$$<br>p_1(x) &#x3D; \frac{17}{48} + \frac{2}{3} x<br>$$</p>
<p>在区间 $\left[\frac{1}{4}, 1\right]$ 上，最大误差为：<br>$$<br>\max_{\frac{1}{4} \leq x \leq 1} \left| \sqrt{x} - p_1(x) \right| &#x3D; \frac{1}{48}<br>$$</p>
<hr>
<p>求函数 $f(x) &#x3D; \sqrt{1 + x^2}$ 在 $[0,1]$ 上的一次最佳一致逼近多项式，并求其偏差。</p>
<p><strong>解题过程</strong><br>因 $f’(x) &#x3D; x &#x2F; \sqrt{1 + x^2}$，$f’’(x) &#x3D; 1 &#x2F; (1 + x^2)^{3&#x2F;2}$，所以在 $[0, 1]$ 上 $f’’(x)$ 恒为正，</p>
<p>故由公式 $|| f - P_n^*  || _{\infty} &#x3D; \min || f - P_n || _{\infty}$ 知：</p>
<p>$$<br>a_1 &#x3D; \frac{f(1) - f(0)}{1 - 0} &#x3D; \sqrt{2} - 1 \approx 0.4142<br>$$</p>
<p>由 $f’(x_2) &#x3D; x_2 &#x2F; \sqrt{1 + x_2^2} &#x3D; \sqrt{2} - 1$，得：</p>
<p>$$<br>x_2 &#x3D; \left( \frac{\sqrt{2} - 1}{2} \right)^{1&#x2F;2} \approx 0.4551<br>$$</p>
<p>且：</p>
<p>$$<br>f(x_2) &#x3D; \sqrt{1 + x_2^2} \approx 1.0986<br>$$</p>
<p>所以：</p>
<p>$$<br>a_0 &#x3D; \frac{1}{2} \left[ f(0) + f(x_2) \right] - a_1 \cdot \frac{0 + x_2}{2} \approx 0.955<br>$$</p>
<p>于是得到 $f(x) &#x3D; \sqrt{1 + x^2}$ 在 $[0,1]$ 上一次最佳一致逼近多项式：</p>
<p>$$<br>P_1(x) &#x3D; 0.955 + 0.4142x<br>$$</p>
<p>又因区间端点必属于 Chebyshev 交错点组，故：</p>
<p>$$<br>\Delta(f, P_1) &#x3D; \max_{0 \leq x \leq 1} |f(x) - P_1| &#x3D; |f(0) - P_1(0)| &#x3D; |1 - 0.955| &#x3D; 0.045<br>$$</p>
</blockquote>
<blockquote>
<p><img src="/blog/image/Snipaste_2025-06-01_09-28-07.png"></p>
</blockquote>
<blockquote>
<p><img src="/blog/image/Snipaste_2025-06-01_09-33-26.png"></p>
</blockquote>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>数值分析</tag>
      </tags>
  </entry>
  <entry>
    <title>数值分析-常微分方程数值解</title>
    <url>/blog/2025/04/23/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90-%E5%B8%B8%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B%E6%95%B0%E5%80%BC%E8%A7%A3/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>此部分包含常微分方程的数值解部分———————————————————————————————————————————————————————————–</p>
<h1 id="第五章-常微分方程数值解"><a href="#第五章-常微分方程数值解" class="headerlink" title="第五章 常微分方程数值解"></a>第五章 常微分方程数值解</h1><h2 id="记忆内容汇总"><a href="#记忆内容汇总" class="headerlink" title="记忆内容汇总"></a>记忆内容汇总</h2><blockquote>
<p><strong>欧拉法</strong><br>$$<br>y_{n+1} &#x3D; y_n + h f(x_n, y_n)<br>$$<br><strong>改进欧拉法</strong><br>$$<br>y_{n+1} &#x3D; y_n + \frac{h}{2} \left[ f(x_n, y_n) + f(x_{n+1}, y_n + h f(x_n, y_n)) \right]<br>$$</p>
<p><strong>四阶经典R-K方法</strong><br>$$<br>y_{n+1} &#x3D; y_n + \frac{h}{6} (K_1 + 2K_2 + 2K_3 + K_4)<br>$$</p>
<p>$$<br>K_1 &#x3D; f(x_n, y_n)<br>$$</p>
<p>$$<br>K_2 &#x3D; f(x_n + \frac{h}{2}, y_n + \frac{h}{2} K_1)<br>$$</p>
<p>$$<br>K_3 &#x3D; f(x_n + \frac{h}{2}, y_n + \frac{h}{2} K_2)<br>$$</p>
<p>$$<br>K_4 &#x3D; f(x_n + h, y_n + h K_3)<br>$$</p>
<p><strong>稳定区间</strong></p>
<ol>
<li>欧拉法</li>
</ol>
  <div>

<p>$$<br>  E(h\lambda)&#x3D;1+h\lambda \<br>  -2 &lt; \lambda h &lt; 0<br>$$</p>
  </div>

<ol start="2">
<li>改进欧拉法</li>
</ol>
  <div>

<p>$$<br>  E(h\lambda)&#x3D;1 + h\lambda + \frac{(h\lambda)^2}{2} \<br>  -2 &lt; h\lambda &lt; 0<br>$$</p>
  </div>

<ol start="3">
<li>4阶经典龙格库塔方法<br>$$<br>  E(h\lambda) &#x3D; 1 + h\lambda + \frac{(h\lambda)^2}{2!} + \frac{(h\lambda)^3}{3!} + \frac{(h\lambda)^4}{4!}.<br>$$</li>
</ol>
<p>$$<br>  -2.78 &lt; h\lambda &lt; 0<br>$$</p>
</blockquote>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>考虑一阶常微分方程的初值问题 &#x2F;* Initial-Value Problem *&#x2F;:</p>
<span>
$$
\begin{cases}
\frac{dy}{dx} = f(x, y), & x \in [a, b] \\
y(a) = y_0
\end{cases}
$$

</span>

<p>只要 $f(x, y)$ 在 $[a, b] \times \mathbb{R}^1$ 上连续，且关于 $y$ 满足 Lipschitz 条件，即存在与 $x, y$ 无关的常数 $L$ 使得<br>$$<br>|f(x, y_1) - f(x, y_2)| \leq L |y_1 - y_2|<br>$$</p>
<p>对任意定义在 $[a, b]$ 上的 $y_1(x)$ 和 $y_2(x)$ 都成立，则上述 IVP (一阶常微分方程的初值问题)存在唯一解。</p>
<ul>
<li>本章的任务：计算出解函数 $y(x)$ 在一系列节点 $a &#x3D; x_0 &lt; x_1 &lt; \dots &lt; x_n &#x3D; b$ 处的近似值。</li>
</ul>
<p>$$<br>y_n \approx y(x_n) \quad (n &#x3D; 1, \dots, N)<br>$$</p>
<h2 id="建立常微分方程数值方法的基本思想"><a href="#建立常微分方程数值方法的基本思想" class="headerlink" title="建立常微分方程数值方法的基本思想"></a>建立常微分方程数值方法的基本思想</h2><p>微分方程数值解法，其实是求出方程的解 $y(x)$ 在一系列离散点上的近似值。则微分方程数值解的基本思想是：求解区间和方程离散化。</p>
<h3 id="求解区间离散化"><a href="#求解区间离散化" class="headerlink" title="求解区间离散化"></a>求解区间离散化</h3><p>将求解区间 $[a, b]$ 离散化，是在 $[a, b]$ 上插入一系列的分点 ${x_k}$ 使得<br>$$<br>a &#x3D; x_0 &lt; x_1 &lt; \dots &lt; x_n &lt; \dots &lt; x_N &#x3D; b<br>$$</p>
<ul>
<li><p>记 $h_n &#x3D; x_{n+1} - x_n$ ($n &#x3D; 0, 1, \dots, N-1$) 称为步长，一般取 $h_n &#x3D; h$（常数）</p>
</li>
<li><p>节点为 $x_n &#x3D; x_0 + nh$ ($n &#x3D; 0, 1, 2, \dots, N$)</p>
</li>
<li><p>$h &#x3D; \frac{b - a}{N}$ 为等步长节点。</p>
</li>
</ul>
<hr>
<h3 id="微分方程离散化"><a href="#微分方程离散化" class="headerlink" title="微分方程离散化"></a>微分方程离散化</h3><p>将微分方程离散化，通常有以下几种方法：</p>
<ol>
<li><p><strong>差商逼近法</strong></p>
<p>即是用适当的差商逼近导数值。</p>
</li>
<li><p><strong>数值积分法</strong></p>
<p>基本思想是先将问题转化为积分类方程</p>
<p>$$<br>y(x_m) - y(x_n) &#x3D; \int_{x_n}^{x_m} f(x, y(x)) dx \quad (y(x_0) &#x3D; y_0)<br>$$</p>
<p>然后将式子右端采用第四章介绍的数值积分离散化，从而获得初值问题的一个离散差分格式。</p>
</li>
<li><p><strong>Taylor 展开法</strong></p>
</li>
</ol>
<blockquote>
<p><strong>例题</strong></p>
<p>用二阶 Taylor 展开法求初值问题<br>$$<br>\begin{cases}<br>y’ &#x3D; x^2 + y^2 \<br>y(1) &#x3D; 1<br>\end{cases}<br>$$</p>
<p>求其在 $x &#x3D; 1.5$ 时的近似值（取步长 $h &#x3D; 0.25$，小数点后至少保留 5 位）。</p>
<hr>
<p><strong>解题过程</strong><br>二阶 Taylor 展开公式为：<br>$$<br>y(x_{n+1}) &#x3D; y(x_n) + y’(x_n) h + \frac{y’’(x_n)}{2!} h^2 + O(h^3)<br>$$</p>
<p>已知：</p>
<p>$$<br>y’ &#x3D; x^2 + y^2,\quad y’’ &#x3D; 2x + 2y \cdot y’ &#x3D; 2x + 2y(x^2 + y^2)<br>$$</p>
<p>代入上式，并略去高阶项 $O(h^3)$，则求解公式为：</p>
<p>$$<br>y_{n+1} &#x3D; y_n + h(x_n^2 + y_n^2) + \frac{h^2}{2} \left[ 2x_n + 2y_n(x_n^2 + y_n^2) \right]<br>$$</p>
<p>由 $y(1) &#x3D; y_0 &#x3D; 1$，计算得：</p>
<p>$$<br>y(1.25) \approx y_1 &#x3D; 1.6875 ;\<br>y(1.50) \approx y_2 &#x3D; 3.333298<br>$$</p>
</blockquote>
<h2 id="欧拉方法"><a href="#欧拉方法" class="headerlink" title="欧拉方法"></a>欧拉方法</h2><h3 id="欧拉公式"><a href="#欧拉公式" class="headerlink" title="欧拉公式"></a>欧拉公式</h3><p>向前差商近似导数  →  $y’(x_0) \approx \frac{y(x_1) - y(x_0)}{h}$</p>
<p>记为</p>
<p>$$<br>y(x_1) \approx y(x_0) + h y’(x_0) &#x3D; y_0 + h f(x_0, y_0)<br>$$</p>
<p>递推公式为</p>
<p>$$<br>y_{n+1} &#x3D; y_n + h f(x_n, y_n) \quad (n &#x3D; 0, \dots, N-1)<br>$$</p>
<p><strong>原理图形</strong></p>
<p><img src="/blog/image/Snipaste_2025-05-20_14-47-05.png"></p>
<h2 id="隐式欧拉法"><a href="#隐式欧拉法" class="headerlink" title="隐式欧拉法"></a>隐式欧拉法</h2><p>向后差商近似导数  →  $y’(x_1) \approx \frac{y(x_1) - y(x_0)}{h}$</p>
<p>记为</p>
<p>$$<br>y(x_1) \approx y_0 + h f(x_1, y(x_1))<br>$$</p>
<p>递推公式为</p>
<p>$$<br>y_{n+1} &#x3D; y_n + h f(x_{n+1}, y_{n+1}) \quad (n &#x3D; 0, \dots, N-1)<br>$$</p>
<p>由于未知数 $y_{n+1}$ 同时出现在等式的两边，不能直接得到，故称为<strong>隐式欧拉公式</strong>，而前者称为<strong>显式欧拉公式</strong>。</p>
<p>一般先用显式计算一个初值，再递代求解。即</p>
<p>$$<br>y_{n+1}^{(0)} &#x3D; y_n + h f(x_n, y_n)<br>$$</p>
<p>$$<br>y_{n+1}^{(k+1)} &#x3D; y_n + h f(x_{n+1}, y_{n+1}^{(k)}) \quad k &#x3D; 0, 1, 2, \dots<br>$$</p>
<p>如果迭代过程收敛，则步后 $y_{n+1}^{(k+1)}$ 就可以作为 $y_{n+1}$，从而进行下一步的计算。</p>
<h2 id="梯形公式"><a href="#梯形公式" class="headerlink" title="梯形公式"></a>梯形公式</h2><p>显、隐式两种算法的平均<br>$$<br>y_{n+1} &#x3D; y_n + \frac{h}{2} \left[ f(x_n, y_n) + f(x_{n+1}, y_{n+1}) \right] \quad (n &#x3D; 0, \dots, N-1)<br>$$</p>
<hr>
<h2 id="两步欧拉公式"><a href="#两步欧拉公式" class="headerlink" title="两步欧拉公式"></a>两步欧拉公式</h2><p>中心差商近似导数  →  $y’(x_1) \approx \frac{y(x_2) - y(x_0)}{2h}$</p>
<p>$$<br>y(x_2) \approx y(x_0) + 2h f(x_1, y(x_1))<br>$$</p>
<p>递推公式为</p>
<p>$$<br>y_{n+1} &#x3D; y_{n-1} + 2h f(x_n, y_n) \quad n &#x3D; 1, \dots, N-1<br>$$</p>
<hr>
<blockquote>
<p>需要 2 个初值 $y_0$ 和 $y_1$ 来启动递推，这样的算法称为两步法 &#x2F;* double-step method <em>&#x2F;，而前面的三种算法都是单步法 &#x2F;</em> single-step method *&#x2F;。</p>
</blockquote>
<h2 id="改进欧拉法"><a href="#改进欧拉法" class="headerlink" title="改进欧拉法"></a>改进欧拉法</h2><p>Step 1: 先用显式欧拉公式作预测，算出 $\bar{y}_{n+1} &#x3D; y_n + h f(x_n, y_n)$</p>
<p>Step 2: 再将 $\bar y_{n+1}$ 代入隐式梯形公式的右边作校正，得到<br>$$<br>y_{n+1} &#x3D; y_n + \frac{h}{2} \left[ f(x_n, y_n) + f(x_{n+1}, \bar y_{n+1}) \right]<br>$$</p>
<p>递推公式为</p>
<p>$$<br>y_{n+1} &#x3D; y_n + \frac{h}{2} \left[ f(x_n, y_n) + f(x_{n+1}, y_n + h f(x_n, y_n)) \right] \quad (n &#x3D; 0, \dots, N-1)<br>$$</p>
<p><strong>换一种表示方法</strong><span style="color:#FF0000">（考试记忆这个）</span></p>
<p>$y_p &#x3D; y_n + h f(x_n, y_n)$，$y_c &#x3D; y_n + h f(x_{n+1}, y_p)$，因此有<br>$$<br>y_{n+1} &#x3D; \frac{1}{2} (y_p + y_c)<br>$$</p>
<blockquote>
<p>此法也称为<strong>预测-校正法</strong> &#x2F;* predictor-corrector method *&#x2F;。可以证明该算法具有 <strong>2 阶精度</strong>，同时可以看到它是个单步递推格式，比隐式公式的解求过程简单。后面将看到，它的稳定性高于显式欧拉法。</p>
</blockquote>
<blockquote>
<p><strong>例题</strong></p>
<p>用梯形法和改进的欧拉法求解初值问题</p>
<p>$$<br>\begin{cases}<br>y’ &#x3D; x + y, \quad 0 \leq x \leq 0.5 \<br>y(0) &#x3D; 1<br>\end{cases}<br>$$</p>
<p>取步长 $h &#x3D; 0.1$，并与准确解 $y &#x3D; -x - 1 + 2e^x$ 比较。</p>
<hr>
<p><strong>解题过程</strong></p>
<p>梯形法计算公式为：</p>
<p>$$<br>y_{n+1} &#x3D; y_n + \frac{1}{2}h \left[ x_n + y_n + x_{n+1} + y_{n+1} \right]<br>$$</p>
<p>解得：</p>
<p>$$<br>y_{n+1} &#x3D; \frac{1}{1 - h&#x2F;2} \left[ \left(1 + \frac{h}{2} \right) y_n + \frac{h}{2} (x_n + x_{n+1}) \right], \quad (n &#x3D; 0,1,\cdots,4)<br>$$</p>
<p><span style="color:#FF0000">（这里需要记住梯形法计算时等式右边的$y_{n+1}$需要移项后计算）</span></p>
<p>改进的欧拉法为：<br>$$<br>y_{n+1} &#x3D; y_n + \frac{h}{2}[f(x_n,y_n)+f(x_{n+1},y_n+hf(x_n,y_n))]<br>$$</p>
<p>即：</p>
<p>$$<br>y_{n+1} &#x3D; (1+h+\frac{h^2}{2})y_n+(\frac{h}{2}+\frac{h^2}{2})x_n+\frac{h}{2}x_{n+1}<br>$$</p>
<p>代入 $h &#x3D; 0.1, y_0 &#x3D; 1$ 代入上述两种方法计算，结果见下表：</p>
<table>
<thead>
<tr>
<th>n</th>
<th>$x_n$</th>
<th>梯形法 $y_n$</th>
<th>$y(x_n) - y_n$</th>
<th>n</th>
<th>$x_n$</th>
<th>改进欧拉法 $y_n$</th>
<th>$y(x_n) - y_n$</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>0.1</td>
<td>1.110 526 316</td>
<td>0.184 479 × 10⁻³</td>
<td>0</td>
<td>0.1</td>
<td>1.11 000 000</td>
<td>0.341 836 × 10⁻³</td>
</tr>
<tr>
<td>1</td>
<td>0.2</td>
<td>1.243 213 296</td>
<td>0.407 779 × 10⁻³</td>
<td>1</td>
<td>0.2</td>
<td>1.242 050</td>
<td>0.755 516 × 10⁻³</td>
</tr>
<tr>
<td>2</td>
<td>0.3</td>
<td>1.400 393 643</td>
<td>0.676 027 × 10⁻³</td>
<td>2</td>
<td>0.3</td>
<td>1.398 465 250</td>
<td>1.252 365 × 10⁻³</td>
</tr>
<tr>
<td>3</td>
<td>0.4</td>
<td>1.584 645 606</td>
<td>0.996210 × 10⁻³</td>
<td>3</td>
<td>0.4</td>
<td>1.581804101</td>
<td>1.845 294 × 10⁻³</td>
</tr>
<tr>
<td>4</td>
<td>0.5</td>
<td>1.798 818 827</td>
<td>1.376285 × 10⁻³</td>
<td>4</td>
<td>0.5</td>
<td>1.794893532</td>
<td>2.549 009 × 10⁻³</td>
</tr>
</tbody></table>
<hr>
<p><strong>结论</strong><br>可以看出，就本题而言，梯形法比改进的欧拉法更精确。</p>
</blockquote>
<h2 id="局部截断误差和方法的阶"><a href="#局部截断误差和方法的阶" class="headerlink" title="局部截断误差和方法的阶"></a>局部截断误差和方法的阶</h2><p>初值问题的单步法可用一般形式表示为：</p>
<p>$$<br>y_{n+1} &#x3D; y_n + h \varphi(x_n, y_n, y_{n+1}, h)<br>$$</p>
<p>其中，$\varphi$ 称为增量函数。</p>
<ul>
<li>若 $\varphi$ 包含 $y_{n+1}$ 时，方法是<strong>隐式</strong>的</li>
<li>若 $\varphi$ 不包含 $y_{n+1}$ 时，方法是<strong>显式</strong>的</li>
</ul>
<p>例如</p>
<ul>
<li><p>(显示)欧拉法有 $\varphi(x_n, y_n, h) &#x3D; f(x_n, y_n)$，</p>
</li>
<li><p>隐式欧拉法有 $\varphi(x_n, y_n, y_{n+1},h) &#x3D; f(x_{n+1}, y_{n+1})$</p>
</li>
</ul>
<p>从 $x_0$ 开始计算，如果考虑每一步产生的误差，直到 $x_n$ 则有误差<br>$$<br>e_n &#x3D; y(x_n) - y_n<br>$$</p>
<p>称为该方法在 $x_n$ 的<strong>整体截断误差</strong></p>
<p>分析和求得整体截断误差是复杂的。为此，我们只考虑从 $x_n$ 到 $x_{n+1}$ 的局部情况，并假设 $x_n$ 之前的计算没有误差，即$y(x_n)&#x3D;y_n$</p>
<p><strong>定义</strong></p>
<p>设 $y(x)$ 是初值问题的准确解，称</p>
<p>$$<br>T_{n+1} &#x3D;y(x_{n+1}) - y_{n+1}&#x3D; y(x_{n+1}) - y(x_n) - h \varphi(x_n, y(x_n),y(x_{n+1}) ,h)<br>$$</p>
<p>为单步法的<strong>局部截断误差</strong>。</p>
<p><strong>定义</strong></p>
<blockquote>
<p>若某算法的局部截断误差为 $O(h^{p+1})$，则该算法有 $p$ 阶精度。</p>
</blockquote>
<blockquote>
<span>
$$
\begin{aligned}
f(x + \Delta x, y + \Delta y) &= f(x, y) \\
&\quad + \Delta x \cdot f_x + \Delta y \cdot f_y \\
&\quad + \frac{1}{2} \left( \Delta x^{2} f_{xx} + 2 \Delta x \Delta y f_{xy} + \Delta y^{2} f_{yy} \right) \\
&\quad + \frac{1}{6} \left( \Delta x^{3} f_{xxx} + 3 \Delta x^{2} \Delta y f_{xxy} + 3 \Delta x \Delta y^{2} f_{xyy} + \Delta y^{3} f_{yyy} \right) \\
&\quad + \frac{1}{24} \left( \Delta x^{4} f_{xxxx} + 4 \Delta x^{3} \Delta y f_{xxxy} + 6 \Delta x^{2} \Delta y^{2} f_{xxyy} + 4 \Delta x \Delta y^{3} f_{xyyy} + \Delta y^{4} f_{yyyy} \right) \\
&\quad + O(\Delta x^{5}, \Delta y^{5})
\end{aligned}
$$


</span>

</blockquote>
<h3 id="欧拉法的局部截断误差"><a href="#欧拉法的局部截断误差" class="headerlink" title="欧拉法的局部截断误差"></a>欧拉法的局部截断误差</h3><p>$$<br>T_{n+1} &#x3D; y(x_{n+1}) - y_{n+1}   \<br>&#x3D; [y(x_n) + h y’(x_n) + \frac{h^2}{2} y’’(x_n) + O(h^3)] - [y_n + h f(x_n, y_n)] \<br>$$</p>
<p>$$<br>\text {其中} \quad y_n&#x3D;y(x_n) \quad  f(x_n, y_n)&#x3D;y’(x_n) \<br>$$</p>
<p>$$<br>T_{n+1}&#x3D;\frac{h^2}{2} y’’(x_n) + O(h^3)<br>$$</p>
<p><strong>欧拉法具有 1 阶精度。</strong></p>
<h3 id="隐式欧拉法的局部截断误差"><a href="#隐式欧拉法的局部截断误差" class="headerlink" title="隐式欧拉法的局部截断误差"></a>隐式欧拉法的局部截断误差</h3><p>求隐式欧拉式 $y_{n+1} &#x3D; y_n + h f(x_{n+1}, y_{n+1})$ 的局部截断误差。<br>$$<br>T_{n+1} &#x3D; y(x_{n+1})-y_{n+1} \<br>&#x3D;y(x_{n+1}) - y(x_n) - h f(x_{n+1}, y_{n+1}) \<br>&#x3D;y(x_{n+1}) - y(x_n) - hy’(x_{n+1}) \<br>&#x3D; h y’(x_n) + \frac{h^2}{2} y’’(x_n) + O(h^3) - h[y’(x_n) + h y’’(x_n) + O(h^2)] \<br>&#x3D; -\frac{h^2}{2} y’’(x_n) + O(h^3)<br>$$</p>
<p><strong>具有 1 阶精度。</strong></p>
<hr>
<h3 id="梯形公式的局部截断误差"><a href="#梯形公式的局部截断误差" class="headerlink" title="梯形公式的局部截断误差"></a>梯形公式的局部截断误差</h3><p>梯形公式 $y_{n+1} &#x3D; y_n + \frac{h}{2}[f(x_n, y_n) + f(x_{n+1}, y_{n+1})]$ 的局部截断误差。<br>$$<br>T_{n+1} &#x3D; y(x_{n+1}) - y(x_n) - \frac{h}{2}[y’(x_n) + y’(x_{n+1})] \<br>&#x3D; h y’(x_n) + \frac{h^2}{2} y’’(x_n) + \frac{h^3}{3!} y^{(3)}(x_n) - \frac{h}{2}[y’(x_n) + y’(x_n) + hy’’(x_n) + \frac{h^2}{2} y^{(3)}(x_n) + O(h^4)] \<br>&#x3D; -\frac{h^3}{12} y^{(3)}(x_n) + O(h^4)<br>$$</p>
<p><strong>具有 2 阶精度。</strong></p>
<h3 id="改进欧拉法的局部截断误差"><a href="#改进欧拉法的局部截断误差" class="headerlink" title="改进欧拉法的局部截断误差"></a>改进欧拉法的局部截断误差</h3><p>$$<br>T_{n+1} &#x3D; y(x_{n+1}) -  y_{n+1} &#x3D; O(h^3)<br>$$</p>
<p> $ y(x_{n+1}) $精确解在 $ x_n $ 处展开至三阶项：</p>
<span>
$$
\begin{aligned}
y(x_{n+1}) &= y(x_n) + h y'(x_n) + \frac{h^2}{2} y''(x_n) + \frac{h^3}{6} y'''(x_n) + O(h^4) \\
&= y(x_{n+1}) + h f + \frac{h^2}{2}(f_x + f f_y) + \frac{h^3}{6}(f_{xx} + 2f_{xy}f + f_{yy}f^2 + f_y f_x + f_y^2 f) + O(h^4)
\end{aligned}
$$

</span>



<p>预测-校正步骤：<br>$$<br>y_{n+1} &#x3D; y_n + h (f+f(x_n+h,y_n+hf))<br>$$</p>
<p>对 $f(x_n + h, y_n + h f)$ 进行二元泰勒展开（至二阶项）：<br>$$<br>f(x_n + h, y_n + h f) &#x3D; f + h f_x + h f f_y + \frac{h^2}{2}(f_{xx} + 2 f_{xy} f + f_{yy} f^2) + O(h^3)<br>$$</p>
<p>代入得数值解：<br>$$<br>y_{n+1} &#x3D; y_n + h f + \frac{h^2}{2}(f_x + f f_y) + \frac{h^3}{4}(f_{xx} + 2 f_{xy} f + f_{yy} f^2) + O(h^4)<br>$$</p>
<span>
$$
\begin{aligned}
T_{n+1} &= y(x_{n+1}) - y_{n+1} \\
&= \left[ \frac{h^3}{6}(f_{xx} + 2 f_{xy} f + f_{yy} f^2 + f_y f_x + f_y^2 f) \right] \\
&\quad - \left[ \frac{h^3}{4}(f_{xx} + 2 f_{xy} f + f_{yy} f^2) \right] + O(h^4) \\
&= -\frac{h^3}{12}(f_{xx} + 2 f_{xy} f + f_{yy} f^2) + \frac{h^3}{6}(f_y f_x + f_y^2 f) + O(h^4)
\end{aligned}
$$

</span>

<p><strong>即两步欧拉公式具有 2 阶精度。</strong></p>
<h3 id="方法比较表"><a href="#方法比较表" class="headerlink" title="方法比较表"></a>方法比较表</h3><table>
<thead>
<tr>
<th>方法</th>
<th>局部截断误差</th>
<th>精度（阶）</th>
</tr>
</thead>
<tbody><tr>
<td>显式欧拉法</td>
<td>$\frac{h^2}{2} y’’(x_n) + O(h^3)$</td>
<td>1</td>
</tr>
<tr>
<td>隐式欧拉法</td>
<td>$-\frac{h^2}{2} y’’(x_n) + O(h^3)$</td>
<td>1</td>
</tr>
<tr>
<td>梯形公式</td>
<td>$-\frac{h^3}{12} y^{(3)}(x_n) + O(h^4)$</td>
<td>2</td>
</tr>
<tr>
<td>改进欧拉法</td>
<td>$O(h^3)$</td>
<td>2</td>
</tr>
</tbody></table>
<h2 id="龙格-库塔法"><a href="#龙格-库塔法" class="headerlink" title="龙格 - 库塔法"></a>龙格 - 库塔法</h2><h3 id="龙格-库塔法的基本思想"><a href="#龙格-库塔法的基本思想" class="headerlink" title="龙格 - 库塔法的基本思想"></a>龙格 - 库塔法的基本思想</h3><ul>
<li>建立高精度的单步逆推公式。</li>
</ul>
<p>单步逆推法的基本思想是从 $(x_n, y_n)$ 点出发，以某一斜率沿直线达到 $(x_{n+1}, y_{n+1})$ 点。欧拉法及其各种变形所能达到的最高精度为2阶。</p>
<p>考虑改进的欧拉法，可以将其改写为：</p>
<p>$$<br>y_{n+1} &#x3D; y_n + h \left[ \frac{1}{2} K_1 + \frac{1}{2} K_2 \right]<br>$$</p>
<p>$$<br>K_1 &#x3D; f(x_n, y_n)<br>$$</p>
<p>$$<br>K_2 &#x3D; f(x_n + h, y_n + h K_1)<br>$$</p>
<p>当然，$K_1, K_2$ 是在点 $x_n, x_{n+1}$ 处的斜率。以上公式用到了两个点的斜率的加权平均，它为构造算法提供了新的途径。<strong>Runge-Kutta方法就是这种思想的体现和发展</strong>。</p>
<p><strong>将改进欧拉法推广为</strong><br>$$<br>y_{n+1} &#x3D; y_n + h[\lambda_1 K_1 + \lambda_2 K_2]<br>$$</p>
<p>$$<br>K_1 &#x3D; f(x_n, y_n)<br>$$</p>
<p>$$<br>K_2 &#x3D; f(x_n + ph, y_n + phK_1)<br>$$</p>
<p>首先希望能够确定系数 $\lambda_1, \lambda_2, p$，使得到的算法公式有2阶精度，即在 $y_n &#x3D; y(x_n)$ 的前提假设下，使得</p>
<p>$$<br>T_{n+1} &#x3D; y(x_{n+1}) - y_{n+1} &#x3D; O(h^3)<br>$$</p>
<p><strong>Step 1</strong>: 将 $K_2$ 在 $(x_n, y_n)$ 点作 Taylor 展开<br>$$<br>K_2 &#x3D; f(x_n + ph, y_n + phK_1)<br>$$</p>
<blockquote>
<span>
$$
\begin{aligned}
f(x + \Delta x, y + \Delta y) &= f(x, y) \\
&\quad + \Delta x \cdot f_x + \Delta y \cdot f_y \\
&\quad + \frac{1}{2} \left( \Delta x^{2} f_{xx} + 2 \Delta x \Delta y f_{xy} + \Delta y^{2} f_{yy} \right) \\
&\quad + \frac{1}{6} \left( \Delta x^{3} f_{xxx} + 3 \Delta x^{2} \Delta y f_{xxy} + 3 \Delta x \Delta y^{2} f_{xyy} + \Delta y^{3} f_{yyy} \right) \\
&\quad + \frac{1}{24} \left( \Delta x^{4} f_{xxxx} + 4 \Delta x^{3} \Delta y f_{xxxy} + 6 \Delta x^{2} \Delta y^{2} f_{xxyy} + 4 \Delta x \Delta y^{3} f_{xyyy} + \Delta y^{4} f_{yyyy} \right) \\
&\quad + O(\Delta x^{5}, \Delta y^{5})
\end{aligned}
$$

</span>

</blockquote>
<p>$$<br>&#x3D; f(x_n, y_n) + phf_x(x_n, y_n) + phK_1 f_y(x_n, y_n) + O(h^2)<br>$$</p>
<blockquote>
<p>$$<br>y’’(x) &#x3D; \frac{d}{dx} f(x, y)&#x3D; f_x(x, y) + f_y(x, y) \frac{dy}{dx}&#x3D; f_x(x, y) + f_y(x, y) f(x, y)<br>$$</p>
</blockquote>
<p>$$<br>&#x3D; y’(x_n) + ph y’’(x_n) + O(h^2)<br>$$</p>
<p><strong>Step 2</strong>: 将 $K_2$ 代入第1式，得到<br>$$<br>y_{n+1} &#x3D; y_n + h \left( \lambda_1 y’(x_n) + \lambda_2 \left[ y’(x_n) + ph y’’(x_n) + O(h^2) \right] \right)<br>$$</p>
<p>$$<br>&#x3D; y_n + (\lambda_1 + \lambda_2) h y’(x_n) + \lambda_2 ph^2 y’’(x_n) + O(h^3)<br>$$</p>
<p><strong>Step 3</strong>: 将 $y_{n+1}$ 与 $y(x_{n+1})$ 在 $x_n$ 点的泰勒展开比较<br>$$<br>y_{n+1} &#x3D; y_n + (\lambda_1 + \lambda_2) h y’(x_n) + \lambda_2 ph^2 y’’(x_n) + O(h^3)<br>$$</p>
<p>$$<br>y(x_{n+1}) &#x3D; y(x_n) + h y’(x_n) + \frac{h^2}{2} y’’(x_n) + O(h^3)<br>$$</p>
<p>要求 $T_{n+1} &#x3D; y(x_{n+1}) - y_{n+1} &#x3D; O(h^3)$，则必须有：</p>
<p>$$<br>\lambda_1 + \lambda_2 &#x3D; 1, \quad \lambda_2 p &#x3D; \frac{1}{2}<br>$$</p>
<p><strong>这里有3个未知数，2个方程</strong>。</p>
<p>存在无穷多个解。所有满足上述的格式系统称为2阶龙格-库塔格式。注意到，$p &#x3D; 1, \lambda_1 &#x3D; \lambda_2 &#x3D; \frac{1}{2}$ 就是改进的欧拉法。</p>
<h3 id="Runge-Kutta方法的一般形式"><a href="#Runge-Kutta方法的一般形式" class="headerlink" title="Runge-Kutta方法的一般形式"></a>Runge-Kutta方法的一般形式</h3><p>$$<br>y_{n+1} &#x3D; y_n + h \sum_{i&#x3D;1}^{L} \lambda_i k_i<br>$$</p>
<p>$$<br>k_1 &#x3D; f(x_n, y_n)<br>$$</p>
<p>$$<br>k_2 &#x3D; f(x_n + c_2 h, y_n + c_2 h k_1)<br>$$</p>
<p>$$<br>k_3 &#x3D; f(x_n + c_3 h, y_n + c_3 h (a_{31} k_1 + a_{32} k_2))<br>$$</p>
<p>$$<br>\vdots<br>$$</p>
<p>$$<br>k_i &#x3D; f(x_n + c_i h, y_n + c_i h \sum_{j&#x3D;1}^{i-1} a_{ij} k_j) \quad i &#x3D; 2, 3, \dots, L<br>$$</p>
<p>其中，$\sum_{i&#x3D;1}^{L} \lambda_i &#x3D; 1, \quad c_i \leq 1, \quad \sum_{j&#x3D;1}^{i-1} a_{ij} &#x3D; 1$ 均为待定系数，确定这些系数的步骤与前面相似。</p>
<h3 id="二阶中点格式"><a href="#二阶中点格式" class="headerlink" title="二阶中点格式"></a>二阶中点格式</h3><p>$$<br>\begin{cases}<br>y_{n+1} &#x3D; y_n + h K_2 \<br>K_1 &#x3D; f(x_n, y_n) \<br>K_2 &#x3D; f\left( x_n + \frac{h}{2},\ y_n + \frac{h}{2} K_1 \right), \quad (n &#x3D; 0, 1, 2, \cdots)<br>\end{cases}<br>$$</p>
<h3 id="二阶休恩格式"><a href="#二阶休恩格式" class="headerlink" title="二阶休恩格式"></a>二阶休恩格式</h3><p>$$<br>\begin{cases}<br>y_{n+1} &#x3D; y_n + \frac{h}{4} \left( K_1 + 3K_2 \right) \<br>K_1 &#x3D; f(x_n, y_n) \<br>K_2 &#x3D; f\left( x_n + \frac{2}{3}h,\ y_n + \frac{2}{3}h K_1 \right), \quad (n &#x3D; 0, 1, 2, \cdots)<br>\end{cases}<br>$$</p>
<h3 id="四级4阶经典龙格-库塔法"><a href="#四级4阶经典龙格-库塔法" class="headerlink" title="四级4阶经典龙格-库塔法"></a>四级4阶经典龙格-库塔法</h3><p>$$<br>y_{n+1} &#x3D; y_n + \frac{h}{6} (K_1 + 2K_2 + 2K_3 + K_4)<br>$$</p>
<p>$$<br>K_1 &#x3D; f(x_n, y_n)<br>$$</p>
<p>$$<br>K_2 &#x3D; f(x_n + \frac{h}{2}, y_n + \frac{h}{2} K_1)<br>$$</p>
<p>$$<br>K_3 &#x3D; f(x_n + \frac{h}{2}, y_n + \frac{h}{2} K_2)<br>$$</p>
<p>$$<br>K_4 &#x3D; f(x_n + h, y_n + h K_3)<br>$$</p>
<blockquote>
<p><strong>例题</strong><br>$$<br>y’&#x3D;y-\frac {2x}{y} \quad(0&lt;x&lt;1) \<br>y(0)&#x3D;1<br>$$<br><strong>解</strong>：对于本题，经典的四阶 Runge-Kutta 方法具有以下形式：<br>$$<br>y_{n+1} &#x3D; y_n + \frac{h}{6} \left( k_1 + 2k_2 + 2k_3 + k_4 \right)<br>$$</p>
<p>$$<br>k_1 &#x3D; y_n - \frac{2x_n}{y_n}<br>$$</p>
<p>$$<br>k_2 &#x3D; y_n + \frac{h}{2} k_1 - \frac{2x_n + h}{y_n + \frac{h}{2} k_1}<br>$$</p>
<p>$$<br>k_3 &#x3D; y_n + \frac{h}{2} k_2 - \frac{2x_n + h}{y_n + \frac{h}{2} k_2}<br>$$</p>
<p>$$<br>k_4 &#x3D; y_n + h k_3 - \frac{2(x_n + h)}{y_n + h k_3}<br>$$</p>
<p>这里，我们取步长 $h&#x3D;0.2$，下面是计算结果（符号的意义同前）：</p>
<table>
<thead>
<tr>
<th>$X_n$</th>
<th>$y_n$</th>
<th>$y(x_n)$</th>
</tr>
</thead>
<tbody><tr>
<td>0.2</td>
<td>1.1832</td>
<td>1.1832</td>
</tr>
<tr>
<td>0.4</td>
<td>1.3417</td>
<td>1.3416</td>
</tr>
<tr>
<td>0.6</td>
<td>1.4833</td>
<td>1.4832</td>
</tr>
<tr>
<td>0.8</td>
<td>1.6125</td>
<td>1.6125</td>
</tr>
<tr>
<td>1.0</td>
<td>1.7321</td>
<td>1.7321</td>
</tr>
</tbody></table>
</blockquote>
<blockquote>
<p><strong>注</strong>:<br>龙格-库塔法的主要运算是在计算 $K_i$ 的值，即计算 $f$ 的值。Butcher 于 1965 年给出了计算量与可达到的最高精度阶数的关系：</p>
<table>
<thead>
<tr>
<th>每步须计算 $K_i$ 的个数</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>$n \geq 8$</th>
</tr>
</thead>
<tbody><tr>
<td>可达到的最高精度</td>
<td>$O(h^2)$</td>
<td>$O(h^3)$</td>
<td>$O(h^4)$</td>
<td>$O(h^4)$</td>
<td>$O(h^5)$</td>
<td>$O(h^6)$</td>
<td>$O(h^{n-2})$</td>
</tr>
</tbody></table>
<p>由于龙格-库塔法的导出基于泰勒展开，故精度主要受解函数的光滑性影响。对于光滑性不太好的解，最好采用低阶方法而将步长 $h$ 取小。</p>
</blockquote>
<blockquote>
<p><strong>【题 1】（北京理工大学 2006 年）</strong></p>
<p><strong>考查初值问题</strong></p>
<span>
$$
\begin{cases}
y' = x^4, \quad x > 0 \\
y(0) = 1
\end{cases} \quad \text{①}
$$

</span>

<p>其准确解为 $y(x) &#x3D; 1 + \frac{x^5}{5}$。记 $x_i &#x3D; ih$, $i &#x3D; 0, 1, 2, \cdots$，设 ${y_i}_{i&#x3D;0}^\infty$ 为用经典 Runge-Kutta 公式所得近似解，证明：<br>$$<br>y(x_i) - y_i &#x3D; -\frac{x_i}{120}h^4, \quad i &#x3D; 0, 1, 2, \cdots \quad \text{②}<br>$$</p>
<hr>
<p><strong>解题过程</strong></p>
<p>求解 ① 的 Runge-Kutta 公式为：</p>
<span>
$$
\begin{cases}
y_{i+1} = y_i + \frac{h}{6}(K_1 + 2K_2 + 2K_3 + K_4) \\
K_1 = f(x_i, y_i) = x_i^4 \\
K_2 = f\left(x_i + \frac{h}{2},\ y_i + \frac{1}{2}hK_1\right) = \left(x_i + \frac{h}{2} \right)^4 \\
K_3 = f\left(x_i + \frac{h}{2},\ y_i + \frac{1}{2}hK_2\right) = \left(x_i + \frac{h}{2} \right)^4 \\
K_4 = f(x_i + h, y_i + hK_3) = (x_i + h)^4 \\
y_0 = 1
\end{cases}
$$

</span>

<p>因此：<br>$$<br>y_{i+1} &#x3D; y_i + \frac{h}{6} \left[ x_i^4 + 2\left(x_i + \frac{h}{2}\right)^4 + 2\left(x_i + \frac{h}{2}\right)^4 + (x_i + h)^4 \right]<br>$$</p>
<blockquote>
<p>$$<br>(a + b)^n &#x3D; \sum_{k&#x3D;0}^{n} C_n^k a^{n-k} b^k<br>$$</p>
<p>$$<br>(a + b)^4 &#x3D; a^4 + 4a^3b + 6a^2b^2 + 4ab^3 + b^4<br>$$</p>
</blockquote>
<p>展开得：</p>
<p>$$<br>&#x3D; y_i + h \left(x_i^4 + 2x_i^3 h + 2x_i^2 h^2 + x_i h^3 + \frac{5}{24} h^4 \right) \quad \text{③}<br>$$</p>
<hr>
<p>另一方面：</p>
<p>$$<br>y(x_{i+1}) &#x3D; 1 + \frac{1}{5}x_{i+1}^5 &#x3D; 1 + \frac{1}{5}(x_i + h)^5<br>$$</p>
<p>展开：</p>
<p>$$<br>&#x3D; 1 + \frac{1}{5} \left[ x_i^5 + 5x_i^4 h + 10x_i^3 h^2 + 10x_i^2 h^3 + 5x_i h^4 + h^5 \right] \<br>&#x3D; y(x_i) + x_i^4 h + 2x_i^3 h^2 + 2x_i^2 h^3 + x_i h^4 + \frac{1}{5} h^5 \quad \text{④}<br>$$</p>
<hr>
<p>将③和④相减，得：</p>
<p>$$<br>y(x_{i+1}) - y_{i+1} &#x3D; y(x_i) - y_i + \frac{1}{5}h^5 - \frac{5}{24}h^5 \<br>&#x3D; y(x_i) - y_i - \frac{1}{120}h^5<br>$$</p>
<span>
$$
\begin{cases}
y(x_i) - y_i  = y(x_{i-1}) - y_{i-1} - \frac{1}{120}h^5 \\
y(x_{i-1}) - y_{i-1}=y(x_{i-2}) - y_{i-2}- \frac{1}{120}h^5\\
\vdots \vdots  \\
 y(x_{1}) - y_{1}= y(x_{0}) - y_{0}- \frac{1}{120}h^5
\end{cases}
$$

</span>

<p>上式相加整理得：<br>$$<br>y(x_i) - y_i &#x3D; - \frac{1}{120}h^5 \cdot i &#x3D; -\frac{x_i}{120}h^4<br>$$</p>
<p>因此最终结果为：</p>
<p>$$<br>\boxed{y(x_i) - y_i &#x3D; -\frac{x_i}{120}h^4}, \quad i &#x3D; 0, 1, 2, \cdots<br>$$</p>
</blockquote>
<h2 id="收敛性与稳定性"><a href="#收敛性与稳定性" class="headerlink" title="收敛性与稳定性"></a>收敛性与稳定性</h2><h3 id="收敛性"><a href="#收敛性" class="headerlink" title="收敛性"></a>收敛性</h3><p><strong>定义</strong><br>若某算法对于任意固定的 $x &#x3D; x_n &#x3D; x_0 + n h$，当 $h \to 0$（同时 $n \to \infty$）时有 $y_n \to y(x_n)$，则称该算法是<strong>收敛</strong>的。</p>
<p><strong>例</strong>: 就初值问题<br>$$<br>y’ &#x3D; \lambda y<br>$$</p>
<p>$$<br>y(0) &#x3D; y_0<br>$$</p>
<p>考察欧拉显式格式的收敛性.</p>
<p><strong>解</strong>: 该问题的精确解为<br>$$<br>y(x) &#x3D; y_0 e^{\lambda x}<br>$$</p>
<p>欧拉公式为<br>$$<br>y_{n+1} &#x3D; y_n + h \lambda y_n &#x3D; (1 + \lambda h) y_n<br>\Rightarrow y_n &#x3D; (1 + \lambda h)^n y_0<br>$$</p>
<p>对于任意固定的 $x &#x3D; x_n &#x3D; n h$，有<br>$$<br>y_n &#x3D; y_0 (1 + \lambda h)^n &#x3D; y_0 \left[(1 + \lambda h)^{\frac{1}{\lambda h}}\right]^{\lambda x_n}<br>\Rightarrow y_0 e^{\lambda x_n} &#x3D; y(x_n) \checkmark<br>$$<br><strong>定理</strong><br>对于一个 $p$ 阶的显式单步法，若满足以下条件：</p>
<ol>
<li>增量函数 $\Phi$ 关于 $y$ 满足 Lipschitz 条件，即存在常数 $L_\varphi &gt; 0$，使得<br>$$<br>|\varphi(x, y, h) - \varphi(x, \bar{y}, h)| \leq L_\varphi |y - \bar{y}|, \quad \forall y, \bar{y} \in \mathbb{R}<br>$$</li>
<li>微分方程的初值是准确的，<br>则该方法收敛，其<strong>整体</strong>截断误差为：<br>$$<br>|e_n| &#x3D; |y(x_n) - y_n| &#x3D; O(h^p).<br>$$</li>
</ol>
<p><strong>注</strong>:</p>
<ol>
<li>判定显式单步格式的收敛性，归结为验证增量函数 $\Phi$ 是否满足 Lipschitz 条件。</li>
<li><strong>单步格式的整体截断误差</strong>差由<strong>初值误差</strong>及<strong>局部截断误差</strong>决定，整体截断误差比局部截断误差的阶数<strong>低一阶</strong>。</li>
<li>要构造高精度的计算方法，只需设计提高局部截断误差的阶即可。</li>
</ol>
<h3 id="稳定性"><a href="#稳定性" class="headerlink" title="稳定性"></a>稳定性</h3><p><strong>定义</strong><br>若某算法在计算过程中任一步产生的误差在以后的计算中都<strong>逐步衰减</strong>，则称该算法是<strong>绝对稳定的</strong> 。</p>
<p>一般分析时为简便起见，只考虑<strong>试验方程</strong>：</p>
<p>$$<br>y’ &#x3D; \lambda y \quad \text{Re}(\lambda) &lt; 0<br>$$</p>
<p>若得到的解<br>$y_{n+1} &#x3D; E(h\lambda) y_n$，满足 $|E(h\lambda)| &lt; 1$，则称该方法是<strong>绝对稳定</strong>的。<br>在 $\mu &#x3D; h\lambda$ 平面上，使 $|E(h\lambda)| &lt; 1$ 的区域称为<strong>绝对稳定域</strong>，<br>它与实轴的交称为<strong>绝对稳定区间</strong>。<span style="color:blue">（求$\lambda h$的取值范围，即$h$的取值范围）</span></p>
<blockquote>
<p><strong>一阶线性微分方程的通解</strong></p>
<p>一阶线性微分方程的标准形式为：</p>
<p>$$<br>\frac{dy}{dx} + P(x)y &#x3D; Q(x)<br>$$</p>
<p>其中，$ P(x) $ 和 $ Q(x) $ 是已知函数。</p>
<p>$$<br>y &#x3D; e^{-\int P(x) dx} \left( \int Q(x) e^{\int P(x) dx} dx + C \right)<br>$$</p>
</blockquote>
<hr>
<h4 id="欧拉法"><a href="#欧拉法" class="headerlink" title="欧拉法"></a>欧拉法</h4><p><strong>例：</strong> </p>
<p>对<strong>欧拉法</strong>有<br>$$<br>y_{n+1} &#x3D; y_n + h f(x_n, y_n) &#x3D; y_n + \lambda h y_n &#x3D; (1 + \lambda h) y_n,<br>$$<br>$$<br>\Rightarrow \text{稳定区间为 } -2 &lt; \lambda h &lt; 0。<br>$$</p>
<p>当 $\lambda &#x3D; -100$ 时，$0 &lt; h &lt; \frac{2}{100} &#x3D; 0.02$，<br>例如 $h &#x3D; 0.025$ 不稳定，$h &#x3D; 0.005$ 稳定</p>
<hr>
<h4 id="隐式欧拉法-1"><a href="#隐式欧拉法-1" class="headerlink" title="隐式欧拉法"></a>隐式欧拉法</h4><p><strong>例：</strong> </p>
<p>考察隐式欧拉法<br>$$<br>y_{i+1} &#x3D; y_i + h\lambda y_{i+1}<br>$$</p>
<p>解得：<br>$$<br>y_{i+1} &#x3D; \left(\frac{1}{1 - \lambda h}\right) y_i<br>$$</p>
<p>可见绝对稳定区域为：<br>$$<br>|1 - \lambda h| &gt; 1<br>$$</p>
<p>绝对稳定区间为 $-\infty &lt; \lambda h &lt; 0$。</p>
<p>当 $\lambda &lt; 0$ 时，$0 &lt; h &lt; \infty$，即对任何步长稳定。</p>
<blockquote>
<p><strong>注：</strong> 一般来说，隐式欧拉法的绝对稳定性比同阶的显式法的好。</p>
</blockquote>
<hr>
<h4 id="改进欧拉法-1"><a href="#改进欧拉法-1" class="headerlink" title="改进欧拉法"></a>改进欧拉法</h4><p><strong>例</strong></p>
<p>改进欧拉法（预测—校正，即二阶 $R-K$ 法）：<br>$$<br>\begin{cases}<br>y_{n+1} &#x3D; y_n + h \left( \frac{k_1}{2} + \frac{k_2}{2} \right), \<br>k_1 &#x3D; f(x_n, y_n) &#x3D; \lambda y_n, \<br>k_2 &#x3D; f(x_n + h, y_n + h k_1) &#x3D; \lambda (y_n + h \lambda y_n),<br>\end{cases}<br>$$</p>
<p>即：</p>
<p>$$<br>y_{n+1} &#x3D; y_n + \frac{h\lambda}{2} \left( y_n + (y_n + h\lambda y_n) \right)<br>&#x3D; \left( 1 + h\lambda + \frac{(h\lambda)^2}{2} \right) y_n.<br>$$</p>
<p>故：</p>
<p>$$<br>E(h\lambda) &#x3D; 1 + h\lambda + \frac{(h\lambda)^2}{2}.<br>$$</p>
<p>$$<br>\left| 1 + h\lambda + \frac{(h\lambda)^2}{2} \right| &lt; 1<br>\Leftrightarrow -2 &lt; 2 + 2h\lambda + (h\lambda)^2 &lt; 2<br>$$</p>
<p>$$<br>\Leftrightarrow -2 &lt; 1 + (1 + h\lambda)^2 &lt; 2<br>\Leftrightarrow |1 + h\lambda| &lt; 1 \Leftrightarrow -2 &lt; h\lambda &lt; 0.<br>$$</p>
<hr>
<h4 id="梯形方法"><a href="#梯形方法" class="headerlink" title="梯形方法"></a>梯形方法</h4><p><strong>例</strong></p>
<p>梯形方法：对模型方程 $y’ &#x3D; \lambda y$ 使用梯形法（隐式中点法）</p>
<p>其更新格式为：</p>
<p>$$<br>y_{n+1} &#x3D; y_n + \frac{h}{2} \left[ f(x_n, y_n) + f(x_{n+1}, y_{n+1}) \right]<br>$$</p>
<p>代入模型方程得：</p>
<p>$$<br>y_{n+1} &#x3D; y_n + \frac{h}{2} \left[ \lambda y_n + \lambda y_{n+1} \right]<br>&#x3D; y_n + \frac{h\lambda}{2} (y_n + y_{n+1})<br>$$</p>
<p>将 $y_{n+1}$ 移项整理：</p>
<p>$$<br>y_{n+1} - \frac{h\lambda}{2} y_{n+1} &#x3D; y_n + \frac{h\lambda}{2} y_n<br>\Rightarrow \left( 1 - \frac{h\lambda}{2} \right) y_{n+1} &#x3D; \left( 1 + \frac{h\lambda}{2} \right) y_n<br>$$</p>
<p>因此，得到递推公式：</p>
<p>$$<br>y_{n+1} &#x3D; \frac{1 + \frac{h\lambda}{2}}{1 - \frac{h\lambda}{2}} y_n<br>$$</p>
<p>于是</p>
<p>$$<br>E(h\lambda) &#x3D; \frac{1 + \frac{h\lambda}{2}}{1 - \frac{h\lambda}{2}}<br>$$</p>
<p>只要 $\operatorname{Re}(\lambda) &lt; 0$，则：</p>
<p>$$<br>\left|E(h\lambda)\right| &lt; 1<br>$$</p>
<ul>
<li>绝对稳定域为 $\mu &#x3D; h\lambda$ 的左半平面， </li>
<li>绝对稳定区间为 $-\infty &lt; \lambda h &lt; 0$，即 $0 &lt; h &lt; \infty$ 时梯形法均是稳定的。</li>
</ul>
<hr>
<h4 id="三阶、四阶-R-K-法"><a href="#三阶、四阶-R-K-法" class="headerlink" title="三阶、四阶 $R-K$ 法"></a>三阶、四阶 $R-K$ 法</h4><p><strong>例</strong></p>
<p>三阶、四阶 $R-K$ 法分别有：<br>$$<br>E(h\lambda) &#x3D; 1 + h\lambda + \frac{(h\lambda)^2}{2!} + \frac{(h\lambda)^3}{3!},<br>$$</p>
<p>$$<br>E(h\lambda) &#x3D; 1 + h\lambda + \frac{(h\lambda)^2}{2!} + \frac{(h\lambda)^3}{3!} + \frac{(h\lambda)^4}{4!}.<br>$$</p>
<p>由 $|E(h\lambda)| &lt; 1$，当 $\lambda$ 为实数时，得绝对稳定区间分别为：</p>
<p><span style="color:blue">三阶显式 $R-K$ 法：$-2.51 &lt; h\lambda &lt; 0$，即 $0 &lt; h &lt; -2.51 &#x2F; \lambda$</span></p>
<p><span style="color:blue">四阶显式 $R-K$ 法：$-2.78 &lt; h\lambda &lt; 0$，即 $0 &lt; h &lt; -2.78 &#x2F; \lambda$</span></p>
<hr>
<h4 id="中点公式"><a href="#中点公式" class="headerlink" title="中点公式"></a>中点公式</h4><p>证明中点公式<br>$$<br>\begin{cases}<br>y_{n+1} &#x3D; y_n + hK_2 \<br>K_1 &#x3D; f(x_n, y_n) \<br>K_2 &#x3D; f\left(x_n + \frac{h}{2}, y_n + \frac{h}{2}K_1\right)<br>\end{cases}<br>$$</p>
<p>是二阶的，并求其绝对稳定区间。</p>
<p><strong>分析</strong>　本题考查了中点公式及其绝对稳定区间。</p>
<p><strong>解</strong><br>$$<br>T_{n+1} &#x3D; y(x_{n+1}) - y(x_n) - h f\left(x_n + \frac{h}{2}, y(x_n) + \frac{h}{2} y’(x_n)\right)<br>$$</p>
<p>$$<br>&#x3D; y(x_n) + h y’(x_n) + \frac{h^2}{2} y’’(x_n) + \frac{1}{3!} h^3 y^{(3)}(x_n) + O(h^4)<br>$$</p>
<p>$$<br>&#x3D; y(x_n) + h ( f(x_n, y(x_n)) + \frac{h}{2} \frac{\partial f(x_n, y(x_n))}{\partial x}<br>$$</p>
<p>$$<br>+\frac{h}{2} y’(x_n) \frac{\partial f(x_n, y(x_n))}{\partial y}<br>$$</p>
<p>$$<br>+\frac{1}{2!} \left[ \frac{h}{2} \right]^2 \frac{\partial^2 f(x_n, y(x_n))}{\partial x^2}<br>$$</p>
<p>$$<br>+\frac{h}{2} \cdot \frac{h}{2} y’(x_n) \frac{\partial^2 f(x_n, y(x_n))}{\partial x \partial y}<br>$$</p>
<p>$$<br>+\left( \frac{h}{2} y’(x_n) \right)^2 \frac{\partial^2 f(x_n, y(x_n))}{\partial y^2} + O(h^3) )<br>$$</p>
<p>$$<br>&#x3D; \frac{h^3}{3!} y^{(3)}(x_n) - \frac{h^3}{8} \left[ \frac{\partial^2 f}{\partial x^2} +2 y’(x) \frac{\partial^2 f}{\partial x \partial y}<br>+(y’(x))^2 \frac{\partial^2 f}{\partial y^2} \right]_{(x_n, y(x_n))} + O(h^4) &#x3D; O(h^3)<br>$$</p>
<p>因此，中点公式是二阶的。</p>
<p>对模型方程 $y’ &#x3D; \lambda y\ ( \operatorname{Re}(\lambda) &lt; 0 )$ 使用中点公式求解，得：</p>
<p>$$<br>y_{n+1} &#x3D; \left[ 1 + \lambda h + \frac{1}{2} (\lambda h)^2 \right] y_n<br>$$</p>
<p>易知，当<br>$$<br>\left| 1 + \lambda h + \frac{1}{2} (\lambda h)^2 \right| &lt;1<br>$$<br>时，中点公式绝对稳定。特别当 $\lambda$ 为实数且 $\lambda &lt; 0$ 时，上不等式的解为：</p>
<p>$$<br>-2 &lt; \lambda h &lt; 0<br>$$</p>
<hr>
<h4 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h4><p> 对于初值问题<br>$$<br>y’ &#x3D; -100(y - x^2) + 2x, \quad y(0) &#x3D; 1.<br>$$</p>
<p>(1) 用欧拉法求解，步长 $h$ 取什么范围的值，才能使计算稳定。  </p>
<p>(2) 若用四阶龙格–库塔方法计算，步长 $h$ 如何选取？<br>(3) 若用梯形公式计算，步长 $h$ 有无限制。</p>
<p><strong>解</strong></p>
<p>(1) 原方程为<br>$$<br>y’ &#x3D; -100y+100x^2+2x<br>$$</p>
<p>稳定性分析主要关注<strong>齐次方程</strong>部分$y’ &#x3D; -100y$</p>
<p>用欧拉法求解题中初值问题，递推公式为<br>$$<br>y_{n+1}&#x3D;y_n+hf(x_n,y_n)&#x3D;y_n+h(-100y_n)&#x3D;(1-100h)y_n<br>$$</p>
<p>故当<br>$$<br>|1 + (-100h)| \leq 1<br>$$</p>
<p>时绝对稳定，即当 $0 &lt; h \leq 0.02$ 时欧拉法绝对稳定。</p>
<hr>
<p>(2) 当 $\lambda h &#x3D; -100h$ 满足不等式</p>
<p>$$<br>\left| 1 + \lambda h + \frac{1}{2}(\lambda h)^2 + \frac{1}{3!}(\lambda h)^3 + \frac{1}{4!}(\lambda h)^4 \right| \leq 1<br>$$</p>
<p>时，四阶龙格–库塔法绝对稳定，也即当 $\lambda h$ 满足</p>
<p>$$<br>-2.785 \leq \lambda h &lt; 0, \quad 0 &lt; h \leq \frac{-2.785}{\lambda} &#x3D; \frac{2.785}{100} &#x3D; 0.02785<br>$$</p>
<p>时绝对稳定。</p>
<p>(3) 对于梯形公式，当 $\lambda h &#x3D; -100h \in (-\infty, 0)$ 时，绝对稳定，<br>此条件 $\forall h \in (0, +\infty)$ 都成立，即梯形法对 $h$ 无限制。</p>
<hr>
<p><strong>例：</strong> 隐式龙格-库塔法  </p>
<span>
$$
\begin{cases}
y_{i+1} = y_i + h[\lambda_1 K_1 + \cdots + \lambda_m K_m] \\
K_j = f\left(x_i + \alpha_j h, y_i + \beta_{j1} h K_1 + \cdots + \beta_{jm} h K_m \right), \quad (j = 1, \ldots, m)
\end{cases}
$$

</span>

<p>其中 <strong>2 阶方法</strong>：</p>
<span>
$$
\begin{cases}
y_{i+1} = y_i + h K_1 \\
K_1 = f\left(x_i + \frac{h}{2}, y_i + \frac{h}{2} K_1\right)
\end{cases}
$$

</span>

<p>该方法的<strong>绝对稳定区域</strong>为图中左侧阴影区域（无条件稳定）。</p>
<p><img src="/blog/image/Snipaste_2025-04-28_15-16-58.png"></p>
<p>而<strong>显式 1～4 阶方法</strong>的绝对稳定区域如下图所示（随阶数增加扩大但仍有限）：</p>
<p><img src="/blog/image/Snipaste_2025-04-28_15-17-09.png"></p>
<p>图示区域说明：</p>
<ul>
<li>$k&#x3D;1$ 到 $k&#x3D;4$ 分别表示显式龙格-库塔法从一阶到四阶的稳定区域</li>
</ul>
<h2 id="线性多步法"><a href="#线性多步法" class="headerlink" title="线性多步法"></a>线性多步法</h2><p>用<strong>若干</strong>节点处的 $y$ 及 $y’$ 值的<strong>线性组合</strong>来近似 $y(x_{n+1})$。其通式可写为：</p>
<p>$$<br>y_{n+1} &#x3D; \alpha_0 y_n + \alpha_1 y_{n-1} + \dots + \alpha_k y_{n-k} + h\left( \beta_{-1} f_{n+1} + \beta_0 f_n + \beta_1 f_{n-1} + \dots + \beta_k f_{n-k} \right)<br>$$</p>
<ul>
<li><p>当$\beta_{-1} \neq 0$时，为隐式公式</p>
</li>
<li><p>当$\beta_{-1} &#x3D; 0$时，为显式公式</p>
</li>
</ul>
<h3 id="基于数值积分的构造法"><a href="#基于数值积分的构造法" class="headerlink" title="基于数值积分的构造法"></a>基于数值积分的构造法</h3><p>将 $y’ &#x3D; f(x, y)$ 在 $[x_n, x_{n+1}]$ 上积分，得到：</p>
<p>$$<br>y(x_{n+1}) - y(x_n) &#x3D; \int_{x_n}^{x_{n+1}} f(x, y(x)) , dx<br>$$</p>
<p>只要<strong>近似地算出右边的积分</strong> $I_n \approx \int_{x_n}^{x_{n+1}} f(x, y(x)) , dx$，则可通过<br>$$<br>y_{n+1} &#x3D; y_n + I_n<br>$$<br>近似 $y(x_{n+1})$。而<strong>选用不同近似式 $I_n$</strong>，可得到不同的计算公式。</p>
<h3 id="亚当姆斯显式公式"><a href="#亚当姆斯显式公式" class="headerlink" title="亚当姆斯显式公式"></a>亚当姆斯显式公式</h3><p>利用 $k+1$ 个节点上的被积函数值 $f_n, f_{n-1}, \ldots, f_{n-k}$ 构造 $k$ 阶牛顿<strong>后插多项式</strong> $N_k(x_n + th)$，$t \in [0,1]$，有：</p>
<p>$$<br>\int_{x_n}^{x_{n+1}} f(x, y(x)) dx &#x3D; \int_0^1 N_k(x_n + th) h , dt + \int_0^1 R_k(x_n + th) h , dt<br>$$</p>
<p>从而得<strong>显式计算公式</strong>：<br>$$<br>y_{n+1} &#x3D; y_n + h \int_0^1 N_k(x_n + th) , dt<br>$$</p>
<p>局部截断误差为：<br>$$<br>T_{n+1} &#x3D; y(x_{n+1}) - y_{n+1} &#x3D; h \int_0^1 R_k(x_n + th) , dt<br>$$</p>
<hr>
<p><strong>例：</strong> 当 $k &#x3D; 1$ 时，有<br>$$<br>N_1(x_n + th) &#x3D; f_n + t \nabla f_n &#x3D; f_n + t(f_n - f_{n-1})<br>$$</p>
<p>代入得：<br>$$<br>y_{n+1} &#x3D; y_n + h \int_0^1 [f_n + t(f_n - f_{n-1})] dt &#x3D; y_n + \frac{h}{2} (3f_n - f_{n-1})<br>$$</p>
<p>局部截断误差为：<br>$$<br>T_{n+1} &#x3D; h \int_0^1  \frac{d^2}{dx^2} f(\xi_x, y(\xi_x)) \cdot \frac{1}{2!} th(t+1) h , dt &#x3D; \frac{5}{12} h^3 y’’’(\xi_n)<br>$$</p>
<hr>
<p><strong>注：</strong> 一般有<br>$$<br>T_{n+1} &#x3D; B_k h^{k+2} y^{(k+2)} (\xi_n)<br>$$<br>其中 $B_k$ 与 $y_{n+1}$ 计算公式中的系数 $f_n, f_{n-1}, \dots, f_{n-k}$ 各项的系数均可表示得到。</p>
<table>
<thead>
<tr>
<th>k</th>
<th>$f_n$</th>
<th>$f_{n-1}$</th>
<th>$f_{n-2}$</th>
<th>$f_{n-3}$</th>
<th>…</th>
<th>$B_k$</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>1</td>
<td></td>
<td></td>
<td></td>
<td>…</td>
<td>1</td>
</tr>
<tr>
<td>1</td>
<td>$\frac{3}{2}$</td>
<td>$-\frac{1}{2}$</td>
<td></td>
<td></td>
<td>…</td>
<td>$\frac{1}{2}$</td>
</tr>
<tr>
<td>2</td>
<td>$\frac{23}{12}$</td>
<td>$-\frac{16}{12}$</td>
<td>$\frac{5}{12}$</td>
<td></td>
<td>…</td>
<td>$\frac{5}{12}$</td>
</tr>
<tr>
<td>3</td>
<td>$\frac{55}{24}$</td>
<td>$-\frac{59}{24}$</td>
<td>$\frac{37}{24}$</td>
<td>$-\frac{9}{24}$</td>
<td>…</td>
<td>$\frac{251}{720}$</td>
</tr>
</tbody></table>
<hr>
<p><strong>常用的</strong> $k &#x3D; 3$ <strong>的 4 阶亚当姆斯显式公式</strong>：<br>$$<br>y_{n+1} &#x3D; y_n + \frac{h}{24} \left( 55 f_n - 59 f_{n-1} + 37 f_{n-2} - 9 f_{n-3} \right)<br>$$<br><strong>常用的</strong> $k &#x3D; 3$ <strong>的 4 阶亚当姆斯隐式公式</strong>：<br>$$<br>y_{n+1} &#x3D; y_n + \frac{h}{24} \left( 9 f_{n+1} + 19 f_n - 5 f_{n-1} + f_{n-2} \right)<br>$$</p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
  </entry>
  <entry>
    <title>数值分析-数值积分</title>
    <url>/blog/2025/03/26/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90-%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>此文章包含数值积分部分—————————————————————————————————————————————————————-</p>
<h1 id="数值积分"><a href="#数值积分" class="headerlink" title="数值积分"></a>数值积分</h1><h2 id="记忆内容汇总"><a href="#记忆内容汇总" class="headerlink" title="记忆内容汇总"></a>记忆内容汇总</h2><blockquote>
<h3 id="梯形公式"><a href="#梯形公式" class="headerlink" title="梯形公式"></a>梯形公式</h3><p><strong>n&#x3D;1</strong></p>
<p><strong>积分公式</strong>:<br>$$<br>\int_{a}^{b} f(x) dx \approx \frac{b-a}{2} \left[ f(a) + f(b) \right]<br>$$</p>
<p><strong>代数精度</strong>: 1</p>
<p><strong>余项公式</strong>:<br>$$<br>R[f] &#x3D;-\frac{1}{12} (b-a)^3 f’’(\xi)<br>$$</p>
<p>$$<br>\xi \in [a,b]<br>$$</p>
<h3 id="辛普森公式"><a href="#辛普森公式" class="headerlink" title="辛普森公式"></a>辛普森公式</h3><p><strong>n&#x3D;2</strong></p>
<p><strong>积分公式</strong>:<br>$$<br>\int_{a}^{b} f(x) dx \approx \frac{b-a}{6} \left[ f(a) + 4f\left( \frac{a+b}{2} \right) + f(b) \right]<br>$$</p>
<p><strong>代数精度</strong>: 3</p>
<p><strong>余项公式</strong>:<br>$$<br>R[f] &#x3D; -\frac{1}{2880} (b-a)^5 f^{(4)}(\xi)<br>$$</p>
<p>$$<br>\xi \in (a,b)<br>$$</p>
<h3 id="复化梯形公式"><a href="#复化梯形公式" class="headerlink" title="复化梯形公式"></a>复化梯形公式</h3><p>$$<br>\int_a^b f(x) dx &#x3D; \frac{h}{2} \left[ f(a) + 2\sum_{k&#x3D;1}^{n-1} f(x_k) + f(b) \right]<br>$$</p>
<p>$$<br>R[f] &#x3D; -\frac{(b - a)}{12} h^2 f’’(\xi), \quad \xi \in (a, b)<br>$$</p>
<h3 id="复化辛普森公式"><a href="#复化辛普森公式" class="headerlink" title="复化辛普森公式"></a>复化辛普森公式</h3><p>$$<br>\int_a^b f(x) dx \approx \frac{h}{6} \left[ f(a) + 4\sum_{k&#x3D;0}^{n-1} f\left(x_{k+\frac{1}{2}}\right) + 2\sum_{k&#x3D;1}^{n-1} f(x_k) + f(b) \right]<br>$$</p>
<p>$$<br>R[f] &#x3D;-\frac{b - a}{2880} h^4 f^{(4)}(\xi), \quad \xi \in (a,b)<br>$$</p>
</blockquote>
<h2 id="数值积分近似公式"><a href="#数值积分近似公式" class="headerlink" title="数值积分近似公式"></a>数值积分近似公式</h2><h3 id="梯形公式-1"><a href="#梯形公式-1" class="headerlink" title="梯形公式"></a>梯形公式</h3><p>$$<br>\int _{a}^{b} f(x) dx \approx \frac{(b - a)}{2} \left[ f(a) + f(b) \right]<br>$$</p>
<h3 id="矩形公式"><a href="#矩形公式" class="headerlink" title="矩形公式"></a>矩形公式</h3><p>$$<br>\int _{a}^{b} f(x) dx \approx (b - a) f\left( \frac{a + b}{2} \right)<br>$$</p>
<h3 id="辛普森公式（Simpson’s-Rule）"><a href="#辛普森公式（Simpson’s-Rule）" class="headerlink" title="辛普森公式（Simpson’s Rule）"></a>辛普森公式（Simpson’s Rule）</h3><p>$$<br>\int _{a}^{b} f(x) dx \approx \frac{(b - a)}{6} \left[ f(a) + 4f\left( \frac{a + b}{2} \right) + f(b) \right]<br>$$</p>
<h3 id="机械求积公式"><a href="#机械求积公式" class="headerlink" title="机械求积公式"></a>机械求积公式</h3><p>一般的，我们取区间 $[a, b]$ 内若干个节点 $x_k$ 处的函数值 $f(x_k)$，通过加权平均的方法近似地得出平均高度。这类求积公式的一般形式为：</p>
<p>$$<br>\int_a^b f(x) , dx \approx \sum_{k&#x3D;0}^n A_k f(x_k)<br>$$</p>
<p>式中：</p>
<ul>
<li>$x_k$ 称为<strong>求积节点</strong></li>
<li>$A_k$ 称为<strong>求积系数</strong>，亦称伴随节点 $x_k$ 的<strong>权</strong>。</li>
</ul>
<h2 id="代数精度的概念"><a href="#代数精度的概念" class="headerlink" title="代数精度的概念"></a>代数精度的概念</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>如果某个求积公式对于次数不超过 $m$ 的多项式均能准确成立，但对于 $m+1$ 次多项式就不一定准确，则称该求积公式具有 <strong>$m$ 次代数精度</strong>。</p>
<p>即若某个求积公式所对应的误差 $R[f]$ 满足：</p>
<span>
$$
\begin{cases}
R[P_k] = 0 & \text{对任意 } k \leq m \text{ 阶的多项式成立} \\
R[P_{m+1}] \neq 0 & \text{对某个 } m+1 \text{ 阶多项式不成立}
\end{cases}
$$
</span>

<p>则称此求积公式的代数精度为 $m$</p>
<h3 id="实现条件"><a href="#实现条件" class="headerlink" title="实现条件"></a>实现条件</h3><p>欲使求积公式有 $m$ 次代数精度，需满足它对 $f(x) &#x3D; 1, x, x^2, \ldots, x^m$ 都能准确成立：<br>$$<br>\sum_{k&#x3D;0}^n A_k x_k^\alpha &#x3D; \int_a^b x^\alpha dx \quad (\alpha &#x3D; 0,1,2,\ldots,m)<br>$$<br>具体表现为：</p>
<span>
$$
\begin{aligned}
\sum_{k=0}^n A_k &= b - a \\
\sum_{k=0}^n A_k x_k &= \frac{1}{2}(b^2 - a^2) \\
\sum_{k=0}^n A_k x_k^2 &= \frac{1}{3}(b^3 - a^3) \\
&\vdots \\
\sum_{k=0}^n A_k x_k^m &= \frac{1}{m+1}(b^{m+1} - a^{m+1})
\end{aligned}
$$

</span>

<blockquote>
<p><strong>定理</strong></p>
<p>在区间 $[a,\ b]$ 上，对于给定的 $n+1$ 个互异节点：<br>$$<br>a \leq x_0 &lt; x_1 &lt; \ldots &lt; x_n \leq b<br>$$<br>总存在求积系数 $A_0,\ A_1,\ \ldots,\ A_n$，使求积公式至少具有 <strong>$n$</strong> 次代数精度。</p>
</blockquote>
<h2 id="插值型的求积公式"><a href="#插值型的求积公式" class="headerlink" title="插值型的求积公式"></a>插值型的求积公式</h2><p>设给定一组节点：<br>$$<br>a \leq x _ { 0 } &lt; x _ { 1 } &lt; \cdots &lt; x _ { n } \leq b<br>$$<br>且已知函数 $ f(x) $ 在这些节点上的值，作插值函数：<br>$$<br>L_{n} ( x ) &#x3D; \sum _{ k&#x3D;0 }^{ n } l _{ k } ( x ) f ( x _{ k } )<br>$$<br>其中 $ l _{ k } ( x ) $ 为插值基函数。</p>
<h3 id="积分近似表达式"><a href="#积分近似表达式" class="headerlink" title="积分近似表达式"></a>积分近似表达式</h3><p>将积分 $ I &#x3D; \int _{ a }^{ b } f(x) dx $ 近似为：</p>
<span>
$$
I _{ n } = \int _{ a }^{ b } L _{ n } ( x ) dx =\int_a^b \sum_{k=0}^{n} f(x_k) l_k(x) dx \\
= \sum _{ k=0 }^{ n } \left( \int _{ a }^{ b } l _{ k } ( x ) dx \right) f ( x _{ k } )=\sum_{k=0}^{n} A_k f(x_k)
$$

</span>

<p>求积系数：</p>
<span>
$$
A _{ k } = \int _{ a }^{ b } l _{ k } ( x ) dx \quad (k = 0,1,\ldots,n) \\
$$
</span>

<span>
$$
l_k(x) = \prod_{\substack{j=0 \\ j \neq k}}^{n} \frac{x - x_j}{x_k - x_j}
$$

</span>

<p><strong>最终得到插值型求积公式：</strong><br>$$<br>I _{ n } &#x3D; \sum _{ k&#x3D;0 }^{ n } A _{ k } f ( x _{ k } )<br>$$</p>
<h3 id="余项公式"><a href="#余项公式" class="headerlink" title="余项公式"></a>余项公式</h3><p>插值型求积公式的余项为：<br>$$<br>R[f] &#x3D; I - I_n &#x3D; \int_a^b \frac{f^{(n+1)}(\xi)}{(n+1)!} \omega_{n+1}(x) dx<br>$$<br>式中 $\xi$ 与变量 $x$ 有关，<br>$$<br>\omega_{n+1}(x) &#x3D; (x - x_0)(x - x_1) \cdots (x - x_n)<br>$$</p>
<blockquote>
<p><strong>定理</strong></p>
<p>形如<br>$$<br>\sum_{k&#x3D;0}^n A_k f(x_k)<br>$$<br>的求积公式至少有 $n$ 次代数精度 $\Leftrightarrow$ 该公式为插值型（即：$A_k &#x3D; \int_a^b l_k(x) dx$)</p>
</blockquote>
<h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><blockquote>
<p><img src="/blog/image/IMG_0148.jpg"></p>
</blockquote>
<blockquote>
<p><img src="/blog/image/Snipaste_2025-06-04_09-35-05.png"></p>
<p><img src="/blog/image/IMG_0149.jpg"></p>
</blockquote>
<blockquote>
<p><img src="/blog/image/Snipaste_2025-06-16_16-21-07.png"></p>
<p><img src="/blog/image/Snipaste_2025-06-16_16-21-15.png"></p>
<p><img src="/blog/image/Snipaste_2025-06-16_16-21-19.png"></p>
</blockquote>
<h2 id="牛顿—柯特斯公式"><a href="#牛顿—柯特斯公式" class="headerlink" title="牛顿—柯特斯公式"></a>牛顿—柯特斯公式</h2><p>节点等距分布时的求积公式<br>$$<br>x _ { k } &#x3D; a + k h<br>$$<br>$$<br>h &#x3D; \frac { b - a } { n }<br>$$<br>$$<br>k &#x3D; 0,\ 1,\ \cdots ,\ n<br>$$</p>
<p><strong>积分系数公式</strong><br>$$<br>A _ { k } &#x3D; \int _ { x _ { 0 } } ^ { x _ { n } } \prod _ { j \neq k } \frac { ( x - x _ { j } ) } { ( x _ { k } - x _ { j } ) } d x<br>$$</p>
<p>令 $x &#x3D; a + t h$，则：<br>$$<br>A_k&#x3D; \int _ { 0 } ^ { n } \prod _ { j \neq k } \frac { ( t - j ) h } { ( k - j ) h } \times h d t<br>$$<br>$$<br>&#x3D; \frac { ( b - a ) ( -1 ) ^ { n - k } } { n k ! ( n - k ) ! } \int _ { 0 } ^ { n } \prod _ { j \neq k } ( t - j ) d t \<br>&#x3D;(b-a)C _ { k } ^ { ( n ) }<br>$$</p>
<blockquote>
<ol>
<li><strong>Cotes系数性质</strong>：</li>
</ol>
<ul>
<li>仅取决于 $n$ 和 $k$</li>
<li>与函数 $f(x)$ 及积分区间 $[a,\ b]$ 均无关</li>
</ul>
<ol start="2">
<li><strong>Cotes系数表示</strong>：</li>
</ol>
<ul>
<li>记作<br>$$<br>C _ { k } ^ { ( n ) }&#x3D; \frac {( -1 ) ^ { n - k } } { n k ! ( n - k ) ! } \int _ { 0 } ^ { n } \prod _ { j \neq k } ( t - j ) d t<br>$$</li>
</ul>
</blockquote>
<h3 id="柯特斯系数表-Newton-Cotes-公式"><a href="#柯特斯系数表-Newton-Cotes-公式" class="headerlink" title="柯特斯系数表 (Newton-Cotes 公式)"></a>柯特斯系数表 (Newton-Cotes 公式)</h3><table>
<thead>
<tr>
<th>$n$</th>
<th>$C_0^{(n)}$</th>
<th>$C_1^{(n)}$</th>
<th>$C_2^{(n)}$</th>
<th>$C_3^{(n)}$</th>
<th>$C_4^{(n)}$</th>
<th>$C_5^{(n)}$</th>
<th>$C_6^{(n)}$</th>
<th>$C_7^{(n)}$</th>
<th>$C_8^{(n)}$</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>$\frac{1}{2}$</td>
<td>$\frac{1}{2}$</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>$\frac{1}{6}$</td>
<td>$\frac{2}{3}$</td>
<td>$\frac{1}{6}$</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>3</td>
<td>$\frac{1}{8}$</td>
<td>$\frac{3}{8}$</td>
<td>$\frac{3}{8}$</td>
<td>$\frac{1}{8}$</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>4</td>
<td>$\frac{7}{90}$</td>
<td>$\frac{16}{45}$</td>
<td>$\frac{2}{15}$</td>
<td>$\frac{16}{45}$</td>
<td>$\frac{7}{90}$</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>5</td>
<td>$\frac{19}{288}$</td>
<td>$\frac{25}{96}$</td>
<td>$\frac{25}{144}$</td>
<td>$\frac{25}{144}$</td>
<td>$\frac{25}{96}$</td>
<td>$\frac{19}{288}$</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>6</td>
<td>$\frac{41}{840}$</td>
<td>$\frac{9}{35}$</td>
<td>$\frac{9}{280}$</td>
<td>$\frac{34}{105}$</td>
<td>$\frac{9}{280}$</td>
<td>$\frac{9}{35}$</td>
<td>$\frac{41}{840}$</td>
<td></td>
<td></td>
</tr>
<tr>
<td>7</td>
<td>$\frac{715}{17280}$</td>
<td>$\frac{3577}{17280}$</td>
<td>$\frac{1323}{17280}$</td>
<td>$\frac{2989}{17280}$</td>
<td>$\frac{2989}{17280}$</td>
<td>$\frac{1323}{17280}$</td>
<td>$\frac{3577}{17280}$</td>
<td>$\frac{715}{17280}$</td>
<td></td>
</tr>
<tr>
<td>8</td>
<td>$\frac{989}{28350}$</td>
<td>$\frac{5888}{28350}$</td>
<td>$\frac{-928}{28350}$</td>
<td>$\frac{10496}{28350}$</td>
<td>$\frac{-4540}{28350}$</td>
<td>$\frac{10496}{28350}$</td>
<td>$\frac{-928}{28350}$</td>
<td>$\frac{5888}{28350}$</td>
<td>$\frac{989}{28350}$</td>
</tr>
</tbody></table>
<blockquote>
<p>当 $n \geq 8$ 时，柯特斯系数有正有负，这时稳定性得不到保证。</p>
</blockquote>
<h3 id="梯形公式-2"><a href="#梯形公式-2" class="headerlink" title="梯形公式"></a>梯形公式</h3><p><strong>n&#x3D;1</strong></p>
<p><strong>求积系数</strong>:<br>$$<br>C_0^{(1)} &#x3D; \frac{1}{2}, \quad C_1^{(1)} &#x3D; \frac{1}{2}<br>$$</p>
<p><strong>积分公式</strong>:<br>$$<br>\int_{a}^{b} f(x) dx \approx \frac{b-a}{2} \left[ f(a) + f(b) \right]<br>$$</p>
<p><strong>代数精度</strong>: 1</p>
<p><strong>余项公式</strong>:<br>$$<br>R[f] &#x3D; -\frac{1}{12} h^3 f’’(\xi)&#x3D;-\frac{1}{12} (b-a)^3 f’’(\xi)<br>$$</p>
<p>$$<br> \xi \in [a,b], \quad h &#x3D; \frac{b-a}{1}<br>$$</p>
<h3 id="辛普森公式-1"><a href="#辛普森公式-1" class="headerlink" title="辛普森公式"></a>辛普森公式</h3><p><strong>n&#x3D;2</strong></p>
<p><strong>求积系数</strong>:<br>$$<br>C_0^{(2)} &#x3D; \frac{1}{6}, \quad C_1^{(2)} &#x3D; \frac{2}{3}, \quad C_2^{(2)} &#x3D; \frac{1}{6}<br>$$</p>
<p><strong>积分公式</strong>:<br>$$<br>\int_{a}^{b} f(x) dx \approx \frac{b-a}{6} \left[ f(a) + 4f\left( \frac{a+b}{2} \right) + f(b) \right]<br>$$</p>
<p><strong>代数精度</strong>: 3</p>
<p><strong>余项公式</strong>:<br>$$<br>R[f] &#x3D; -\frac{1}{90} h^5 f^{(4)}(\xi)&#x3D;-\frac{1}{2880} (b-a)^5 f^{(4)}(\xi)<br>$$</p>
<p>$$<br>\xi \in (a,b), \quad h &#x3D; \frac{b-a}{2}<br>$$</p>
<p><u>3. 辛普森3&#x2F;8法则 (Simpson’s 3&#x2F;8 Rule) - <strong>n&#x3D;3</strong></u></p>
<p><strong>代数精度</strong>: 3</p>
<p><strong>余项公式</strong>:<br>$$<br>R[f] &#x3D; -\frac{3}{80} h^5 f^{(4)}(\xi), \quad \xi \in (a,b), \quad h &#x3D; \frac{b-a}{3}<br>$$</p>
<p><u>4. 科特斯公式- <strong>n&#x3D;4</strong></u></p>
<p><strong>代数精度</strong>: 5</p>
<p><strong>余项公式</strong>:<br>$$<br>R[f] &#x3D; -\frac{8}{945} h^7 f^{(6)}(\xi), \quad \xi \in (a,b), \quad h &#x3D; \frac{b-a}{4}<br>$$</p>
<blockquote>
<p>$n$为偶数阶的$Newton-Cotes$公式至少有$n+1$次代数精度</p>
<p>$n$为奇数阶的$Newton-Cotes$公式至少有$n$次代数精度</p>
</blockquote>
<h3 id="例题-1"><a href="#例题-1" class="headerlink" title="例题"></a>例题</h3><blockquote>
<p><img src="/blog/image/Snipaste_2025-06-04_15-02-57.png"></p>
</blockquote>
<h2 id="求积公式的收敛性与稳定性"><a href="#求积公式的收敛性与稳定性" class="headerlink" title="求积公式的收敛性与稳定性"></a>求积公式的收敛性与稳定性</h2><h3 id="收敛性定义"><a href="#收敛性定义" class="headerlink" title="收敛性定义"></a>收敛性定义</h3><p>当求积公式$\int_a^b f(x) , dx \approx \sum_{k&#x3D;0}^n A_k f(x_k)$满足：<br>$$<br>\lim_{\substack{n \to \infty \ h \to 0}} \sum_{k&#x3D;0}^{n} A_k f(x_k) &#x3D; \int_{a}^{b} f(x) , dx<br>$$<br>其中：<br>$$<br>h &#x3D; \max_{1 \leq i \leq n} (x_i - x_{i-1})<br>$$<br>则称该求积公式是<strong>收敛的</strong>。</p>
<h3 id="稳定性定义"><a href="#稳定性定义" class="headerlink" title="稳定性定义"></a>稳定性定义</h3><p>对任给 $\epsilon &gt; 0$，若存在 $\delta &gt; 0$，使得只要满足：<br>$$<br>|f(x_k) - \tilde{f}_k| &lt; \delta<br>$$</p>
<p>就有：</p>
<p>$$<br>|\sum_{k&#x3D;0}^{n} A_k \cdot [f(x_k) - \tilde{f}_k]| \leq \epsilon<br>$$<br>成立，则称该求积公式是<strong>稳定的</strong>。</p>
<blockquote>
<p><span style="color:red">定理</span></p>
<p>若求积公式<br>$$<br>\int_a^b f(x) , dx \approx \sum_{k&#x3D;0}^n A_k f(x_k)<br>$$<br>其中系数满足<br>$$<br>A_k &gt; 0 \quad (k &#x3D; 0, 1, \ldots, n)<br>$$</p>
<p>则此求积公式是稳定的。</p>
</blockquote>
<h2 id="复化求积"><a href="#复化求积" class="headerlink" title="复化求积"></a>复化求积</h2><p><strong>基本概念</strong></p>
<p>高次插值有Runge现象，故采用分段低次插值<br>⇒ 分段低次合成的Newton-Cotes复化求积公式</p>
<h3 id="复化梯形公式-1"><a href="#复化梯形公式-1" class="headerlink" title="复化梯形公式"></a>复化梯形公式</h3><p><strong>1. 区间划分</strong></p>
<p>$$<br> h &#x3D; \frac{b - a}{n}, \quad x_k &#x3D; a + kh \quad (k &#x3D; 0, \ldots, n)<br>$$</p>
<p><strong>2. 子区间积分近似</strong></p>
<p>在每个$[x_{k-1}, x_k]$上使用梯形公式：<br>$$<br>\int_{x_{k-1}}^{x_k} f(x) dx \approx \frac{x_k - x_{k-1}}{2} [f(x_{k-1}) + f(x_k)], \quad k &#x3D; 1, \ldots, n<br>$$</p>
<p><strong>3. 整体复化公式</strong><br>$$<br>\begin{aligned}<br>\int_a^b f(x) dx &amp;\approx \sum_{k&#x3D;1}^n \frac{h}{2} [f(x_{k-1}) + f(x_k)] \<br>&amp;&#x3D; \frac{h}{2} \left[ f(a) + 2\sum_{k&#x3D;1}^{n-1} f(x_k) + f(b) \right] \<br>&amp;&#x3D; T_n<br>\end{aligned}<br>$$</p>
<p><strong>4.误差分析</strong></p>
<p>$$<br>\begin{aligned}<br>R[f] &amp;&#x3D; \sum_{k&#x3D;1}^n \left[ -\frac{h^3}{12} f’’(\xi_k) \right] \<br>&amp;&#x3D; -\frac{h^2}{12} (b - a) \frac{\sum_{k&#x3D;1}^n f’’(\xi_k)}{n} \quad \text{&#x2F;* 中值定理 *&#x2F;} \<br>&amp;&#x3D; -\frac{(b - a)}{12} h^2 f’’(\xi), \quad \xi \in (a, b)<br>\end{aligned}<br>$$</p>
<h3 id="复化Simpson公式"><a href="#复化Simpson公式" class="headerlink" title="复化Simpson公式"></a>复化Simpson公式</h3><p><strong>1. 区间划分</strong></p>
<p>$$<br> h &#x3D; \frac{b - a}{n}<br>$$</p>
<p>$$<br> x_k &#x3D; a + kh \quad (k &#x3D; 0, \ldots, n)<br>$$</p>
<p><strong>2. 子区间积分近似</strong></p>
<p>在$[x_k, x_{k+1}]$上的近似：<br>$$<br>\int_{x_k}^{x_{k+1}} f(x) dx \approx \frac{h}{6} \left[ f(x_k) + 4f\left(x_{k+\frac{1}{2}}\right) + f(x_{k+1}) \right]<br>$$</p>
<p><strong>3. 整体复化公式</strong><br>$$<br>\begin{aligned}<br>\int_a^b f(x) dx &amp;\approx \frac{h}{6} \left[ f(a) + 4\sum_{k&#x3D;0}^{n-1} f\left(x_{k+\frac{1}{2}}\right) + 2\sum_{k&#x3D;1}^{n-1} f(x_k) + f(b) \right] \<br>&amp;&#x3D; S_n<br>\end{aligned}<br>$$</p>
<p><strong>4.误差分析</strong><br>$$<br>R[f] &#x3D; -\frac{b - a}{180} \left( \frac{h}{2} \right)^4 f^{(4)}(\xi)&#x3D;-\frac{b - a}{2880} h^4 f^{(4)}(\xi), \quad \xi \in (a,b)<br>$$</p>
<h3 id="例题-2"><a href="#例题-2" class="headerlink" title="例题"></a>例题</h3><blockquote>
<p>地球轨道是一个椭圆，其周长为<br>$$<br>S &#x3D; 4a \int_{0}^{\pi&#x2F;2} \sqrt{1-\left(\frac{c}{a}\right)^2 \sin^2 \theta},d\theta<br>$$<br>其中 $a$ 是椭圆的半长轴，$c$ 是地球中心与轨道中心（椭圆中心）的距离。记 $h$ 为近地点距离，$H$ 为远地点距离，$R &#x3D; 6371\ \text{km}$ 为地球半径，则<br>$$<br>a &#x3D; \frac{2R + H + h}{2},\qquad<br>c &#x3D; \frac{H - h}{2}<br>$$<br>我国第一颗人造地球卫星近地点距离 $h &#x3D; 439\ \text{km}$，远地点距离 $H &#x3D; 2384\ \text{km}$。  试求卫星轨道的周长（用复化辛普森公式，$n &#x3D; 3$）。</p>
<p><strong>解</strong></p>
<p>$$<br>a &#x3D; \frac{2R + H + h}{2}&#x3D; 7782.5<br>$$</p>
<p>$$<br>c &#x3D; \frac{H - h}{2} &#x3D; 972.5<br>$$</p>
<p>$$<br>e &#x3D; \frac{c}{a} \approx 0.125.<br>$$</p>
<h4 id="2-计算积分"><a href="#2-计算积分" class="headerlink" title="2. 计算积分"></a>2. 计算积分</h4><p>$$<br>I &#x3D; \int_{0}^{\pi&#x2F;2} \sqrt{1 - e^{2}\sin^{2}\theta},d\theta.<br>$$</p>
<p>复化辛普森公式（$n &#x3D; 3$，步长 $h&#x3D;\dfrac{\pi}{6}$，$\theta_i&#x3D;\dfrac{\pi}{6}i$ ）</p>
<table>
<thead>
<tr>
<th>$i$</th>
<th>$\theta_i$ (rad)</th>
<th>$f(\theta_i)&#x3D;\sqrt{1-e^{2}\sin^{2}\theta_i}$</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>$0$</td>
<td>$1.000000$</td>
</tr>
<tr>
<td>1&#x2F;2</td>
<td>$\dfrac{\pi}{12}$</td>
<td>$0.999$</td>
</tr>
<tr>
<td>1</td>
<td>$\dfrac{\pi}{6}$</td>
<td>$0.998$</td>
</tr>
<tr>
<td>3&#x2F;2</td>
<td>$\dfrac{\pi}{4}$</td>
<td>$0.996$</td>
</tr>
<tr>
<td>2</td>
<td>$\dfrac{\pi}{3}$</td>
<td>$0.994$</td>
</tr>
<tr>
<td>5&#x2F;2</td>
<td>$\dfrac{5\pi}{12}$</td>
<td>$0.993$</td>
</tr>
<tr>
<td>3</td>
<td>$\dfrac{\pi}{2}$</td>
<td>$0.992$</td>
</tr>
</tbody></table>
<p>$$<br>I \approx \frac{h}{6}\Bigl[f_0 + 4(f_1 + f_3 + f_5) + 2(f_2 + f_4) + f_6\Bigr]<br>     \approx 1.5645<br>$$</p>
<h4 id="3-求椭圆轨道周长"><a href="#3-求椭圆轨道周长" class="headerlink" title="3. 求椭圆轨道周长"></a>3. 求椭圆轨道周长</h4><p>$$<br>S &#x3D; 4a,I &#x3D; 4 \times 7782.5 \times 1.5645 \approx48703.29<br>$$</p>
<h3 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h3><p>卫星椭圆轨道周长约为<br>$$<br>\boxed{S \approx 4.87\times10^{4}\ \text{km}}.<br>$$</p>
</blockquote>
<blockquote>
<p><img src="/blog/image/Snipaste_2025-06-04_10-48-03.png"></p>
<p><img src="/blog/image/IMG_0150.jpg"></p>
</blockquote>
<blockquote>
<p>计算积分：<br>$$<br>I &#x3D; \int_{0}^{1} e^{x} dx<br>$$</p>
<p>要求：</p>
<ol>
<li>使用复化梯形公式和复化辛普森公式</li>
<li>截断误差 $\leq \frac{1}{2} \times 10^{-4}$</li>
<li>确定所需节点数</li>
</ol>
<p><strong>解</strong><br>$$<br>f(x) &#x3D; e^{x} \qquad f’(x) &#x3D; f’’(x) &#x3D; f^{(4)}(x) &#x3D; e^{x}<br>$$</p>
<p>在区间 $[0,\ 1]$ 上：<br>$$<br>\max|f’’(x)| &#x3D; \max|f^{(4)}(x)| &#x3D; e<br>$$</p>
<p>1.复化梯形公式计算</p>
<p>误差公式：<br>$$<br>|R_T[f]| \leq \frac{e}{12} h^2 \leq \frac{1}{2} \times 10^{-4}<br>$$</p>
<p>解得：<br>$$<br>h \leq 0.0149<br>$$</p>
<p>节点数：<br>$$<br>N \geq \frac{1}{h} &#x3D;67.1<br>$$</p>
<p>$$<br>\Rightarrow N + 1 &#x3D; 69 \text{个节点}<br>$$</p>
<hr>
<p>2.复化辛普森公式计算</p>
<p>误差公式：</p>
<p>$$ |R_S[f]| \leq \frac{e}{2880} h^4 \leq \frac{1}{2} \times 10^{-4} $$</p>
<ol>
<li>解得：<br>$$ h \leq 0.4798 $$</li>
<li>节点数：<br>$$ N \geq \frac{1}{h} &#x3D; 2.085 $$</li>
<li>取：<br>$$ N &#x3D; 3 $$<br>$$ \Rightarrow 2N + 1 &#x3D; 7 \text{个节点} $$</li>
</ol>
</blockquote>
<blockquote>
<p><img src="/blog/image/Snipaste_2025-06-04_10-50-56.png"></p>
<p><img src="/blog/image/Snipaste_2025-06-04_10-51-01.png"></p>
</blockquote>
<blockquote>
<p><img src="/blog/image/Snipaste_2025-06-04_15-40-32.png"></p>
</blockquote>
<h2 id="高斯求积公式"><a href="#高斯求积公式" class="headerlink" title="高斯求积公式"></a>高斯求积公式</h2><p>构造具有2n+1次代数精度的求积公式</p>
<p>$$<br>\int_a^b \rho(x) f(x) dx \approx \sum_{k&#x3D;0}^{n} A_k f(x_k)<br>$$</p>
<ul>
<li><p>节点：$x_0, \ldots, x_n$（共n+1个）</p>
</li>
<li><p>系数：$A_0, \ldots, A_n$（共n+1个）</p>
<p>二者都作为待定系数</p>
</li>
</ul>
<p><strong>精度条件方程</strong>：<br>$$<br>\int \rho(x) \cdot 1 dx &#x3D; \sum_{k&#x3D;0}^{n} A_k \<br>\int \rho(x) x dx &#x3D; \sum_{k&#x3D;0}^{n} A_k x_k \<br>\vdots \<br>\int \rho(x) x^{2n+1} dx &#x3D; \sum_{k&#x3D;0}^{n} A_k x_k^{2n+1}<br>$$</p>
<p><strong>代数精度</strong>：</p>
<blockquote>
<p>当取$f(x)&#x3D;1,x,x^2,\ldots,x^{2n+1}$代入可求解，得到的公式具有<strong>2n+1次代数精度</strong></p>
</blockquote>
<ul>
<li>节点称为<strong>Gauss点</strong></li>
<li>公式称为<strong>Gauss型求积公式</strong></li>
</ul>
<blockquote>
<p><strong>定义</strong>：</p>
<p>选取互异节点 $x_{0}, x_{1}, \ldots, x_{n}$，使插值型求积公式的代数精度达到 $2n+1$，则称该求积公式为<strong>Gauss型</strong>的，称这些节点为<strong>Gauss点</strong>。</p>
</blockquote>
<h3 id="例题-3"><a href="#例题-3" class="headerlink" title="例题"></a>例题</h3><blockquote>
<p>试构造高斯求积公式 $\int_{-1}^{1}f(x)dx\approx w_{0}f(x_{0})+w_{1}f(x_{1})$.</p>
<ul>
<li><p>显然$n&#x3D;1$，则具有$2 \cdot 1+1$次代数精度</p>
</li>
<li><p>分别将$f(x)&#x3D;1,x,x^2,x^{3}$依次带入</p>
</li>
</ul>
<div>

<p>$$<br>w_{0} + w_{1} &#x3D; 2,\<br>w_{0}x_{0} + w_{1}x_{1} &#x3D; 0,\<br>w_{0}x_{0}^{2} + w_{1}x_{1}^{2} &#x3D; \frac{2}{3},\<br>w_{0}x_{0}^{3} + w_{1}x_{1}^{3} &#x3D; 0<br>$$</p>
</div>
$$
\int_{-1}^{1}f(x)dx\approx f\left(-\frac{1}{\sqrt{3}}\right)+f\left(\frac{1}{\sqrt{3}}\right)
$$
</blockquote>
<blockquote>
<p><img src="/blog/image/Snipaste_2025-06-04_14-28-26.png"></p>
<p><img src="/blog/image/Snipaste_2025-06-04_14-28-39.png"></p>
</blockquote>
<h3 id="Gauss点与正交多项式零点的关系"><a href="#Gauss点与正交多项式零点的关系" class="headerlink" title="Gauss点与正交多项式零点的关系"></a>Gauss点与正交多项式零点的关系</h3><ol>
<li>一般利用正交多项式来确定Gauss点 $x_{0}, x_{1}, \ldots, x_{n}$</li>
<li>然后利用插值原理确定Gauss求积系数 $A_{k}$</li>
</ol>
<p>$$<br>A_{k} &#x3D; \int_a^b \rho(x)  l_{k}(x) dx<br>$$</p>
<p>其中：</p>
<ul>
<li>$l_{k}(x)$ 是关于Gauss点的Lagrange插值基函数</li>
</ul>
<p><strong>插值型求积公式</strong><br>$$<br>\int_a^b \rho(x) f(x) dx \approx \sum_{k&#x3D;0}^{n} A_k f(x_k)<br>$$</p>
<hr>
<blockquote>
<p><strong>定理</strong></p>
<p>设节点 $x_0, \ldots, x_n$ 为 Gauss 点</p>
<p>$\Leftrightarrow$</p>
<p>$ \omega(x) &#x3D; \prod_{k&#x3D;0}^n (x - x_k) $<br>与任意次数不大于 $n$ 的多项式 $P(x)$（带权）正交。</p>
</blockquote>
<blockquote>
<p><strong>正交多项式族与Gauss点关系:</strong></p>
<p>设正交多项式族为 ${\phi_0, \phi_1, \ldots, \phi_n, \ldots}$，具有以下性质：</p>
<p>对任意次数<strong>不大于</strong>$n$的多项式$P(x)$，必与$\phi_{n+1}$正交：<br>$\Rightarrow$若取$\omega(x)$为其中的$\phi_{n+1}$，则：$\phi_{n+1}$的零点${x_k}_{k&#x3D;0}^n$即为<strong>Gauss点</strong></p>
</blockquote>
<h3 id="高斯求积公式的余项"><a href="#高斯求积公式的余项" class="headerlink" title="高斯求积公式的余项"></a>高斯求积公式的余项</h3><p>$$<br>R_n[f] &#x3D; \int_a^b \rho(x) f(x) , dx - \sum_{k&#x3D;0}^{n} A_k f(x_k) \<br> &#x3D; \frac{f^{(2n+2)}(\eta)}{(2n+2)!} \int_a^b \omega_{n+1}^2(x) \rho(x) , dx, \quad \eta \in [a, b]<br>$$</p>
<h3 id="例题-4"><a href="#例题-4" class="headerlink" title="例题"></a>例题</h3><blockquote>
<p>求形如<br>$$<br>\int_{0}^{1} \sqrt{x} f(x) dx \approx A_0 f(x_0) + A_1 f(x_1)<br>$$</p>
<p>的两点Gauss型求积公式</p>
<p><strong>法一：正交多项式法</strong></p>
<p>Step 1：构造正交多项式</p>
<p>设 $\varphi_2(x) &#x3D; x^2 + b x + c$ 为区间 $[0,1]$ 上带权 $\sqrt{x}$ 正交的多项式</p>
<p>正交条件：</p>
<ol>
<li>$(\varphi_2, 1) &#x3D; 0 \Rightarrow \int_{0}^{1} \sqrt{x} (x^2 + b x + c) dx &#x3D; 0$</li>
<li>$(\varphi_2, x) &#x3D; 0 \Rightarrow \int_{0}^{1} \sqrt{x} (x^3 + b x^2 + c x) dx &#x3D; 0$</li>
</ol>
<p>解得：<br>$$ \varphi_2(x) &#x3D; x^2 - \frac{10}{9}x + \frac{5}{21} $$</p>
<p>Step 2：求Gauss点</p>
<p>解 $\varphi_2(x)&#x3D;0$ 得：<br>$$ x_{0,1} &#x3D; \frac{\frac{10}{9} \pm \sqrt{\left(\frac{10}{9}\right)^2 - \frac{20}{21}}}{2} $$<br>数值解：<br>$$ x_0 \approx 0.821162,\quad x_1 \approx 0.289949 $$</p>
<p>Step 3：求系数</p>
<p>通过解方程组：</p>
<ol>
<li>$\int_{0}^{1} \sqrt{x} dx &#x3D; \frac{2}{3} &#x3D; A_0 + A_1$</li>
<li>$\int_{0}^{1} \sqrt{x} x dx &#x3D; \frac{2}{5} &#x3D; A_0 x_0 + A_1 x_1$</li>
</ol>
<p>解得：<br>$$ A_0 \approx 0.389111,\quad A_1 \approx 0.277556 $$</p>
<p>最终公式：<br>$$ \int_{0}^{1} \sqrt{x} f(x) dx \approx 0.389111 f(0.821162) + 0.277556 f(0.289949) $$</p>
<p>PS：$A_0 \quad A_1$也可由公式$A_{k} &#x3D; \int_a^b \rho(x)  l_{k}(x) dx$求出</p>
<p><strong>法二：直接构造法</strong></p>
<p>设 $\omega(x) &#x3D; (x-x_0)(x-x_1)$ 满足：<br>$$ \int_{0}^{1} \sqrt{x} \omega(x) dx &#x3D; 0 $$<br>$$ \int_{0}^{1} \sqrt{x} x \omega(x) dx &#x3D; 0 $$</p>
<p>解出$x_0,x_1$ ，后续方法同上</p>
</blockquote>
<h3 id="高斯-勒让德-Gauss-Legendre-求积公式"><a href="#高斯-勒让德-Gauss-Legendre-求积公式" class="headerlink" title="高斯-勒让德(Gauss-Legendre)求积公式"></a>高斯-勒让德(Gauss-Legendre)求积公式</h3><p>构造形如：<br>$$<br>\int_{-1}^{1} f(x)dx \approx \sum_{k&#x3D;0}^{n} A_k f(x_k)<br>$$</p>
<p>的求积公式，使其为Gauss型的。</p>
<p>当积分区间为$[-1,1]$时，求积公式的代数精度为$2n+1$的<strong>充要条件</strong>是：<br>$$ \omega(x) \text{ 在 } [-1,1] \text{ 上与一切次数不超过 } n \text{ 的多项式正交} $$</p>
<p><strong>由正交多项式的性质可知：</strong></p>
<ol>
<li>$n+1$次勒让德多项式$P_{n+1}(x)$具有这个性质</li>
<li>用$n+1$次勒让德多项式的零点作为节点，可得高斯型求积公式</li>
</ol>
<hr>
<p>$$<br> \int_{-1}^{1} f(x)dx \approx \sum_{k&#x3D;0}^{n} A_k f(x_k)<br>$$</p>
<p>该公式通常称为<strong>高斯-勒让德(Gauss-Legendre)求积公式</strong></p>
<blockquote>
<p><strong>Legendre多项式族</strong></p>
<p>定义在区间$[-1,1]$上，权函数$\rho(x)&#x3D;1$：<br>$$<br>P_k(x) &#x3D; \frac{1}{2^k k!} \cdot \frac{d^k}{dx^k}(x^2-1)^k<br>$$<br>正交性条件</p>
<p>$$ (P_k, P_l) &#x3D; \left{<br>\begin{matrix}<br>0 &amp; k \neq l \<br>\frac{2}{2k+1} &amp; k &#x3D; l<br>\end{matrix}<br>\right. $$</p>
<p>其中<br>$$ P_0 &#x3D; 1,\quad P_1 &#x3D; x ,\quad P_2(x) &#x3D; \frac{1}{2}(3x^2 - 1) \quad P_3(x) &#x3D; \frac{1}{2}(5x^3-3x)  $$</p>
<p>递推公式：<br>$$ (k+1)P_{k+1} &#x3D; (2k+1)xP_k - kP_{k-1} $$</p>
<p>以$P_{n+1}$的根为节点的求积公式称为<strong>Gauss-Legendre公式</strong></p>
</blockquote>
<blockquote>
<p><strong>例题</strong></p>
<p>构造两点的高斯-勒让德求积分公式：<br>$$<br>\int_{-1}^{1} f(x)dx \approx A_0 f(x_0) + A_1 f(x_1)<br>$$</p>
<ol>
<li>取勒让德多项式零点</li>
</ol>
<p>取二次勒让德多项式：<br>$$ P_2(x) &#x3D; \frac{1}{2}(3x^2 - 1) $$</p>
<p>求其两个零点：<br>$$ x_{0,1} &#x3D; \pm \frac{1}{\sqrt{3}} $$</p>
<ol start="2">
<li>建立求积公式</li>
</ol>
<p>设求积公式为：<br>$$ \int_{-1}^{1} f(x)dx \approx A_0 f\left(-\frac{1}{\sqrt{3}}\right) + A_1 f\left(\frac{1}{\sqrt{3}}\right) $$</p>
<ol start="3">
<li>确定系数</li>
</ol>
<p>当$f(x)&#x3D;1$时：<br>$$ A_0 + A_1 &#x3D; \int_{-1}^{1} 1 dx &#x3D; 2 $$</p>
<p>当$f(x)&#x3D;x$时：<br>$$ A_0 \left(-\frac{1}{\sqrt{3}}\right) + A_1 \left(\frac{1}{\sqrt{3}}\right) &#x3D; \int_{-1}^{1} x dx &#x3D; 0 $$</p>
<p>解得：<br>$$ A_0 &#x3D; A_1 &#x3D; 1 $$</p>
<ol start="4">
<li>最终公式</li>
</ol>
<p>得到两点高斯-勒让德求积公式：<br>$$ \int_{-1}^{1} f(x)dx \approx f\left(-\frac{1}{\sqrt{3}}\right) + f\left(\frac{1}{\sqrt{3}}\right) $$</p>
<ol start="5">
<li>验证代数精度</li>
</ol>
<p>可以验证，该公式对$f(x)&#x3D;x^3$也精确成立，因此代数精度为3。</p>
</blockquote>
<blockquote>
<p>对于积分 $\int_{a}^{b} f(x) dx$，通过变量替换：<br>$$<br>x &#x3D; \frac{b-a}{2} t + \frac{b+a}{2}<br>$$</p>
<p>可以转化为：<br>$$<br>\int_{a}^{b} f(x) dx &#x3D; \frac{b-a}{2} \int_{-1}^{1} f\left(\frac{b-a}{2} t + \frac{b+a}{2}\right) dt<br>$$</p>
</blockquote>
<blockquote>
<p>(1) 一个节点时  <strong>$n&#x3D;0$</strong><br>$$<br>\int_{-1}^{1} f(x)dx \approx 2f(0).<br>$$</p>
<p>(2) 两个节点时 <strong>$n&#x3D;1$</strong><br>$$<br>\int_{-1}^{1} f(x)dx \approx<br>f\left(-\frac{1}{\sqrt{3}}\right)+<br>f\left(\frac{1}{\sqrt{3}}\right).<br>$$</p>
<p>(3) 三个节点时 <strong>$n&#x3D;2$</strong><br>$$<br>\int_{-1}^{1} f(x)dx \approx<br>\frac{5}{9}f\left(-\sqrt{\frac{3}{5}}\right)+<br>\frac{8}{9}f(0)+<br>\frac{5}{9}f\left(\sqrt{\frac{3}{5}}\right).<br>$$</p>
<p>(4) 四个节点时   <strong>$n&#x3D;3$</strong><br>$$<br>\begin{aligned}<br>\int_{-1}^{1} f(x),dx &amp;\approx<br>0.3478548f(-0.8611363)+{}\<br>&amp;\quad 0.6521452f(-0.3399810)+{}\<br>&amp;\quad 0.6521452f(0.3399810)+{}\<br>&amp;\quad 0.3478548f(0.8611363).<br>\end{aligned}<br>$$</p>
</blockquote>
<h3 id="高斯-切比雪夫-Gauss-Chebyshev-求积公式）"><a href="#高斯-切比雪夫-Gauss-Chebyshev-求积公式）" class="headerlink" title="高斯-切比雪夫(Gauss-Chebyshev)求积公式）"></a>高斯-切比雪夫(Gauss-Chebyshev)求积公式）</h3><p>形如：<br>$$<br> \int_{-1}^{1} \frac{f(x)}{\sqrt{1-x^2}} dx \approx \sum_{k&#x3D;0}^{n} A_k f(x_k)<br>$$</p>
<p>的求积公式，若其代数精度为$2n+1$，则称其为<strong>高斯-切比雪夫求积公式</strong>。</p>
<blockquote>
<p><strong>Chebyshev多项式族</strong></p>
<p>定义在区间$[-1,1]$上，权函数$\rho(x)&#x3D;\frac{1}{\sqrt{1-x^2}}$：<br>$$<br>T_k(x) &#x3D; \cos(k \cdot \arccos x)<br>$$</p>
<p>$T_{n+1}$的根为：<br>$$<br>x_k &#x3D; \cos\left(\frac{(2k+1)\pi}{2n+2}\right),\quad k&#x3D;0,1,\ldots,n<br>$$</p>
<p>$$<br>\int_{-1}^1 \frac{1}{\sqrt{1-x^2}} f(x)dx \approx \sum_{k&#x3D;0}^n A_kf(x_k)<br>$$</p>
<p>称为<strong>Gauss-Chebyshev公式</strong></p>
</blockquote>
<blockquote>
<p><strong>例题</strong></p>
<p>求形如：<br>$$<br>\int_{-1}^{1} \frac{f(x)}{\sqrt{1-x^2}} dx \approx A_0 f(x_0) + A_1 f(x_1)<br>$$</p>
<p>的两点Gauss型求积公式。</p>
<ol>
<li><p><strong>确定节点</strong>：<br>由于节点必是区间$[-1,1]$上带权$p(x)&#x3D;\frac{1}{\sqrt{1-x^2}}$的二次正交多项式的零点，这个正交多项式就是二次切比雪夫多项式：<br>$$ T_2(x) &#x3D; \cos(2 \arccos x) $$<br>其零点为：<br>$$ x_0 &#x3D; -\frac{\sqrt{2}}{2},\quad x_1 &#x3D; \frac{\sqrt{2}}{2} $$</p>
</li>
<li><p><strong>确定系数</strong>：<br>要求公式对$f(x)&#x3D;1$和$f(x)&#x3D;x$都准确成立，可得方程组：</p>
<div>

<p>$$ \begin{cases}<br>A_0 + A_1 &#x3D; \pi \<br>A_0 \left(-\frac{\sqrt{2}}{2}\right) + A_1 \left(\frac{\sqrt{2}}{2}\right) &#x3D; 0<br>\end{cases} $$</p>
</div>

<p>解得：<br>$$ A_0 &#x3D; A_1 &#x3D; \frac{\pi}{2} $$</p>
</li>
<li><p><strong>最终公式</strong>：<br>$$<br>\int_{-1}^{1} \frac{f(x)}{\sqrt{1-x^2}} dx \approx \frac{\pi}{2} f\left(-\frac{\sqrt{2}}{2}\right) + \frac{\pi}{2} f\left(\frac{\sqrt{2}}{2}\right)<br>$$</p>
</li>
</ol>
</blockquote>
<p>利用$n+1$次切比雪夫多项式$T_{n+1}(x)$的零点：<br>$$<br>x_k &#x3D; \cos\left(\frac{2k+1}{2(n+1)}\pi\right) \quad (k&#x3D;0,1,\ldots,n)<br>$$</p>
<p>可以得到$n+1$点的Gauss型求积公式：<br>$$<br> \int_{-1}^{1} \frac{f(x)}{\sqrt{1-x^2}} dx \approx \frac{\pi}{n+1} \sum_{k&#x3D;0}^{n} f\left(\cos\frac{2k+1}{2(n+1)}\pi\right)<br>$$</p>
<blockquote>
<p><strong>例题</strong></p>
<p>计算积分：<br>$$ \int_{-1}^{1} \sqrt\frac{2+x}{1-x^2} dx $$</p>
<p>选用$n&#x3D;2$的Gauss-Chebyshev公式</p>
<p>节点和系数为：<br>$$<br>\begin{cases}<br>x_0 &#x3D; \cos\left(\frac{5}{6}\pi\right) &#x3D; -0.866025403 \<br>x_1 &#x3D; \cos\left(\frac{\pi}{2}\right) &#x3D; 0 \<br>x_2 &#x3D; \cos\left(\frac{\pi}{6}\right) &#x3D; 0.866025403 \<br>A_k &#x3D; \frac{\pi}{3}, \quad k&#x3D;0,1,2<br>\end{cases}<br>$$<br>即<br>$$<br>\int_{-1}^{1} \frac{2+x}{\sqrt{1-x^2}} dx \approx \frac{\pi}{3} \left[ \sqrt{2+x_0} + \sqrt{2+x_1} + \sqrt{2+x_2} \right] \<br>&#x3D; \frac{\pi}{3} \left[ \sqrt{2-0.866025403} + \sqrt{2+0} + \sqrt{2+0.866025403} \right]  \<br>&#x3D; 4.368939556<br>$$</p>
</blockquote>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>数值分析</tag>
      </tags>
  </entry>
  <entry>
    <title>数值分析-插值法</title>
    <url>/blog/2025/05/08/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90-%E6%8F%92%E5%80%BC%E6%B3%95/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>此文章包含数值分析的插值法部分—————————————————————————————————————————————————————————————————</p>
<h1 id="第二章-插值法"><a href="#第二章-插值法" class="headerlink" title="第二章 插值法"></a>第二章 插值法</h1><h2 id="插值法定义"><a href="#插值法定义" class="headerlink" title="插值法定义"></a>插值法定义</h2><p>设函数 $y &#x3D; f(x)$ 在区间 $[a, b]$ 上有定义，且满足节点排列：<br>$$ a \leq x_0 &lt; x_1 &lt; \cdots &lt; x_n \leq b $$</p>
<p>已知在点 ${x_0, x_1, \ldots, x_n}$ 上的对应函数值 ${y_0, y_1, \ldots, y_n}$。</p>
<p>若存在一简单函数 $p(x)$，满足插值条件：<br>$$ p(x_i) &#x3D; y_i \quad (i &#x3D; 0, 1, 2, \ldots, n) \tag{2.1} $$  （1） </p>
<p>则称：</p>
<ul>
<li>$p(x)$ 为 $f(x)$ 的<strong>插值函数</strong></li>
<li>${x_0, x_1, \ldots, x_n}$ 为<strong>插值节点</strong></li>
<li>包含节点的区间 $[a, b]$ 为<strong>插值区间</strong></li>
<li>式 (1) 为<strong>插值条件</strong></li>
<li>求插值函数的方法称为<strong>插值法</strong></li>
</ul>
<hr>
<h3 id="插值函数分类"><a href="#插值函数分类" class="headerlink" title="插值函数分类"></a>插值函数分类</h3><p>当 $p(x)$ 具有以下形式时：</p>
<ol>
<li><p><strong>多项式插值</strong><br>$$ p(x) &#x3D; a_0 + a_1x + \cdots + a_nx^n \quad (a_i \in \mathbb{R}) \tag{2.2} $$<br>其中多项式次数 $\leq n$</p>
</li>
<li><p><strong>分段插值</strong><br>$p(x)$ 为分段多项式</p>
</li>
<li><p><strong>三角插值</strong><br>$p(x)$ 为三角多项式</p>
</li>
</ol>
<blockquote>
<p><strong>定理</strong>：满足$p(x_i)&#x3D;y_i,i&#x3D;0,\cdots n$ 次数不超过<strong>n</strong>的插值多项式是唯一存在的（证明略）</p>
</blockquote>
<h2 id="拉格朗日插值"><a href="#拉格朗日插值" class="headerlink" title="拉格朗日插值"></a>拉格朗日插值</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>求 <strong>n次多项式</strong>：<br>$$<br>L_n(x) &#x3D; y_0 l_0(x) + y_1 l_1(x) + \cdots + y_n l_n(x)<br>$$<br>满足插值条件：<br>$$<br>L_n(x_i) &#x3D; y_i \quad (i &#x3D; 0,1,2,\ldots,n)<br>$$</p>
<p><strong>约束条件</strong>：</p>
<ul>
<li>无重合节点：当 $i \neq j$ 时，$x_i \neq x_j$</li>
</ul>
<hr>
<h3 id="线性插值特例-n-1"><a href="#线性插值特例-n-1" class="headerlink" title="线性插值特例 ($n&#x3D;1$)"></a>线性插值特例 ($n&#x3D;1$)</h3><p>已知两点 $(x_0, y_0)$ 和 $(x_1, y_1)$，构造一次多项式：<br>$$<br>L_1(x) &#x3D; l_0(x)y_0 + l_1(x)y_1<br>$$</p>
<p><strong>插值条件</strong>：<br>$$<br>\begin{cases}<br>L_1(x_0) &#x3D; y_0 \<br>L_1(x_1) &#x3D; y_1<br>\end{cases}<br>$$</p>
<p><strong>几何意义</strong>：$L_1(x)$ 是过点 $(x_0, y_0)$ 和 $(x_1, y_1)$ 的直线</p>
<p><strong>插值公式</strong><br>$$<br>L_1(x) &#x3D; \frac{x - x_1}{x_0 - x_1} y_0 + \frac{x - x_0}{x_1 - x_0}y_1<br>$$</p>
<p>$$<br>\frac{x - x_1}{x_0 - x_1}与\frac{x - x_0}{x_1 - x_0}称为拉氏基函数<br>$$</p>
<p>等价于点斜式：<br>$$<br>L_1(x) &#x3D; y_0 + \frac{y_1 - y_0}{x_1 - x_0}(x - x_0)<br>$$</p>
<p><strong>公式说明</strong></p>
<table>
<thead>
<tr>
<th>符号</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>$l_i(x)$</td>
<td>拉格朗日基函数，满足 $l_i(x_j) &#x3D; \delta_{ij}$</td>
</tr>
<tr>
<td>$\delta_{ij}$</td>
<td>克罗内克函数，当 $i&#x3D;j$ 时为1，否则为0</td>
</tr>
<tr>
<td>$x_i$</td>
<td>互不相同的插值节点</td>
</tr>
</tbody></table>
<h3 id="n-geq-1-时的插值公式"><a href="#n-geq-1-时的插值公式" class="headerlink" title="$n \geq 1$时的插值公式"></a>$n \geq 1$时的插值公式</h3><p><strong>目标</strong>：希望找到$l_i(x_j)$，满足下式：<br>$$<br>l_i(x_j) &#x3D; \delta_{ij} &#x3D; \begin{cases}<br>1 &amp; i &#x3D; j \<br>0 &amp; i \neq j<br>\end{cases} \quad (i,j&#x3D;0,1,\dots,n)<br>$$</p>
<p><strong>然后令</strong>：<br>$$<br>L_n(x) &#x3D; \sum_{i&#x3D;0}^n l_i(x) y_i \quad \text{显然满足} \quad L_n(x_i) &#x3D; y_i<br>$$</p>
<ol>
<li><p><strong>零点分析</strong>：<br>每个基函数 $l_i(x)$ 在 $n$ 个节点处取零值：<br>$$<br>l_i(x_j) &#x3D; 0 \quad (j \neq i)<br>$$<br>即多项式可表示为：<br>$$<br>l_i(x) &#x3D; C_i \prod_{\substack{j&#x3D;0 \ j \neq i}}^n (x - x_j)<br>$$</p>
</li>
<li><p><strong>归一化条件</strong>：<br>通过 $l_i(x_i) &#x3D; 1$ 确定常数 $C_i$：<br>$$<br>C_i &#x3D; \frac{1}{\prod_{\substack{j&#x3D;0 \ j \neq i}}^n (x_i - x_j)}<br>$$</p>
</li>
<li><p><strong>最终基函数表达式</strong></p>
</li>
</ol>
<p>$$<br>l_i(x) &#x3D; \prod_{\substack{j&#x3D;0 \ j \neq i}}^n \frac{x - x_j}{x_i - x_j}<br>$$</p>
<ol start="4">
<li><strong>插值多项式合成</strong></li>
</ol>
<p>$$<br>L_n(x)&#x3D; \sum_{i&#x3D;0}^n l_i(x) y_i&#x3D; \sum_{i&#x3D;0}^n \left[ \prod_{\substack{j&#x3D;0 \ j \neq i}}^n \frac{x - x_j}{x_i - x_j} \right] y_i &#x3D; \sum_{i&#x3D;0}^{n}  \frac{\omega_{n+1}(x)}{(x - x_i)\omega’_{n+1}(x_i)} y_i<br>$$</p>
<p>$$<br>\omega_{n+1}(x) &#x3D; (x - x_0)(x - x_1)\cdots(x - x_n)<br>$$</p>
<p>$$<br>\omega_{n+1}’(x_i) &#x3D; (x_i - x_0)\cdots(x_i - x_{i-1})(x_i - x_{i+1})\cdots(x_i - x_n)<br>$$</p>
<blockquote>
<p>$$<br>\sum_{i&#x3D;0}^n l_i(x) &#x3D; 1 \quad \text{（特别地，当所有 $y_i&#x3D;1$ 时 $L_n(x)&#x3D;1$）}<br>$$</p>
</blockquote>
<hr>
<h3 id="一点零次插值、线性插值、抛物插值公式"><a href="#一点零次插值、线性插值、抛物插值公式" class="headerlink" title="一点零次插值、线性插值、抛物插值公式"></a>一点零次插值、线性插值、抛物插值公式</h3><ol>
<li><strong>一点零次插值</strong></li>
</ol>
<p><strong>条件</strong>：仅1个节点 $(x_0, y_0)$  </p>
<p><strong>多项式：</strong><br>$$<br>L_n(x) &#x3D; y_0<br>$$</p>
<hr>
<ol start="2">
<li><strong>两点一次插值（线性插值）</strong></li>
</ol>
<p><strong>条件</strong>：2个节点 $(x_0, y_0)$ 和 $(x_1, y_1)$  </p>
<p><strong>多项式</strong>：<br>$$<br>L_1(x) &#x3D; \frac{x - x_1}{x_0 - x_1} y_0 + \frac{x - x_0}{x_1 - x_0} y_1<br>$$</p>
<p><strong>等价形式</strong>：<br>$$<br>L_1(x) &#x3D; y_0 + \frac{y_1 - y_0}{x_1 - x_0}(x - x_0)<br>$$</p>
<hr>
<ol start="3">
<li><strong>三点二次插值（抛物插值）</strong></li>
</ol>
<p><strong>条件</strong>：3个节点 $(x_0, y_0)$，$(x_1, y_1)$，$(x_2, y_2)$<br><strong>多项式</strong>：<br>$$<br>L_2(x) &#x3D; \frac{(x - x_1)(x - x_2)}{(x_0 - x_1)(x_0 - x_2)} y_0 + \frac{(x - x_0)(x - x_2)}{(x_1 - x_0)(x_1 - x_2)} y_1 + \frac{(x - x_0)(x - x_1)}{(x_2 - x_0)(x_2 - x_1)} y_2<br>$$</p>
<h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><blockquote>
<p>给定数据表</p>
<table>
<thead>
<tr>
<th align="center">$x_i$</th>
<th align="center">0</th>
<th align="center">1</th>
<th align="center">2</th>
<th align="center">3</th>
</tr>
</thead>
<tbody><tr>
<td align="center">$y_i$</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">5</td>
<td align="center">14</td>
</tr>
</tbody></table>
<p>求三次拉格朗日插值多项式 $L_3(x)$.</p>
<p><strong>解：</strong> 取 $n&#x3D;3$ 并代入数据表值得<br>$$<br>L_3(x) &#x3D; 0 \cdot l_0(x) + 1 \cdot l_1(x) + 5 \cdot l_2(x) + 14 \cdot l_3(x)<br>$$</p>
<p>$$<br>&#x3D; 0 + 1 \cdot \frac{x(x-2)(x-3)}{1 \cdot (-1) \cdot (-2)} + 5 \cdot \frac{x(x-1)(x-3)}{2 \cdot 1 \cdot (-1)} + 14 \cdot \frac{x(x-1)(x-2)}{3 \cdot 2 \cdot 1}<br>$$</p>
<p>$$<br>&#x3D; 0 + 1 \cdot \frac{x(x-2)(x-3)}{2} + 5 \cdot \frac{x(x-1)(x-3)}{-2} + 14 \cdot \frac{x(x-1)(x-2)}{6}<br>$$</p>
<p>$$<br>&#x3D; \frac{x(2x^2 + 3x + 1)}{6}<br>$$</p>
<p>$$<br>&#x3D; \frac{1}{6} x(x+1)(2x+1)<br>$$</p>
<blockquote>
<p><span style="color:#FF0000">根据插值条件进行验算</span>$L_n(x_i) &#x3D; y_i \quad (i &#x3D; 0,1,2,\ldots,n)$</p>
</blockquote>
<hr>
<p>已知由数据 $(0,0), (0.5,y), (1,3), (2,2) $构造出的三次插值多项式 $P_3(x)$的 $x^3$的系数是 6，试确定数据$y$ </p>
<p><strong>解</strong></p>
<p>利用 Lagrange 插值多项式：</p>
<p>$$<br>P_3(x) &#x3D; L_3(x) &#x3D; f(x_0)l_0(x) + f(x_1)l_1(x) + f(x_2)l_2(x) + f(x_3)l_3(x)<br>$$</p>
<p>由基函数的表达形式可知 $x^3$的系数为：</p>
<p>$$<br>\frac{f(x_0)}{(x_0 - x_1)(x_0 - x_2)(x_0 - x_3)} +<br>\frac{f(x_1)}{(x_1 - x_0)(x_1 - x_2)(x_1 - x_3)} +<br>\frac{f(x_2)}{(x_2 - x_0)(x_2 - x_1)(x_2 - x_3)} +<br>\frac{f(x_3)}{(x_3 - x_0)(x_3 - x_1)(x_3 - x_2)}<br>$$</p>
<p>将有关数据代入上述式得：</p>
<p>$$<br>6 &#x3D; \frac{0}{0.5 \times (-0.5) \times (-1.5)} +<br>\frac{y}{(0.5 - 0)(0.5 - 1)(0.5 - 2)} +<br>\frac{3}{(1 - 0)(1 - 0.5)(1 - 2)} +<br>\frac{2}{(2 - 0)(2 - 0.5)(2 - 1)}<br>$$</p>
<p>解得：</p>
<p>$$<br>y &#x3D; 4.25<br>$$</p>
</blockquote>
<h3 id="插值余项与误差估计"><a href="#插值余项与误差估计" class="headerlink" title="插值余项与误差估计"></a>插值余项与误差估计</h3><p><strong>条件</strong>：</p>
<ol>
<li>函数 $f^{(n)}(x)$ 在区间 $[a, b]$ 上连续</li>
<li>$f^{(n+1)}(x)$ 在 $(a, b)$ 内存在</li>
<li>$L_n(x)$ 是满足插值条件的 $n$ 次多项式，插值节点为 $a \leq x_0 &lt; x_1 &lt; \cdots &lt; x_n \leq b $ <span style="color:#FF0000">($n+1$个)</span></li>
</ol>
<p><strong>结论</strong>：<br>对任意 $x \in [a,b]$，插值余项满足：<br>$$<br>R_n(x) &#x3D; f(x) - L_n(x) &#x3D; \frac{f^{(n+1)}(\xi)}{(n+1)!} \prod_{j&#x3D;0}^n (x - x_j) \quad<br>$$<br>其中 $\xi \in (a, b)$，且 $\xi$ 的值依赖于 $x$</p>
<h4 id="误差上界估计"><a href="#误差上界估计" class="headerlink" title="误差上界估计"></a><strong>误差上界估计</strong></h4><p>若记 $\max_{x \in [a,b]} |f^{(n+1)}(x)| &#x3D; M_{n+1}$，则余项绝对误差满足：<br>$$<br>|R_n(x)| \leq \frac{M_{n+1}}{(n+1)!} \cdot |\omega_{n+1}(x)| \quad<br>$$<br>其中 $\omega_{n+1}(x) &#x3D; \prod_{j&#x3D;0}^n (x - x_j)$ 为节点多项式</p>
<blockquote>
<p>$$<br>\omega_{n+1}(x) &#x3D; (x - x_0)(x - x_1)\cdots(x - x_n)<br>$$</p>
<p>$$<br>\omega_{n+1}’(x_i) &#x3D; (x_i - x_0)\cdots(x_i - x_{i-1})(x_i - x_{i+1})\cdots(x_i - x_n)<br>$$</p>
<p>$$<br>L_n(x) &#x3D; \sum_{i&#x3D;0}^{n}  \frac{\omega_{n+1}(x)}{(x - x_i)\omega’_{n+1}(x_i)}y_i<br>$$</p>
</blockquote>
<ul>
<li>节点多项式 $\omega_{n+1}(x)$ 是(n+1)个线性因子的乘积</li>
<li>导数 $\omega’_{n+1}(x_i)$ 计算时排除$(x_i - x_i)$项</li>
<li>基函数构造 $\frac{\omega_{n+1}(x)}{(x - x_i)}$ 确保在$x&#x3D;x_i$时取值为1</li>
</ul>
<p><strong>n&#x3D;1时，线性插值余项</strong><br>$$<br>R_1(x) &#x3D; \frac{1}{2} f’’(\xi) \omega_2(x) &#x3D; \frac{1}{2} f’’(\xi) (x - x_0)(x - x_1), \quad \xi \in [x_0, x_1]<br>$$</p>
<p><strong>n&#x3D;2时，抛物插值余项</strong><br>$$<br>R_2(x) &#x3D; \frac{1}{6} f’’’(\xi) (x - x_0)(x - x_1)(x - x_2), \quad \xi \in [x_0, x_2]<br>$$</p>
<blockquote>
<p><strong>例题</strong></p>
<p>已知 $\sin 0.32 &#x3D; 0.314567$, $\sin 0.34 &#x3D; 0.333487$, $\sin 0.36 &#x3D; 0.352274$, 用线性插值计算和抛物插值计算 $\sin 0.3367$ 的值，并估计误差。</p>
<p><strong>解：</strong><br>$$<br>L_1(x) &#x3D; \frac{x - x_1}{x_0 - x_1} y_0 + \frac{x - x_0}{x_1 - x_0} y_1<br>$$</p>
<p>$$<br>\sin 0.3367 \approx L_1(0.3367) &#x3D;0.330365<br>$$</p>
<p>$$<br>|R_1(x)| \leq \frac{M_2}{2} |(x - x_0)(x - x_1)|,<br>$$</p>
<p>$$<br>M_2 &#x3D; \max_{x_0 \leq x \leq x_1} |f’’(x)| &#x3D; \sin x_1 \leq 0.3335,<br>$$</p>
<p>$$<br>|R_1(0.3367)| \leq \frac{1}{2} \times 0.3335 \times 0.0167 \times 0.0033 \leq 9.2 \times 10^{-6}<br>$$</p>
<hr>
<p>$$<br>L_2(x) &#x3D; y_0 \frac{(x - x_1)(x - x_2)}{(x_0 - x_1)(x_0 - x_2)} + y_1 \frac{(x - x_0)(x - x_2)}{(x_1 - x_0)(x_1 - x_2)} + y_2 \frac{(x - x_0)(x - x_1)}{(x_2 - x_0)(x_2 - x_1)}<br>$$</p>
<p>$$<br>\sin 0.3367 \approx L_2(0.3367) &#x3D; \cdots &#x3D; 0.330365.<br>$$</p>
<p>$$<br>|R_2(x)| \leq \frac{M_3}{6} |(x - x_0)(x - x_1)(x - x_2)|, \quad M_3 \leq \cos(x_0) &lt; 0.828,<br>$$</p>
<p>$$<br>|R_2(0.3367)| \leq \frac{1}{6} \times 0.828 \times 0.0167 \times 0.0033 \times 0.0233 \leq 1.78 \times 10^{-7}.<br>$$</p>
</blockquote>
<blockquote>
<p><strong>例题</strong></p>
<p>已知 $f(4) &#x3D; 2$, $f(9) &#x3D; 3$，用线性插值计算 $f(6)$，并估计误差。</p>
<p><strong>解：</strong><br>已知插值节点 $x_0 &#x3D; 4$, $x_1 &#x3D; 9$，两个插值基函数分别为</p>
<p>$$<br>l_0(x) &#x3D; \frac{x - x_1}{x_0 - x_1} &#x3D; -\frac{1}{5} (x - 9),<br>$$</p>
<p>$$<br>l_1(x) &#x3D; \frac{x - x_0}{x_1 - x_0} &#x3D; \frac{1}{5} (x - 4).<br>$$</p>
<p>故有</p>
<p>$$<br>L_1 &#x3D; l_0(x) y_0 + l_1(x) y_1 &#x3D; -\frac{2}{5} (x - 9) + \frac{3}{5} (x - 4) &#x3D; \frac{x}{5} + \frac{6}{5}.<br>$$</p>
<p>因此，计算得</p>
<p>$$<br>f(6) \approx L_1(6) &#x3D; \frac{6}{5} + \frac{6}{5} &#x3D; 2.4.<br>$$</p>
<p><strong>误差为</strong></p>
<p>$$<br>R_1(6) &#x3D; \frac{f’’(\xi)}{2!} (6 - 4)(6 - 9) &#x3D; -3 f’’(\xi).<br>$$</p>
</blockquote>
<blockquote>
<p><strong>例题</strong></p>
<p>设 $y &#x3D; \ln x$，且有函数表</p>
<table>
<thead>
<tr>
<th>$x$</th>
<th>0.40</th>
<th>0.50</th>
<th>0.70</th>
<th>0.80</th>
</tr>
</thead>
<tbody><tr>
<td>$\ln x$</td>
<td>-0.916291</td>
<td>-0.693147</td>
<td>-0.356675</td>
<td>-0.223144</td>
</tr>
</tbody></table>
<p>试计算 $f(0.6) &#x3D; \ln 0.6$ 的近似值，并估计误差。</p>
<hr>
<p>解：</p>
<p>(1) 取插值节点：$x_1 &#x3D; 0.50$, $x_2 &#x3D; 0.70$，做线性插值**（内插式）**</p>
<p>$$<br>f(0.6) \approx L_1(0.6) &#x3D; \left[ y_1 \frac{x - x_2}{x_1 - x_2} + y_2 \frac{x - x_1}{x_2 - x_1} \right]_{x&#x3D;0.6} &#x3D; -0.524911<br>$$</p>
<p>误差：</p>
<p>$$<br>R_1(0.6) &#x3D; f(0.6) - L_1(0.6) &#x3D; \frac{f^{(2)}(\xi)}{2!} (0.6 - 0.5)(0.6 - 0.7) &#x3D; 0.01 \times \frac{1}{\xi^2} \quad (0.5 \leq \xi \leq 0.7)<br>$$</p>
<p>因此，$100&#x2F;49 &lt; 1&#x2F;\xi^2 &lt; 100&#x2F;25$，故 $0.01 &lt; R_1(x) &lt; 0.02$。</p>
<hr>
<p>(2) 取插值节点：$x_1 &#x3D; 0.50$, $x_2 &#x3D; 0.70$, $x_3 &#x3D; 0.80$，做拉格朗日插值**（内插式）**</p>
<p>$$<br>\ln 0.6 \approx L_2(0.6) &#x3D; [y_1 l_1(x) + y_2 l_2(x) + y_3 l_3(x)]_{x&#x3D;0.6} &#x3D; -0.513343<br>$$</p>
<p>误差：</p>
<p>$$<br>R_2(0.6) &#x3D; \frac{f^{(3)}(\xi)}{3!} (0.6 - 0.5)(0.6 - 0.7)(0.6 - 0.8) &#x3D; \frac{2}{3} \times 10^{-3} \times \frac{1}{\xi^3}, \quad x_1 \leq \xi \leq x_3<br>$$</p>
<p>$$<br>1.3 \times 10^{-3} &lt; R_2(0.6) &#x3D; f(0.6) - L_2(0.6) &lt; 5.34 \times 10^{-3}<br>$$</p>
<p>$ f(0.6) &#x3D; \ln 0.6$ 的真值为 $-0.510826$。</p>
<p>因此，拉格朗日插值更精确。</p>
</blockquote>
<h2 id="差商与牛顿插值"><a href="#差商与牛顿插值" class="headerlink" title="差商与牛顿插值"></a>差商与牛顿插值</h2><h3 id="差商及其性质"><a href="#差商及其性质" class="headerlink" title="差商及其性质"></a>差商及其性质</h3><h4 id="差商（均差）的定义"><a href="#差商（均差）的定义" class="headerlink" title="差商（均差）的定义"></a>差商（均差）的定义</h4><p><strong>1阶差商</strong><br>$$<br>f[x_i, x_j] &#x3D; \frac{f(x_i) - f(x_j)}{x_i - x_j} \quad (i \neq j, x_i \neq x_j)<br>$$<br><strong>2阶差商</strong><br>$$<br>f[x_i, x_j, x_k] &#x3D; \frac{f[x_i, x_j] - f[x_j, x_k]}{x_i - x_k} \quad (i \neq k)<br>$$<br><strong>$k+1$阶差商</strong>（$k+2$个点）<br>$$<br>f[x_0, …, x_{k+1}] &#x3D; \frac{f[x_0, x_1, …, x_k] - f[x_1, …, x_k, x_{k+1}]}{x_0 - x_{k+1}}<br>&#x3D; \frac{f[x_0, …, x_{k-1}, x_k] - f[x_0, …, x_{k-1}, x_{k+1}]}{x_k - x_{k+1}}<br>$$</p>
<blockquote>
<p>k阶差商必须由k+1个节点构成，k个节点是构造不出k阶差商的。</p>
<p>差商的值与$x_i$顺序无关的</p>
</blockquote>
<h4 id="差商性质"><a href="#差商性质" class="headerlink" title="差商性质"></a>差商性质</h4><ol>
<li><p><strong>k阶差商的线性组合</strong><br>k阶差商可以表示为函数值 $ f(x_0), f(x_1), \ldots, f(x_k) $ 的线性组合，即<br>$$<br>f[x_0, x_1, \ldots, x_k] &#x3D; \sum_{j&#x3D;0}^k \frac{f(x_j)}{(x_j - x_0) \cdots (x_j - x_{j-1})(x_j - x_{j+1}) \cdots (x_j - x_k)}（用数学归纳法证明）<br>$$</p>
</li>
<li><p><strong>对称性</strong><br>差商具有对称性，即<br>$$<br>f[x_0, x_1, \ldots, x_k] &#x3D; f[x_1, x_0, x_2, \ldots, x_k] &#x3D; \cdots &#x3D; f[x_1, \ldots, x_k, x_0]<br>$$</p>
</li>
<li><p><strong>与导数的关系</strong><br>若函数 $ f(x) $ 在区间 $[a, b]$ 上有 $ n $ 阶导数，且节点 $ x_i \in [a, b] $（$ i &#x3D; 0, 1, \ldots, n $），则 $ n $ 阶差商与 $ n $ 阶导数有如下关系式：<br>$$<br>f[x_0, x_1, \ldots, x_n] &#x3D; \frac{f^{(n)}(\xi)}{n!}<br>$$<br>其中 $ \xi \in [a, b] $。</p>
</li>
<li><p><strong>多项式性质</strong><br>若 $ f(x) $ 是 $ n $ 次多项式，则其 $ k $ 阶差商 $ f[x_0, x_1, \ldots, x_{k-1}, x] $ 当 $ k \leq n $ 时是一个 $ n-k $ 次多项式，而当 $ k &gt; n $ 时恒为零。</p>
</li>
</ol>
<h4 id="差商表"><a href="#差商表" class="headerlink" title="差商表"></a>差商表</h4><table>
<thead>
<tr>
<th align="center">$ x_i $</th>
<th align="center">$ f(x_i) $</th>
<th align="center">一阶差商</th>
<th align="center">二阶差商</th>
<th align="center">三阶差商</th>
</tr>
</thead>
<tbody><tr>
<td align="center">$ x_0 $</td>
<td align="center">$ f(x_0) $</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">$ x_1 $</td>
<td align="center">$ f(x_1) $</td>
<td align="center">$ f[x_0, x_1] $</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">$ x_2 $</td>
<td align="center">$ f(x_2) $</td>
<td align="center">$ f[x_1, x_2] $</td>
<td align="center">$ f[x_0, x_1, x_2] $</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">$ x_3 $</td>
<td align="center">$ f(x_3) $</td>
<td align="center">$ f[x_2, x_3] $</td>
<td align="center">$ f[x_1, x_2, x_3] $</td>
<td align="center">$ f[x_0, x_1, x_2, x_3] $</td>
</tr>
</tbody></table>
<h3 id="牛顿插值"><a href="#牛顿插值" class="headerlink" title="牛顿插值"></a>牛顿插值</h3><p>Newton插值是通过选取特殊的基函数来实现的，这时，取</p>
<p>$$<br>\varphi_0(x) &#x3D; 1<br>$$</p>
<p>$$<br>\varphi_{i+1}(x) &#x3D; (x - x_i)\varphi_i(x), \quad i &#x3D; 0, 1, \ldots, n - 1<br>$$</p>
<p>作为Newton插值的以 $ x_0, x_1, \ldots, x_n $ 为节点的基函数，而次数不超过 $ n $ 的多项式 $ N_n(x) $ 可表示为</p>
<p>$$<br>N_n(x) &#x3D; c_0 + c_1(x - x_0) + c_2(x - x_0)(x - x_1) + \cdots + c_n(x - x_0)(x - x_1)\cdots(x - x_{n-1})<br>$$</p>
<p>其中 $ c_0, c_1, \ldots, c_n $ 是待定系数。<br>$$<br>&#x3D; f(x_0) + f[x_0, x_1](x - x_0) + \cdots + f[x_0, \ldots, x_n](x - x_0)\cdots(x - x_{n-1})<br>$$</p>
<p><em><strong>下面推导待定系数：</strong></em><br>$$<br>f(x_0)&#x3D;N_n(x_0)&#x3D;c_0<br>$$</p>
<p>$$<br>f(x_1) &#x3D; N_n(x_1) &#x3D; c_0 + c_1(x_1 - x_0)&#x3D; f(x_0) + c_1(x_1 - x_0)<br>$$</p>
<p>$$<br>c_1 &#x3D; \frac{f(x_1) - f(x_0)}{x_1 - x_0} &#x3D; f[x_0, x_1]<br>$$</p>
<p>通过插值条件运用数学归纳法可以求得<br>$$<br>c_k &#x3D; f[x_0, x_1, \ldots, x_k]<br>$$</p>
<p>因此，得到满足插值条件的 $ n $ 次插值多项式：<br>$$<br>N_n(x)&#x3D; f(x_0) + f[x_0, x_1](x - x_0) + \cdots + f[x_0, \ldots, x_n](x - x_0)\cdots(x - x_{n-1})<br>$$</p>
<p><em><strong>余项的推导</strong></em><br>$$<br>f(x) &#x3D; f(x_0) + (x - x_0)f[x, x_0] \quad \text{(1)}<br>$$</p>
<p>$$<br>f[x, x_0] &#x3D; f[x_0, x_1] + (x - x_1)f[x, x_0, x_1] \quad \text{(2)}<br>$$</p>
<p>$$<br>\vdots<br>$$</p>
<p>$$<br>f[x, x_0, \ldots, x_{n-1}] &#x3D; f[x_0, \ldots, x_n] + (x - x_n)f[x, x_0, \ldots, x_n] \quad \text{(n-1)}<br>$$</p>
<p>$$<br>\text{(1)} + (x - x_0) \times \text{(2)} + \cdots + (x - x_0)\cdots(x - x_{n-1}) \times \text{(n-1)}<br>$$</p>
<p>$$<br>\Rightarrow f(x) &#x3D; f(x_0) + f[x_0, x_1](x - x_0) + f[x_0, x_1, x_2](x - x_0)(x - x_1) + \cdots + f[x_0, \ldots, x_n](x - x_0)\cdots(x - x_{n-1}) + f[x, x_0, \cdots, x_n](x - x_0)\cdots(x - x_{n-1})(x - x_n)<br>$$</p>
<p><strong>因此，余项公式为</strong>：</p>
<blockquote>
<p>$$<br>R_n(x)&#x3D;f[x, x_0, \ldots, x_n](x - x_0)\cdots(x - x_{n-1})(x - x_n)&#x3D;f[x, x_0, \ldots, x_n]\omega_{n+1}(x)<br>$$</p>
<p>$$<br>\omega_{n+1}(x) &#x3D; (x - x_0)(x - x_1)\cdots(x - x_n) \<br>c_i &#x3D; f[x_0, \ldots, x_i]<br>$$</p>
</blockquote>
<blockquote>
<p><strong>例1</strong></p>
<p>设当 $x_i &#x3D; 1, 2, 3, 4, 5$ 时, $f(x_i) &#x3D; 1, 4, 7, 8, 6$。求四次牛顿插值多项式。</p>
<table>
<thead>
<tr>
<th>k</th>
<th>$x_k$</th>
<th>$f(x_k)$</th>
<th>一阶差商</th>
<th>二阶差商</th>
<th>三阶差商</th>
<th>四阶差商</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>1</td>
<td>1</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>4</td>
<td>3</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>7</td>
<td>3</td>
<td>0</td>
<td></td>
<td></td>
</tr>
<tr>
<td>3</td>
<td>4</td>
<td>8</td>
<td>1</td>
<td>-1</td>
<td>-1&#x2F;3</td>
<td></td>
</tr>
<tr>
<td>4</td>
<td>5</td>
<td>6</td>
<td>-2</td>
<td>-3&#x2F;2</td>
<td>-1&#x2F;6</td>
<td>1&#x2F;24</td>
</tr>
</tbody></table>
<p>$$<br>N_4(x) &#x3D; 1 + (x - 1) \cdot 3 + (x - 1)(x - 2) \cdot 0 + (x - 1)(x - 2)(x - 3) \cdot \left(-\frac{1}{3}\right) + (x - 1)(x - 2)(x - 3)(x - 4) \cdot \frac{1}{24}<br>$$</p>
<p>$$<br>&#x3D; \frac{1}{24} x^4 - \frac{9}{12} x^3 + \frac{83}{24} x^2 - \frac{33}{12} x + 1<br>$$</p>
<blockquote>
<p>提示：</p>
<ol>
<li>根据差商表计算更高阶的差商时，遵循相近作差的原则。比如计算三阶差商$- \frac{1}{6}$时候，直接用前一阶差商的-1和-3&#x2F;2作差，然后三阶差商需要4个点，即从该列开始往前数4个点,序号差别最大的作差（本例就是$x_4-x_1$），两个差值作除法就是新差商</li>
<li>注意4次牛顿插值，反应到多项式就是4次多项式。组合牛顿插值的时候几阶差商乘的就是几阶多项式</li>
</ol>
</blockquote>
<p><strong>例2</strong></p>
<p>给定 $f(x)$ 的函数表，求四次牛顿插值值多项式，计算 $f(0.596)$ 的近似值，并估计误差。</p>
<p>得出差商表，得到</p>
<p>$$<br>N_4(x) &#x3D; 0.41075 + 1.116(x - 0.4) + 0.28(x - 0.4)(x - 0.55) + 0.19733(x - 0.4)(x - 0.55)(x - 0.65) + 0.03134(x - 0.4)(x - 0.55)(x - 0.65)(x - 0.8)<br>$$</p>
<p>$$<br>f(0.596) \approx N_4(0.596) &#x3D; 0.63192,<br>$$</p>
<p>误差：</p>
<p>$$<br>R_4(x) &#x3D; (x - x_0)(x - x_1) \cdots (x - x_4) f[x,x_0, x_1, \cdots, x_4],<br>$$</p>
<p>$$<br>|R_4(x)| \approx |f[x_0, x_1, \cdots, x_5] \omega_5(0.596)| \leq 3.63 \times 10^{-9}.<br>$$</p>
<p>因此 $x &#x3D; 0.596$ 和 $f(x) \approx 0.63192$，得到 $f[x_0, \cdots, x_4]$ 的近似值。</p>
</blockquote>
<p><strong>注：</strong></p>
<p>由唯一性可知 $ N_n(x) \equiv L_n(x) $，只是算法不同，故其余项也相同，即</p>
<p>$$<br>f[x, x_0, \ldots, x_n] \omega_{n+1}(x) &#x3D; \frac{f^{(n+1)}(\xi_x)}{(n+1)!} \omega_{n+1}(x)<br>$$</p>
<p>则</p>
<p>$$<br>f[x_0, \ldots, x_k] &#x3D; \frac{f^{(k)}(\xi)}{k!}, \quad \xi \in (x_{\min}, x_{\max})<br>$$</p>
<blockquote>
<p><strong>证明（不用掌握）：</strong></p>
<p>$$ f[x_0, x_1, \ldots, x_k] &#x3D; \frac{f^{(k)}(\xi)}{k!}, \quad \xi \in (x_{\min}, x_{\max}) $$</p>
<hr>
<p>数学归纳法推导</p>
<p><span style="color:#FF0000">基例验证（$ k&#x3D;1 $）</span></p>
<p><strong>命题</strong>：对任意两节点 $ x_0, x_1 $，一阶差商满足：<br>$$ f[x_0, x_1] &#x3D; \frac{f’(\xi)}{1!}, \quad \xi \in (x_0, x_1) $$</p>
<p><strong>推导步骤</strong>：</p>
<ol>
<li><strong>差商定义</strong>：</li>
</ol>
<p>$$<br> f[x_0, x_1] &#x3D; \frac{f(x_1) - f(x_0)}{x_1 - x_0}<br>$$</p>
<ol start="2">
<li><strong>微分中值定理</strong>：存在 $ \xi \in (x_0, x_1) $，使得：</li>
</ol>
<p>$$<br> \frac{f(x_1) - f(x_0)}{x_1 - x_0} &#x3D; f’(\xi)<br>$$</p>
<ol start="3">
<li><strong>结论</strong>：</li>
</ol>
<p>$$<br> f[x_0, x_1] &#x3D; \frac{f’(\xi)}{1!} \quad \text{（基例成立）}<br>$$</p>
<hr>
<p><span style="color:#FF0000">归纳假设（假设 $ k&#x3D;m $ 时成立）</span></p>
<p>假设对任意 $ m+1 $ 个节点 $ x_0, x_1, \ldots, x_m $，有：<br>$$<br>f[x_0, x_1, \ldots, x_m] &#x3D; \frac{f^{(m)}(\eta)}{m!}, \quad \eta \in (x_{\min}, x_{\max})<br>$$</p>
<hr>
<p><span style="color:#FF0000">归纳步骤（证明 $ k&#x3D;m+1 $ 时成立）</span></p>
<p><strong>目标</strong>：对任意 $ m+2 $ 个节点 $ x_0, x_1, \ldots, x_{m+1} $，证明：<br>$$<br>f[x_0, x_1, \ldots, x_{m+1}] &#x3D; \frac{f^{(m+1)}(\xi)}{(m+1)!}, \quad \xi \in (x_{\min}, x_{\max})<br>$$</p>
<p><strong>推导过程</strong>：</p>
<ol>
<li><strong>差商递归关系</strong>：</li>
</ol>
<p>$$<br> f[x_0, \ldots, x_{m+1}] &#x3D; \frac{f[x_1, \ldots, x_{m+1}] - f[x_0, \ldots, x_m]}{x_{m+1} - x_0}<br>$$</p>
<ol start="2">
<li><strong>应用归纳假设</strong>：</li>
</ol>
<ul>
<li><p>对 $ f[x_1, \ldots, x_{m+1}] $：<br>$$<br>f[x_1, \ldots, x_{m+1}] &#x3D; \frac{f^{(m)}(\eta_1)}{m!}, \quad \eta_1 \in (x_1, x_{m+1})<br>$$</p>
</li>
<li><p>对 $ f[x_0, \ldots, x_m] $：<br>$$<br>f[x_0, \ldots, x_m] &#x3D; \frac{f^{(m)}(\eta_2)}{m!}, \quad \eta_2 \in (x_0, x_m)<br>$$</p>
</li>
</ul>
<ol start="3">
<li><strong>构造辅助函数</strong>：<br> 定义 $ g(x) &#x3D; f^{(m)}(x) $，则：</li>
</ol>
<p>$$<br> f[x_0, \ldots, x_{m+1}] &#x3D; \frac{g(\eta_1) - g(\eta_2)}{(x_{m+1} - x_0) \cdot m!}<br>$$</p>
<ol start="4">
<li><strong>广义微分中值定理</strong>：<br> 存在 $ \xi \in (\eta_2, \eta_1) \subseteq (x_{\min}, x_{\max}) $，使得：</li>
</ol>
<p>$$<br> \frac{g(\eta_1) - g(\eta_2)}{\eta_1 - \eta_2} &#x3D; g’(\xi) &#x3D; f^{(m+1)}(\xi)<br>$$</p>
<ol start="5">
<li><strong>结合节点间距</strong>：<br> 由于 $ \eta_1 - \eta_2 \leq x_{m+1} - x_0 $，整理得：</li>
</ol>
<p>$$<br> f[x_0, \ldots, x_{m+1}] &#x3D; \frac{f^{(m+1)}(\xi)}{(m+1)!}<br>$$</p>
<hr>
<p><span style="color:#FF0000">归纳结论</span></p>
<p>对所有 $ k \geq 1 $，公式成立：<br>$$<br>\boxed{f[x_0, x_1, \ldots, x_k] &#x3D; \frac{f^{(k)}(\xi)}{k!}, \quad \xi \in (x_{\min}, x_{\max})}<br>$$</p>
<p>关键符号说明</p>
<table>
<thead>
<tr>
<th>符号</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>$ f[x_0, \ldots, x_k] $</td>
<td>$ k $ 阶差商，节点 $ x_0, \ldots, x_k $ 处的函数变化率</td>
</tr>
<tr>
<td>$ f^{(k)}(\xi) $</td>
<td>函数 $ f $ 在区间内的 $ k $ 阶导数</td>
</tr>
<tr>
<td>$ \xi $</td>
<td>区间内的某点，由中值定理保证存在</td>
</tr>
</tbody></table>
</blockquote>
<h4 id="差分形式的牛顿插值公式"><a href="#差分形式的牛顿插值公式" class="headerlink" title="差分形式的牛顿插值公式"></a>差分形式的牛顿插值公式</h4><p><strong>节点等距分布条件</strong>：<br>当节点满足等距分布时：<br>$$ x_i &#x3D; x_0 + ih \quad (i&#x3D;0,\ldots,n) $$</p>
<hr>
<p><strong>向前差分</strong><br>$$<br>\Delta f_i &#x3D; f_{i+1} - f_i<br>$$</p>
<p>$$<br>\Delta^k f_i &#x3D; \Delta(\Delta^{k-1}f_i) &#x3D; \Delta^{k-1}f_{i+1} - \Delta^{k-1}f_i<br>$$</p>
<hr>
<p><strong>向后差分</strong><br>$$<br>\nabla f_i &#x3D; f_i - f_{i-1}<br>$$</p>
<p>$$<br>\nabla^k f_i &#x3D; \nabla(\nabla^{k-1}f_i) &#x3D; \nabla^{k-1}f_i - \nabla^{k-1}f_{i-1}<br>$$</p>
<hr>
<p><strong>中心差分</strong><br>$$<br>\delta f_i &#x3D; f_{i+\frac{1}{2}} - f_{i-\frac{1}{2}} \quad \text{其中} \quad f_{i\pm\frac{1}{2}} &#x3D; f\left(x_i \pm \frac{h}{2}\right)<br>$$</p>
<p>$$<br>\delta^k f_i &#x3D; \delta^{k-1}f_{i+\frac{1}{2}} - \delta^{k-1}f_{i-\frac{1}{2}}<br>$$</p>
<hr>
<p><strong>差分的重要性质：</strong></p>
<ol>
<li><p>差分可由函数值计算<br>$$<br>\Delta^n f_k &#x3D; \sum_{j&#x3D;0}^n (-1)^{j} \binom{n}{j} f_{n+k-j} \<br>\nabla^n f_k &#x3D; \sum_{j&#x3D;0}^n (-1)^{n-j} \binom{n}{j} f_{k+j-n}<br>$$<br>其中：</p>
<ul>
<li><p>$$<br>\binom{n}{j} &#x3D; \frac{n(n-1)\cdots(n-j+1)}{j!}<br>$$</p>
<p>是二项式系数。</p>
</li>
</ul>
</li>
<li><p>函数值可由差分值算出<br>$$<br>f_{n+k} &#x3D; \sum_{j&#x3D;0}^n \binom{n}{j} \Delta^j f_k<br>$$</p>
</li>
<li><p>差商和差分的关系</p>
</li>
</ol>
<p>$$<br>f[x_k, x_{k+1}, \ldots, x_{k+m}] &#x3D; \frac{1}{m! h^m} \Delta^m f_k<br>$$</p>
<p>$$<br>f[x_k, x_{k-1}, \ldots, x_{k-m}] &#x3D; \frac{1}{m! h^m} \nabla^m f_k<br>$$</p>
<ol start="4">
<li>差分与导数的关系<br>$$<br>\Delta^n f_k &#x3D; h^n f^{(n)}(\xi), \quad \xi \in (x_k, x_{k+n})<br>$$</li>
</ol>
<p><strong>牛顿公式：</strong><br>$$<br>N_n(x) &#x3D; f(x_0) + f[x_0, x_1](x - x_0) + \cdots + f[x_0, \ldots, x_n](x - x_0)\cdots(x - x_{n-1})<br>$$</p>
<p><span style="color:rgb(255, 53, 116)">牛顿前插公式：</span><br>设 $ x &#x3D; x_0 + th $（$ 0 \leq t \leq 1 $），则<br>$$<br>N_n(x) &#x3D; N_n(x_0 + th) &#x3D; \sum_{k&#x3D;0}^{n} \binom{t}{k} \Delta^k f(x_0)<br>$$<br>$$<br>&#x3D; f_0 + t\Delta f_0 + \frac{t(t - 1)}{2!}\Delta^2 f_0 + \dots + \frac{t(t - 1)\dots(t - n + 1)}{n!}\Delta^n f_0<br>$$</p>
<p>余项：<br>$$<br>R_n(x) &#x3D; \frac{f^{(n+1)}(\xi)}{(n+1)!} t(t-1)\cdots(t-n) h^{n+1}, \quad \xi \in (x_0, x_n)<br>$$</p>
<p><span style="color:rgb(255, 53, 116)">牛顿后插公式：</span><br>将节点顺序倒置：<br>$$<br>N_n(x) &#x3D; f(x_n) + f[x_n, x_{n-1}](x - x_n) + \cdots + f[x_n, \ldots, x_0](x - x_n)\cdots(x - x_1)<br>$$<br>设 $ x &#x3D; x_n + th $（$ -1 \leq t \leq 0 $），则<br>$$<br>N_n(x) &#x3D; N_n(x_n + th) &#x3D; \sum_{k&#x3D;0}^{n} (-1)^k \binom{-t}{k} \nabla^k f(x_n)<br>$$<br>$$<br>&#x3D; f_n + t\nabla f_n + \frac{t(t + 1)}{2!}\nabla^2 f_n + \dots + \frac{t(t + 1)\dots(t + n - 1)}{n!}\nabla^n f_n<br>$$</p>
<p>余项：<br>$$<br>R_n(x) &#x3D; \frac{f^{(n+1)}(\xi)}{(n+1)!} t(t+1)\cdots(t+n) h^{n+1}, \quad \xi \in (x_0, x_n)<br>$$</p>
<p>注：一般当 $ x $ 靠近 $ x_0 $ 时用前插，靠近 $ x_n $ 时用后插，故两种公式亦称为表初公式和表末公式。</p>
<p><strong>差分表</strong></p>
<p><img src="/blog/image/Snipaste_2025-03-12_16-09-19.png"></p>
<p><strong>例题</strong></p>
<blockquote>
<p>给出 $f(x) &#x3D; \cos x$ 在 $x_k &#x3D; kh, k &#x3D; 0, 1, 2, 3, 4, 5, h &#x3D; 0.1$ 时的函数值，试用 4 次牛顿前插公式计算 $f(0.048)$ 的近似值，并估计误差。</p>
<p><strong>解：</strong> 先构造差商表并用牛顿前插公式求 $f(0.048)$ 的近似值。</p>
<p><strong>差商表</strong></p>
<table>
<thead>
<tr>
<th>$x_k$</th>
<th>$f(x_k)$</th>
<th>$\Delta f$</th>
<th>$\Delta^2 f$</th>
<th>$\Delta^3 f$</th>
<th>$\Delta^4 f$</th>
<th>$\Delta^5 f$</th>
</tr>
</thead>
<tbody><tr>
<td>0.00</td>
<td>1.00000</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>-0.00500</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>0.10</td>
<td>0.99500</td>
<td></td>
<td>-0.00993</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>-0.01493</td>
<td></td>
<td>0.00013</td>
<td></td>
<td></td>
</tr>
<tr>
<td>0.20</td>
<td>0.98007</td>
<td></td>
<td>-0.00980</td>
<td></td>
<td>0.00012</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>-0.02473</td>
<td></td>
<td>0.00025</td>
<td></td>
<td>-0.00002</td>
</tr>
<tr>
<td>0.30</td>
<td>0.95534</td>
<td></td>
<td>-0.00955</td>
<td></td>
<td>0.00010</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>-0.03428</td>
<td></td>
<td>0.00035</td>
<td></td>
<td></td>
</tr>
<tr>
<td>0.40</td>
<td>0.92106</td>
<td></td>
<td>-0.00920</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>-0.04348</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>0.50</td>
<td>0.87758</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>取 $x &#x3D; 0.048, h &#x3D; 0.1, t &#x3D; \frac{x - 0}{h} &#x3D; 0.48$，得</p>
<p>$$<br>N_4(0.048) &#x3D; 1.00000 + 0.48 \times (-0.00500) + \frac{(0.48)(0.48-1)}{2} \times (-0.00993) + \frac{(0.48)(0.48-1)(0.48-2)}{6} \times (0.00013)<br>$$</p>
<p>$$</p>
<ul>
<li>\frac{(0.48)(0.48-1)(0.48-2)(0.48-3)}{24} \times (0.00012)<br>$$</li>
</ul>
<p>$$<br>&#x3D; 0.99885 \approx \cos 0.048,<br>$$</p>
<p>误差估计为：</p>
<p>$$<br>|R_4(0.048)| \leq \frac{M_5}{5!} |t(t-1)(t-2)(t-3)(t-4)| h^5 \leq 1.3433 \times 10^{-7},<br>$$</p>
<p>其中 $M_5 &#x3D; |\sin 0.5| \leq 0.479$。</p>
<hr>
<p>给出 $f(x) &#x3D; \cos x$ 在 $x_k &#x3D; kh, k &#x3D; 0, 1, 2, 3, 4, 5,6； h &#x3D; 0.1$ 时的函数值，用 4 次牛顿后插公式计算 $f(0.566)$ 的近似值，并估计误差。</p>
<p>做差商表</p>
<table>
<thead>
<tr>
<th align="right">$k$</th>
<th align="center">$x_k$</th>
<th align="center">$f(x_k)$</th>
<th align="center">$\nabla f $</th>
<th align="center">$\nabla^2 f $</th>
<th align="center">$\nabla^3 f$</th>
<th align="center">$\nabla^4 f$</th>
<th align="center">$\nabla^5 f$</th>
<th align="center">$\nabla^6 f$</th>
</tr>
</thead>
<tbody><tr>
<td align="right"><strong>6</strong></td>
<td align="center">0.6</td>
<td align="center">0.8253356</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="right"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">−0.0522470</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="right"><strong>5</strong></td>
<td align="center">0.5</td>
<td align="center">0.8775826</td>
<td align="center"></td>
<td align="center">−0.0087687</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="right"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">−0.0434783</td>
<td align="center"></td>
<td align="center">0.0004340</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="right"><strong>4</strong></td>
<td align="center">0.4</td>
<td align="center">0.9210609</td>
<td align="center"></td>
<td align="center">−0.0092027</td>
<td align="center"></td>
<td align="center">0.0000912</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="right"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">−0.0342756</td>
<td align="center"></td>
<td align="center">0.0003428</td>
<td align="center"></td>
<td align="center">−0.0000046</td>
<td align="center"></td>
</tr>
<tr>
<td align="right"><strong>3</strong></td>
<td align="center">0.3</td>
<td align="center">0.9553365</td>
<td align="center"></td>
<td align="center">−0.0095455</td>
<td align="center"></td>
<td align="center">0.0000958</td>
<td align="center"></td>
<td align="center">−0.0000027</td>
</tr>
<tr>
<td align="right"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">−0.0247301</td>
<td align="center"></td>
<td align="center">0.0002470</td>
<td align="center"></td>
<td align="center">−0.0000019</td>
<td align="center"></td>
</tr>
<tr>
<td align="right"><strong>2</strong></td>
<td align="center">0.2</td>
<td align="center">0.9800666</td>
<td align="center"></td>
<td align="center">−0.0097925</td>
<td align="center"></td>
<td align="center">0.0000977</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="right"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">−0.0149376</td>
<td align="center"></td>
<td align="center">0.0001493</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="right"><strong>1</strong></td>
<td align="center">0.1</td>
<td align="center">0.9950042</td>
<td align="center"></td>
<td align="center">−0.0099418</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="right"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">−0.0049958</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="right"><strong>0</strong></td>
<td align="center">0.0</td>
<td align="center">1.0000000</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody></table>
<p>取 $x &#x3D; 0.566, h &#x3D; 0.1, t &#x3D; \frac{x - 0.6}{h} &#x3D; -0.34$，得<br>$$<br>N_4(x)&#x3D; f_6 + t\nabla f_6 + \frac{t(t + 1)}{2!}\nabla^2 f_6 + \frac{t(t + 1)(t+2)}{3!}\nabla^3 f_6 +\frac{t(t + 1)(t+2)(t+3)}{4!}\nabla^4 f_6<br>$$</p>
<p>$$<br>&#x3D;0.84405\approx \cos 0.566<br>$$</p>
<p>$$<br>R_4(0.566) \leq \frac{| \sin 0.6 |}{5!} \cdot | -0.34 \cdot (-0.34 + 1) \cdots (-0.48 + 4) | \cdot (0.1)^5 \leq 1.7064 \times 10^{-7}.<br>$$</p>
<hr>
<p>给定数据表如下：</p>
<table>
<thead>
<tr>
<th>$x$</th>
<th>0.2</th>
<th>0.4</th>
<th>0.6</th>
<th>0.8</th>
<th>1.0</th>
<th>1.2</th>
</tr>
</thead>
<tbody><tr>
<td>$f(x)$</td>
<td>21</td>
<td>25</td>
<td>23</td>
<td>20</td>
<td>21</td>
<td>24</td>
</tr>
</tbody></table>
<p>(1) 用三次插值多项式计算 $f(0.7)$ 的近似值；</p>
<p>(2) 用二次插值多项式计算 $f(0.95)$ 的近似值；</p>
<p><strong>解</strong></p>
<p><strong>备注：由于节点等距，可用差分形式的牛顿插值公式</strong></p>
<p>先造差分表如下表</p>
<table>
<thead>
<tr>
<th>$y_i$</th>
<th>$\Delta y_i$</th>
<th>$\Delta^2 y_i$</th>
<th>$\Delta^3 y_i$</th>
<th>$\Delta^4 y_i$</th>
<th>$\Delta^5 y_i$</th>
</tr>
</thead>
<tbody><tr>
<td>21</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>4</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>25</td>
<td></td>
<td>-6</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>-2</td>
<td></td>
<td>5</td>
<td></td>
<td></td>
</tr>
<tr>
<td>23</td>
<td></td>
<td>-1</td>
<td></td>
<td>0</td>
<td></td>
</tr>
<tr>
<td></td>
<td>-3</td>
<td></td>
<td>5</td>
<td></td>
<td>-7</td>
</tr>
<tr>
<td>20</td>
<td></td>
<td>4</td>
<td></td>
<td>-7</td>
<td></td>
</tr>
<tr>
<td></td>
<td>1</td>
<td></td>
<td>-2</td>
<td></td>
<td></td>
</tr>
<tr>
<td>21</td>
<td></td>
<td>2</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>3</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>24</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<hr>
<p>(1) 选取 $x_1 &#x3D; 0.4,\ x_2 &#x3D; 0.6,\ x_3 &#x3D; 0.8,\ x_4 &#x3D; 1.0$ 为节点，构造三次向前 Newton 插值多项式：</p>
<p>$$<br>N_3(x_1 + th) &#x3D; y_1 + \Delta y_1 t + \frac{\Delta^2 y_1}{2!} t(t - 1) + \frac{\Delta^3 y_1}{3!} t(t - 1)(t - 2)<br>$$</p>
<p>将 $x_1$ 和 $h$ 代入上式，得：</p>
<p>$$<br>N_3(0.4 + 0.2t) &#x3D; 25 - 2t - \frac{1}{2}t(t - 1) + \frac{5}{6}t(t - 1)(t - 2)<br>$$</p>
<p>由 $0.4 + 0.2t &#x3D; 0.7$ 解得 $t &#x3D; 1.5$，所以：</p>
<p>$$<br>f(0.7) \approx N_3(0.7) &#x3D; 21.3125<br>$$</p>
<hr>
<p>(2) 选 $x_3 &#x3D; 0.8,\ x_4 &#x3D; 1.0,\ x_5 &#x3D; 1.2$ 为节点，构造二次向前 Newton 插值式：</p>
<p>$$<br>N_2(x_3 + th) &#x3D; y_3 + \Delta y_3 t + \frac{\Delta^2 y_3}{2!} t(t - 1)<br>$$</p>
<p>将 $x_3$ 和 $h$ 代入上式，得：</p>
<p>$$<br>N_2(0.8 + 0.2t) &#x3D; 20 + t + t(t - 1)<br>$$</p>
<p>由 $0.8 + 0.2t &#x3D; 0.95$ 解得 $t &#x3D; 0.75$，所以：</p>
<p>$$<br>f(0.95) \approx N_2(0.95) &#x3D; 20.5625<br>$$</p>
</blockquote>
<blockquote>
<ol start="2">
<li>给出 $f(x) &#x3D; \ln x$ 数值表</li>
</ol>
<table>
<thead>
<tr>
<th>$x$</th>
<th>0.4</th>
<th>0.5</th>
<th>0.6</th>
</tr>
</thead>
<tbody><tr>
<td>$\ln x$</td>
<td>-0.916291</td>
<td>-0.693147</td>
<td>-0.510826</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>$x$</th>
<th>0.7</th>
<th>0.8</th>
</tr>
</thead>
<tbody><tr>
<td>$\ln x$</td>
<td>-0.356675</td>
<td>-0.223144</td>
</tr>
</tbody></table>
<hr>
<p>用线性插值及二次插值计算 $\ln 0.54$ 的近似值。</p>
<h4 id="解"><a href="#解" class="headerlink" title="解"></a>解</h4><p>根据插值误差估计式选距离 $0.54$ 较近的点为插值节点，并建立差商表：</p>
<p>$$<br>\begin{aligned}<br>x_0 &amp;&#x3D; 0.5,\quad f(x_0) &#x3D; -0.693147 \<br>x_1 &amp;&#x3D; 0.6,\quad f(x_1) &#x3D; -0.510826 \<br>x_2 &amp;&#x3D; 0.4,\quad f(x_2) &#x3D; -0.916291<br>\end{aligned}<br>$$</p>
<p>差商计算如下：</p>
<p>$$<br>f[x_0, x_1] &#x3D; \frac{f(x_1) - f(x_0)}{x_1 - x_0} &#x3D; \frac{-0.510826 + 0.693147}{0.6 - 0.5} &#x3D; 1.823210<br>$$</p>
<p>$$<br>f[x_1, x_2] &#x3D; \frac{f(x_2) - f(x_1)}{x_2 - x_1} &#x3D; \frac{-0.916291 + 0.510826}{0.4 - 0.6} &#x3D; 2.027325<br>$$</p>
<p>$$<br>f[x_0, x_1, x_2] &#x3D; \frac{f[x_1, x_2] - f[x_0, x_1]}{x_2 - x_0} &#x3D; \frac{2.027325 - 1.823210}{0.4 - 0.5} &#x3D; -0.204115<br>$$</p>
<hr>
<p>写出 Newton 插值多项式：</p>
<p>$$<br>N_1(x) &#x3D; -0.693147 + 1.823210(x - 0.5)<br>$$</p>
<p>$$<br>N_2(x) &#x3D; N_1(x) + (-0.204115)(x - 0.5)(x - 0.6)<br>$$</p>
<p>计算近似值：</p>
<p><strong>一阶插值：</strong></p>
<p>$$<br>N_1(0.54) &#x3D; -0.693147 + 1.823210 \times (0.54 - 0.5) \<br>\approx -0.620219<br>$$</p>
<p><strong>二阶插值：</strong><br>$$<br>N_2(0.54) &#x3D; N_1(0.54) + (-0.204115) \times (0.54 - 0.5)(0.54 - 0.6) \<br>\approx -0.616839<br>$$</p>
</blockquote>
<h2 id="埃尔米特插值"><a href="#埃尔米特插值" class="headerlink" title="埃尔米特插值"></a>埃尔米特插值</h2><p><span style="color:blue">不仅要求函数值重合，而且要求若干阶导数也重合，这种插值问题称为埃尔米特插值问题。</span></p>
<h3 id="两个典型的埃尔米特插值多项式"><a href="#两个典型的埃尔米特插值多项式" class="headerlink" title="两个典型的埃尔米特插值多项式"></a><span style="color:#FF0000">两个典型的埃尔米特插值多项式</span></h3><ol>
<li><h4 id="二点三次埃尔米特插值多项式"><a href="#二点三次埃尔米特插值多项式" class="headerlink" title="二点三次埃尔米特插值多项式"></a>二点三次埃尔米特插值多项式</h4><p>**问题描述：**给定区间 $[x_0, x_1]$ 两端点的函数值与导数值：</p>
<table>
<thead>
<tr>
<th>$x$</th>
<th>$x_0$</th>
<th>$x_1$</th>
</tr>
</thead>
<tbody><tr>
<td>$f(x)$</td>
<td>$y_0$</td>
<td>$y_1$</td>
</tr>
<tr>
<td>$f’(x)$</td>
<td>$m_0$</td>
<td>$m_1$</td>
</tr>
</tbody></table>
<p>要求构造三次多项式 $H_3(x)$，满足：<br>$$<br>\begin{cases}<br>H_3(x_0) &#x3D; y_0, &amp; H_3(x_1) &#x3D; y_1 \<br>H_3’(x_0) &#x3D; m_0, &amp; H_3’(x_1) &#x3D; m_1<br>\end{cases}<br>$$</p>
<hr>
<p><strong>解法形式</strong></p>
<p>设 $H_3(x)$ 为：<br>$$<br>H_3(x) &#x3D; \alpha_0(x)y_0 + \alpha_1(x)y_1 + \beta_0(x)m_0 + \beta_1(x)m_1<br>$$<br>其中 $\alpha_i(x)$ 和 $\beta_i(x)$ 为基函数（<u>三次式</u>），满足以下条件：</p>
<ol>
<li><p><strong>插值条件</strong>：</p>
<ul>
<li>$\alpha_i(x_j) &#x3D; \delta_{ij}$（$\delta_{ij}$ 为克罗内克函数）</li>
<li>$\alpha’_i(x_j) &#x3D; 0$</li>
<li>$\beta_i(x_j) &#x3D; 0$</li>
<li>$ \beta’_i(x_j) &#x3D; \delta _{ij}$</li>
</ul>
</li>
<li><p><strong>基函数构造</strong>：<br>$$<br>\alpha_i(x) &#x3D; (a_i x + b_i) l_i^2(x), \quad \beta_i(x) &#x3D; c_i(x - x_i) l_i^2(x)<br>$$<br>其中 $l_i(x) &#x3D; \frac{x - x_j}{x_i - x_j}$（$j \neq i$）为拉格朗日基函数。</p>
</li>
</ol>
<hr>
<p><strong>基函数推导</strong></p>
<p>$\alpha_0(x)$ 的构造</p>
<p>通过条件 $\alpha_0(x_0) &#x3D; 1$ 和 $\alpha’_0(x_0) &#x3D; 0$，解得：<br>$$<br>\begin{cases}<br>a_0 &#x3D; -\dfrac{2}{x_0 - x_1}, \<br>b_0 &#x3D; 1 + \dfrac{2x_0}{x_0 - x_1}<br>\end{cases}<br>$$<br>最终形式为：<br>$$<br>\alpha_0(x) &#x3D; \left(1 - 2\dfrac{x - x_0}{x_0 - x_1}\right)\left(\dfrac{x - x_1}{x_0 - x_1}\right)^2 \<br>\alpha_1(x) &#x3D; \left(1 - 2\dfrac{x - x_1}{x_1 - x_0}\right)\left(\dfrac{x - x_0}{x_1 - x_0}\right)^2<br>$$</p>
<p>$\beta_i(x)$ 的构造<br>$$<br>\beta_0(x) &#x3D; (x - x_0)\left(\dfrac{x - x_1}{x_0 - x_1}\right)^2, \quad \beta_1(x) &#x3D; (x - x_1)\left(\dfrac{x - x_0}{x_1 - x_0}\right)^2<br>$$</p>
<hr>
<p><strong>最终表达式</strong><br>$$<br>H_3(x) &#x3D; y_0\left(1 - 2\dfrac{x - x_0}{x_0 -x_1}\right)\left(\dfrac{x - x_1}{x_0 - x_1}\right)^2<br>$$</p>
</li>
</ol>
<p>$$<br>+y_1\left(1 - 2\dfrac{x - x_1}{x_1 - x_0}\right)\left(\dfrac{x - x_0}{x_1 - x_0}\right)^2<br>$$</p>
<p>$$<br>+m_0(x - x_0)\left(\dfrac{x - x_1}{x_0 - x_1}\right)^2 + m_1(x - x_1)\left(\dfrac{x - x_0}{x_1 - x_0}\right)^2<br>$$</p>
<blockquote>
<p>$$<br>\sum_{i&#x3D;0}^1 \alpha_i(x) &#x3D; 1 \quad \text{（当 $f(x) &#x3D; 1$ 时）}<br>$$</p>
</blockquote>
<blockquote>
<p><strong>余项为：</strong><br>$$<br>R_3(x)&#x3D;\frac{1}{4!}f^{(4)}(\xi)(x-x_0)^2(x-x_1)^2\<br>\xi \in(x_0,x_1)<br>$$</p>
</blockquote>
<ol start="2">
<li><h4 id="三点三次带一个导数值的插值多项式"><a href="#三点三次带一个导数值的插值多项式" class="headerlink" title="三点三次带一个导数值的插值多项式"></a>三点三次带一个导数值的插值多项式</h4></li>
</ol>
<p><strong>问题描述</strong></p>
<p>给定函数表如下：</p>
<table>
<thead>
<tr>
<th>$x$</th>
<th>$x_0$</th>
<th>$x_1$</th>
<th>$x_2$</th>
</tr>
</thead>
<tbody><tr>
<td>$f(x)$</td>
<td>$y_0$</td>
<td>$y_1$</td>
<td>$y_2$</td>
</tr>
<tr>
<td>$f’(x)$</td>
<td></td>
<td>$m_1$</td>
<td></td>
</tr>
</tbody></table>
<p>要求构造三次多项式 $H_3(x)$，满足：<br>$$<br>\begin{cases}<br>H_3(x_i) &#x3D; y_i, &amp; i &#x3D; 0, 1, 2 \<br>H_3’(x_1) &#x3D; m_1<br>\end{cases}<br>$$</p>
<p><strong>解法形式</strong></p>
<p>利用满足插值条件的 Newton 插值多项式，设：<br>$$<br>H_3(x) &#x3D; y_0 + f[x_0, x_1](x - x_0) + f[x_0, x_1, x_2](x - x_0)(x - x_1) + k(x - x_0)(x - x_1)(x - x_2)<br>$$<br>其中 $k$ 为待定系数。</p>
<p><strong>待定系数求解</strong></p>
<p>通过导数条件 $H_3’(x_1) &#x3D; m_1$ 确定 $k$：<br>$$<br>H_3’(x_1) &#x3D; f[x_0, x_1] + f[x_0, x_1, x_2](x_1 - x_0) + k(x_1 - x_0)(x_1 - x_2) &#x3D; m_1<br>$$<br>解得：<br>$$<br>k &#x3D; \frac{m_1 - f[x_0, x_1] - f[x_0, x_1, x_2](x_1 - x_0)}{(x_1 - x_0)(x_1 - x_2)}<br>$$</p>
<p><strong>最终表达式</strong></p>
<p>将 $k$ 代入后，$H_3(x)$ 的完整形式为：<br>$$<br>H_3(x) &#x3D; y_0 + f[x_0, x_1](x - x_0) + f[x_0, x_1, x_2](x - x_0)(x - x_1) \<br>+\frac{m_1 - f[x_0, x_1] - f[x_0, x_1, x_2](x_1 - x_0)}{(x_1 - x_0)(x_1 - x_2)} (x - x_0)(x - x_1)(x - x_2)<br>$$</p>
<blockquote>
<p>余项为：<br>$$<br>R(x)&#x3D;\frac{1}{4!}f^{(4)}(\xi)(x-x_0)(x-x_1)^2(x-x_2)\<br>\xi \in(x_0,x_2)<br>$$</p>
</blockquote>
<blockquote>
<p><strong>例题</strong></p>
<p>若$f(x)$在$[a,b]$上有三阶连续导数，试求满足条件</p>
<p>$$H(x_0) &#x3D; f(x_0), H(x_1) &#x3D; f(x_1), H’(x_0) &#x3D; f’(x_0)$$</p>
<p>的插值多项式及其余项。</p>
<p><strong>解</strong><br>$$<br>H_2(x) &#x3D; f(x_0) + (x - x_0) f[x_0, x_1] + A(x - x_0)(x - x_1)<br>$$</p>
<p>再由条件$H’(x_0) &#x3D; f’(x_0)$，可得</p>
<p>$$<br>A &#x3D; \frac{f[x_0, x_1] - f’(x_0)}{x_1 - x_0}.<br>$$<br>构造补函数$g(t) &#x3D; f(t) - H(t) - K(x)(t - x_0)^2 (t - x_1)$，得余项</p>
<p>$$<br>R(x) &#x3D; f(x) - H(x) &#x3D; \frac{f^{(3)}(\xi)}{6} (x - x_0)^2 (x - x_1)<br>$$<br>PS:余项公式有以下规律</p>
<ol>
<li><p>余项公式的阶数要比插值多项式多一阶，此项$ (x - x_0)^2 (x - x_1)$依赖题目条件：提供函数和导数条件的为2次项，其余为1次项</p>
</li>
<li><p>$\frac{f^{(3)}(\xi)}{6}$此项与拉格朗日余项$R_n(x)$中的$\frac{f^{(n+1)}(\xi)}{(n+1)!}$一致保持</p>
</li>
</ol>
</blockquote>
<blockquote>
<p>  <strong>例题</strong></p>
<p>  给定$f(x) &#x3D; x^{3&#x2F;2}, x_0 &#x3D; \frac{1}{4}, x_1 &#x3D; 1, x_2 &#x3D; \frac{9}{4}$，试求$f(x)$在$\left[\frac{1}{4}, \frac{9}{4}\right]$上的三次插值多项式$P(x)$，使它满足$P(x_i) &#x3D; f(x_i) \ (i &#x3D; 0, 1, 2), P’(x_1) &#x3D; f’(x_1)$，并写出余项表达式。</p>
<p>  <strong>解</strong> </p>
<p>  由所给节点可求出<br>  $$<br>  f_0 &#x3D; f\left(\frac{1}{4}\right) &#x3D; \frac{1}{8}, f_1 &#x3D; f(1) &#x3D; 1, f_2 &#x3D; f\left(\frac{9}{4}\right) &#x3D; \frac{27}{8},<br>  $$</p>
<p>  $$<br>  f[x_0, x_1] &#x3D; \frac{7}{6}, f[x_0, x_1, x_2] &#x3D; \frac{11}{30}.<br>  $$<br>  故可令<br>  $$<br>  P(x) &#x3D;f_0+f[x_0, x_1] (x-x_0)+f[x_0, x_1, x_2] (x-x_0)(x-x_1)+A(x-x_0)(x-x_1)(x-x_2)<br>  $$</p>
<p>  $$<br>  &#x3D; \frac{1}{8} + \frac{7}{6} \left( x - \frac{1}{4} \right) + \frac{11}{30} \left( x - \frac{1}{4} \right) \left( x - 1 \right) + A \left( x - \frac{1}{4} \right) \left( x - 1 \right) \left( x - \frac{9}{4} \right).<br>  $$</p>
<p>  再由条件$P’(1) &#x3D; f’(1) &#x3D; \frac{3}{2}$可得</p>
<p>  $$A &#x3D; - \frac{14}{225}$$</p>
<p>  于是所求的三次插值多项式为</p>
<p>  $$<br>  P(x) &#x3D; \frac{1}{8} + \frac{7}{6} \left( x - \frac{1}{4} \right) + \frac{11}{30} \left( x - \frac{1}{4} \right) \left( x - 1 \right) - \frac{14}{225} \left( x - \frac{1}{4} \right) \left( x - 1 \right) \left( x - \frac{9}{4} \right)<br>  $$</p>
<p>  余项为</p>
<p>  $$<br>  R(x) &#x3D; f(x) - P(x) &#x3D; \frac{f^{(4)}(\xi)}{4!} \left( x - \frac{1}{4} \right) \left( x - 1 \right)^2 \left( x - \frac{9}{4} \right),<br>  $$</p>
<p>  其中$\xi \in \left[ \frac{1}{4}, \frac{9}{4} \right]$。</p>
</blockquote>
<blockquote>
<p><strong>例题</strong></p>
<p>求一个次数不高于 4 次的多项式 $P(x)$，使它满足：<br>$$<br>P(0) &#x3D; P’(0) &#x3D; 0,\quad P(1) &#x3D; P’(1) &#x3D; 1,\quad P’(2) &#x3D; 1<br>$$</p>
<hr>
<h3 id="解-1"><a href="#解-1" class="headerlink" title="解"></a>解</h3><p>满足 $H_3(0) &#x3D; H_3’(0) &#x3D; 0,\ H_3(1) &#x3D; H_3’(1) &#x3D; 1$ 的 Hermite 插值多项式为（其中 $x_0 &#x3D; 0,\ x_1 &#x3D; 1$）：</p>
<p>$$<br>H_3(x) &#x3D; \sum_{j&#x3D;0}^{1} \left[ H_3(x_j)\alpha_j(x) + H_3’(x_j)\beta_j(x) \right]<br>$$</p>
<p>其中：</p>
<p>$$<br>\alpha_0(x) &#x3D; \left[1 - 2\frac{x - 0}{1 - 0}\right] \left( \frac{x - 1}{0 - 1} \right)^2 \<br>&#x3D; (1 - 2x)(1 - x)^2<br>$$</p>
<p>$$<br>\beta_0(x) &#x3D; (x - 0)\left( \frac{x - 1}{0 - 1} \right)^2 &#x3D; x(1 - x)^2<br>$$</p>
<p>$$<br>\alpha_1(x) &#x3D; \left[1 - 2\frac{x - 1}{0 - 1}\right] \left( \frac{x - 0}{1 - 0} \right)^2 &#x3D; (2x - 1)x^2<br>$$</p>
<p>$$<br>\beta_1(x) &#x3D; (x - 1) \left( \frac{x - 0}{1 - 0} \right)^2 &#x3D; (x - 1)x^2<br>$$</p>
<p>代入得：</p>
<p>$$<br>H_3(x) &#x3D; [1 - 2x](1 - x)^2 + (x - 1)(x^2) &#x3D; 2x^2 - x^3<br>$$</p>
<p>设：</p>
<p>$$<br>P(x) &#x3D; H_3(x) + Ax^2(x - 1)^2<br>$$</p>
<p>令 $P(2) &#x3D; 1$，代入得：</p>
<p>$$<br>P(2) &#x3D; 2 \cdot 4 - 8 + A \cdot 4 \cdot 1 &#x3D; 0 + 4A &#x3D; 1 \Rightarrow A &#x3D; \frac{1}{4}<br>$$</p>
<p>所以：</p>
<p>$$<br>P(x) &#x3D; 2x^2 - x^3 + \frac{1}{4}x^2(x - 1)^2<br>&#x3D; \frac{1}{4}x^2(x - 3)^2<br>$$</p>
</blockquote>
<h3 id="一般埃尔米特插值多项式"><a href="#一般埃尔米特插值多项式" class="headerlink" title="一般埃尔米特插值多项式"></a>一般埃尔米特插值多项式</h3><p><strong>问题描述</strong></p>
<p>已知节点 $x_0, x_1, \ldots, x_n$ 处的函数值 $y_0, y_1, \ldots, y_n$ 和导数值 $y’_0, y’_1, \ldots, y’_n$</p>
<p>要求构造次数为 $2n+1$ 的多项式$H_{2n+1}(x)$（这样的Hermite 插值唯一），满足：<br>$$<br>\begin{cases}<br>H_{2n+1}(x_i) &#x3D; y_i, \<br>H’_{2n+1}(x_i) &#x3D; y’_i<br>\end{cases}<br>\quad (i &#x3D; 0, 1, \ldots, n)<br>$$</p>
<p><strong>解法形式</strong></p>
<p>设多项式为：<br>$$<br>H_{2n+1}(x) &#x3D; \sum_{i&#x3D;0}^n y_i \alpha_i(x) + \sum_{i&#x3D;0}^n y’_i \beta_i(x)<br>$$</p>
<p>其中基函数 $\alpha_i(x)$ 和 $\beta_j(x)$ 满足：<br>$$<br>\alpha_i(x_j) &#x3D; \delta_{ij} \quad \alpha’_i(x_j) &#x3D; 0 ;<br>$$</p>
<p>$$<br>\beta_i(x_j) &#x3D; 0 \quad \beta^{‘} _i(x_j) &#x3D; \delta _{ij}<br>$$</p>
<blockquote>
<p>$\alpha_i(x)$ 和 $\beta_i(x)$ 均为 $2n+1$ 次多项式。</p>
</blockquote>
<p><strong>基函数构造</strong></p>
<p><u>$\alpha_i(x)$ 的构造</u></p>
<ol>
<li><p><strong>零点性质</strong>：$\alpha_i(x)$ 在 $x_0, x_1, \ldots, x_n$ 处有二重零点（除 $x_i$ 外）。</p>
</li>
<li><p><strong>形式假设</strong>：<br>$$<br>\alpha_i(x) &#x3D; [A_ix + B_i] l_i^2(x)<br>$$<br>其中 $l_i(x) &#x3D; \prod_{\substack{\ i \neq i}} \dfrac{x - x_j}{x_i - x_j}$ 为拉格朗日基函数。</p>
</li>
<li><p><strong>条件求解</strong>：</p>
<ul>
<li>$\alpha_i(x_i) &#x3D; 1 \Rightarrow B_i &#x3D; 1$</li>
<li>$\alpha’_i(x_i) &#x3D; 0 \Rightarrow A_i &#x3D; -2 l_i’(x_i)$</li>
</ul>
<p>最终形式为：<br>$$<br>\alpha_i(x) &#x3D; \left[ 1 - 2 l_i’(x_i)(x - x_i) \right] l_i^2(x)<br>$$</p>
</li>
</ol>
<p><u>$\beta_i(x)$ 的构造</u></p>
<ol>
<li><p><strong>零点性质</strong>：$\beta_i(x)$ 在 $x_0, x_1, \ldots, x_n$ 处有二重零点（除 $x_i$ 外）。</p>
</li>
<li><p><strong>形式假设</strong>：<br>$$<br>\beta_i(x) &#x3D; C_i (x - x_i) l_i^2(x)<br>$$</p>
</li>
<li><p><strong>条件求解</strong>：</p>
<ul>
<li>$\beta’_i(x_i) &#x3D; 1 \Rightarrow C_i &#x3D; 1$</li>
</ul>
<p>最终形式为：<br>$$<br>\beta_i(x) &#x3D; (x - x_i) l_i^2(x)<br>$$</p>
</li>
</ol>
<blockquote>
<p><span style="color:blue"><strong>余项分析</strong></span></p>
<p>设区间 $[a, b]$ 满足 $a &#x3D; x_0 &lt; x_1 &lt; \cdots &lt; x_n &#x3D; b$，且 $f \in C^{2n}&gt;[a, b]$，则插值余项为：<br>$$<br>R_n(x) &#x3D; \frac{f^{(2n+2)}(\xi)}{(2n+2)!} \left[ \prod_{i&#x3D;0}^n (x - x_i) \right]^2<br>$$<br>其中 $\xi \in (a, b)$。</p>
</blockquote>
<h3 id="例题-1"><a href="#例题-1" class="headerlink" title="例题"></a>例题</h3><h2 id="分段低次插值"><a href="#分段低次插值" class="headerlink" title="分段低次插值"></a>分段低次插值</h2><h3 id="分段线性插值"><a href="#分段线性插值" class="headerlink" title="分段线性插值"></a>分段线性插值</h3><p><strong>定义</strong></p>
<p>设已知节点 $a&lt;x_0 &lt; x_1 &lt; \cdots &lt; x_n &#x3D; b$ 处的函数值为 $f_0, f_1, \ldots, f_n$，记区间宽度：<br>$$<br>h_k &#x3D; x_{k+1} - x_k, \quad h &#x3D; \max_{k} h_k<br>$$<br>分段线性插值通过折线段连接插值点逼近 $f(x)$，构造折线函数 $I_h(x)$ 满足：</p>
<ol>
<li><strong>连续性</strong>：$I_h(x) \in C[a, b]$</li>
<li><strong>插值条件</strong>：$I_h(x_k) &#x3D; f_k \quad (k &#x3D; 0, 1, \ldots, n)$</li>
<li><strong>分段线性</strong>：在每段区间 $[x_k, x_{k+1}]$ 上，$I_h(x)$ 为线性函数。</li>
</ol>
<p><strong>分段线性插值函数可表示为：</strong><br>$$<br>I_h(x) &#x3D; \sum_{k&#x3D;0}^n f_k l_k(x)<br>$$<br>其中 $l_k(x)$ 为分段线性基函数。</p>
<p><strong>基函数定义</strong></p>
<p>基函数 $l_k(x)$ 在区间内的表达式为：<br>$$<br>l_k(x) &#x3D;<br>\begin{cases}<br>\dfrac{x - x_{k-1}}{x_k - x_{k-1}}, &amp; x \in [x_{k-1}, x_k] \quad (k \neq 0) \<br>\dfrac{x - x_{k+1}}{x_k - x_{k+1}}, &amp; x \in [x_k, x_{k+1}] \quad (k \neq n) \<br>0, &amp; x \notin [x_{k-1}, x_{k+1}]<br>\end{cases}<br>$$</p>
<p><strong>区间分段表达式</strong></p>
<p>左半区间 $[x_{k-1}, x_k]$：<br>$$<br>I_h(x) &#x3D; \dfrac{x - x_{k-1}}{x_k - x_{k-1}} f_k + \dfrac{x - x_k}{x_{k-1} - x_k} f_{k-1}<br>$$</p>
<p>右半区间 $[x_k, x_{k+1}]$：<br>$$<br>I_h(x) &#x3D; \dfrac{x - x_{k+1}}{x_k - x_{k+1}} f_k + \dfrac{x - x_k}{x_{k+1} - x_k} f_{k+1}<br>$$</p>
<p><strong>收敛性与性质</strong></p>
<ol>
<li><p><strong>一致收敛性</strong>：当 $h \to 0$ 时，$I_h(x)$ 在 $[a, b]$ 上一致收敛到 $f(x)$。</p>
</li>
<li><p><strong>光滑性缺失</strong>：分段线性插值函数仅连续（$C^0$），但不可导（失去原函数的光滑性）。</p>
<blockquote>
<p><strong><span style="color:blue">插值误差</span></strong><br>$$<br>\max_{x_k \leq x \leq x_{k+1}} |f(x) - I_h(x)| \leq \frac{M_2}{2} \max_{x_k \leq x \leq x_{k+1}} |(x - x_k)(x - x_{k+1})|<br>$$<br>或<br>$$<br>\max_{a \leq x \leq b} |f(x) - I_h(x)| \leq \frac{M_2}{8} h^2<br>$$<br>其中<br>$$<br>M_2 &#x3D; \max_{a \leq x \leq b} |f’’(x)|<br>$$</p>
</blockquote>
</li>
</ol>
<h3 id="分段三次-Hermite-插值"><a href="#分段三次-Hermite-插值" class="headerlink" title="分段三次 Hermite 插值"></a>分段三次 Hermite 插值</h3><p><u><strong>问题描述</strong></u></p>
<p>在节点 $x_0 &lt; x_1 &lt; \cdots &lt; x_n$ 上已知函数值 $f_k$ 和导数值 $f’_k &#x3D; m_k$，构造分段插值多项式函数 $I_h(x)$ 满足：</p>
<ol>
<li><p><strong>光滑性</strong>：$I_h \in C^1[a, b]$</p>
</li>
<li><p><strong>插值条件</strong>：<br>$$<br>I_h(x_k) &#x3D; f_k, \quad I’_h(x_k) &#x3D; f’_k \quad (k &#x3D; 0, 1, \ldots, n)<br>$$</p>
</li>
<li><p><strong>分段三次多项式</strong>：在每段区间 $[x_k, x_{k+1}]$ 上，$I_h(x)$ 为三次多项式。</p>
</li>
</ol>
<p><u><strong>全局表达式</strong></u></p>
<p>插值函数可表示为：<br>$$<br>I_h(x) &#x3D; \sum_{k&#x3D;0}^n \left[ f(x_k) \alpha_k(x) + f’(x_k) \beta_k(x) \right]<br>$$</p>
<p><u><strong>区间局部表达式</strong></u></p>
<p>在区间 $[x_k, x_{k+1}]$ 上的具体形式为：<br>$$<br>I_h(x) &#x3D; \left( \dfrac{x - x_{k+1}}{x_k - x_{k+1}} \right)^2 \left( 1 + 2 \dfrac{x - x_k}{x_{k+1} - x_k} \right) f_k<br>+\left( \dfrac{x - x_k}{x_{k+1} - x_k} \right)^2 \left( 1 + 2 \dfrac{x - x_{k+1}}{x_k - x_{k+1}} \right) f_{k+1}<br>$$</p>
<p>$$<br>+\left( \dfrac{x - x_{k+1}}{x_k - x_{k+1}}  \right)^2 (x - x_k) f’ _k<br>$$</p>
<p>$$<br>+\left( \dfrac{x - x_k}{x_{k+1} - x_k}  \right)^2 (x - x_{k+1}) f’ _{k+1}<br>$$</p>
<p><u><strong>基函数定义</strong></u></p>
<p>$\alpha_k(x)$ 的分段表达式<br>$$<br>\alpha_k(x) &#x3D;<br>\begin{cases}<br>\left(\dfrac{x - x_{k-1}}{x_k - x_{k-1}} \right)^2 \left( 1 + 2 \dfrac{x - x_k}{x_{k-1} - x_k} \right), &amp; x \in [x_{k-1}, x_k] \quad (k \neq 0) \<br>\left(\dfrac{x - x_{k+1}}{x_k - x_{k+1}} \right)^2 \left( 1 + 2 \dfrac{x - x_k}{x_{k+1} - x_k} \right), &amp; x \in [x_k, x_{k+1}] \quad (k \neq n) \<br>0, &amp; \text{其他区间}<br>\end{cases}<br>$$</p>
<p>$\beta_k(x)$ 的分段表达式<br>$$<br>\beta_k(x) &#x3D;<br>\begin{cases}<br>\left( \dfrac{x - x_{k-1}}{x_k - x_{k-1}} \right)^2 (x - x_k), &amp; x \in [x_{k-1}, x_k] \quad (k \neq 0) \<br>\left( \dfrac{x - x_{k+1}}{x_k - x_{k+1}} \right)^2 (x - x_k), &amp; x \in [x_k, x_{k+1}] \quad (k \neq n) \<br>0, &amp; \text{其他区间}<br>\end{cases}<br>$$</p>
<blockquote>
<p><strong>误差估计：</strong><br>$$<br>|f(x) - I_h(x)| \leq \frac{1}{384}h_k^4 \max_{x_k \leq x \leq x_{k+1}} |f^{(4)}(x)| \<br>x\in[x_k,x_{k+1}] \<br>h_k&#x3D;x_{k+1}-x_k<br>$$</p>
<p>设函数满足：</p>
<ul>
<li>$ f \in C^4[a,b] $</li>
<li>$ I_h(x) $ 是 $ f(x) $ 在节点</li>
</ul>
<p>$$<br>a &#x3D; x_0 &lt; x_1 &lt; \cdots &lt; x_n &#x3D; b<br>$$</p>
<p>上的分段三次埃尔米特插值多项式</p>
<p>则有全局误差估计：<br>$$<br>\max_{a \leq x \leq b} |f(x) - I_h(x)| \leq \frac{h^4}{384} \max_{a \leq x \leq b} |f^{(4)}(x)| \<br>h&#x3D;\max_{0 \leq k \leq n-1}(x_{k+1}-x_k)<br>$$</p>
</blockquote>
<blockquote>
<p><span style="color:blue">$C^k$表示函数有K阶连续导数；$C^0$表述函数连续，没有要求可导</span></p>
</blockquote>
<h2 id="样条插值"><a href="#样条插值" class="headerlink" title="样条插值"></a>样条插值</h2><h3 id="样条插值的概念"><a href="#样条插值的概念" class="headerlink" title="样条插值的概念"></a>样条插值的概念</h3><p>对于给定节点 $a&#x3D;x_0&lt;x_1&lt;\cdots&lt;x_n&#x3D;b$，若存在函数 $s(x)$ 满足：  </p>
<ol>
<li>在每个小区间 $\left[x_j, x_{j+1}\right]$ 是一个次数不超过 3 次的多项式；  </li>
<li>在每一个内节点上具有直到二阶的连续导数，<br>则称 $s(x)$ 是节点 $x_0, x_1,\cdots, x_n$ 上的三次样条函数。</li>
</ol>
<ol start="3">
<li><p>若在节点上给定函数值 $f\left(x_j\right)&#x3D;y_j(j&#x3D;0,\cdots, n)$，并满足  </p>
<p>$s\left(x_j\right)&#x3D;y_j, j&#x3D;0,\cdots, n$  </p>
<p>则称 $s(x)$ 是三次样条插值函数。</p>
</li>
</ol>
<h3 id="三次样条插值函数-s-x-的确定"><a href="#三次样条插值函数-s-x-的确定" class="headerlink" title="三次样条插值函数 $s(x)$ 的确定"></a>三次样条插值函数 $s(x)$ 的确定</h3><span>
$$
s(x)=\left\{\begin{array}{c} 
s_1(x), & x_0\leq x\leq x_1, \\
\ldots \\
s_n(x), & x_{n-1}\leq x\leq x_n.
\end{array}\right.
$$
</span>

<p>在每个 $\left[x_j, x_{j+1}\right]$ 上要确定 4 个待定系数，共 $4n$ 个参数。因二阶导数连续，故在内节点 $x_j$ 上满足连续性条件：<br>$$<br>\begin{gathered}<br>s\left(x_j-0\right)&#x3D;s\left(x_j+0\right), \quad s^{\prime}\left(x_j-0\right)&#x3D;s^{\prime}\left(x_j+0\right), \<br>s^{\prime\prime}\left(x_j-0\right)&#x3D;s^{\prime\prime}\left(x_j+0\right), \quad (j&#x3D;1,\cdots, n-1)<br>\end{gathered}<br>$$</p>
<p>再加上插值条件，共 $4n-2$ 个条件。还需 2 个条件，通常在两个端点加上边界条件。</p>
<h3 id="常见三种边界条件"><a href="#常见三种边界条件" class="headerlink" title="常见三种边界条件"></a>常见三种边界条件</h3><ol>
<li><p><strong>第一种边界条件</strong>(已知两端的<strong>一阶</strong>导数值)<br>$$<br>s^{\prime}\left(x_0\right)&#x3D;y_0^{\prime}\<br>s^{\prime}\left(x_n\right)&#x3D;y_n^{\prime}<br>$$</p>
</li>
<li><p><strong>第二种边界条件</strong>：(已知两端的<strong>二阶</strong>导数值)<br>$$<br>s^{\prime\prime}\left(x_0\right)&#x3D;y_0^{\prime\prime} \s^{\prime\prime}\left(x_n\right)&#x3D;y_n^{\prime\prime}<br>$$</p>
<p>特别地，<strong>自然边界条件</strong>：$s^{\prime\prime}\left(x_0\right)&#x3D;0, \quad s^{\prime\prime}\left(x_n\right)&#x3D;0$。  </p>
</li>
<li><p><strong>第三种边界条件（周期边界条件）</strong>($f(x)$以$x_n-x_0$为周期的周期函数)<br>$$<br>s^{\prime}\left(x_0+0\right)&#x3D;s^{\prime}\left(x_n-0\right)\<br>s^{\prime\prime}\left(x_0+0\right)&#x3D;s^{\prime\prime}\left(x_n-0\right)<br>$$</p>
<p><em>注意</em>：因插值条件 $y_0&#x3D;y_n$，故 $s\left(x_0+0\right)&#x3D;s\left(x_n-0\right)$ 已经成立。</p>
</li>
</ol>
<h3 id="三次样条插值函数的建立"><a href="#三次样条插值函数的建立" class="headerlink" title="三次样条插值函数的建立"></a>三次样条插值函数的建立</h3><p>求三次样条插值函数常用<strong>三弯矩法</strong>和<strong>三转角法</strong>。</p>
<p><strong>三转角法</strong></p>
<p>假定 $s^{\prime}\left(x_j\right)&#x3D;m_j(j&#x3D;0,\cdots, n)$，根据分段三次埃尔米特插值多项式，<br>$$<br>s(x)&#x3D;\sum_{j&#x3D;0}^n\left[f_j\alpha_j(x)+m_j\beta_j(x)\right]<br>$$</p>
<p>由插值条件、连续性条件和边界条件，可得关于 $m_j$ 的三对角方程组，求出 $m_j$，得到三次样条插值函数。</p>
<p><strong>三弯矩法</strong></p>
<p>令<br>$$<br>s^{\prime\prime}\left(x_j\right)&#x3D;M_j, \quad j&#x3D;0,\cdots, n,<br>$$</p>
<p>$$<br>\quad h_j&#x3D;x_{j+1}-x_j<br>$$</p>
<p>则<br>$$<br>s^{\prime\prime}(x)&#x3D;\frac{x_{j+1}-x}{h_j} M_{j}+\frac{x-x_j}{h_j} M_{j+1}, \quad x\in\left[x_j, x_{j+1}\right]<br>$$</p>
<p>对$s’’(x)$积分两次并利用$s\left(x_{j+1}\right)&#x3D;y_{j+1} \quad s\left(x_{j+1}\right)&#x3D;y_{j+1}$</p>
<span>
$$
\begin{aligned}
s^{\prime}(x) &= -\frac{\left(x_{j+1}-x\right)^{2}}{2 h_{j}} M_{j} + \frac{\left(x-x_{j}\right)^{2}}{2 h_{j}} M_{j+1} + c_{1}, \\
s(x) &= \frac{\left(x_{j+1}-x\right)^{3}}{6 h_{j}} M_{j} + \frac{\left(x-x_{j}\right)^{3}}{6 h_{j}} M_{j+1} + c_{1} x + c_{2}, \\
s\left(x_{j}\right) &= \frac{1}{6} h_{j}^{2} M_{j} + c_{1} x_{j} + c_{2} = y_{j}, \\
s\left(x_{j+1}\right) &= \frac{1}{6} h_{j}^{2} M_{j+1} + c_{1} x_{j+1} + c_{2} = y_{j+1}, \\
c_{1} &= \frac{y_{j+1}-y_{j}}{h_{j}} - \frac{1}{6} h_{j}\left(M_{j+1}-M_{j}\right), \\
c_{2} &= \frac{y_{j} x_{j+1} - y_{j+1} x_{j}}{h_{j}} - \frac{1}{6} h_{j}\left(x_{j+1} M_{j} - x_{j} M_{j+1}\right).
\end{aligned}
$$
</span>
$$
s(x) = \frac{\left(x_{j+1}-x\right)^{3}}{6 h_{j}} M_{j} + \frac{\left(x-x_{j}\right)^{3}}{6 h_{j}} M_{j+1} + \left(y_{j}-\frac{M_{j} h_{j}^{2}}{6}\right)\frac{x_{j+1}-x}{h_{j}} + \left(y_{j+1}-\frac{M_{j+1} h_{j}^{2}}{6}\right)\frac{x-x_{j}}{h_{j}}
$$

<p>$$<br>s^{\prime}(x) &#x3D; -\frac{\left(x_{j+1}-x\right)^2}{2 h_j} M_{j} + \frac{\left(x-x_j\right)^2}{2 h_j} M_{j+1} + \frac{y_{j+1}-y_j}{h_j} - \frac{M_{j+1}-M_{j}}{6} h_{j}.<br>$$</p>
<p>为了求 $M_0,\cdots, M_n$，要用导数连续条件：$s^{\prime}\left(x_j+0\right)&#x3D;s^{\prime}\left(x_j-0\right)$。</p>
<span>
$$
\begin{align*}
s^{\prime}\left(x_{j}+0\right) &= -\frac{h_{j}}{3} M_{j} - \frac{h_{j}}{6} M_{j+1} + \frac{y_{j+1}-y_{j}}{h_{j}}, \\
s^{\prime}\left(x_{j+1}-0\right) &= \frac{h_{j}}{6} M_{j} + \frac{h_{j}}{3} M_{j+1} + \frac{y_{j+1}-y_{j}}{h_{j}}, \\
s^{\prime}\left(x_{j}-0\right) &= \frac{h_{j-1}}{6} M_{j-1} + \frac{h_{j-1}}{3} M_{j} + \frac{y_{j-1}-y_{j-1}}{h_{j-1}}. \\
\frac{h_{j-1}}{6} M_{j-1} + \frac{h_{j-1}+h_{j}}{3} M_{j} + \frac{h_{j}}{6} M_{j+1} &= \frac{y_{j}-y_{j-1}}{h_{j-1}} - \frac{y_{j+1}-y_{j}}{h_{j}}, \quad j=1,\cdots, n-1,
\end{align*}
$$
</span>
$$
\mu_{j} M_{j-1} + 2 M_{j} + \lambda_{j} M_{j+1} = d_{j}, \quad j=1,\cdots, n-1,
$$

<p>解得<br>$$<br>d_{j}&#x3D;6 f\left[x_{j-1}, x_{j}, x_{j+1}\right]<br>$$</p>
<p>$$<br>\lambda_{j}&#x3D; \frac{h_j}{h_{j-1}+h_j}<br>$$</p>
<p>$$<br>\mu_j &#x3D; \frac{h_{j-1}}{h_{j-1}+h_j}<br>$$</p>
<h4 id="第一边界条件"><a href="#第一边界条件" class="headerlink" title="第一边界条件"></a>第一边界条件</h4><span>
$$
\begin{bmatrix}
2 & \lambda_0 & & & \\
\mu_1 & 2 & \lambda_1 & & \\
 & \ddots & \ddots & \ddots & \\
 & & \mu_{n-1} & 2 & \lambda_{n-1} \\
 & & & \mu_{n} & 2
\end{bmatrix}
\begin{bmatrix}
M_0 \\
M_1 \\
\vdots \\
M_{n-1} \\
M_n
\end{bmatrix}
=
\begin{bmatrix}
d_0 \\
d_1 \\
\vdots \\
d_{n-1} \\
d_n
\end{bmatrix}
$$
</span>

<blockquote>
<p>$$<br>\lambda_0 &#x3D; 1\<br>\mu_n &#x3D; 1\<br>\quad h_j&#x3D;x_{j+1}-x_j<br>$$<br>$$<br>d_0 &#x3D; \frac{6}{h_0} \left( f[x_0, x_1] - f’_0 \right)<br>$$</p>
<p>$$<br>d_j &#x3D; 6 \frac{f[x_j, x_{j+1}] - f[x_{j-1}, x_j]}{h_{j-1} + h_j} &#x3D; 6 f[x_{j-1}, x_j, x_{j+1}], \quad j &#x3D; 1, 2, \dots, n-1<br>$$</p>
<p>$$<br>d_n &#x3D; \frac{6}{h_{n-1}} \left( f’_n - f[x _{n-1}, x_n] \right)<br>$$</p>
<p>$$<br>\lambda_{j}&#x3D; \frac{h_j}{h_{j-1}+h_j}\<br>\mu_j &#x3D; \frac{h_{j-1}}{h_{j-1}+h_j}<br>$$</p>
<p>$$<br>s(x) &#x3D; \frac{\left(x_{j+1}-x\right)^{3}}{6 h_{j}} M_{j} + \frac{\left(x-x_{j}\right)^{3}}{6 h_{j}} M_{j+1} + \left(y_{j}-\frac{M_{j} h_{j}^{2}}{6}\right)\frac{x_{j+1}-x}{h_{j}} + \left(y_{j+1}-\frac{M_{j+1} h_{j}^{2}}{6}\right)\frac{x-x_{j}}{h_{j}}<br>$$</p>
</blockquote>
<p><strong>第二边界条件矩阵方程</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">\begin&#123;bmatrix&#125;</span><br><span class="line">2 &amp; \lambda_1 &amp; &amp; \\</span><br><span class="line">\mu_2 &amp; 2 &amp; \lambda_2 &amp; \\</span><br><span class="line"> &amp; \ddots &amp; \ddots &amp; \ddots \\</span><br><span class="line"> &amp; &amp; \mu_&#123;n-1&#125; &amp; 2</span><br><span class="line">\end&#123;bmatrix&#125;</span><br><span class="line">\begin&#123;bmatrix&#125;</span><br><span class="line">M_1 \\</span><br><span class="line">M_2 \\</span><br><span class="line">\vdots \\</span><br><span class="line">M_&#123;n-1&#125;</span><br><span class="line">\end&#123;bmatrix&#125;</span><br><span class="line">=</span><br><span class="line">\begin&#123;bmatrix&#125;</span><br><span class="line">d_1 - \mu_1 f&#x27;&#x27;_0 \\</span><br><span class="line">d_2 \\</span><br><span class="line">\vdots \\</span><br><span class="line">d_&#123;n-1&#125; - \lambda_&#123;n-1&#125; f&#x27;&#x27;_n</span><br><span class="line">\end&#123;bmatrix&#125;</span><br></pre></td></tr></table></figure>



<p><img src="/blog/image/Snipaste_2025-05-14_14-45-25.png"></p>
<p>边界条件约束：</p>
<span>
$$
\begin{cases}
M_0 = f''_0 \\
M_n = f''_n
\end{cases}
$$

</span>

<p><strong>第三边界条件（周期边界条件）矩阵方程</strong></p>
<span>
$$
\begin{bmatrix}
2 & \lambda_1 & & & \mu_1 \\
\mu_2 & 2 & \lambda_2 & & \\
 & \ddots & \ddots & \ddots & \\
 & & \mu_{n-1} & 2 & \lambda_{n-1} \\
\lambda_n & & & \mu_n & 2
\end{bmatrix}
\begin{bmatrix}
M_1 \\
M_2 \\
\vdots \\
M_{n-1} \\
M_n
\end{bmatrix}
=
\begin{bmatrix}
d_1 \\
d_2 \\
\vdots \\
d_{n-1} \\
d_n
\end{bmatrix}
$$



</span>

<p>特殊约束条件</p>
<span>
$$
\begin{cases}
x_0 = x_n \quad (\text{周期条件}) \\
M_0 = M_n \quad (\text{弯矩周期约束}) \\
\mu_n M_{n-1} + 2M_n + \lambda_n M_1 = d_n \quad (\text{闭环方程})
\end{cases}
$$

</span>

<p>参数定义</p>
<span>
$$
\begin{aligned}
\mu_n &= \frac{h_{n-1}}{h_{n-1} + h_0} \quad (\text{末节点弯矩传递系数}) \\
\lambda_n &= \frac{h_0}{h_{n-1} + h_0} \quad (\text{首节点弯矩传递系数}) \\
d_n &= 6f[x_{n-1}, x_n, x_1] \quad (\text{三阶差商计算})
\end{aligned}
$$

</span>

<h3 id="误差界与收敛性"><a href="#误差界与收敛性" class="headerlink" title="误差界与收敛性"></a>误差界与收敛性</h3><p> 设 $f(x) \in C^4[a,b]$，$S(x)$ 满足第一或第二边界条件，<br>令 $h &#x3D; \max\limits_{0 \leq i \leq n-1} h_i$，其中 $h_i &#x3D; x_{i+1} - x_i$，则有估计式：<br>$$<br>\max_{a \leq x \leq b} \left| f^{(k)}(x) - s^{(k)}(x) \right| \leq C_k \left( \max_{a \leq x \leq b} \left| f^{(4)}(x) \right| \right) h^{4-k}<br>$$<br>其中常数项系数为：<br>$$<br>\begin{cases}<br>C_0 &#x3D; \dfrac{5}{384} \<br>C_1 &#x3D; \dfrac{1}{24} \<br>C_2 &#x3D; \dfrac{3}{8}<br>\end{cases} \quad (k&#x3D;0,1,2)<br>$$</p>
<h3 id="例题-2"><a href="#例题-2" class="headerlink" title="例题"></a>例题</h3><blockquote>
<p>给定数据表</p>
<table>
<thead>
<tr>
<th>$x_j$</th>
<th>$y_j$</th>
</tr>
</thead>
<tbody><tr>
<td>0.25</td>
<td>0.5000</td>
</tr>
<tr>
<td>0.30</td>
<td>0.5477</td>
</tr>
<tr>
<td>0.39</td>
<td>0.6245</td>
</tr>
<tr>
<td>0.45</td>
<td>0.6708</td>
</tr>
<tr>
<td>0.53</td>
<td>0.7280</td>
</tr>
</tbody></table>
<p>试求三次样条插值$S(x)$,并满足条件</p>
<ol>
<li>$S’(0.25) &#x3D; 1.0000$，$S’(0.53) &#x3D; 0.6868$</li>
<li>$S’’(0.25) &#x3D; S’’(0.53) &#x3D; 0$</li>
</ol>
<p><strong>解</strong></p>
<p><code>5个点，n=4,5阶方程组</code></p>
<p>计算区间宽度 $h_i$</p>
<span>
$$
\begin{aligned}
h_0 &= 0.30 - 0.25 = 0.05 \\
h_1 &= 0.39 - 0.30 = 0.09 \\
h_2 &= 0.45 - 0.39 = 0.06 \\
h_3 &= 0.53 - 0.45 = 0.08
\end{aligned}
$$

</span>

<p>计算系数 $\mu_i$ 和 $\lambda_i$<br>$$<br>\lambda_{j}&#x3D; \frac{h_j}{h_{j-1}+h_j}\<br>\mu_j &#x3D; \frac{h_{j-1}}{h_{j-1}+h_j}<br>$$</p>
<p>$$<br>\mu_1 &#x3D; \frac{5}{14},\quad \lambda_1 &#x3D; \frac{9}{14} \<br>\mu_2 &#x3D; \frac{3}{5},\quad \lambda_2 &#x3D; \frac{2}{5} \<br>\mu_3 &#x3D; \frac{3}{7},\quad \lambda_3 &#x3D; \frac{4}{7} \<br>\mu_4 &#x3D; 1,\quad \lambda_0 &#x3D; 1<br>$$</p>
<p>建立差商表</p>
<table>
<thead>
<tr>
<th>$x$</th>
<th>$f(x)$</th>
<th>一阶差商</th>
<th>二阶差商</th>
</tr>
</thead>
<tbody><tr>
<td>0.25</td>
<td>0.5000</td>
<td></td>
<td></td>
</tr>
<tr>
<td>0.30</td>
<td>0.5477</td>
<td>0.954</td>
<td></td>
</tr>
<tr>
<td>0.39</td>
<td>0.6245</td>
<td>0.8533</td>
<td>-0.7193</td>
</tr>
<tr>
<td>0.45</td>
<td>0.6708</td>
<td>0.7717</td>
<td>-0.5440</td>
</tr>
<tr>
<td>0.53</td>
<td>0.7280</td>
<td>0.7150</td>
<td>-0.4050</td>
</tr>
</tbody></table>
<p>$$<br>d_0 &#x3D; \frac{6}{h_0} ( f[x_0, x_1] - f’_0 )&#x3D;6(-0.92)<br>$$</p>
<p>$$<br>d_n &#x3D; \frac{6}{h_{n-1}} ( f’_n - f[x _{n-1}, x_n] )&#x3D;6(-0.3525)<br>$$</p>
<p>一阶导数边界条件弯距方程组</p>
<span>
$$
\begin{bmatrix}
2       & 1        & 0        & 0        & 0        \\
\frac{5}{14} & 2       & \frac{9}{14} & 0        & 0        \\
0       & \frac{3}{5} & 2       & \frac{2}{5} & 0        \\
0       & 0        & \frac{3}{7} & 2       & \frac{4}{7} \\
0       & 0        & 0        & 1        & 2
\end{bmatrix}
\begin{bmatrix}
M_0 \\ M_1 \\ M_2 \\ M_3 \\ M_4
\end{bmatrix}
= 6 \times
\begin{bmatrix}
-0.9200 \\ -0.7193 \\ -0.5440 \\ -0.4050 \\ -0.3525
\end{bmatrix}
$$

<span>

<p>追赶法解得：<br>$$<br>M_0 &#x3D; -2.0278 \quad M_1 &#x3D; -1.4643 \quad M_2 &#x3D; -1.0313 \quad<br>M_3 &#x3D; -0.8072 \quad M_4 &#x3D; -0.6539<br>$$</p>
<span>
$$
S(x) =
\begin{cases} 
1.8783x^3 - 2.4227x^2 + 1.8591x + 0.1573, & x \in [0.25, 0.30] \\
0.8019x^3 - 1.4538x^2 + 1.5685x + 0.1863, & x \in [0.30, 0.39] \\
0.6225x^3 - 1.2440x^2 + 1.4866x + 0.1970, & x \in [0.39, 0.45] \\
0.3194x^3 - 0.8348x^2 + 1.3025x + 0.2246, & x \in [0.45, 0.53]
\end{cases}
$$

</span>



<p>系数矩阵与右端项：</p>
<span>
$$
\begin{bmatrix}
2 & \frac{9}{14} & 0 \\
\frac{3}{5} & 2 & \frac{2}{5} \\
0 & \frac{3}{7} & 2
\end{bmatrix}
\begin{bmatrix}
M_1 \\ M_2 \\ M_3
\end{bmatrix}
= 6
\begin{bmatrix}
-0.7193 \\ -0.5440 \\ -0.4050
\end{bmatrix}
$$

</span>

<p><strong>(写系数矩阵的时候直接在一阶导数边界条件的系数矩阵上 上下左右各划掉一行或者一列即可)</strong></p>
<p>追赶法解得：<br>$$<br>M_0 &#x3D; 0,\quad M_1 &#x3D; -1.8809,\quad M_2 &#x3D; -0.8616,\quad M_3 &#x3D; -1.0314,\quad M_4 &#x3D; 0<br>$$</p>
<span>
$$
S(x) =
\begin{cases} 
-6.2697x^3 + 4.7023x^2 - 0.2059x + 0.3555, & x \in [0.25, 0.30] \\
1.8876x^3 - 2.6390x^2 + 1.9966x + 0.1353, & x \in [0.30, 0.39] \\
-0.4689x^3 + 0.1178x^2 + 0.9213x + 0.2751, & x \in [0.39, 0.45] \\
2.1467x^3 - 3.4132x^2 + 2.5103x + 0.0367, & x \in [0.45, 0.53]
\end{cases}
$$
</span></blockquote>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>数值分析</tag>
      </tags>
  </entry>
  <entry>
    <title>数值分析-误差</title>
    <url>/blog/2025/04/30/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90-%E8%AF%AF%E5%B7%AE/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>此文章包含数值分析的误差部分—————————————————————————————————————————————————————————————————-</p>
<p><span style="color:blue">$C^p[a,b]$表示具有$p$阶连续导数的函数空间；$C^0$表述函数连续，没有要求可导</span></p>
<h1 id="第一章-误差"><a href="#第一章-误差" class="headerlink" title="第一章 误差"></a>第一章 误差</h1><h2 id="误差的度量方式"><a href="#误差的度量方式" class="headerlink" title="误差的度量方式"></a>误差的度量方式</h2><ul>
<li><p>设 $x$ 为准确值，$x^* $ 为 $x$ 的一个近似值，称  $$e^* &#x3D; x^* - x$$  为<strong>绝对误差</strong>，简称为<strong>误差</strong>。</p>
</li>
<li><p>对于一般情形</p>
</li>
</ul>
<p>$$<br>| x^*  - x | ≤ ε^*<br>$$</p>
<p>$ε^* $为<strong>绝对误差限</strong> </p>
<ul>
<li><p><strong>相对误差</strong>的公式表示为：  $$e_r^* &#x3D; \frac{e^* }{x}$$，实际中一般取$$e_r^* &#x3D; \frac{e^* }{x^* }$$</p>
</li>
<li><p>$x$ 的<strong>相对误差上限</strong>定义为$\varepsilon_r^* &#x3D; \frac{\varepsilon^* }{|x^* |}$</p>
</li>
</ul>
<h2 id="有效数字"><a href="#有效数字" class="headerlink" title="有效数字"></a>有效数字</h2><h3 id="有效数字的定义"><a href="#有效数字的定义" class="headerlink" title="有效数字的定义"></a>有效数字的定义</h3><p>若近似值 $ x^* $ 的误差限是某一位的半个单位，该位到 $ x $ 的第一位非零数字共有 $ n $ 位，则 $ x $ 有 $ n $ 位有效数字。  </p>
<p><strong>示例</strong><br>圆周率 $ \pi &#x3D; 3.14159265 \dots $  </p>
<ul>
<li>按四舍五入原则，若取四位小数，则 $ \pi \approx 3.1416 $；  </li>
<li>取五位小数，则 $ \pi \approx 3.14159 $。</li>
</ul>
<p>它们的绝对误差不超过末位数的半个单位，即：  </p>
<ul>
<li>$$| \pi - 3.1416 | \leq \frac{1}{2} \times 10^{-4}$$  五位有效数值  </li>
<li>$$| \pi - 3.14159 | \leq \frac{1}{2} \times 10^{-5}$$  六位有效数值</li>
</ul>
<blockquote>
<p>如果是四舍五入的数字，可以直接从后往前数有几位就行了</p>
</blockquote>
<p><strong>科学计数法</strong></p>
<p>用科学计数法，记 $ x^* &#x3D; \pm 0.a_1 a_2 \cdots a_n \times 10^m $（其中 $ a_1 \neq 0 $）。若 $ |x - x^* | \leq 0.5 \times 10^{m-n} $（即 $ a_n $ 的截取按四舍五入规则），则称 $ x^* $ 为有 <strong>$ n $</strong> 位有效数字，精确到 <strong>$ 10^{m-n} $</strong>。</p>
<h3 id="有效数字与相对误差的关系"><a href="#有效数字与相对误差的关系" class="headerlink" title="有效数字与相对误差的关系"></a>有效数字与相对误差的关系</h3><p><strong>有效数字 ⇒ 相对误差限</strong></p>
<p> 已知 $ x^* $ 有 $ n $ 位有效数字，则其相对误差限为<br>$$<br>\varepsilon_r *  &#x3D; \left| \frac{\varepsilon^* }{x^* } \right| &#x3D; \frac{0.5 \times 10^{m-n}}{0.a_1 a_2 \cdots a_n \times 10^m} &#x3D; \frac{10^{-n}}{2 \times 0.a_1 \cdots}  \leq \frac{1}{2a_1} \times 10^{-n+1}<br>$$<br><strong>相对误差限 ⇒ 有效数字</strong></p>
<p> 已知 $ x^* $ 的相对误差限若满足<br>$$<br>\varepsilon_r * \leq \frac{1}{2(a_1 + 1)} \times 10^{-n+1}<br>$$<br>则<br>$$<br>|x - x^* | \leq \varepsilon_r^ *   \cdot |x^* | &#x3D; \frac{10^{-n+1}}{2(a_1 + 1)} \times 0.a_1 a_2 \cdots \times 10^m<br>&lt; \frac{10^{-n+1}}{2(a_1 + 1)} \cdot (a_1 + 1) \times 10^{m-1} &#x3D; 0.5 \times 10^{m-n}<br>$$<br>可见 $ x^* $ 至少有 $ n $ 位有效数字。</p>
<h2 id="求函数值和算术运算的误差估计"><a href="#求函数值和算术运算的误差估计" class="headerlink" title="求函数值和算术运算的误差估计"></a>求函数值和算术运算的误差估计</h2><p>设多元函数 $ A &#x3D; f(x_1, x_2, \cdots, x_n) $，$ x_1^* , x_2^* , \cdots, x_n^*  $ 为 $ x_1, x_2, \cdots, x_n $ 的近似值。 则 $ A $ 的近似值 $ A^* $：$ A^* &#x3D; f(x_1^* , x_2^* , \cdots, x_n^* ) $。 </p>
<p>函数值 $ A^* $ 的绝对误差： $$ A - A^*  &#x3D; f(x_1, \cdots, x_n) - f(x_1^* , \cdots, x_n^* ) $$ </p>
<p>在点 $ x &#x3D; (x_1, x_2, \cdots, x_n) $ 的 Taylor 展开式，设 $ |x_i - x_i^* | $ ($ i &#x3D; 1, 2, \cdots, n $) 都很小</p>
<p>略去高阶项：<br>$$<br>A - A^* &#x3D; f(x_1, \cdots, x_n) - f(x_1^* , \cdots, x_n^* ) \approx \sum_{j&#x3D;1}^n \frac{\partial f(x)}{\partial x_j} (x_j - x_j^* )<br>$$<br>或<br>$$<br>e(A) \approx \sum_{j&#x3D;1}^n \frac{\partial f(x)}{\partial x_j} e(x_j)<br>$$</p>
<p>$$<br>|e(A)| \leq \sum_{j&#x3D;1}^n \left| \frac{\partial f(x)}{\partial x_j} \right| |e(x_j)|<br>$$</p>
<p><strong>一元函数时：</strong><br>$$<br>e^* (x)&#x3D;x^*-x<br>$$</p>
<p>$$<br>e^* (A)&#x3D;f(x^* )-f(x)&#x3D; f’(\xi)(x^* -x)<br>$$</p>
<h2 id="病态问题与条件数"><a href="#病态问题与条件数" class="headerlink" title="病态问题与条件数"></a>病态问题与条件数</h2><p>$$<br> | e_r(y) | &#x3D; \left| \frac{e(y)}{f(x^* )} \right| &#x3D; \left| \frac{f(x) - f(x^* )}{f(x^* )} \right|<br>$$</p>
<p>$$<br> &#x3D; \left| \frac{f(x) - f(x^* )}{x - x^* } \cdot \frac{x}{f(x)} \cdot \frac{x - x^* }{x} \right|<br>$$</p>
<p>$$<br> \approx \left| \frac{x \cdot f’(x)}{f(x)} \right| \cdot \left| \frac{x - x^*}{x} \right| &#x3D; \left| \frac{x \cdot f’(x)}{f(x)} \right| \cdot | e_r(x) |<br>$$</p>
<p>$| \frac{x \cdot f’(x)}{f(x)} |$为条件数，条件数很大时，初始数据的微小误差可能引起结果 $ A $ 的很大误差。</p>
<p>对数学问题而言，如果输入数据有微小扰动，引起输出数据（即数学问题的解）有很大扰动，则称数学问题是病态问题，否则称为良态问题。</p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>数值分析</tag>
      </tags>
  </entry>
  <entry>
    <title>数值分析-非线性方程求根</title>
    <url>/blog/2025/03/26/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90-%E9%9D%9E%E7%BA%BF%E6%80%A7%E6%96%B9%E7%A8%8B%E6%B1%82%E6%A0%B9/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>此文章包含非线性方程组求根部分—————————————————————————————————————————————————————-</p>
<h1 id="第七章-非线性方程求根"><a href="#第七章-非线性方程求根" class="headerlink" title="第七章 非线性方程求根"></a>第七章 非线性方程求根</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p><strong>求 f(x) &#x3D; 0 的根</strong></p>
<ul>
<li>数学物理中的许多问题常常归结为解函数方程 f(x) &#x3D; 0，方程 f(x) &#x3D; 0 的解 x* 称作它的根，或称为 f(x) 的零点。</li>
<li>设函数 f(x) 在 [a,b] 上连续且 f(a)f(b) &lt; 0，根据连续函数的性质可知方程 f(x) &#x3D; 0 在区间 [a,b] 内一定有实根，这时称 (a,b) 为方程 f(x) &#x3D; 0 的有根区间。</li>
</ul>
<h2 id="二分法"><a href="#二分法" class="headerlink" title="二分法"></a>二分法</h2><ul>
<li>二分法的思想是将有根区间折半进行搜索，即对有根区间 $[a, b]$，取中点 $x_1 &#x3D; \frac{a + b}{2}$ 将它分为两半，检查 $f(a)$ 与 $f(x)$ 是否同号，如果确系同号，说明所求的根在 $[x_1, b]$ ；否则根必在 $[a, x_1]$<br>不管出现哪一种情况，新的有根区间仅为原来的一半。</li>
</ul>
<h3 id="误差分析"><a href="#误差分析" class="headerlink" title="误差分析"></a>误差分析</h3><ul>
<li>第1步产生的 $x_1 &#x3D; \frac{a + b}{2}$ 有误差 $|x_1 - x^*| \leq \frac{b - a}{2}$  </li>
<li>第 $k$ 步产生的 $x_k$ 有误差 $|x_k - x^*| \leq \frac{b - a}{2^k}$</li>
</ul>
<p>对于给定的精度 $\epsilon$，可估计二分法所需的步数 $k$：<br>$$<br>\frac{b - a}{2^k} &lt; \epsilon \Rightarrow k &gt; \left[\frac{\ln(b - a) - \ln \epsilon}{\ln 2}\right]<br>$$</p>
<h3 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h3><ol>
<li>简单</li>
<li>对 $f(x)$ 要求不高（只要连续即可）。</li>
</ol>
<h3 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h3><ol>
<li>无法求复根及偶重根。</li>
<li>收敛慢。</li>
</ol>
<blockquote>
<p>注：用二分法求根，最好先给出 $f(x)$ 草图以确定根的大概位置。或用搜索程序，将 $[a, b]$ 分为若干小区间，对每一个满足 $f(a_k) \cdot f(b_k) &lt; 0$ 的区间调用二分法程序，可找出区间 $[a, b]$ 内的多个根，且不必要求 $f(a) \cdot f(b) &lt; 0$。</p>
</blockquote>
<hr>
<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><p>求方程 $f(x) &#x3D; x^3 - x - 1 &#x3D; 0$ 在 $[1.0, 1.5]$ 区间内的一个实根，要求准确到小数点后的第2位。</p>
<p><strong>解</strong></p>
<p>二分法过程解题过程见下表：</p>
<p>(这里 $a &#x3D; 1.0$, $f(a) &lt; 0$；  $b &#x3D; 1.5$, $f(b) &gt; 0$)</p>
<table>
<thead>
<tr>
<th>$k$</th>
<th>$a_k$</th>
<th>$b_k$</th>
<th align="center">$x_k$</th>
<th>$f(x_k)$</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>1.0</td>
<td>1.5</td>
<td align="center">1.25</td>
<td>-</td>
</tr>
<tr>
<td>1</td>
<td>1.25</td>
<td>1.5</td>
<td align="center">1.375</td>
<td>+</td>
</tr>
<tr>
<td>2</td>
<td>1.25</td>
<td>1.375</td>
<td align="center">1.3125</td>
<td>-</td>
</tr>
<tr>
<td>3</td>
<td>1.3125</td>
<td>1.375</td>
<td align="center">1.3438</td>
<td>+</td>
</tr>
<tr>
<td>4</td>
<td>1.3125</td>
<td>1.3438</td>
<td align="center">1.3281</td>
<td>+</td>
</tr>
<tr>
<td>5</td>
<td>1.3125</td>
<td>1.3281</td>
<td align="center">1.3203</td>
<td>-</td>
</tr>
<tr>
<td>6</td>
<td>1.3203</td>
<td>1.3281</td>
<td align="center">1.3242</td>
<td>-</td>
</tr>
</tbody></table>
<h2 id="简单迭代法"><a href="#简单迭代法" class="headerlink" title="简单迭代法"></a>简单迭代法</h2><h3 id="等价变换"><a href="#等价变换" class="headerlink" title="等价变换"></a>等价变换</h3><p>$$<br>f(x) &#x3D; 0 \quad \longleftrightarrow \quad x &#x3D; \varphi(x)<br>$$<br>$$<br>f(x) &#x3D; 0 \text{ 的根} \quad \longleftrightarrow \quad \varphi(x) \text{ 的不动点}<br>$$</p>
<p>从一个初值 $x_0$ 出发，计算 $x_1 &#x3D; \varphi(x_0)$, $x_2 &#x3D; \varphi(x_1)$, …,<br>若 $ {x_k }_{k&#x3D;0}^{\infty}$ 收敛，即存在 $x^* $ 使得<br>$$<br>\lim _{k \to \infty} x_k &#x3D; x^*<br>$$</p>
<p>且 $\varphi$ 连续，则由<br>$$<br>\lim_{k \to \infty} x_{k+1} &#x3D; \lim_{k \to \infty} \varphi(x_k)<br>$$<br>可知 $x^*  &#x3D; \varphi(x^* )$，即 $x^*$ 是 $\varphi$ 的不动点，也就是 $f &#x3D; 0$ 的根。</p>
<blockquote>
<p>迭代法是一种逐次逼近法，其基本思想是将隐式方程归结为一组显式的计算公式，即说，迭代过程实际上是一个逐步显示化的过程。</p>
</blockquote>
<hr>
<h3 id="示例-1"><a href="#示例-1" class="headerlink" title="示例"></a>示例</h3><p>设 $f(x) &#x3D; x^3 + 4x^2 - 10 &#x3D; 0$ （此方程在 $[1, 2]$ 中有唯一根），用不同的方法将它变换成等价的方程。</p>
<p><strong>解</strong>：</p>
<p>(1) $x &#x3D; \varphi_1(x) &#x3D; x - x^3 - 4x^2 + 10$<br>(2) $x &#x3D; \varphi_2(x) &#x3D; \left(\frac{10}{x }-4x\right)^{\frac{1}{2}}$<br>(3) $x &#x3D; \varphi_3(x) &#x3D; \frac{1}{2} \left(10 - x^3\right)^{\frac{1}{2}}$<br>(4) $x &#x3D; \varphi_4(x) &#x3D; \left(\frac{10}{4 + x}\right)^{\frac{1}{2}}$<br>(5) $x &#x3D; \varphi_5(x) &#x3D; x - \frac{x^3 + 4x^2 - 10}{3x^2 + 8x}$</p>
<p>对所选取的 $\varphi_i(x)$ ($i&#x3D;1, 2, 3, 4, 5$) 迭代法计算结果列入下表（取初始近似值 $x_0 &#x3D; 1.5$）</p>
<p><img src="/blog/image/Snipaste_2025-04-16_14-40-28.png"></p>
<h2 id="迭代法收敛定理"><a href="#迭代法收敛定理" class="headerlink" title="迭代法收敛定理"></a>迭代法收敛定理</h2><blockquote>
<p><strong>定理1</strong> 如果迭代函数 $\varphi(x) \in C[a,b]$，并且  </p>
<ol>
<li>$\forall x \in [a,b]$，都有 $\varphi(x) \in [a,b]$，  </li>
<li>$\exists 0 \leq \text{常数 } L &lt; 1$，使得 $\forall x,y \in [a,b]$，都有<br>$$<br>  |\varphi(x) - \varphi(y)| \leq L |x - y|;<br>$$</li>
</ol>
<p>那么 $\varphi(x)$ 在 $[a,b]$ 上存在唯一的不动点 $x^*$。</p>
<p><strong>定理2</strong> 考虑方程 $x &#x3D; \varphi(x)$, $\varphi(x) \in C^1[a, b]$，若：</p>
<p>(I) 当 $x \in [a, b]$ 时，$\varphi(x) \in [a, b]$；</p>
<p>(II) 存在$0 \leq L &lt; 1$，使得 $|\varphi’(x)| \leq L &lt; 1$ 对 $\forall x \in [a, b]$ 成立。</p>
<p>则任取 $x_0 \in [a, b]$，由 $x_{k+1} &#x3D; \varphi(x_k)$ 得到的序列 ${x_k}_{k&#x3D;0}^{\infty}$ 收敛于 $\varphi(x)$ 在 $[a, b]$ 上的<strong>唯一</strong>不动点，并且有误差估计式：</p>
<p>$$<br>|x^* - x_k| \leq \frac{1}{1 - L} |x_{k+1} - x_k|<br>$$</p>
<p>$$<br>|x^* - x_k| \leq \frac{L^k}{1 - L} |x_1 - x_0| \quad (k &#x3D; 1, 2, \dots)<br>$$</p>
<p>并且存在极限：</p>
<p>$$<br>\lim_{k \to \infty} \frac{x^* - x_{k+1}}{x^* - x_k} &#x3D; \varphi’(x^*)<br>$$</p>
</blockquote>
<h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><p>求方程 $f(x) &#x3D; x^3 - x - 1 &#x3D; 0$ 在 $x &#x3D; 1.5$ 附近的根，若将方程改写为：</p>
<p>$$ x &#x3D; x^3 - 1 $$</p>
<p>建立迭代公式：</p>
<p>$$ x_{k+1} &#x3D; x_k^3 - 1 $$</p>
<p>这是因为：</p>
<p>$$ \varphi’(x) &#x3D; (x^3 - 1)’ &#x3D; 3x^2 $$</p>
<p>当 $x &gt; 0.7$ 时，均有 $|\varphi’(x)| &gt; 1$，所以该迭代过程是发散的。</p>
<hr>
<p>考虑迭代过程</p>
<p> (a)<br>$$<br>x_{k+1} &#x3D; \varphi_3(x_k) &#x3D; \frac{1}{2} (10 - x_k^3)^{1&#x2F;2}<br>$$</p>
<p>(b)<br>$$<br>x_{k+1} &#x3D; \varphi_4(x_k) &#x3D; \left( \frac{10}{4 + x_k} \right)^{1&#x2F;2}<br>$$<br> 的收敛性，当 $|x_k - x^*| &lt; 10^{-5}$ 时，确定 (b) 中迭代次数 $k$。</p>
<p><strong>解</strong></p>
<p>对于迭代过程 (b)，迭代函数 $\varphi_4(x) &#x3D; \left( \frac{10}{4 + x} \right)^{1&#x2F;2}$ 于<br>$$<br>|\varphi_4’(x)| &#x3D; \left|\frac{-5}{\sqrt{10} (4 + x)^{3&#x2F;2} }\right| \leq \frac{5}{\sqrt{10}(5)^{3&#x2F;2}} &lt; 0.15<br>$$</p>
<p>因此，迭代函数 $\varphi_4(x)$ 在 $[1, 2]$ 上满足定理条件 (II)，故迭代过程 (b) 收敛。</p>
<p>由 $|x^* - x_k| \leq \frac{L^k}{1 - L} |x_1 - x_0| &lt; \epsilon$ （$\epsilon$ 为给定精度要求）</p>
<p>迭代次数 $k$ 应取：（<span style="color:#FF0000">考试时现推即可</span>）</p>
<p>$$<br>k &gt; \frac{\lg \epsilon - \lg \frac{|x_1 - x_0|}{1-L}}{\lg L}<br>$$</p>
<p>由要求 $|x_k - x^*| &lt; 10^{-5}$，应用上述公式，其中 $x_1 &#x3D; 1.3484$ 和 $L_4 &#x3D; 0.15$，$x_0 &#x3D; 1.5$<span style="color:#FF0000">（初值是自己选的）</span></p>
<p>则有：<br>$$<br>k &gt; \frac{\lg 10^{-5} - \lg \frac{(1.5 - 1.3484)}{0.85}}{\lg 0.15} &#x3D; 5.16<br>$$</p>
<p>于是，推得所要求迭代次数 $k &#x3D; 6$。</p>
<p>对于迭代过程 (a)，迭代函数 $\varphi_3(x) &#x3D; \frac{1}{2} (10 - x^3)^{1&#x2F;2}$ 于：<br>$$<br>\varphi_3’(x) &#x3D; \frac{-3x^2}{4\sqrt{10 - x^3}} &lt; 0<br>$$</p>
<p>注意到 $|\varphi_3’(2)| \approx 2.12$，所以在 $[1, 2]$ 上，定理中条件 (II) 不满足。 但当 $x \in [1, 1.5]$ 时，有 $|\varphi_3’(x)| \leq |\varphi_3’(1.5)| &lt; 0.66 &#x3D; L_3$ 迭代函数 $\varphi_3(x)$ 在 $[1, 1.5]$ 上满足定理的条件 (II)，故迭代过程初值限制在 $[1, 1.5]$ 上时，迭代过程收敛。</p>
<p>由要求 $|x_k - x^*| &lt; 10^{-5}$，应用上述公式，其中 $x_1 &#x3D; 1.287$ 和 $L_3 &#x3D; 0.66$，$x_0 &#x3D; 1.5$，则有：<br>$$<br>k &gt; \frac{\lg 10^{-5} - \lg \frac{(1.5 - 1.287)}{1-0.66}}{\lg 0.66} &#x3D; 26.58<br>$$</p>
<p>于是，推得所要求迭代次数 $k &#x3D; 27$。</p>
<blockquote>
<p><strong>注</strong>：此题中 $L_4 &lt; L_3$，可知迭代过程 (b) 比迭代过程 (a) 收敛快。</p>
<p>定理条件<strong>非必要条件</strong>，可将 $[a, b]$ 缩小，定义<strong>局部收敛性</strong>：</p>
<p>若在 $x^* $ 的某 $\delta$ 邻域 $R &#x3D; { x \ | \ |x - x^*| \leq \delta }$ </p>
<p>有 $\varphi \in C^1[a, b]$ 且 $|\varphi’(x^*)| &lt; 1$，则对 $\forall x_0 \in R$ 开始的迭代收敛。即调换初值可得到收敛的结果。</p>
</blockquote>
<p><strong>定义</strong></p>
<p>若存在在 $x^* $ 的某个邻域 $R: |x - x^*| \leq \delta$，使迭代过程</p>
<p>$$<br>x_{k+1} &#x3D; \varphi(x_k)<br>$$</p>
<p>对于任意初值 $x_0 \in R$ 收敛，则称迭代过程 $x_{k+1} &#x3D; \varphi(x_k)$ 在根 $x^*$ 附近具有局部收敛性。</p>
<p><strong>定理</strong></p>
<p>设 $x^* $ 为方程 $x &#x3D; \varphi(x)$ 的根，$\varphi’(x)$ 在 $x^* $ 的邻域连续，且 $|\varphi’(x^*)| &lt; 1$ 则迭代过程</p>
<p>$$<br>x_{k+1} &#x3D; \varphi(x_k)<br>$$</p>
<p>具有局部收敛性。</p>
<blockquote>
<p><img src="/blog/image/Snipaste_2025-06-11_14-28-44.png"></p>
<p><img src="/blog/image/Snipaste_2025-06-11_14-28-59.png"></p>
</blockquote>
<h2 id="迭代法的收敛阶"><a href="#迭代法的收敛阶" class="headerlink" title="迭代法的收敛阶"></a>迭代法的收敛阶</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>设迭代 $x_{k+1} &#x3D; \varphi(x_k)$ 收敛到 $\varphi(x)$ 的不动点 $x^*$。</p>
<p>设 $e_k &#x3D; x_k - x^*$，若</p>
<p>$$<br>\lim_{k \to \infty}  \frac{e_{k+1}}{e_k^p} &#x3D; C<br>$$</p>
<p>则称该迭代为 <strong>$p$ 阶收敛</strong>，其中 $C$ 称为渐近误差常数（$C \neq0$）。</p>
<blockquote>
<ul>
<li>$p &#x3D; 1$ 时称作<strong>线性收敛</strong></li>
<li>$p &gt; 1$ 时称作<strong>超线性收敛</strong></li>
<li>p &#x3D; 2 时称作<strong>平方收敛</strong></li>
</ul>
</blockquote>
<h3 id="定理"><a href="#定理" class="headerlink" title="定理"></a>定理</h3><p>设 $x^* $ 为方程 $x &#x3D; \varphi(x)$ 的不动点，若 $\varphi \in C^p(R(x^*))$ 且 $p \geq 2$；</p>
<p>$$<br>\varphi’(x^* ) &#x3D; \dots &#x3D; \varphi^{(p-1)}(x^* ) &#x3D; 0, \quad \varphi^{(p)}(x^* ) \neq 0,<br>$$</p>
<p>则 $x_{k+1} &#x3D; \varphi(x_k)$ 在 $R(x^*)$ 内 $p$ 阶收敛。</p>
<p><strong>证明</strong>：<br>$$<br>x_{k+1} &#x3D; \varphi(x_k) &#x3D; \varphi(x^* ) + \varphi’(x^* ) (x_k - x^* ) + \dots + \frac{\varphi^{(p)}(\xi_k)}{p!} (x_k - x^* )^p<br>$$</p>
<p>其中 $\xi_k \to x^<em>$ as $k \to \infty$，极限值为 $C$。<br>$$<br>\lim <em>{k\rightarrow\infty}\frac{e</em>{k+1}}{e_k^p}&#x3D; \lim <em>{k\rightarrow\infty}\frac{x</em>{k+1}-x^{</em>}}{\left(x_{k}-x^{<em>}\right)^{p}}&#x3D;\frac{\varphi^{(p)}\left(x^{</em>}\right)}{p !}<br>$$</p>
<blockquote>
<p>特别地</p>
<p>当 $0 &lt; |\varphi’(x^ * )| &lt; 1$ 时，迭代法线性收敛；<br>当 $\varphi’(x^ * ) &#x3D; 0$，$\varphi’’(x^ * ) \neq 0$ 时，平方收敛。</p>
</blockquote>
<h3 id="例题-1"><a href="#例题-1" class="headerlink" title="例题"></a>例题</h3><blockquote>
<p><img src="/blog/image/Snipaste_2025-06-11_10-09-04.png"></p>
</blockquote>
<h2 id="埃特金（Aitken）算法"><a href="#埃特金（Aitken）算法" class="headerlink" title="埃特金（Aitken）算法"></a>埃特金（Aitken）算法</h2><p>设 $x_k$ 是一个线性收敛序列，其极限为 $x^* $，误差 $e_k &#x3D; x^* - x_k$，若：</p>
<p>$$<br>\lim_{k \to \infty} \left| \frac{e_{k+1}}{e_k} \right| &#x3D; c \quad (0 &lt; c &lt; 1)<br>$$</p>
<p>因此，当 $k$ 充分大时：</p>
<p>$$<br>\frac{x^* - x_{k+1}}{x^* - x_{k+2}} \approx \frac{x^* - x_k}{x^* - x_{k+1}}<br>$$</p>
<p>由此得：</p>
<p>$$<br>x^* \approx x_{k+1} - \frac{(x_{k+2} - x_{k+1})^2}{x_{k+2} - 2x_{k+1} + x_k}&#x3D; x_k - \frac{(x_{k+1} - x_k)^2}{x_k - 2x_{k+1} + x_{k+2}}<br>$$</p>
<p>以上式右端得到的结果作为新的改进值，记为：</p>
<p>$$<br>\overline x_{k+1} &#x3D; x_k - \frac{(x_{k+1} - x_k)^2}{x_k - 2x_{k+1} + x_{k+2}}<br>$$</p>
<p>得到新序列 ${ \overline{x}_k }$，较原序列 ${ x_k }$ 更快的收敛到 $x^*$。</p>
<p><strong>可以证明</strong><br>$$<br>\lim_{k \to \infty} \frac{\overline x_{k+1} - x^* }{x_k - x^* } &#x3D; 0<br>$$</p>
<p>它表明序列 ${ \overline{x}_k }$的收敛速度比 ${ x_k }$ 的收敛速度快。</p>
<p><strong>埃特金（Aitken）算法</strong></p>
<ul>
<li><p>迭代：$\overline x_{k+1} &#x3D; \varphi(x_k) $</p>
</li>
<li><p>重新迭代：$ \tilde x_{k+1} &#x3D; \varphi(\overline{x}_{k+1}) $</p>
</li>
<li><p>改进：<br>$$<br> x_{k+1} &#x3D; x_k - \frac{ (\overline x_{k+1} - x_k)^2}{x_k - 2 \overline x_{k+1} + \tilde x_{k+1}}<br>$$</p>
</li>
</ul>
<h2 id="斯蒂芬森迭代"><a href="#斯蒂芬森迭代" class="headerlink" title="斯蒂芬森迭代"></a>斯蒂芬森迭代</h2><ul>
<li><p>埃特金方法不管原序列 ${x_k}$ 是怎样产生的，对 ${x_k}$ 进行加速计算，得到序列 ${ \tilde{x}_k }$，如果把埃特金加速技巧与不动点迭代结合，则可得到如下的迭代法：<br>$$<br>y_k &#x3D; \varphi(x_k), \quad z_k &#x3D; \varphi(y_k)<br>$$</p>
<p>$$<br>x_{k+1} &#x3D; x_k - \frac{(y_k - x_k)^2}{z_k - 2y_k + x_k} \quad (k &#x3D; 0, 1, \cdots) \qquad (*)<br>$$</p>
<p><span style="color:#FF0000">称为斯蒂芬森 (Steffensen) 迭代法</span></p>
<p>它可以这样理解，我们要求$x &#x3D; \varphi(x)$ 的根 $x^*$</p>
<p>令</p>
<p> $\epsilon(x) &#x3D; \varphi(x) - x $</p>
<p>$ \epsilon(x^* ) &#x3D; \varphi(x^* ) - x^*  &#x3D; 0 $</p>
<p> 已知 $x^* $ 的近似值 $x_k$ 及 $y_k$，其误差分别为：<br>$$<br>\epsilon(y_k) &#x3D; \varphi(y_k) - y_k &#x3D; z_k - y_k<br>$$</p>
<p>$$<br>\epsilon(x_k) &#x3D; \varphi(x_k) - x_k &#x3D; y_k - x_k<br>$$</p>
<p>误差的“外推到零”</p>
<p>即过 $(x_k, \epsilon(x_k))$ 和 $(y_k, \epsilon(y_k))$ 两点做线性插值函数，它与 $x$ 轴交点就是 $(*)$ 中的 $x_{k+1}$。</p>
<p>即方程：</p>
<p>$$<br>\epsilon(x_k) + \frac{\epsilon(y_k) - \epsilon(x_k)}{y_k - x_k}(x - x_k) &#x3D; 0<br>$$</p>
<p>的解：<br>$$<br>x &#x3D; x_k - \frac{\varepsilon(x_k)}{\varepsilon(y_k) - \varepsilon(x_k)} (y_k - x_k) &#x3D; x_k - \frac{(y_k - x_k)^2}{z_k - 2y_k + x_k} &#x3D; x_{k+1}<br>$$<br>实际上 $(*)$ 是将不动点迭代法计算两步合并为一步得到的，可以写成另一种不动点迭代：<br>$$<br>x_{k+1} &#x3D; \psi(x_k) \quad (k &#x3D; 0, 1, \cdots)<br>$$</p>
<p>其中：</p>
<p>$$<br>\psi(x) &#x3D; x - \frac{[\varphi(x) - x]^2}{\varphi(\varphi(x)) - 2\varphi(x) + x}<br>$$</p>
<p>对于不动点迭代：</p>
<p>$$<br>x_{k+1} &#x3D; \psi(x_k) \quad (k &#x3D; 0, 1, \cdots)<br>$$</p>
<p>具有以下局部收敛性定理：</p>
<blockquote>
<p>若 $x^* $ 为迭代函数 $\psi(x)$ 的不动点，则 $x^* $ 为 $\varphi(x)$ 的不动点。</p>
<p>反之，若 $x^* $ 为 $\varphi(x)$ 的不动点，设$\varphi’(x) $存在，且 $\varphi’(x^* ) \neq 1$，则 $x^* $ 是 $\psi(x)$ 的不动点，且斯蒂芬森 (Steffensen) 迭代法是 2 阶收敛的。</p>
</blockquote>
</li>
</ul>
<p><strong>示例：</strong></p>
<p>求方程 $3x^2 - e^x &#x3D; 0$ 在 $[3, 4]$ 中的解。</p>
<p>解：由方程得 $e^x &#x3D; 3x^2$，取对数得<br>$$<br>x &#x3D; \ln 3x^2 &#x3D; 2 \ln x + \ln 3 &#x3D; \varphi(x)<br>$$</p>
<p>若构造迭代法：</p>
<p>$$<br>x_{k+1} &#x3D; 2 \ln x_k + \ln 3<br>$$</p>
<p>由于</p>
<p>$$<br>\varphi’(x) &#x3D; \frac{2}{x}, \quad \max_{3 \leq x \leq 4} |\varphi’(x)| \leq \frac{2}{3} &lt; 1,<br>$$</p>
<p>且当$x \in [3,4]$时，$\varphi(x) \in [3,4]$</p>
<p>故知此迭代法收敛，若取 $x_0 &#x3D; 3.5$ 迭代 16 次得 $x_{16} &#x3D; 3.73307$，有六位有效数字。</p>
<p>若用斯蒂芬森加速法进行加速，计算结果列入表中：</p>
<table>
<thead>
<tr>
<th>$k$</th>
<th>$x_k$</th>
<th>$y_k$</th>
<th>$z_k$</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>3.5</td>
<td>3.60414</td>
<td>3.66202</td>
</tr>
<tr>
<td>1</td>
<td>3.73444</td>
<td>3.73381</td>
<td>3.73447</td>
</tr>
<tr>
<td>2</td>
<td>3.73307</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h2 id="牛顿法"><a href="#牛顿法" class="headerlink" title="牛顿法"></a>牛顿法</h2><h3 id="牛顿迭代法"><a href="#牛顿迭代法" class="headerlink" title="牛顿迭代法"></a>牛顿迭代法</h3><p>牛顿迭代法是一种特殊的不动点迭代法，其计算公式为：</p>
<p>$$<br>x_{k+1} &#x3D; x_k - \frac{f(x_k)}{f’(x_k)}, \quad k &#x3D; 0, 1, 2, \cdots<br>$$</p>
<p>其迭代函数为：</p>
<p>$$<br>\varphi(x) &#x3D; x - \frac{f(x)}{f’(x)}<br>$$</p>
<p><strong>牛顿迭代法的收敛速度</strong></p>
<p>当 $f(x^* ) &#x3D; 0, f’(x^* ) \neq 0$ 时，容易证明，$\varphi’(x^* ) &#x3D; 0, \varphi’’(x^* ) &#x3D;  \frac{f’’(x^* )}{f’(x^* )}$，由定理 7.4 知，牛顿迭代法是平方收敛的，且</p>
<p>$$<br>\lim_{k \to \infty} \frac{e_{k+1}}{e_k^2} &#x3D; \frac{f’’(x^* )}{2f’(x^* )}<br>$$</p>
<p>其中，$e_k &#x3D; x_k - x^*$ 为误差。</p>
<h3 id="简化牛顿法"><a href="#简化牛顿法" class="headerlink" title="简化牛顿法"></a>简化牛顿法</h3><p><strong>构造迭代公式</strong><br>$$<br>x_{k+1} &#x3D; x_k - C f(x_k), \quad C \neq 0, \quad k &#x3D; 0, 1, 2, \dots<br>$$</p>
<p>当 $|g’(x) |&#x3D; |1 - C f’(x)| &lt; 1$，即 $0 &lt; C f’(x) &lt; 2$ 时，公式局部收敛。</p>
<p><strong>简化牛顿法</strong><br>$$<br>x_{k+1} &#x3D; x_k - \frac{f(x_k)}{f’(x_0)}<br>$$</p>
<h3 id="牛顿下山法："><a href="#牛顿下山法：" class="headerlink" title="牛顿下山法："></a>牛顿下山法：</h3><p>$$<br>x_{k+1} &#x3D; x_k - \lambda \frac{f(x_k)}{f’(x_k)}, \quad k &#x3D; 0, 1, 2, \dots<br>$$</p>
<p>其中下山因子 $\lambda &#x3D; 1$，逐次减半直至满足 $|f(x_{k+1})| &lt; |f(x_k)|$。</p>
<hr>
<p><strong>示例</strong></p>
<p>求解 $x^3 - x - 1 &#x3D; 0$ 在 1.5 附近的根 $x^*$。</p>
<p>解：</p>
<ul>
<li><p>第一列牛顿法 $x_0 &#x3D; 1.5$</p>
</li>
<li><p>第二列牛顿法$x_0 &#x3D; 0.6$，</p>
</li>
<li><p>牛顿下山法 $x_0 &#x3D; 0.6$，$\lambda &#x3D; 1$, 经过 16 次迭代得到$\lambda &#x3D; 1&#x2F;32$,此时$x_1&#x3D;1.140625,f(x_1)&#x3D;-0.656643,f(x_0)&#x3D;-1.384$,显然有$|f(x_1)|&lt;|f(x_0)|$,接下来由$x_1$计算$x_2,x_3$时，$\lambda &#x3D; 1$</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>$k$</th>
<th>$x_k$</th>
<th>$x_k$</th>
<th>$x_k$</th>
<th>$f(x_k)$</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>1.5</td>
<td>0.6</td>
<td>0.6</td>
<td>-1.384</td>
</tr>
<tr>
<td>1</td>
<td>1.34783</td>
<td>17.9</td>
<td>1.140625</td>
<td>-0.656643</td>
</tr>
<tr>
<td>2</td>
<td>1.32520</td>
<td>发散</td>
<td>1.36181</td>
<td>0.1866</td>
</tr>
<tr>
<td>3</td>
<td>1.32472</td>
<td></td>
<td>1.32628</td>
<td>0.00667</td>
</tr>
<tr>
<td>4</td>
<td>1.32472</td>
<td></td>
<td>1.32472</td>
<td>0.0000086</td>
</tr>
</tbody></table>
<h3 id="牛顿法的重根情形"><a href="#牛顿法的重根情形" class="headerlink" title="牛顿法的重根情形"></a>牛顿法的重根情形</h3><p><strong>方法1</strong>（知道重数）<br>$$<br>x_{k+1} &#x3D; x_k - m \frac{f(x_k)}{f’(x_k)}, \quad k &#x3D; 0, 1, 2, \dots<br>$$<br><strong>方法2</strong><br>$$<br>x_{k+1} &#x3D; x_k - \frac{f(x_k) f’(x_k)}{[f’(x_k)]^2 - f(x_k) f’’(x_k)}, \quad (k &#x3D; 0, 1, 2, \dots)<br>$$</p>
<h2 id="弦截法"><a href="#弦截法" class="headerlink" title="弦截法"></a>弦截法</h2><p>$$<br>x_{k+1} &#x3D; x_k -  \frac{f(x_k)}{f(x_k)-f(x_{k-1})} (x_k-x_{k-1}), \quad k &#x3D;  1, 2, \dots<br>$$</p>
<p>弦截法具有超线性收敛，且收敛阶 $p&#x3D;1.618$</p>
<h2 id="抛物线法"><a href="#抛物线法" class="headerlink" title="抛物线法"></a>抛物线法</h2><p>以 $x_k, x_{k-1}$ 和 $x_{k-2}$ 为插值节点，得到插值函数</p>
<p>$$<br>p_2(x) &#x3D; f(x_k) + f[x_k, x_{k-1}](x - x_k) + f[x_k, x_{k-1}, x_{k-2}](x - x_k)(x - x_{k-1})<br>$$</p>
<p>令 $p_2(x) &#x3D; 0$，得到两个零点：</p>
<p>$$<br>x_{k+1} &#x3D; x_k - \frac{2 f(x_k)}{\omega \pm \sqrt{\omega - 4 f(x_k)f[x_k, x_{k-1}, x_{k-2}]}}<br>$$</p>
<p>式中 $\omega &#x3D; f[x_k, x_{k-1}] + f[x_k, x_{k-1}, x_{k-2}](x_k - x_{k-1})$，</p>
<p>$$<br>\Rightarrow x_{k+1} &#x3D; x_k - \frac{2 f(x_k)}{\omega + \text{sgn}(\omega) \sqrt{\omega - 4 f(x_k)  f[x_k, x_{k-1}, x_{k-2}]}}<br>$$</p>
<p>插值线法按阶 $p &#x3D; 1.840$ 收敛到 $x^*$。</p>
<h2 id="例题-2"><a href="#例题-2" class="headerlink" title="例题"></a>例题</h2><blockquote>
<p>（15 分）用下列方法求 $f(x)&#x3D;x^{3}-\dfrac{x}{9}-\dfrac{2}{9}$ 在 $x_{0}&#x3D;0.5$ 附近的根，根的准确值是 $x^{\ast}&#x3D;0.66666\ldots$。要求计算第 2 步：  </p>
<ol>
<li>牛顿法；  </li>
<li>弦截法，$x_{0}&#x3D;0.5,;x_{1}&#x3D;0.6$</li>
</ol>
<p><strong>解答</strong>  </p>
<ul>
<li>牛顿法</li>
</ul>
<p>牛顿迭代公式  </p>
<p>$$<br>x_{k+1}&#x3D;x_{k}-\frac{f(x_{k})}{f’(x_{k})},<br>\qquad<br>f’(x)&#x3D;3x^{2}-\frac{1}{9}.<br>$$</p>
<table>
<thead>
<tr>
<th>步</th>
<th>$x_k$</th>
<th>$f(x_k)$</th>
<th>$f’(x_k)$</th>
<th>$x_{k+1}$</th>
</tr>
</thead>
<tbody><tr>
<td>初值</td>
<td>$x_0 &#x3D; 0.500000$</td>
<td>$-0.1527778$</td>
<td>$0.6388889$</td>
<td>—</td>
</tr>
<tr>
<td>第 1 步</td>
<td>$x_0$</td>
<td>$-0.1527778$</td>
<td>$-0.1527778$</td>
<td>$x_1 &#x3D; 0.739130$</td>
</tr>
<tr>
<td>第 2 步</td>
<td>$x_1$</td>
<td>$0.0994493$</td>
<td>$1.527553$</td>
<td>$x_2 &#x3D; 0.674039$</td>
</tr>
</tbody></table>
<ul>
<li>弦截法</li>
</ul>
<p>弦截迭代公式  </p>
<p>$$<br>x_{k+1}&#x3D;x_{k}-f(x_{k}),<br>\frac{x_{k}-x_{k-1}}{f(x_{k})-f(x_{k-1})}.<br>$$</p>
<table>
<thead>
<tr>
<th>步</th>
<th>$x_{k-1}$</th>
<th>$x_{k}$</th>
<th>$f(x_{k-1})$</th>
<th>$f(x_{k})$</th>
<th>$x_{k+1}$</th>
</tr>
</thead>
<tbody><tr>
<td>初值</td>
<td>$x_0 &#x3D; 0.500000$</td>
<td>$x_1 &#x3D; 0.600000$</td>
<td>$-0.1527778$</td>
<td>$-0.0728889$</td>
<td>—</td>
</tr>
<tr>
<td>第 1 步</td>
<td>$x_0$</td>
<td>$x_1$</td>
<td>$0.1527778$</td>
<td>$-0.0728889$</td>
<td>$x_2 &#x3D; 0.691238$</td>
</tr>
<tr>
<td>第 2 步</td>
<td>$x_1$</td>
<td>$x_2$</td>
<td>$-0.0728889$</td>
<td>$0.0312537$</td>
<td>$x_3 &#x3D; 0.663857$</td>
</tr>
</tbody></table>
</blockquote>
<blockquote>
<p><img src="/blog/image/Snipaste_2025-06-11_10-19-37.png"></p>
<p><img src="/blog/image/Snipaste_2025-06-11_10-19-46.png"></p>
</blockquote>
<blockquote>
<p><img src="/blog/image/Snipaste_2025-06-11_10-36-48.png"></p>
</blockquote>
<blockquote>
<p><img src="/blog/image/Snipaste_2025-06-11_11-25-59.png"></p>
<p><img src="/blog/image/Snipaste_2025-06-11_11-26-06.png"></p>
<p><img src="/blog/image/Snipaste_2025-06-11_11-26-26.png"></p>
</blockquote>
<blockquote>
<p><img src="/blog/image/Snipaste_2025-06-11_14-50-34.png"></p>
</blockquote>
<blockquote>
<p><img src="/blog/image/Snipaste_2025-06-11_15-28-31.png"></p>
<p><img src="/blog/image/Snipaste_2025-06-11_15-28-49.png"></p>
<p><img src="/blog/image/Snipaste_2025-06-11_15-28-59.png"></p>
</blockquote>
<blockquote>
<p><img src="/blog/image/Snipaste_2025-06-11_16-05-13.png"></p>
</blockquote>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
  </entry>
  <entry>
    <title>数值分析-线性方程的解法</title>
    <url>/blog/2025/03/26/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90-%E7%BA%BF%E6%80%A7%E6%96%B9%E7%A8%8B%E7%BB%84%E7%9A%84%E8%A7%A3%E6%B3%95/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>此文章包含线性方程组的解法部分—————————————————————————————————————————————————————-</p>
<h1 id="线性方程组的解法"><a href="#线性方程组的解法" class="headerlink" title="线性方程组的解法"></a>线性方程组的解法</h1><h2 id="记忆内容汇总"><a href="#记忆内容汇总" class="headerlink" title="记忆内容汇总"></a>记忆内容汇总</h2><blockquote>
<p><strong>常用矩阵范数</strong>(<strong>下面的$x$都指的是向量</strong>)</p>
<ol>
<li><strong>Frobenius范数</strong></li>
</ol>
<p>$$<br>||A||_F &#x3D; \sqrt {\sum _{i&#x3D;1}^n  \sum _{j&#x3D;1}^n |a _{ij}|^2}<br>$$</p>
<p>对于方阵 $A \in \mathbb{R}^{n \times n}$ 和向量 $x \in \mathbb{R}^n$ 有：</p>
<p>$$<br>||Ax||_2 \leq ||A||_F \cdot ||x||_2<br>$$</p>
<ol start="2">
<li><strong>算子范数（Operator Norm）</strong></li>
</ol>
<p>矩阵范数与向量范数的<strong>相容性</strong>（<em>consistent</em>）</p>
<p>$$<br>||A|| _p &#x3D; \max _{x \neq 0} \frac{||Ax|| _p}{||x|| _p} &#x3D; \max _{||x|| _p&#x3D;1} ||Ax|| _p<br>$$</p>
<p>进一步：</p>
<p>$$<br>||Ax||_p \leq ||A||_p ||x||_p<br>$$</p>
<blockquote>
<p><strong>行和范数（∞-范数）</strong><br>$$<br>||A|| _\infty &#x3D; \max _{1 \leq i \leq n} \sum _{j&#x3D;1}^n |a _{ij}|<br>$$</p>
</blockquote>
<blockquote>
<p><strong>列和范数（1-范数）</strong></p>
<p>$$<br>||A||_1 &#x3D; \max _{1 \leq j \leq n} \sum _{i&#x3D;1}^n |a _{ij}|<br>$$</p>
</blockquote>
<blockquote>
<p><strong>谱范数（2-范数）</strong></p>
</blockquote>
<blockquote>
<p>$$<br>||A||_2 &#x3D; \sqrt{\lambda _{\max}(A^T A)}<br>$$</p>
<p>矩阵$A^T A$的最大特征根</p>
</blockquote>
<p><strong>矩阵谱半径定义</strong></p>
<p>设矩阵 $A \in \mathbb{C}^{n \times n}$ 的特征根为 $\lambda_1, \lambda_2, \ldots, \lambda_n$，则矩阵 $A$ 的<strong>谱半径</strong>（<em>spectral radius</em>）定义为：</p>
<p>$$<br>\rho(A) &#x3D; \max_{1 \leq i \leq n} |\lambda_i|<br>$$</p>
</blockquote>
<h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><blockquote>
<p><img src="/blog/image/Snipaste_2025-06-07_15-31-27.png"></p>
</blockquote>
<h2 id="向量与矩阵范数"><a href="#向量与矩阵范数" class="headerlink" title="向量与矩阵范数"></a>向量与矩阵范数</h2><h3 id="向量范数"><a href="#向量范数" class="headerlink" title="向量范数"></a>向量范数</h3><p>我们用 $\mathbb{R}^n$ 表示 $n$ 维实向量的空间。</p>
<p>定义</p>
<blockquote>
<p>hexo显示有误，下面 |.| 皆为范数 ||.||</p>
</blockquote>
<p>如果向量 $X \in \mathbb{R}^n$ 的某个实值函数 $N(X) &#x3D; ||X||$ 满足以下条件：</p>
<ol>
<li><p><strong>正定性</strong>：<br>$$<br>||x|| \geq 0，\quad \text{当且仅当} \ x &#x3D; 0 \ \text{时，} \ ||x|| &#x3D; 0<br>$$</p>
</li>
<li><p><strong>齐次性</strong>：<br>$$<br>|| \alpha x || &#x3D; |\alpha| \cdot ||x||，\quad \alpha \in \mathbb{R}<br>$$</p>
</li>
<li><p><strong>三角不等式</strong>：<br>$$<br>||x + y|| \leq ||x|| + ||y||，\quad x, y \in S<br>$$</p>
</li>
</ol>
<p><u>则称 $N(X)$ 是向量 $X$ 的范数。</u></p>
<blockquote>
<ol>
<li><p><strong>∞-范数（最大范数）</strong>：<br>$$<br>||x|| _ \infty &#x3D; \max_{1 \leq i \leq n} |x_i|<br>$$</p>
</li>
<li><p><strong>1-范数</strong>：<br>$$<br>||x|| _ 1 &#x3D; \sum_{i&#x3D;1}^n |x_i|<br>$$</p>
</li>
<li><p><strong>2-范数</strong>：<br>$$<br>||x|| _ 2 &#x3D; \left( \sum_{i&#x3D;1}^n x_i^2 \right)^{1&#x2F;2}<br>$$</p>
</li>
<li><p><strong>p-范数（推广范数）</strong></p>
</li>
</ol>
<p>$$<br>|X|_p &#x3D; \left( \sum _{i&#x3D;1}^n |x_i|^p \right)^{1&#x2F;p}<br>$$</p>
<ol start="2">
<li>计算示例</li>
</ol>
<p>对向量 $X &#x3D; (1, -2, 3)$：</p>
<p>$$<br>||X||_1 &#x3D; |1| + |-2| + |3| &#x3D; 6<br>$$</p>
<p>$$<br>||X||_\infty &#x3D; \max(|1|, |-2|, |3|) &#x3D; 3<br>$$</p>
<p>$$<br>||X||_2 &#x3D; \sqrt{1^2 + (-2)^2 + 3^2} &#x3D; \sqrt{14}<br>$$</p>
</blockquote>
<hr>
<p><strong>一些定义和定理：</strong></p>
<p><strong>定义</strong>：向量序列 ${X^{(k)}}$ 收敛于向量 $X^*$ 是指对每一个 $1 \leq i \leq n$ 都有</p>
<p>$$<br>\lim_{k \to \infty} x_i^{(k)} &#x3D; x_i^*<br>$$</p>
<p>可以理解为</p>
<p>$$<br>||X^{(k)} - X^*||_\infty \to 0 \quad<br>$$</p>
<p><strong>定义</strong>：若存在常数 $C &gt; 0$，使得对任意 $X \in \mathbb{R}^n$ 满足<br>$$<br>||X||_A \leq C ||X||_B,<br>$$</p>
<p>则称范数 $||\cdot||_A$ 比范数 $||\cdot||_A$ <strong>强</strong></p>
<p><strong>定义</strong>：若 $||\cdot||_A$ 比 $||\cdot||_A$ 强，同时 $||\cdot||_B$ 也比 $||\cdot||_A$ 强，即存在常数 $C_1, C_2 &gt; 0$ 使得<br>$$<br>C_1 ||\cdot||_B \leq ||\cdot||_A \leq C_2 ||\cdot||_B<br>$$</p>
<p>则称 $||\cdot||_A$ 和 $||\cdot||_B$ <strong>等价</strong>。</p>
<p><strong>定理</strong><br>$$<br>\mathbb{R}^n \text{上一切范数都等价。}<br>$$</p>
<p><strong>定理：</strong></p>
<p>$$<br>\lim_{k \to \infty} X^{(k)} &#x3D; X^* \quad \Leftrightarrow \quad |X^{(k)} - X^*| \to 0 \quad (k \to \infty)<br>$$</p>
<hr>
<h3 id="矩阵范数"><a href="#矩阵范数" class="headerlink" title="矩阵范数"></a>矩阵范数</h3><p><strong>定义</strong></p>
<p>矩阵范数 $||\cdot||$ 对任意矩阵 $A, B \in \mathbb{R}^{m \times n}$ 满足以下条件：</p>
<ol>
<li><p><strong>正定性</strong>（<em>positive definite</em>）</p>
<p>$$<br>|A| \geq 0；\quad |A| &#x3D; 0 \Leftrightarrow A &#x3D; 0<br>$$</p>
</li>
<li><p><strong>齐次性</strong>（<em>homogeneous</em>）</p>
<p>$$<br>|\alpha A| &#x3D; |\alpha| \cdot |A| \quad \text{对任意} \ \alpha \in \mathbb{C}<br>$$</p>
</li>
<li><p><strong>三角不等式</strong>（<em>triangle inequality</em>）</p>
<p>$$<br>|A + B| \leq |A| + |B|<br>$$</p>
</li>
<li><p><strong>相容性</strong>（<em>consistent</em>，当$m &#x3D; n$时）</p>
<p>$$<br>|AB| \leq |A| \cdot |B|<br>$$</p>
</li>
</ol>
<blockquote>
<p><strong>常用矩阵范数</strong>(<strong>下面的$x$都指的是向量</strong>)</p>
<ol>
<li><strong>Frobenius范数</strong></li>
</ol>
<p>$$<br>||A||_F &#x3D; \sqrt {\sum _{i&#x3D;1}^n  \sum _{j&#x3D;1}^n |a _{ij}|^2}<br>$$</p>
<p>对于方阵 $A \in \mathbb{R}^{n \times n}$ 和向量 $x \in \mathbb{R}^n$ 有：</p>
<p>$$<br>||Ax||_2 \leq ||A||_F \cdot ||x||_2<br>$$</p>
<ol start="2">
<li><strong>算子范数（Operator Norm）</strong></li>
</ol>
<p>矩阵范数与向量范数的<strong>相容性</strong>（<em>consistent</em>）</p>
<p>$$<br>||A|| _p &#x3D; \max _{x \neq 0} \frac{||Ax|| _p}{||x|| _p} &#x3D; \max _{||x|| _p&#x3D;1} ||Ax|| _p<br>$$</p>
<p>进一步：</p>
<p>$$<br>||Ax||_p \leq ||A||_p ||x||_p<br>$$</p>
<blockquote>
<p><strong>特别有</strong></p>
</blockquote>
<blockquote>
<p><strong>行和范数（∞-范数）</strong></p>
<p>$$<br>||A|| _\infty &#x3D; \max _{1 \leq i \leq n} \sum _{j&#x3D;1}^n |a _{ij}|<br>$$</p>
</blockquote>
<blockquote>
<p><strong>列和范数（1-范数）</strong></p>
<p>$$<br>||A||_1 &#x3D; \max _{1 \leq j \leq n} \sum _{i&#x3D;1}^n |a _{ij}|<br>$$</p>
</blockquote>
<blockquote>
<p><strong>谱范数（2-范数）</strong></p>
</blockquote>
<blockquote>
<p>$$<br>||A||_2 &#x3D; \sqrt{\lambda _{\max}(A^T A)}<br>$$</p>
<p>矩阵$A^T A$的最大特征根</p>
</blockquote>
<p><strong>矩阵谱半径定义</strong></p>
<p>设矩阵 $A \in \mathbb{C}^{n \times n}$ 的特征根为 $\lambda_1, \lambda_2, \ldots, \lambda_n$，则矩阵 $A$ 的<strong>谱半径</strong>（<em>spectral radius</em>）定义为：</p>
<p>$$<br>\rho(A) &#x3D; \max_{1 \leq i \leq n} |\lambda_i|<br>$$</p>
</blockquote>
<p><strong>一些定理</strong></p>
<ol>
<li>对于任意算子范数  $||\cdot||$  ，有：</li>
</ol>
<p>$$<br>\rho(A) \leq ||A||<br>$$</p>
<ol start="2">
<li><p>若$A$对称，则有</p>
<p>$$<br>||A||_2 &#x3D; \rho(A)<br>$$</p>
</li>
<li><p>若矩阵$B$对某个算子范数满足$||B|| &lt; 1$，则必有：</p>
<ol>
<li>$I \pm B$ 可逆；</li>
<li>$||(I \pm B)^{-1}|| \leq \dfrac{1}{1 - ||B||}$</li>
</ol>
</li>
</ol>
<h2 id="高斯消元法"><a href="#高斯消元法" class="headerlink" title="高斯消元法"></a>高斯消元法</h2><p><strong>定理</strong> </p>
<p>设矩阵 $A$ 为 $n$ 阶非奇异矩阵（可逆方阵），则可通过高斯消去法（包括交换两行的初等变换）将方程组 $A\mathbf{x} &#x3D; \mathbf{b}$ 化为<strong>三角形方程组</strong>。</p>
<p><strong>引理</strong> </p>
<p>约化过程中主元素 $a_{ii}^{(i)} \neq 0$（$i&#x3D;1,2,\ldots,k$）的充要条件是矩阵 $A$ 的顺序主子式满足：<br>$$<br>D_i \neq 0 \quad (i&#x3D;1,2,\ldots,k)<br>$$</p>
<p>特别地，一阶主子式：</p>
<p>$$<br>D_1 &#x3D; a_{11} \neq 0<br>$$</p>
<p><strong>顺序主子式定义如下：</strong></p>
<span>
$$
A_k = \begin{pmatrix} a_{11} & \cdots & a_{1k} \\\ \vdots & \ddots & \vdots \\\ a_{k1} & \cdots & a_{kk} \end{pmatrix}, \quad D_k = \det(A_k)
$$
</span>

<p><strong>推论</strong></p>
<p>如果矩阵 $A$ 的顺序主子式 $D_k \neq 0$（$k&#x3D;1,2,\ldots,n-1$），则：</p>
<p>$$<br>a_{11}^{(1)} &#x3D; D_1<br>$$</p>
<p>$$<br>a_{kk}^{(k)} &#x3D; \frac{D_k}{D_{k-1}} \quad (k&#x3D;2,\ldots,n)<br>$$</p>
<p><strong>定理</strong></p>
<p>若 $A$ 的所有顺序主子式均满足：</p>
<p>$$<br>D_k \neq 0<br>$$</p>
<p>则高斯消元无需换行即可进行到底，得到唯一解。</p>
<blockquote>
<p>高斯消去法的计算过程略</p>
</blockquote>
<p><strong>高斯法的问题</strong></p>
<ol>
<li><p><strong>主元素为零</strong>：</p>
<p>$$<br>a_{kk}^{(k)} &#x3D; 0 \quad \text{消去过程中出现，导致消去法无法进行}<br>$$</p>
</li>
<li><p><strong>小主元素问题</strong>：</p>
<ul>
<li><p>即使 $a_{kk}^{(k)} \neq 0$ 但绝对值很小时：</p>
<ul>
<li>导致其他元素数量级严重增长</li>
<li>引发舍入误差扩散</li>
<li>最终使计算解不可靠</li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="高斯列主元消去法"><a href="#高斯列主元消去法" class="headerlink" title="高斯列主元消去法"></a>高斯列主元消去法</h2><p>设方程组的增广矩阵为：</p>
<span>
$$
B = \begin{bmatrix} a_{11} & a_{12} & \cdots & a_{1n} & b_1 \\\ a_{21} & a_{22} & \cdots & a_{2n} & b_2 \\\ \vdots & \vdots & \ddots & \vdots & \vdots \\\ a_{n1} & a_{n2} & \cdots & a_{nn} & b_n \end{bmatrix}
$$
</span>

<p>在矩阵 $A$ 的<span style="color:#FF0000">第一列</span>选取绝对值最大的元素：</p>
<p>$$<br>|a_{i_1,1}| &#x3D; \max_{1 \leq i \leq n} |a_{i1}| \neq 0<br>$$</p>
<p>交换矩阵 $B$ 的第1行与第$i_1$行，经第一次消元计算得：</p>
<p>$$<br>(A|b) \rightarrow (A^{(2)}|b^{(2)})<br>$$</p>
<p>设已完成第$k-1$步的选主元素、交换两行及消元计算，$(A|b)$约化为：</p>
<span>
$$
(A^{(k)}|b^{(k)}) = \begin{bmatrix} a_{11} & a_{12} & \cdots & a_{1k} & \cdots & a_{1n} & b_1 \\\ & a_{22} & \cdots & a_{2k} & \cdots & a_{2n} & b_2 \\\ & & \ddots & \vdots & \ddots & \vdots & \vdots \\\ & & & a_{kk} & \cdots & a_{kn} & b_k \\\ & & & \vdots & \ddots & \vdots & \vdots \\\ & & & a_{nk} & \cdots & a_{nn} & b_n \end{bmatrix}
$$
</span>

<p>在$A^{(k)}$右下角子矩阵的第1列选取主元素：</p>
<p>$$<br>|a_{i_k,k}| &#x3D; \max_{k \leq i \leq n} |a_{i,k}| \neq 0<br>$$</p>
<p>消元后三角矩阵</p>
<span>
$$
\begin{bmatrix} a_{11} & a_{12} & \cdots & a_{1n} \\\ & a_{22} & \cdots & a_{2n} \\\ & & \ddots & \vdots \\\ & & & a_{nn} \end{bmatrix} \begin{bmatrix} x_1 \\\ x_2 \\\ \vdots \\\ x_n \end{bmatrix} = \begin{bmatrix} b_1 \\\ b_2 \\\ \vdots \\\ b_n \end{bmatrix} 
$$
</span>

<p>回代求解公式</p>
<span>
$$
 x_n = \dfrac{b_n}{a_{nn}} \qquad\\
 x_i = \left(b_i - \sum\limits_{j=i+1}^{n} a_{ij} x_j\right) \bigg/ a_{ii} \quad (i = n-1, \ldots, 2, 1)
$$
</span>

<h2 id="矩阵三角分解法"><a href="#矩阵三角分解法" class="headerlink" title="矩阵三角分解法"></a>矩阵三角分解法</h2><p><strong>定理</strong> </p>
<p>设$A$为$n$阶矩阵，如果$A$的顺序主子式$|D_i| \neq 0$ $(i &#x3D; 1,2,\cdots,n-1)$</p>
<p>则$A$的$LU$分解唯一</p>
<p><strong>（其中$L$为单位下三角阵，U为上三角矩阵）</strong></p>
<h3 id="道立特分解法（Doolittle-Factorization）"><a href="#道立特分解法（Doolittle-Factorization）" class="headerlink" title="道立特分解法（Doolittle Factorization）"></a>道立特分解法（Doolittle Factorization）</h3><p>通过比较法直接导出L和U的计算公式。</p>
<p><img src="/blog/image/Snipaste_2025-04-07_20-28-30.png"></p>
<p><strong>方法备注：</strong></p>
<ol>
<li><span style="color:#FF0000">L的对角线元素为1，U的第一行元素$u_{1j}&#x3D;a_{1j}$</span></li>
<li>然后求L的第一列元素，随后求U的第二列，然后L，随后U，交替往复。<strong>（瞪眼法）</strong></li>
</ol>
<h3 id="例题-1"><a href="#例题-1" class="headerlink" title="例题"></a>例题</h3><blockquote>
<span>
$$
A=\begin{bmatrix}1&1&1\\0&4&-1\\2&-2&1\end{bmatrix}=\begin{bmatrix}1&0&0\\0&1&0\\2&-1&1\end{bmatrix}\begin{bmatrix}1&1&1\\0&4&-1\\0&0&-2\end{bmatrix}=LU
$$
</span></blockquote>
<blockquote>
<p>设</p>
<span>
$$
A = \begin{bmatrix} 2 & 1 & 1 \\ 2 & 3 & 2 \\ 2 & 3 & 4 \end{bmatrix}, \quad b = \begin{bmatrix} 4 \\ 7 \\ 9 \end{bmatrix}
$$
</span>



<p>将 $A$ 作 LU 分解，求解 $AX &#x3D; b$。</p>
<p><strong>解：</strong></p>
<span>
$$
LU = 
\begin{bmatrix}
1 & 0 & 0 \\
1 & 1 & 0 \\
1 & 1 & 1 
\end{bmatrix}
\begin{bmatrix}
2 & 1 & 1 \\
0 & 2 & 1 \\
0 & 0 & 2
\end{bmatrix}
$$

</span>
$$
Ly = b \Rightarrow y = \begin{bmatrix} 4 \\ 3 \\ 2 \end{bmatrix}, \quad
UX = y \Rightarrow X = \begin{bmatrix} 1 \\ 1 \\ 1 \end{bmatrix}.
$$</blockquote>
<blockquote>
<p><img src="/blog/image/Snipaste_2025-06-07_10-31-16.png"></p>
</blockquote>
<h3 id="平方根法（Choleski’s-Method）"><a href="#平方根法（Choleski’s-Method）" class="headerlink" title="平方根法（Choleski’s Method）"></a>平方根法（Choleski’s Method）</h3><blockquote>
<p><strong>对称矩阵</strong></p>
<p>一个矩阵 $A &#x3D; (a_{ij})_{n \times n}$ 称为<strong>对称阵</strong>，如果满足：</p>
<p>$a_{ij} &#x3D; a_{ji}$</p>
<p><strong>正定矩阵</strong></p>
<p>一个矩阵 $A$ 称为<strong>正定阵</strong>，如果对任意非零向量 $\vec{x} \neq \vec{0}$，满足： $\vec{x}^T A \vec{x} &gt; 0$</p>
<p><strong>对称正定矩阵的性质</strong></p>
<ol>
<li><p><strong>逆矩阵性质</strong> $A^{-1}$ 仍为对称正定矩阵，且其主对角元满足： $a_{ii} &gt; 0 \quad (i&#x3D;1,2,\cdots,n)$</p>
</li>
<li><p><strong>主子阵性质</strong><br>&#x20;$A$ 的任意<strong>顺序主子阵</strong>（leading principal submatrices） $A_k$ （ $k&#x3D;1,2,\cdots,n$ ）均为对称正定矩阵。</p>
</li>
<li><p><strong>特征值性质</strong><br>&#x20;$A$ 的所有特征值 $\lambda_i$ 均为正数： $\lambda_i &gt; 0 \quad (i&#x3D;1,2,\cdots,n)$</p>
</li>
<li><p><strong>主子式性质</strong> </p>
<p>$A$ 的全部顺序主子式满足： $\det(A_k) &gt; 0 \quad (k&#x3D;1,2,\cdots,n)$ 特别地，矩阵行列式可表示为： $\det(A) &#x3D; \prod_{i&#x3D;1}^n \lambda_i$</p>
</li>
</ol>
</blockquote>
<hr>
<p>设<strong>对称正定</strong>矩阵$A$的LU分解结果为：<br>$$<br>A &#x3D; LU<br>$$<br>其中：</p>
<ul>
<li><p>$L$为<strong>单位下三角阵</strong>（主对角线元素为1）</p>
</li>
<li><p>$U$为<strong>上三角阵</strong>，可进一步分解为对角阵乘积：</p>
<p><img src="/blog/image/Snipaste_2025-04-21_09-49-01.png"></p>
</li>
</ul>
<p>由对称性$A &#x3D; A^T$，有$L&#x3D;\tilde{U}^T$， 故$A &#x3D; LDL^T$</p>
<p>取对角阵的平方根：</p>
<p>$$<br>D^{1&#x2F;2} &#x3D; \mathrm{diag}\left( \sqrt{u_{11}}, \sqrt{u_{22}}, \dots, \sqrt{u_{nn}} \right)<br>$$</p>
<p>定义新的下三角阵： $\tilde{L} &#x3D; LD^{1&#x2F;2}$ 则矩阵可表示为： $A &#x3D; \tilde{L}\tilde{L}^T$</p>
<p><strong>定理</strong> </p>
<p>设矩阵$A \in \mathbb{R}^{n \times n}$对称正定，则存在<strong>非奇异下三角阵</strong>$L$满足： $A &#x3D; LL^T$ 若进一步限定$L$的主对角元素满足： $l_{ii} &gt; 0 \quad (i&#x3D;1,2,\dots,n)$ 则该分解<strong>唯一存在</strong>。</p>
<hr>
<h3 id="追赶法"><a href="#追赶法" class="headerlink" title="追赶法"></a>追赶法</h3><span>
$$
A=\begin{bmatrix}b_1&c_1\\a_2&b_2&c_2\\&\ddots&\ddots&\ddots\\&&a_{n-1}&b_{n-1}&c_{n-1}\\&&&a_n&b_n\end{bmatrix}=\begin{bmatrix}\alpha_1\\r_2&\alpha_2\\&\ddots&\ddots\\&&r_n&\alpha_n\end{bmatrix}\begin{bmatrix}1&\beta_1\\&1&\ddots\\&&\ddots&\beta_{n-1}\\&&&1\end{bmatrix}
$$
</span>

<p>并且满足</p>
<ol>
<li><p>$a_i \ne 0\ (i &#x3D; 2, 3, \dots, n),\ c_i \ne 0\ (i &#x3D; 1, 2, \dots, n - 1);$</p>
</li>
<li><p>$|b_1| &gt; |c_1|,\ |b_i| \ge |a_i| + |c_i|\ (i &#x3D; 2, 3, \dots, n - 1),\ |b_n| &gt; |a_n|.$</p>
</li>
</ol>
<p>$$<br>\boxed{<br>\text{条件1保证方程组不能降阶，条件2保证三角分解可做到底。}<br>}<br>$$</p>
<p>$$<br>r_i&#x3D;a_i<br>$$</p>
<p>$$<br>\beta_1&#x3D;\frac{c_1}{b_1}<br>$$</p>
<p>$$<br>\beta_i&#x3D;\frac{c_i}{b_i-a_i \beta_{i-1}}<br>$$</p>
<p>$$<br>\alpha_1&#x3D;b_{1}\quad \<br>\alpha_{i}&#x3D;b_{i}-a_{i}\beta_{i-1}<br>$$</p>
<hr>
<blockquote>
<p><strong>解题过程</strong></p>
<ol>
<li><p><strong>方程组分解</strong>： 原方程组$AX &#x3D; f$分解为两个三角方程组：</p>
</li>
<li><p><strong>计算 ${\beta_i}$ 的递推关系</strong>：</p>
</li>
<li><p><strong>计算 ${\alpha_i}$ 和${r_i}$的递推关系</strong>：</p>
</li>
<li><p><strong>解下三角方程组 $Ly &#x3D; f$</strong>：</p>
</li>
<li><p><strong>解上三角方程组 $Ux &#x3D; y$</strong>：</p>
</li>
</ol>
<p><strong>例题</strong></p>
<p><img src="/blog/image/shuzhifenxi1.jpg"></p>
</blockquote>
<blockquote>
<p><img src="/blog/image/Snipaste_2025-06-07_11-03-13.png"></p>
</blockquote>
<blockquote>
<p><img src="/blog/image/Snipaste_2025-06-07_15-09-52.png"></p>
</blockquote>
<p><strong>定理</strong></p>
<blockquote>
<p><strong>对角占优矩阵（Diagonally Dominant Matrix）</strong></p>
<p>对于$n$阶矩阵$A &#x3D; (a_{ij})$，若其<strong>每一行</strong>满足：<br>$$<br>|a_{ii}| \geq \sum_{\substack{j&#x3D;1 \ j \neq i}}^{n} |a_{ij}| \quad (i&#x3D;1,2,\dots,n)<br>$$</p>
<p>则称$A$为<strong>行对角占优矩阵</strong>。</p>
<p>若其<strong>每一列</strong>满足：<br>$$<br>|a_{jj}| \geq \sum_{\substack{i&#x3D;1 \ i \neq j}}^{n} |a_{ij}| \quad (j&#x3D;1,2,\dots,n)<br>$$</p>
<p>则称$A$为<strong>列对角占优矩阵</strong>。</p>
<p><u>上面两个条件满足其一就是对角占优矩阵</u></p>
<hr>
<p><strong>严格对角占优矩阵（Strictly Diagonally Dominant Matrix）</strong></p>
<p>将上述不等式中的”≥”改为严格”&gt;”：</p>
</blockquote>
<p>若$A$为<strong>对角占优</strong>（diagonally dominant）的三对角阵，且满足：</p>
<ol>
<li><p>首尾行条件：$|b_1| &gt; |c_1| &gt; 0$   $|b_n| &gt; |a_n| &gt; 0$</p>
</li>
<li><p>非零条件：$a_i \neq 0 $  $c_i \neq 0 $</p>
<p>则追赶法可解以$A$为系数矩阵的方程组。</p>
</li>
</ol>
<p><strong>注</strong><br>当$A$是<strong>严格对角占优阵</strong>时（即满足严格不等式 $|b_i| &gt; |a_i| + |c_i|$），不要求三对角线上所有元素非零（允许$a_i&#x3D;0$或$c_i&#x3D;0$的特殊情况存在）。</p>
<hr>
<h2 id="线性方程组的误差分析"><a href="#线性方程组的误差分析" class="headerlink" title="线性方程组的误差分析"></a>线性方程组的误差分析</h2><h3 id="情形1：矩阵-A-精确，右端项-vec-b-存在误差"><a href="#情形1：矩阵-A-精确，右端项-vec-b-存在误差" class="headerlink" title="情形1：矩阵$A$精确，右端项$\vec{b}$存在误差"></a>情形1：矩阵$A$精确，右端项$\vec{b}$存在误差</h3><p>设$\vec{b}$有扰动$\delta\vec{b}$，对应解的扰动为$\delta\vec{x}$，满足：</p>
<p>$$<br>A(\vec{x} + \delta\vec{x}) &#x3D; \vec{b} + \delta\vec{b}<br>$$</p>
<ol>
<li><p><strong>扰动解表达式</strong> $\delta\vec{x} &#x3D; A^{-1}\delta\vec{b}$</p>
</li>
<li><p><strong>范数不等式</strong> $|\delta\vec{x}| \leq |A^{-1}| \cdot |\delta\vec{b}|$</p>
</li>
<li><p><strong>原始解范数关系</strong> $|\vec{b}| &#x3D; |A\vec{x}| \leq |A| \cdot |\vec{x}| \implies \frac{1}{|\vec{x}|} \leq \frac{|A|}{|\vec{b}|}$</p>
</li>
<li><p><strong>相对误差界</strong> $\frac{|\delta\vec{x}|}{|\vec{x}|} \leq |A| \cdot |A^{-1}| \cdot \frac{|\delta\vec{b}|}{|\vec{b}|}$</p>
</li>
</ol>
<h3 id="情形2：矩阵-A-存在误差-delta-A"><a href="#情形2：矩阵-A-存在误差-delta-A" class="headerlink" title="情形2：矩阵$A$存在误差$\delta A$"></a>情形2：矩阵$A$存在误差$\delta A$</h3><p>设矩阵有扰动$\delta A$，解的扰动满足：</p>
<p>$$<br>(A + \delta A)(\vec{x} + \delta\vec{x}) &#x3D; \vec{b}<br>$$</p>
<p>推导过程略</p>
<p>$$<br>\frac{|\delta \bar{x}|}{|\bar{x}|} \leq \frac{|A^{-1}| \cdot |\delta A|}{1 - |A^{-1}| \cdot |\delta A|} &#x3D; \frac{|A| \cdot |A^{-1}| \cdot \frac{|\delta A|}{|A|}}{1 - |A| \cdot |A^{-1}| \cdot \frac{|\delta A|}{|A|}}<br>$$</p>
<hr>
<h3 id="条件数"><a href="#条件数" class="headerlink" title="条件数"></a>条件数</h3><p>矩阵$A$的条件数定义为：</p>
<p>$$<br>\text{cond}(A) &#x3D; |A| \cdot |A^{-1}|<br>$$</p>
<p><strong>核心结论</strong></p>
<p><strong>条件数与病态性关系</strong>：</p>
<p>$\text{cond}(A) \text{ 越大} \implies A \text{ 越病态} \implies \text{解算结果越难准确}$</p>
<p>$cond(A)$的大小与$||.||$的取法有关，但相对大小一致</p>
<p><strong>常用条件数定义</strong></p>
<p><em>一般矩阵条件数</em></p>
<span>
$$
 \begin{cases}
 \text{cond}(A)_1 \\
 \text{cond}(A)_\infty \\
 \text{cond} (A)_2 = \sqrt{\frac{\lambda_{\max}(A^T A)}{\lambda_{\min}(A^T A)}} 
 \end{cases} 
$$
</span>

<p><em>对称矩阵的特殊情形</em></p>
<p>当$A$为对称矩阵时： $\text{cond}(A)_2 &#x3D; \frac{\max|\lambda|}{\min|\lambda|}$</p>
<p><strong>条件数性质</strong></p>
<p>□ 若$A$可逆，则$\text{cond}(A)_p \geq 1$；</p>
<p> □ 若$A$可逆且$\alpha \in \mathbb{R}$，则$\text{cond}(\alpha A) &#x3D; \text{cond}(A)$；</p>
<p>□若$A$正交，则$\text{cond}(A)_2 &#x3D; 1$；</p>
<p>□ 若$A$可逆且$R$正交，则： $\text{cond}(RA)_2 &#x3D; \text{cond}(AR)_2 &#x3D; \text{cond}(A)_2$</p>
<hr>
<h3 id="近似解的误差估计及改善"><a href="#近似解的误差估计及改善" class="headerlink" title="近似解的误差估计及改善"></a>近似解的误差估计及改善</h3><p>设 $A\vec{x} &#x3D; \vec{b}$ 的近似解为 $\vec{x}^*$，则：</p>
<ol>
<li>残差向量：$\vec{r} &#x3D; \vec{b} - A\vec{x}^* \neq \vec{0}$</li>
<li>误差上界：</li>
</ol>
<p>$$<br>\frac{|\vec{x} - \vec{x}^*|}{|\vec{x}|} \leq \text{cond}(A) \cdot \frac{|\vec{r}|}{|\vec{b}|}<br>$$</p>
<p><strong>改善方法</strong></p>
<p><strong>Step 1</strong> 求初始近似解： $A\vec{x}_1 &#x3D; \vec{b} \quad \Rightarrow \quad \vec{x}_1$</p>
<p><strong>Step 2</strong> 计算残差： $\vec{r}_1 &#x3D; \vec{b} - A\vec{x}_1$</p>
<p><strong>Step 3</strong> 解校正方程： $A\vec{d}_1 &#x3D; \vec{r}_1 \quad \Rightarrow \quad \vec{d}_1$</p>
<p><strong>Step 4</strong> 更新解： $\vec{x}_2 &#x3D; \vec{x}_1 + \vec{d}_1$</p>
<p>若 $\vec{d}_1$ 可精确解得：</p>
<p>$$<br>\vec{x}_2 &#x3D; \vec{x}_1 + A^{-1}(\vec{b} - A\vec{x}_1) &#x3D; A^{-1}\vec{b}<br>$$</p>
<p>此时 $\vec{x}_2$ 即为精确解。</p>
<p><strong>经验表明</strong>： 若$A$不是非常病态（例如：$ε \cdot \text{cond}(A)_∞ &lt; 1$），则如此迭代可达到机器精度； 但若$A$病态，则此算法也不能改进。</p>
<h2 id="解线性方程的迭代法"><a href="#解线性方程的迭代法" class="headerlink" title="解线性方程的迭代法"></a>解线性方程的迭代法</h2><p>方程组改写形式</p>
<p>$$<br>A \bar{x} &#x3D; \bar{b} \quad \Rightarrow \quad \bar{x} &#x3D; B \bar{x} + \bar{f}<br>$$</p>
<p>建立迭代</p>
<p>$$<br>\bar{x}^{(k+1)} &#x3D; B \bar{x}^{(k)} + \bar{f}<br>$$</p>
<p>从初值$\bar{x}^{(0)}$得到${\bar{x}^{(k)}}$</p>
<h3 id="Jacobi-雅可比-迭代法"><a href="#Jacobi-雅可比-迭代法" class="headerlink" title="Jacobi(雅可比)迭代法"></a>Jacobi(雅可比)迭代法</h3><p>线性方程组标准形式</p>
<span>
$$
\begin{cases} 
a_{11}x_1 + a_{12}x_2 + \cdots + a_{1n}x_n = b_1 \\\ 
a_{21}x_1 + a_{22}x_2 + \cdots + a_{2n}x_n = b_2 \\\
\vdots \quad \vdots \quad \ddots \quad \vdots \\\
a_{n1}x_1 + a_{n2}x_2 + \cdots + a_{nn}x_n = b_n 
\end{cases}
$$
</span>

<p><strong>条件</strong>：$a_{ii} \neq 0$（主对角元非零）</p>
<p><strong>Jacobi迭代公式（分量形式）</strong></p>
<p>第i分量迭代式</p>
<p>$$<br>x_i^{(k+1)} &#x3D; \frac{1}{a_{ii}} \left( b_i - \sum_{\substack{j&#x3D;1 \ j \neq i}}^{n} a_{ij}x_j^{(k)} \right)<br>$$</p>
<ol>
<li>第一分量：$x_1 &#x3D; \frac{1}{a_{11}}(-a_{12}x_2 - \cdots - a_{1n}x_n + b_1)$</li>
<li>第二分量：$x_2 &#x3D; \frac{1}{a_{22}}(-a_{21}x_1 - \cdots - a_{2n}x_n + b_2)$</li>
<li>第n分量：$x_n &#x3D; \frac{1}{a_{nn}}(-a_{n1}x_1 - \cdots - a_{nn-1}x_{n-1} + b_n)$</li>
</ol>
<p><strong>Jacobi迭代的矩阵形式</strong></p>
<p><strong>矩阵分解形式</strong></p>
<p><img src="/blog/image/Snipaste_2025-04-06_16-16-19.png"></p>
<p>$$<br>A\vec{x} &#x3D; \vec{b} \Leftrightarrow (D + L + U)\vec{x} &#x3D; \vec{b}<br>$$</p>
<span>
$$
\begin{gathered}
\boldsymbol{L}=\begin{bmatrix}0\\a_{21}&0\\\vdots&\ddots\\\vdots&&\ddots\\a_{n-1}&\cdots&\cdots&a_{n,n-1}&0\end{bmatrix}
U=\begin{bmatrix}
0&a_{12}&\cdots&a_{1n}\\&\ddots&\ddots&\vdots\\&&\ddots&a_{n-1,n}\\
&&&0
\end{bmatrix}
\quad
\boldsymbol{D}=\begin{bmatrix}a_{11}\\&a_{22}\\&&\ddots\\&&&\ddots\\&&&&a_{nn}\end{bmatrix}\quad\end{gathered}
$$

</span>


<ul>
<li><p><strong>对角阵</strong>$D$： </p>
</li>
<li><p><strong>严格下三角</strong>$L$：</p>
</li>
<li><p><strong>严格上三角</strong>$U$：</p>
</li>
</ul>
<p><strong>迭代推导过程</strong></p>
<span>
$$
\begin{cases} D\vec{x} = -(L + U)\vec{x} + \vec{b} \\\ \vec{x} = -D^{-1}(L + U)\vec{x} + D^{-1}\vec{b} \\\ \vec{x}^{(k+1)} = -D^{-1}(L + U)\vec{x}^{(k)} + D^{-1}\vec{b} \end{cases}
$$
</span>

<p><span style="color:#FF0000">Jacobi迭代阵</span><br>$$<br> B_J&#x3D;-D^{-1}(L + U)<br>$$</p>
<h3 id="Gauss-Seidel迭代法"><a href="#Gauss-Seidel迭代法" class="headerlink" title="Gauss-Seidel迭代法"></a>Gauss-Seidel迭代法</h3><p><strong>迭代公式</strong></p>
<ol>
<li>第1分量： $x_1^{(k+1)} &#x3D; \frac{1}{a_{11}} \left( -a_{12}x_2^{(k)} - a_{13}x_3^{(k)} - \cdots - a_{1n}x_n^{(k)} + b_1 \right)$</li>
<li>第2分量： $x_2^{(k+1)} &#x3D; \frac{1}{a_{22}} \left( -a_{21}x_1^{(k+1)} - a_{23}x_3^{(k)} - \cdots - a_{2n}x_n^{(k)} + b_2 \right)$</li>
<li>第3分量： $x_3^{(k+1)} &#x3D; \frac{1}{a_{33}} \left( -a_{31}x_1^{(k+1)} - a_{32}x_2^{(k+1)} - \cdots - a_{3n}x_n^{(k)} + b_3 \right)$</li>
<li>第n分量： $x_n^{(k+1)} &#x3D; \frac{1}{a_{nn}} \left( -a_{n1}x_1^{(k+1)} - \cdots - a_{n,n-1}x_{n-1}^{(k+1)} + b_n \right)$</li>
</ol>
<p>通用形式</p>
<p>$x_i^{(k+1)} &#x3D; \frac{1}{a_{ii}} \left( b_i - \sum_{j&#x3D;1}^{i-1} a_{ij}x_j^{(k+1)} - \sum_{j&#x3D;i+1}^n a_{ij}x_j^{(k)} \right)$</p>
<p><strong>矩阵形式</strong></p>
<p>矩阵分解</p>
<p>$A &#x3D; D + L + U$ <strong>迭代公式推导</strong></p>
<ol>
<li>原始形式： $x^{(k+1)} &#x3D; -D^{-1}(Lx^{(k+1)} + Ux^{(k)}) + D^{-1}b$</li>
<li>等价变形： $(D + L)x^{(k+1)} &#x3D; -Ux^{(k)} + b$</li>
<li>标准形式： $x^{(k+1)} &#x3D; -(D + L)^{-1}Ux^{(k)} + (D + L)^{-1}b$</li>
</ol>
<p><span style="color:#FF0000">Gauss-Seidel迭代阵</span><br>$$<br>B &#x3D; -(D + L)^{-1}U<br>$$</p>
<hr>
<p><strong>收敛性说明</strong></p>
<blockquote>
<p><strong>注</strong>：两种方法都存在收敛性问题。<br>有例子表明：</p>
<ul>
<li>Gauss-Seidel法收敛时，Jacobi法可能不收敛</li>
<li>Jacobi法收敛时，Gauss-Seidel法也可能不收敛</li>
</ul>
</blockquote>
<h3 id="例题-2"><a href="#例题-2" class="headerlink" title="例题"></a>例题</h3><blockquote>
<p><img src="/blog/image/Snipaste_2025-06-07_16-51-36.png"></p>
<p><img src="/blog/image/Snipaste_2025-06-07_16-51-42.png"></p>
</blockquote>
<blockquote>
<p><img src="/blog/image/Snipaste_2025-06-09_10-29-46.png"></p>
</blockquote>
<blockquote>
<p><img src="/blog/image/Snipaste_2025-06-09_10-50-29.png"></p>
</blockquote>
<h2 id="迭代法的收敛性"><a href="#迭代法的收敛性" class="headerlink" title="迭代法的收敛性"></a>迭代法的收敛性</h2><h3 id="递推公式与收敛条件"><a href="#递推公式与收敛条件" class="headerlink" title="递推公式与收敛条件"></a>递推公式与收敛条件</h3><ol>
<li><strong>递推公式</strong>：</li>
</ol>
<p>$$<br>  \vec x^{(k+1)} &#x3D; B\vec x^{(k)} +\vec f<br>$$</p>
<ol start="2">
<li><strong>收敛条件推导</strong>：</li>
</ol>
<p>$$<br>e^{(k+1)} &#x3D; x^{(k+1)} - x^*<br>&#x3D; (Bx^{(k)} + f) - (Bx^* + f)<br>&#x3D; B(x^{(k)} - x^*)<br>&#x3D; Be^{(k)}<br>$$</p>
<p>进一步可得：</p>
<p>$$<br>e^{(k)} &#x3D; B^k e^{(0)}<br>$$</p>
<p><strong>定理</strong>：<br>设方程 $x &#x3D; Bx + f$ 存在唯一解，则从任意初始值 $x^{(0)}$ 出发，迭代格式<br>$$<br>x^{(k+1)} &#x3D; Bx^{(k)} + f<br>$$</p>
<p>收敛的充要条件是 $B^k \to 0$（当 $k \to \infty$ 时）。</p>
<p><strong>矩阵序列收敛定义</strong>：<br>设 </p>
<p>$A &#x3D; (a_{ij})_{n \times n}$</p>
<p>$A_k &#x3D; (a_{ij}^{(k)})_{n \times n} \in \mathbb{R}^{n \times n}$</p>
<p>则<br>$$<br>\lim_{k \to \infty} A_k &#x3D; A<br>$$</p>
<p>定义为对所有 $1 \leq i, j \leq n$，满足</p>
<p>$$<br>\lim_{k \to \infty} a_{ij}^{(k)} &#x3D; a_{ij}<br>$$</p>
<p>等价于对任何算子范数有$||A_k-A||\to 0 \quad as \quad k\to \infty$</p>
<p><strong>定理：</strong><br>$$<br>B^k \to0\Leftrightarrow \rho(B)&lt;1<br>$$</p>
<p><strong>迭代算法收敛条件</strong></p>
<p>$$<br>\text{迭代从任意向量出发收敛 } \Leftrightarrow B^k \to 0 \quad (k \to \infty) \Leftrightarrow \rho(B) &lt; 1<br>$$</p>
<p><strong>定理</strong></p>
<p>设有方程组</p>
<p>$$<br>x &#x3D; Bx + f<br>$$</p>
<p>对于任意初始向量 $x^{(0)}$ 及任意 $f$，解此方程组的迭代法</p>
<p>$$<br>x^{(k+1)} &#x3D; Bx^{(k)} + f<br>$$</p>
<p>收敛的充要条件是</p>
<p>$$<br>\rho(B) &lt; 1<br>$$</p>
<p>当$\rho(B) &lt; 1$时，迭代过程收敛，且$\rho(B) $越小，迭代收敛越快。</p>
<hr>
<p>注意到 $\vec{e}^{(k+1)} &#x3D; \vec{x}^{(k+1)} - \vec{x}^* &#x3D; B(\vec{x}^{(k)} - \vec{x}^*) &#x3D; B\vec{e}^{(k)} &#x3D; B^{k+1}\vec{e}^{(0)}$</p>
<p>则 $||\vec{e}^k|| &#x3D; ||B^k\vec{e}^{(0)}|| \leq ||B^k|| ||\vec{e}^{(0)}|| \leq ||B||^k||\vec{e}^{(0)}||$<br>$$<br>||\vec{e}^k|| \approx (\rho(B))^k||\vec{e}^{(0)}||<br>$$</p>
<p><strong>定义</strong></p>
<p>称 $R(B) &#x3D; -\ln \rho(B)$ 为迭代法的<span style="color:#FF0000">收敛速度</span></p>
<hr>
<p><strong>定理（充分条件）</strong></p>
<p>若存在一个矩阵范数使得 $|B| &#x3D; q &lt; 1$，则迭代收敛，且有下列误差估计：</p>
<p>$$<br>|\vec{x}^* - \vec{x}^{(k)}| \leq \frac{q}{1-q} |\vec{x}^{(k)} - \vec{x}^{(k-1)}|<br>$$</p>
<p>$$<br>|\vec{x}^* - \vec{x}^{(k)}| \leq \frac{q^k}{1-q} |\vec{x}^{(1)} - \vec{x}^{(0)}|<br>$$</p>
<p><strong>注</strong>：因 $\rho(B) \leq |B| &lt; 1$，故收敛性得证。</p>
<hr>
<p><strong>定理（充分条件）：</strong></p>
<p>若A为严格对角占优阵，则解$A \vec x&#x3D; \vec b$的Jacobi和Gauss-Seidel迭代均收敛。</p>
<hr>
<h3 id="例题-3"><a href="#例题-3" class="headerlink" title="例题"></a>例题</h3><blockquote>
<p>已知方程组</p>
<span>
$$
\begin{bmatrix} 1 & -2 \\\ -0.32 & 1 \end{bmatrix} 
\begin{bmatrix} x_1 \\\ x_2 \end{bmatrix} = \begin{bmatrix} b_1 \\\ b_2 \end{bmatrix}
$$
</span>

<p>考察解此方程组的Jacobi迭代法是否收敛，它的渐近收敛速度为多少。</p>
<p><strong>解</strong></p>
<p>方程组的Jacobi迭代阵<br>$$<br>B &#x3D; \begin{bmatrix} 0 &amp; 2 \\ 0.32 &amp; 0 \end{bmatrix}<br>$$</p>
<p>$$<br>|\lambda I - B| &#x3D; \begin{vmatrix} \lambda &amp; -2 \\ -0.32 &amp; \lambda \end{vmatrix} &#x3D; 0<br>$$</p>
<p>$\lambda_1 &#x3D; -0.8, \lambda_2 &#x3D; 0.8$</p>
<ul>
<li><p>因 $\rho(B) &#x3D; 0.8$ 故方程组的Jacobi迭代收敛。</p>
</li>
<li><p>其渐近收敛速度 $R(B) &#x3D; -\ln \rho(B) &#x3D; -\ln 0.8 &#x3D; 0.223$</p>
</li>
</ul>
</blockquote>
<blockquote>
<p><img src="/blog/image/Snipaste_2025-06-09_14-32-52.png"></p>
</blockquote>
<blockquote>
<p><img src="/blog/image/Snipaste_2025-06-09_14-42-52.png"></p>
</blockquote>
<h2 id="松弛法"><a href="#松弛法" class="headerlink" title="松弛法"></a>松弛法</h2><p><strong>基本迭代公式</strong><br>$$<br>x_i^{(k+1)} &#x3D; \frac{1}{a_{ii}} \left[ b_i - \sum_{j&#x3D;1}^{i-1} a_{ij}x_j^{(k+1)} - \sum_{j&#x3D;i+1}^n a_{ij}x_j^{(k)} \right]<br>$$</p>
<p><strong>残差形式表示</strong></p>
<p>$$<br>&#x3D; x_i^{(k)} + \frac{r_i^{(k+1)}}{a_{ii}}<br>$$</p>
<p>其中残差$r_i^{(k+1)}$定义为：</p>
<p>$$<br>r_i^{(k+1)} &#x3D; b_i - \sum_{j&lt;i} a_{ij}x_j^{(k+1)} - \sum_{j \geq i} a_{ij}x_j^{(k)}<br>$$</p>
<p>令</p>
<p>$$<br>x_i^{(k+1)} &#x3D; x_i^{(k)} + \omega \frac{r_i^{(k+1)}}{a_{ii}}<br>$$</p>
<p>$$<br>&#x3D;x_i^{(k)} + \frac{\omega }{a_{ii}}\left [b_i - \sum_{j&lt;i} a_{ij}x_j^{(k+1)} - \sum_{j \geq i} a_{ij}x_j^{(k)} \right ]<br>$$</p>
<p>选取合适的$\omega$来加速收敛，这就是<u>松弛法</u>。</p>
<ol>
<li><strong>低松弛法</strong> (Under-Relaxation methods)： $0 &lt; \omega &lt; 1$</li>
<li><strong>Gauss-Seidel法</strong>： $\omega &#x3D; 1$</li>
<li><strong>超松弛法</strong> (SOR&#x2F;Successive Over-Relaxation methods)： $\omega &gt; 1$</li>
</ol>
<p><strong>矩阵形式公式</strong></p>
<ol>
<li><strong>基本形式</strong>：</li>
</ol>
<p>$$<br>  \vec{x}^{(k+1)} &#x3D; x_i^{(k)} + \omega \frac{r_i^{(k+1)}}{a_{ii}}<br>  &#x3D; (1 - \omega) \vec{x}^{(k)} + \omega D^{-1} \left[ -L \vec{x}^{(k+1)} - U \vec{x}^{(k)} + \vec{b} \right]<br>$$</p>
<ol start="2">
<li><strong>标准迭代形式</strong>：</li>
</ol>
<p>$$<br>\vec{x}^{(k+1)}<br>&#x3D; (D + \omega L)^{-1} \left[ (1 - \omega) D - \omega U \right] \vec{x}^{(k)} + (D + \omega L)^{-1} \omega \vec{b} \<br>$$</p>
<p>$$<br>H_{\omega}<br>&#x3D;(D + \omega L)^{-1} \left[ (1 - \omega) D - \omega U \right]<br>$$</p>
<p><strong>定理</strong>：设$A$可逆，且$a_{ii} \neq 0$，则松弛法从任意$\vec{x}^{(0)}$出发对某个$\omega$收敛的充要条件为： $\rho(H_\omega) &lt; 1$ 其中<br>$$<br>H_\omega &#x3D; (D + \omega L)^{-1} \left[ (1 - \omega) D - \omega U \right]<br>$$</p>
<p>为迭代矩阵</p>
<hr>
<p><strong>定理</strong>（必要条件）</p>
<p>设$A$可逆，且$a_{ii} \neq 0$，则松弛法从任意$\vec{x}^{(0)}$出发对某个$\omega$收敛$\Rightarrow 0&lt; \omega&lt;2 $</p>
<hr>
<p><strong>定理（Ostrowski-Reich充分条件）</strong></p>
<p><strong>设</strong> $A$ 为对称正定矩阵，且松弛因子满足 $0 &lt; \omega &lt; 2$，<br><strong>则</strong> 松弛法从任意初始向量 $\vec{x}^{(0)}$ 出发均收敛。</p>
<hr>
<p><strong>定理</strong></p>
<p><strong>设</strong> $A$ 为对称正定三对角矩阵，则：</p>
<ol>
<li>谱半径关系：</li>
</ol>
<p>$$<br>\rho(B_{G-S}) &#x3D; [\rho(B_J)]^2 &lt; 1<br>$$</p>
<ol start="2">
<li>SOR最佳松弛因子为</li>
</ol>
<p>$$<br>\omega&#x3D;\frac{2}{1 + \sqrt{1 - [\rho(B_J)]^2}}<br>$$</p>
<ol start="3">
<li>此时收敛速度</li>
</ol>
<p>$$<br>\rho(H_ \omega) &#x3D; \omega - 1<br>$$</p>
<h3 id="例题-4"><a href="#例题-4" class="headerlink" title="例题"></a>例题</h3><blockquote>
<p><img src="/blog/image/Snipaste_2025-06-09_15-03-59.png"></p>
</blockquote>
<blockquote>
<p><img src="/blog/image/Snipaste_2025-06-09_15-14-08.png"></p>
</blockquote>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
  </entry>
  <entry>
    <title>机电一体化分析与建模（1-4章）</title>
    <url>/blog/2025/05/12/%E6%9C%BA%E7%94%B5%E4%B8%80%E4%BD%93%E5%8C%96%E5%88%86%E6%9E%90%E4%B8%8E%E5%BB%BA%E6%A8%A1%EF%BC%88%E4%B8%80%EF%BC%89/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>第二章12 16题<br>第三章3 7 8<br>第四章8 11<br>第五章19<br>第六章9</p>
<h1 id="第一章-绪论"><a href="#第一章-绪论" class="headerlink" title="第一章 绪论"></a>第一章 绪论</h1><ol>
<li><p><strong>机电系统</strong>：是机械电子系统的简称，是由<strong>机械系统</strong>和<strong>电气系统</strong>组成的，其核心是<strong>控制系统。</strong></p>
</li>
<li><p>机电控制系统一般由7个部分组成：</p>
</li>
</ol>
<p><img src="/blog/image/Snipaste_2025-06-28_08-40-57.png"></p>
<p><strong>放大器</strong>：是将比较得出的偏差信号进行放大，用来推动<strong>执行器</strong>去控制被控对象。</p>
<p><strong>被控对象</strong>：是控制系统要操纵的对象。</p>
<p><strong>机电控制系统的执行器</strong>：也称为执行元件或执行装置。</p>
<ol start="3">
<li>根据<strong>使用能量的不同</strong>，可以将<strong>执行装置</strong>大体分为<u>电气式</u>、<u>液压式</u>、<u>气动式</u></li>
</ol>
<p><strong>液压式执行装置</strong>：</p>
<p>a)    优点：液压驱动装置具有<u>重量轻、惯性小、快速性好</u>等优点；</p>
<p>b)   缺点：液压元件<u>易漏油</u>，会<u>污染环境</u>，也有可能<u>引起火灾</u>；液压系统<u>易受环境温度变化的影响</u></p>
<p><strong>气动执行装置：</strong></p>
<p>a)    优点：是<u>动作迅速、反应快、维护简单、成本低</u>，同时由于空气黏度很小，压力损失小，节能高效，适用于<u>远距离输送</u>；<u>工作环境适应性好</u></p>
<p>b)   缺点：由于空气可压缩性较大。负载变化时系统的动作稳定性较差，也不易获得较大输出力或力矩，同时需要对气源中杂质和水分进行处理，排气时噪声较大。</p>
<ol start="4">
<li><p><strong>机电控制系统的基本要求</strong>：<u>稳定性、快速性、准确性</u></p>
<ul>
<li><p><u>稳定性</u>是保证控制系统正常工作的先决条件。</p>
</li>
<li><p>稳定系统：被控量偏离期望值的偏差 <strong>随时间增长逐渐减小或趋于零</strong>，过渡过程的振荡 <strong>逐渐减弱</strong>，最终能达到平衡状态（<span style="color:#FF0000">偏差减小，震荡减弱</span>）</p>
</li>
<li><p>不稳定系统：被控量偏离期望值的偏差 <strong>随时间增长而发散</strong>，过渡过程的振荡 <strong>逐步增强</strong>，导致被控量失控（）</p>
</li>
<li><p><strong>稳态误差</strong>：被控量的<u>稳态值</u>与<u>期望值</u>之间会有误差存在，称之为稳态误差。</p>
</li>
</ul>
</li>
<li><p><strong>机电控制系统控制方式的分类</strong>：一般可以分为<u>开环控制</u>、<u>闭环控制</u>和<u>复合控制</u>。</p>
</li>
<li><p><strong>复合控制方式</strong>：是把<u>偏差控制</u>与按<u>扰动控制</u>结合起来的控制方式</p>
</li>
<li><p><strong>开环控制系统与闭环控制系统不同的地方是</strong>：开环控制系统不需要被控对象的<u>反馈信号</u>，他的控制器直接根据<u>给定信号</u>去控制被控对象工作。</p>
</li>
</ol>
<h1 id="第二章-自动控制系统基本知识"><a href="#第二章-自动控制系统基本知识" class="headerlink" title="第二章 自动控制系统基本知识"></a>第二章 自动控制系统基本知识</h1><ol>
<li><p><strong>控制系统的组成</strong>：由<u>给定单元</u>、<u>控制单元</u>、<u>执行单元</u>、<u>被控对象</u>、<u>测量单元</u>等五大部分组成。</p>
<p><img src="/blog/image/Snipaste_2025-06-28_09-32-30.png"></p>
</li>
<li><p><strong>控制系统的分类：</strong></p>
<ul>
<li>按<strong>系统输入信号</strong>的特点分类：<u>定值控制系统</u>、<u>随动控制系统</u>、<u>程序控制系统</u>。</li>
<li>按<strong>系统信号的传递</strong>特点分类：开环控制系统、闭环控制系统、复合环控制系统。</li>
<li>按<strong>系统的变量</strong>特点分类：连续控制系统、离散控制系统。</li>
</ul>
</li>
<li><p><strong>建立系统数学模型的方法</strong>：</p>
</li>
</ol>
<p>（1）分析计算法（<strong>解析法</strong>）</p>
<p>（2）<strong>实验测定法</strong></p>
<ol start="4">
<li><p><strong>传递函数</strong>定义为：在零初始条件下，线性定常系统的输出量的拉普拉斯变换式与输入量的拉普拉斯变换式之比  </p>
</li>
<li><p><strong>恒值系统与随动系统</strong>：它们的特征方程和通解是相同的，所不同的是它们的边界条件和特解。研究恒值系统和随动系统不仅在方法上基本相同，而且运动方程也很相似。（特解代表系统强制运动，通解代表系统自然运动）</p>
</li>
<li><p><strong>几个典型环节的传递函数</strong></p>
<ul>
<li><p><strong>比例环节</strong></p>
<p><img src="/blog/image/Snipaste_2025-06-28_09-57-05.png"></p>
</li>
<li><p><strong>惯性环节</strong></p>
<p><img src="/blog/image/Snipaste_2025-06-28_10-00-48.png"></p>
</li>
<li><p><strong>积分环节</strong></p>
<p><img src="/blog/image/Snipaste_2025-06-28_10-00-58.png"></p>
<p><img src="/blog/image/Snipaste_2025-06-28_10-01-17.png"></p>
</li>
<li><p><strong>振荡环节</strong></p>
<p><img src="/blog/image/Snipaste_2025-06-28_10-01-10.png"></p>
<p><img src="/blog/image/Snipaste_2025-06-28_10-01-24.png"></p>
<p><img src="/blog/image/Snipaste_2025-06-28_10-01-29.png"></p>
</li>
<li><p><strong>实际微分环节</strong></p>
<p><img src="/blog/image/Snipaste_2025-06-28_10-01-38.png"></p>
<p><img src="/blog/image/Snipaste_2025-06-28_10-01-43.png"></p>
</li>
<li><p><strong>延迟环节</strong></p>
<p><img src="/blog/image/Snipaste_2025-06-28_10-01-50.png"></p>
</li>
</ul>
</li>
</ol>
<p><img src="/blog/image/Snipaste_2025-06-28_10-01-54.png"></p>
<h2 id="控制器的控制规律及响应特性（PID）"><a href="#控制器的控制规律及响应特性（PID）" class="headerlink" title="控制器的控制规律及响应特性（PID）"></a>控制器的控制规律及响应特性（PID）</h2><p><strong>1. 比例控制（P）</strong></p>
<p><u><strong>工作原理</strong></u></p>
<p>控制器输出与输入信号 <strong>成比例关系</strong>，数学表达式：</p>
<p>$$<br>y(t) &#x3D; Kx(t) \quad \text{或} \quad \Delta y &#x3D; K\Delta x<br>$$</p>
<p>（$K$ 为比例放大系数，$\Delta$ 表示信号变化量）</p>
<p><u><strong>特性</strong></u></p>
<ul>
<li><p><strong>余差特性</strong>：过渡过程结束后，被控量的稳定值与给定值存在 <strong>余差</strong>（偏差无法完全消除）。</p>
</li>
<li><p><strong>响应特性</strong>：比例系数 $K$ 越大，响应越快；$K$ 越小，响应越慢</p>
</li>
</ul>
<p><u><strong>性能</strong></u></p>
<ul>
<li><p><strong>优点</strong>：结构简单，响应快速</p>
</li>
<li><p><strong>缺点</strong>：无法消除稳态误差（余差），仅适用于对稳态精度要求不高的场景。</p>
</li>
</ul>
<hr>
<p>   <strong>2. 比例积分控制（PI）</strong></p>
<p><strong>工作原理</strong></p>
<p>   输出为 <strong>比例作用 + 积分作用</strong>，数学表达式：</p>
<p>$$<br>   y(t) &#x3D; K\left[ x(t) + \frac{1}{T_i} \int x(t)dt \right]<br>$$</p>
<p>   （$T_i$ 为积分时间，积分部分累积历史偏差，逐步消除余差）</p>
<p><strong>特性</strong></p>
<ul>
<li><p><strong>余差特性</strong>：积分作用可 <strong>理论上消除余差</strong>（稳态误差为零）。</p>
</li>
<li><p><strong>积分特性</strong>：$T_i$ 越小，积分速度越快、作用越强；但 $T_i$ 过小会导致系统振荡加剧，甚至失稳（积分作用与稳定性存在矛盾）。</p>
</li>
</ul>
<p><strong>性能</strong></p>
<ul>
<li><p><strong>优点</strong>：消除稳态误差，提高控制精度；继承比例控制的快速性。</p>
</li>
<li><p><strong>缺点</strong>：积分作用会降低系统稳定性（需合理设置 $T_i$），过渡过程可能更振荡或变慢。</p>
<hr>
</li>
</ul>
<p>   <strong>3. 比例微分控制（PD）</strong></p>
<p>   <strong>工作原理</strong></p>
<p>   输出为 <strong>比例作用 + 微分作用</strong>，数学表达式：</p>
<p>$$<br>   y(t) &#x3D; K\left[ x(t) + T_d \frac{dx(t)}{dt} \right]<br>$$</p>
<p>   （$T_d$ 为微分时间，微分部分反映信号变化率，实现 “超前控制”）</p>
<p>   <strong>特性</strong></p>
<ul>
<li><p><strong>超前特性</strong>：微分作用可 <strong>预见偏差变化趋势</strong>（如偏差增大时提前抑制），改善动态响应。</p>
</li>
<li><p><strong>微分特性</strong>：$T_d$ 越大，微分作用越强，超调越小；但 $T_d$ 过大易引发被控量剧烈振荡；$T_d$ 过小则控制效果不明显。</p>
</li>
</ul>
<p>   <strong>性能</strong></p>
<ul>
<li><p><strong>优点</strong>：抑制超调，改善动态响应（超前控制）</p>
</li>
<li><p><strong>缺点</strong>：对高频噪声敏感</p>
<hr>
</li>
</ul>
<p>   <strong>4. 比例积分微分控制（PID）</strong></p>
<p>   <strong>工作原理</strong></p>
<p>   输出为 <strong>比例 + 积分 + 微分作用</strong>，数学表达式：</p>
<p>$$<br>   y(t) &#x3D; K\left[ x(t) + \frac{1}{T_i} \int x(t)dt + T_d \frac{dx(t)}{dt} \right]<br>$$</p>
<p>   <strong>特性</strong></p>
<ul>
<li><p><strong>协同特性</strong>：综合三者优势，兼顾 <strong>快速性（P）、稳定性（D）、精度（I）</strong>。</p>
</li>
<li><p><strong>参数特性</strong>：参数整定复杂（需平衡 $K$、$T_i$、$T_d$），但适配范围广（尤其高精度控制）。</p>
</li>
</ul>
<p>   <strong>性能</strong></p>
<ul>
<li><p><strong>优点</strong>：兼具快速响应、消除余差、抑制振荡的能力，适用于<strong>高精度复杂控制</strong>场景</p>
</li>
<li><p><strong>缺点</strong>：参数调试难度大</p>
</li>
</ul>
<ol start="7">
<li><p><strong>控制系统的控制质量指标</strong>：<u>衰减率</u>、<u>余差</u>、<u>最大偏差</u>、<u>过渡过程时间</u></p>
</li>
<li><p>**稳定性：**当自控系统处于平衡状时，由于受到内部或外部的扰动，被调量偏离原有的平衡值，当扰动过后，经过足够的时间，系统仍能够回到原有的平衡工作状态，即被调量回到原有平衡值上，则系统是稳定的，否则，系统是不稳定的</p>
</li>
<li><p><strong>误差</strong>是描述自动控制系统精度的指标，反映了系统在<strong>跟随输入信号</strong>和<strong>抑制干扰信号</strong>整个过程的精度。 所以误差有动态误差和稳态误差两种。</p>
</li>
</ol>
<ul>
<li><p><strong>动态误差</strong>描述系统的误差随时间变化的过程</p>
</li>
<li><p><strong>稳态误差</strong>（也称静态误差或余差）反映动态过程在时间趋于无穷大时，系统到达稳态时的误差</p>
</li>
</ul>
<h1 id="第三章-机电系统中的传感器技术"><a href="#第三章-机电系统中的传感器技术" class="headerlink" title="第三章 机电系统中的传感器技术"></a>第三章 机电系统中的传感器技术</h1><ol>
<li><strong>传感器的组成</strong>：传感器一般由<u>敏感元件</u>、<u>转换元件</u>、<u>基本转换电路</u>三部分组成</li>
</ol>
<p><img src="/blog/image/Snipaste_2025-06-28_14-53-18.png"></p>
<ol start="2">
<li><strong>传感器的分类</strong>：</li>
</ol>
<p>按<strong>输入量</strong>分类：<u>物理量传感器</u>、<u>化学量传感器</u>、<u>生物量传感器</u>三大类；</p>
<p>按<strong>输出信号形式</strong>分类：<u>模拟式</u>、<u>开关式</u>、<u>数字式</u>；</p>
<p>按<strong>转换原理</strong>分类：<u>结构型</u>、<u>物性型</u>、<u>复合型</u>；</p>
<ol start="3">
<li><p><strong>传感器的基本特性</strong>：静态特性、动态特性</p>
<ul>
<li><strong>静态特性</strong>：灵敏度、线性度、迟滞性、重复性、分辨力以及零漂等  </li>
<li><strong>动态特性</strong>：传感器要检测的输入信号是随时间而变化的，传感器的特性应能<strong>跟踪</strong>输入信号的变化，才能获得准确的输出信号</li>
</ul>
</li>
<li><p><strong>电学式压力传感器</strong>：</p>
<ul>
<li><p><strong>电阻应变片式压力传感器</strong> ：靠电阻值来度量压变和压力的，所以必需考虑电阻丝的温度效应</p>
</li>
<li><p><strong>电容式压力传感器</strong>：采用变电容测量原理，将由被测压力引起的<u>弹性元件的位移变形</u>转变为<u>电容的变化</u>，测出电容量便可知道被测压力的大小。<br>$$<br>C &#x3D; \frac{\varepsilon A}{d}<br>$$</p>
</li>
<li><p><strong>压阻式压力传感器</strong>：  压阻式压力传感器是基于半导体材料（单晶硅）的<strong>压阻效应</strong>（<u>固体受力后电阻率发生变化的现象</u>  ）原理制成的传感器  </p>
<p>特点：灵敏度高，频率响应高；测量范围宽；精度高，工作可靠；易于微小型化  </p>
</li>
<li><p><strong>压电式压力传感器</strong>  ：压电传感器主要是利用<strong>压电效应</strong>制造而成的</p>
<p>压电效应 ：某些晶体介质，当沿着一定方向受到机械力作用发生变形时，就产生了<strong>极化效应</strong>，而在其某些表面上会产生电荷；当机械力撤掉之后，又会重新回到不带电的状态，此现象称为“压电效应  “<br>$$<br>p &#x3D; \frac{Q}{kS} \tag{3-4}<br>$$<br>$Q$ 为电荷量，$k$ 为压电常数，$S$ 为作用面积，$p$ 为压力。通过测量电荷量可知被测压力大小。</p>
</li>
<li><p><strong>差动变压器式压力传感器</strong>  :由弹性敏感元件和差动变压器构成的压力传感器。 它的弹性敏感元件作为受力机构，把<strong>被测压力转换成位移</strong>，再用差动变压器把位移转换为与被测压力成一定关系的电信号</p>
</li>
</ul>
</li>
<li><p><strong>位移传感器</strong>：<u>电感式位移传感器</u>、<u>电容式位移传感器</u>、电阻式位移传感器、<u>光栅位移传感器</u>、光电式位移传感器、超声波式位移传感器、霍尔式位移传感器等。  </p>
</li>
<li><p><strong>电感式位移传感器</strong>：</p>
<ul>
<li><p><strong>电涡流式位移传感器</strong>：电涡流式位移传感器是利用<strong>电涡流原理</strong>设计而成的，它可以实现静态和动态地、非接触、高线性度、高分辨率地<strong>测量金属表面与传感器探头之间的距离及其变化</strong>  </p>
</li>
<li><p><strong>差动变压器式位移传感器</strong></p>
<p>差动变压器式位移传感器是利用<strong>线圈的互感作用</strong>将<strong>位移转换成感应电势的变化</strong>。</p>
<ul>
<li><p>传感器主要由线圈、铁心和活动衔铁三个部分组成，如图3.10（a）（b）所示。</p>
</li>
<li><p>线圈包括一个初级线圈和两个反接的次级线圈，当线圈输入交流激励电压时，次级线圈将产生感应电动势$e_1$和$e_2$。由于两个次级线圈极性反接，因此传感器的输出电压为两者之差，即$e_y&#x3D;e_1-e_2$</p>
</li>
<li><p>活动衔铁能改变线圈之间的耦合程度。输出ey的大小随活动衔铁的位置而改变。当活动衔铁的位置居中时，即e1&#x3D;e2，ey&#x3D;0；当活动衔铁向上移时，即e1&gt;e2，ey&gt;0;当活动衔铁向下移时，即e1&lt;e2，ey&lt;0。活动衔铁的位置往复变化，其输出电压也随之变化，输出特性如图3.10（c）所示。</p>
</li>
</ul>
<p><img src="/blog/image/Snipaste_2025-06-23_15-51-57.png"></p>
</li>
</ul>
</li>
<li><p><strong>光栅式位移传感器</strong></p>
<ul>
<li>光栅的特点是<strong>测量精度高</strong>（可达±１μｍ）、<strong>响应速度快</strong>和<strong>量程范围大</strong>等。 用于精密机械的位移测量  </li>
<li>光栅传感器工作的基础是<strong>莫尔条纹</strong>  </li>
<li>光栅传感器可以根据<u>莫尔条纹移动量和移动方</u>向判定<u>光栅的位移量和位移的方向</u></li>
</ul>
</li>
<li><p><strong>速度传感器</strong>：测速发电机、电涡轮式转速传感器  、霍尔转速传感器   、光电式转速传感器  </p>
<ul>
<li>光电法测转速分透射式和反射式两种</li>
</ul>
</li>
<li><p><strong>温度传感器</strong>：热电偶、热敏电阻、热电阻</p>
</li>
<li><p><strong>热电偶冷端补偿</strong>（温度补偿）的3种方法：<u>延长导线法、机械调零法、补偿电桥法</u></p>
<blockquote>
<p><strong>说明热电偶的工作原理。当热端与冷端之间距离较远时，采用什么冷端补偿方式较好？</strong></p>
<p>热电偶的工作原理是<strong>基于物体的热电效应</strong></p>
<p>（即不同导体或半导体材料连接形成回路时，在两个接点处温度不同会产生热电动势，从而测量温度。）</p>
<p><strong>当热端与冷端之间的距离较远时：</strong></p>
<ul>
<li>需要使用<strong>补偿导线</strong>来延长热电偶的冷端，使之远离测量点</li>
<li>注意<strong>导线的型号、极性、以及接点的温度</strong>。</li>
</ul>
</blockquote>
</li>
<li><p><strong>热敏电阻</strong>：一般把金属氧化物陶瓷半导体材料经成形、烧结等工艺制成的测温元件叫做热敏电阻</p>
<ul>
<li><p>热敏电阻是<strong>中低温区</strong>最常用的一种温度检测器  </p>
</li>
<li><p><strong>分类</strong>：</p>
<p><strong>根据温度系数正负</strong>：PTC热敏电阻（电阻温度系数为正）、NTC热敏电阻（电阻温度系数为负）。</p>
<p><strong>NTC</strong>热敏电阻<strong>根据不同的用途</strong>：负指数型NTC（电阻值与温度之间呈负指数关系，用于测量宽度较宽的温度测量）、突变型NTC（当温度上升到某一设定值时，其电阻值突然下降，多作电路保护）</p>
<p><strong>PTC</strong>热敏电阻：突变型PTC（温度范围较窄，一般用于恒温加热控制或温度开关）、线性型PTC（可用于温度补偿或温度测量）。</p>
</li>
</ul>
</li>
<li><p><strong>热电阻</strong>:把金属导体如铜、镍、铂制成的测温电阻称为热电阻。  </p>
<ul>
<li>热电阻是利用物质在温度变化时本身电阻也随着发生变化的特性来测量温度的</li>
</ul>
</li>
<li><p><strong>热电阻传感器的测量电路</strong><br>热电阻传感器的测量电路一般使用电桥电路，由于工业用热电阻安装在生产现场，离控制室较远，因此热电阻的引线对测量结果有较大影响。为此，热电阻内部引线方式有<strong>二线制、三线制和四线制三种</strong>。</p>
</li>
</ol>
<p>​      <img src="/blog/image/IMG_20250328_095737_%E7%9C%8B%E5%9B%BE%E7%8E%8B.jpg"></p>
<blockquote>
<p><strong>两线制</strong></p>
<p><span style="color:#FF0000">电路结构</span></p>
<ul>
<li><p>采用 <strong>电桥电路</strong> 测量热电阻 $  R_t  $：电源 $  E_s  $ 供电，桥臂含固定电阻 $  R_1 \quad R_2  $、可调电阻 $  R_3  $，中间串联微安表 $  \mu A  $ 检测平衡。</p>
</li>
<li><p>热电阻 $  R_t  $ 通过 <strong>两根引线</strong> 接入电桥，引线自身存在电阻 $  r  $（图中虚线框内两侧的 $  r  $），即 <strong>引线电阻会串联在热电阻回路中</strong>。</p>
</li>
</ul>
<p><span style="color:#FF0000">优缺点</span></p>
<ul>
<li>这种引线方式简单、费用低，但是引线电阻以及引线电阻的变化会带来附加误差。</li>
<li>两线制适于引线不长，精度要求较低的场合。</li>
</ul>
</blockquote>
<p><img src="/blog/image/Snipaste_2025-06-29_10-12-28.png"></p>
<blockquote>
<p><strong>三线制</strong></p>
<p>热电阻的一端与一根导线相接，另一端同时接两根导线。</p>
<p><span style="color:#FF0000">工作原理</span></p>
<p>惠斯通电桥</p>
<p><img src="/blog/image/Snipaste_2025-06-29_11-00-42.png"></p>
<p>图中热电阻 $  R_t  $ 的三根导线，粗细相同，长度相等，阻值都是 $  r  $。其中一根串联在电桥的电源上，对电桥的平衡与否毫无影响。另外两根分别串联在电桥的相邻两臂里，使相邻两臂的阻值都增加同样大的阻值 $  r  $。</p>
<p><strong>当电桥平衡时，可写出下列关系，即</strong></p>
<p>$(R_t + r)R_2 &#x3D; (R_3 + r)R_1$</p>
<p>由此可以得出</p>
<p>$R_t &#x3D; \frac{(R_3 + r)R_1 - rR_2}{R_2} &#x3D; \frac{R_3R_1}{R_2} + \frac{R_1r}{R_2} - r$</p>
<p>设计电桥时如满足 $  R_1 &#x3D; R_2  $，则上式等号右边含有 $  r  $ 的两项完全消去，就和 $  r&#x3D;0  $ 的电桥平衡公式完全一样了。这种情况下，导线电阻 $  r  $ 对热电阻的测量毫无影响。但必须注意，只有在左右对称的电桥（即 $  R_1 &#x3D; R_2  $ 的电桥），且只有在平衡状态下才是如此。</p>
<p><img src="/blog/image/IMG_20250328_095926.jpg"></p>
<p><strong>为什么使用三线制？有什么作用？</strong></p>
<p>由于热电阻的电阻值较小，因此在热电阻与测量仪表之间引线过长会引起测量误差。所以此时引线电阻及其随长度和温度的变化就不能忽略不计。<span style="color:#FF0000">为了消除和减小引线电阻对测量精度的影响</span>，通常采用三线制连接法  </p>
<ul>
<li>减少引线电阻误差，提高测量精度</li>
<li>适用于长距离测温</li>
</ul>
</blockquote>
<blockquote>
<p><strong>四线制</strong></p>
<p><span style="color:#FF0000">工作原理</span></p>
<ol>
<li><strong>电流激励回路</strong></li>
</ol>
<ul>
<li>恒流源（如 1mA）通过两根导线向热电阻提供稳定电流 I。</li>
<li>引线电阻（$r_1 \quad r_4$）的压降被恒流源的高输出阻抗克服，不影响电流大小。</li>
</ul>
<ol start="2">
<li><strong>电压测量回路</strong></li>
</ol>
<ul>
<li><p>高阻抗电压表（输入阻抗 &gt;10 MΩ）通过另两根导线直接测量热电阻两端电压 U。</p>
</li>
<li><p>因测量回路电流趋近于零（I≈0），引线电阻（$r_2 \quad r_3$）的压降 IR≈0</p>
<p>故<br>$$<br>R_t&#x3D;\frac{U}{I}<br>$$<br><img src="/blog/image/IMG_20250328_095932.jpg"></p>
<p><strong>为什么使用四线制？有什么作用？</strong></p>
<p><span style="color:#FF0000">为了消除和减小引线电阻对测量精度的影响</span></p>
<ul>
<li>消除引线电阻误差，提高测量精度</li>
<li>适用于长距离与高精度测量</li>
</ul>
</li>
</ul>
</blockquote>
<h1 id="第四章-电路及接口设计"><a href="#第四章-电路及接口设计" class="headerlink" title="第四章 电路及接口设计"></a>第四章 电路及接口设计</h1><h2 id="运算放大器电路设计"><a href="#运算放大器电路设计" class="headerlink" title="运算放大器电路设计"></a>运算放大器电路设计</h2><h3 id="“理想”运算放大器"><a href="#“理想”运算放大器" class="headerlink" title="“理想”运算放大器"></a>“理想”运算放大器</h3><p>运算放大器的<strong>理想化条件</strong>通常有以下几点：</p>
<ol>
<li><p><strong>开环电压放大倍数（$A_{uo} \to \infty$）</strong>：</p>
<ul>
<li><p>理想运算放大器要求它的开环增益（即没有任何反馈的增益）无限大。</p>
<ul>
<li>运算放大器的<strong>开环增益</strong>就是输入信号与输出信号之比，通常是一个非常大的数值，理想情况下无穷大。</li>
</ul>
<p>开环增益的表达式为：<br>$$<br>A_{u_o}&#x3D;\frac{u_0}{u_d}<br>$$</p>
<p>其中：</p>
<ul>
<li><p>$u_d$：输入电压信号（即运算放大器的正输入和负输入之间的电压差）</p>
</li>
<li><p>$u_o$：输出电压信号</p>
<blockquote>
<p><strong>虚短</strong><br>$$<br>u_d&#x3D;\frac {u_0}{A_{u0}}<br>$$<br>由于$A_{U0} \to \infty$且$u_0$为有限值，则$u_d&#x3D;0$<br>$$<br>u_+&#x3D;u_{-}<br>$$</p>
</blockquote>
</li>
</ul>
</li>
<li><p>开环增益越大，意味着即使输入信号很小，输出信号也会被放大得非常明显。</p>
</li>
</ul>
</li>
<li><p><strong>开环输入电阻（$r_{id} \to \infty$）</strong>：</p>
<ul>
<li><p>理想的运算放大器要求其输入电阻无限大。这意味着输入端几乎不消耗电流，所有的输入电流都被输入端的电路系统吸收，不影响放大器的输入信号。</p>
<blockquote>
<p><strong>虚断</strong><br>$$<br>i_+&#x3D;i_{-}&#x3D;0<br>$$</p>
</blockquote>
</li>
<li><p>在实际运算放大器中，输入电阻是非常高的（通常达到几兆欧），但由于技术限制不能无限大。</p>
</li>
</ul>
</li>
<li><p><strong>开环输出电阻（$r_o \to 0$）</strong>：</p>
<ul>
<li>理想化运算放大器的输出电阻要求为零。这意味着理想放大器在输出端没有任何“阻抗”，输出信号不会受到负载影响，也不会因为负载电阻而减少功率。</li>
<li>实际上，运算放大器的输出电阻是有限的（但非常小，通常在几欧姆至几十欧姆之间）。</li>
</ul>
</li>
<li><p><strong>共模抑制比（$K_{CMRR} \to \infty$）</strong>：</p>
<ul>
<li>共模抑制比（CMRR, Common-Mode Rejection Ratio）是一个衡量运算放大器对共模信号（即两输入端同时接收到的相同信号）的抑制能力的参数。理想情况下，运算放大器应该能够完全抑制共模信号，CMRR趋近于无穷大。</li>
<li>实际上，运算放大器对于共模信号的抑制是有限的，但好的运算放大器具有非常高的共模抑制比。</li>
</ul>
</li>
</ol>
<blockquote>
<p>由于实际运算放大器的技术指标接近理想化条件，所以用理想运算放大器分析电路能够简化问题的复杂度</p>
</blockquote>
<h3 id="运算放大器的电压传输特性"><a href="#运算放大器的电压传输特性" class="headerlink" title="运算放大器的电压传输特性"></a>运算放大器的电压传输特性</h3><ul>
<li>设输入电压 $u_d &#x3D; u_+ - u_-$，其中 $u_+$ 和 $u_-$ 分别为运算放大器的两个输入端电压。</li>
<li>输出电压 $u_o$ 和输入 $u_d$ 之间的传输特性曲线如下图所示。</li>
</ul>
<p><img src="/blog/image/Snipaste_2025-05-12_20-44-27.png"></p>
<ul>
<li>近似特性和实际特性分别用不同的曲线表示：<ul>
<li>近似特性：线性区域为主，开始接近饱和时，曲线逐渐饱和。</li>
<li>实际特性：表现出一定的饱和电压，出现非线性区域。</li>
</ul>
</li>
</ul>
<ol>
<li><strong>线性工作区</strong>：<ul>
<li>$|u_d| &lt; U_{ds}$，在此区域，输出电压 $u_o &#x3D; A u_d$，即输出与输入呈线性关系。</li>
</ul>
</li>
<li><strong>正向饱和区</strong>：<ul>
<li>$u_d &gt; U_{ds}$，在此区域，输出电压达到最大饱和值 $u_o &#x3D; U_{sat}$</li>
</ul>
</li>
<li><strong>负向饱和区</strong>：<ul>
<li>$u_d &lt; -U_{ds}$，在此区域，输出电压达到最小饱和值 $u_o &#x3D; - U_{sat}$</li>
</ul>
</li>
</ol>
<blockquote>
<ul>
<li><p><strong>实际表现</strong>：<span style="color:#FF0000">工作在开环状态的运放</span>，任何微小的输入电压差 <code>(u_+ - u_- ≠ 0)</code> 都会使输出瞬间饱和（达到正电源电压 <code>+V_sat</code> 或负电源电压 <code>-V_sat</code>），无法进行线性放大。输出仅有两种状态：<br>$$<br> u_o&#x3D;\begin{cases}+V_\mathrm{sat}&amp;\mathrm{if<del>}u_+&gt;u_-\-V_\mathrm{sat}&amp;\mathrm{if</del>}u_+&lt;u_-&amp;\end{cases}<br>$$</p>
</li>
<li><p><strong>用途</strong>：<span style="color:#FF0000">构成电压比较器。</span></p>
</li>
</ul>
</blockquote>
<h3 id="反向比例器"><a href="#反向比例器" class="headerlink" title="反向比例器"></a>反向比例器</h3><p><strong><span style="color:#FF0000">反相端接输入，同相端接地</span></strong></p>
<p>电路图示意图</p>
<p><img src="/blog/image/1746757641996_%E7%9C%8B%E5%9B%BE%E7%8E%8B.jpg" alt="反向比例器电路图"></p>
<ul>
<li><p><strong>虚短</strong>：$u_+ &#x3D; u_- &#x3D; 0$</p>
</li>
<li><p><strong>电流分析</strong>：</p>
<p>$$<br>i_1 &#x3D; \frac{u_i}{R_1}, \quad i_2 &#x3D; \frac{-u_o}{R_f}<br>$$</p>
</li>
<li><p><strong>虚断</strong>：$i_- &#x3D; 0$, 所以 $i_2 &#x3D; i_1$</p>
</li>
</ul>
<p>因此，</p>
<p>$$<br>u_o &#x3D; -\frac{R_f}{R_1} u_i<br>$$</p>
<p><span style="color:#FF0000">（直接记忆）</span></p>
<ol>
<li><p>当 $R_1$ 和 $R_f$ 确定后，为使 $u_o$ 不超过饱和电压（即保证工作在线性区），对 $u_i$ 有一定限制。<span style="color:#FF0000">（在脉宽调制式功率放大级那块有用到饱和的例子）</span></p>
</li>
<li><p>运放不工作在开环状态（极不稳定，振荡在饱和区），都工作在闭环状态，输出电压由外电路决定。</p>
</li>
</ol>
<h3 id="加法器"><a href="#加法器" class="headerlink" title="加法器"></a>加法器</h3><ul>
<li>电路图示意图</li>
</ul>
<p><img src="/blog/image/1747877382020_%E7%9C%8B%E5%9B%BE%E7%8E%8B.jpg" alt="加法器电路图"></p>
<ul>
<li><strong>电路分析</strong></li>
</ul>
<p><strong>虚短</strong>（$u^- &#x3D; u^+$）<br><strong>虚断</strong>（$i^- &#x3D; 0$）</p>
<p>所以：</p>
<p>$$<br>\frac{u_{i1}}{R_1} + \frac{u_{i2}}{R_2} + \frac{u_{i3}}{R_3} &#x3D; \frac{-u_o}{R_f}<br>$$</p>
<p>进一步解得：</p>
<p>$$<br>u_o &#x3D; - R_f \left( \frac{u_{i1}}{R_1} + \frac{u_{i2}}{R_2} + \frac{u_{i3}}{R_3} \right)<br>$$</p>
<ul>
<li><strong>特殊情况</strong></li>
</ul>
<p>如果：$R_1 &#x3D; R_2 &#x3D; R_3 &#x3D; R_f$，则：</p>
<p>$$<br>u_o &#x3D; - (u_1 + u_2 + u_3)<br>$$</p>
<blockquote>
<p>式中负号说明输出电压和输入电压反相。</p>
</blockquote>
<ul>
<li><strong>比例加法器</strong></li>
</ul>
<p><img src="/blog/image/Snipaste_2025-05-22_09-32-28.png"><br>$$<br>y &#x3D; a_1 x_1 + a_2 x_2 + a_3 x_3<br>$$</p>
<p>符号如右图：</p>
<p>其中：</p>
<ul>
<li>$a_1 &#x3D; \frac{R_f}{R_1}$</li>
<li>$a_2 &#x3D; \frac{R_f}{R_2}$</li>
<li>$a_3 &#x3D; \frac{R_f}{R_3}$</li>
</ul>
<h3 id="减法器-加法器"><a href="#减法器-加法器" class="headerlink" title="减法器&#x2F;加法器"></a>减法器&#x2F;加法器</h3><ul>
<li>电路图示意图</li>
</ul>
<p><img src="/blog/image/Snipaste_2025-05-22_09-39-47.png" alt="减法器电路图"></p>
<ul>
<li>电路分析</li>
</ul>
<p>对节点 1、2 分别列出节点电压方程：（并注意规则 1，$i^+ &#x3D; i^- &#x3D; 0$）</p>
<p>由虚短知：$U_{n1}&#x3D;U_{n2}$</p>
<p>由虚断知：$i_{+}&#x3D;i_{-}$<br>$$<br>\frac{U_{1}-U_{n1}}{R_{1}}&#x3D;\frac{U_{n1}-U_{o}}{R_{2}}<br>$$</p>
<p>$$<br>\frac{U_{2}-U_{n2}}{R_{1}}&#x3D;\frac{U_{n2}}{R_{2}}<br>$$</p>
<p>整理得<br>$$<br>\left( \frac{1}{R_1} + \frac{1}{R_2} \right) u_{n1} - \frac{u_1}{R_1} - \frac{u_0}{R_2} &#x3D; 0 \\<br>\left( \frac{1}{R_1} + \frac{1}{R_2} \right) u_{n2} - \frac{u_2}{R_1} &#x3D; 0<br>$$</p>
<p>得</p>
<p>$$<br>\frac{u_1}{R_1} + \frac{u_0}{R_2} &#x3D; \frac{u_2}{R_1}<br>$$</p>
<p>整理后解得：</p>
<p>$$<br>u_0 &#x3D; \frac{R_2}{R_1} (u_2 - u_1)<br>$$</p>
<blockquote>
<p><img src="/blog/image/Snipaste_2025-07-05_14-44-17.png"></p>
<p><strong>两个要点</strong></p>
<ul>
<li>$\frac{R_f}{R_s}$</li>
<li>同相端电压之和-反相端电压之和</li>
</ul>
</blockquote>
<h3 id="积分器"><a href="#积分器" class="headerlink" title="积分器"></a>积分器</h3><ul>
<li>电路图示意图</li>
</ul>
<p><img src="/blog/image/Snipaste_2025-05-22_09-52-15.png" alt="微分器电路图"></p>
<ul>
<li>电路分析</li>
</ul>
<p>由虚短和虚断知：</p>
<p>$$<br>u^- &#x3D; 0, \quad i^- &#x3D; 0<br>$$</p>
<p>$$<br>\frac {u_i}{R}&#x3D;-C \frac{du_0}{dt}<br>$$</p>
<p>最终可得输出电压表达式：</p>
<p>$$<br>u_0 &#x3D; - \frac {1}{RC }\int u_idt<br>$$</p>
<h3 id="电感-电容的电流与电压关系"><a href="#电感-电容的电流与电压关系" class="headerlink" title="电感&#x2F;电容的电流与电压关系"></a>电感&#x2F;电容的电流与电压关系</h3><blockquote>
<ul>
<li><p>电感<br>$$<br>i(t) &#x3D; \frac{1}{L} \int u(t) dt \<br>u(t)&#x3D;L\frac{di(t)}{dt}<br>$$</p>
</li>
<li><p>电容</p>
</li>
</ul>
<p>$$<br>i(t) &#x3D; C \frac{du(t)}{dt} \<br>u(t) &#x3D; \frac{1}{C} \int i(t) dt<br>$$</p>
</blockquote>
<h3 id="微分器"><a href="#微分器" class="headerlink" title="微分器"></a>微分器</h3><ul>
<li>电路图示意图</li>
</ul>
<p><img src="/blog/image/Snipaste_2025-05-22_10-03-07.png" alt="微分器电路图"></p>
<ul>
<li>电路分析</li>
</ul>
<p>由虚短和虚断知：</p>
<p>$$<br>u^- &#x3D; 0, \quad i^- &#x3D; 0<br>$$</p>
<p>$$<br>C \frac{du_i}{dt} &#x3D; \frac{- u_0}{R}<br>$$</p>
<p>最终可得输出电压表达式：</p>
<p>$$<br>u_0 &#x3D; -RC \frac{du_i}{dt}<br>$$</p>
<h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><p>图所示为两级比例运算放大电路，求 $u_o$ 与 $u_i$ 的关系。</p>
<ul>
<li>电路图示意图</li>
</ul>
<p><img src="/blog/image/Snipaste_2025-05-22_10-07-09.png" alt="两级比例运放电路图"></p>
<p>第一极放大器输出：</p>
<p>$$<br>u_{o1} &#x3D; -\frac{R_f}{R_1} u_i<br>$$</p>
<p>第二极运放输出：</p>
<p>$$<br>u_{o2} &#x3D; -\frac{2R}{R} u_{o1}<br>$$</p>
<p>代入 $u_{o1}$ 得：</p>
<p>$$<br>u_{o2} &#x3D; -2 u_{o1}  &#x3D; \frac{2R_f}{R_1} u_i<br>$$</p>
<p>最终输出：</p>
<p>$$<br>u_o &#x3D; u_{o2} - u_{o1}&#x3D; \frac{3R_f}{R_1} u_i<br>$$</p>
<hr>
<p>如图所示，$A_1$、$A_2$ 为理想运算放大器，参数如电路图所示。<br>输入：$U_{i1} &#x3D; 1.1, \text{V}$，$U_{i2} &#x3D; 1, \text{V}$</p>
<p><strong>试求：</strong> 接入 $U_{i1} &#x3D; 1.1, \text{V}$，$U_{i2} &#x3D; 1, \text{V}$ 后，输出电压 $U_o$ 由 $0, \text{V}$ 上升到 $10, \text{V}$ 所需的时间</p>
<p><strong>电路图</strong></p>
<p><img src="/blog/image/Snipaste_2025-05-22_10-34-00.png" alt="积分电路图"></p>
<p><span style="color:#FF0000">（减法器+积分器）</span></p>
<ul>
<li>电路分析推导：</li>
</ul>
<p>中间运放 $A_1$ ：<br>$$<br>\frac {u_{i1}-u_1}{R_1}&#x3D;\frac {u_1-u_{o1}}{R_f}<br>$$</p>
<p>$$<br>\frac {u_{i2}-u_1}{R_2}&#x3D;\frac {u_1}{R_3}<br>$$</p>
<p>中间运放 $A_2$ ：<br>$$<br>\frac {u_{o1}}{R_4}&#x3D;-C \frac {du_0}{dt}<br>$$</p>
<p>$$<br>U_{o1} &#x3D; \frac{R_3}{R_2 + R_3} \cdot \frac{R_1 + R_f}{R_1} U_{i2} - \frac{R_f}{R_1} U_{i1}&#x3D;0.2 \text{V}<br>$$</p>
<p>$$<br>U_o &#x3D; -\frac{1}{R_4 C} \int_0^t U_{o1} , dt &#x3D; 10t\text{V} \cdot \text{s}^{-1}<br>$$</p>
<p>$$<br>t &#x3D; \frac{U_o}{10, \text{V&#x2F;s}} &#x3D; \frac{10, \text{V}}{10, \text{V&#x2F;s}} &#x3D; 1\text{s}<br>$$</p>
<p><strong>$U_o$ 从 0 V 上升到 10 V 需要 1 秒钟。</strong></p>
<p><strong>电容单位换算规则</strong></p>
<blockquote>
<p>$$<br>1mF &#x3D; 10^{-3}F\<br>$$</p>
<p>$$<br>1 \mu F &#x3D; 10^{-6}F \<br>$$</p>
<p>$$<br>1nF&#x3D; 10^{-9}F \<br>$$</p>
<p>$$<br>1pF &#x3D; 10^{-12}F\<br>$$</p>
</blockquote>
<p><strong>题目描述：</strong></p>
<p>下图所示的电路中，设运算放大器 $A_1$，$D_1$、$D_2$ 均为理想元件，其中 $D_z &#x3D; 5,\text{V}$。  并设电路的初始状态为零。<br>当 $t &#x3D; 0$ 时，开关 $S$ 置于位置“1”；<br>当 $t &#x3D; 2,\text{s}$ 时，突然转换到位置“2”。</p>
<p>试绘出输出电压 $U_o$ 的波形，并求出输出电压过零时间 $t_1$ 和开始限制时间 $t_2$。</p>
<p><strong>电路图</strong></p>
<p><img src="/blog/image/Snipaste_2025-05-22_10-53-31.png" alt="积分电路与开关控制"></p>
<blockquote>
<p>根据电容两端电压判断电流走向</p>
<ul>
<li>0-2-5 S：左零右负，电流向右，D截止</li>
<li>5-7.5 S：左零右正，电流向左，$D_Z$截止，直到反向导通</li>
</ul>
</blockquote>
<ul>
<li>解题过程：</li>
</ul>
<p><strong>1. 阶段一：$0 &lt; t &lt; 2,\text{s}$，开关在位置 “1”</strong></p>
<p>$$<br>U_o &#x3D; -\frac{1}{RC} \int_0^t U_i, dt &#x3D; -3t<br>$$</p>
<p>当 $t &#x3D; 2,\text{s}$ 时：</p>
<p>$$<br>U_o &#x3D; -6\text{V}<br>$$</p>
<p><strong>2. 阶段二：$2,\text{s} &lt; t &lt; t_1$，开关切换到位置 “2”</strong></p>
<p>此时电压源变为 $2,\text{V}$，且考虑初值 $U_o(2) &#x3D; -6,\text{V}$，积分器继续作用：</p>
<p>$$<br>U_o &#x3D; -6-\frac{1}{RC} \int_2^t U_i  dt &#x3D; 2(t - 2) - 6<br>$$</p>
<p>令 $U_o &#x3D; 0$，解得过零时间：</p>
<p>$$<br>t_1 &#x3D; 5\text{s}<br>$$</p>
<p><strong>3. 阶段三：积分到 $U_o &#x3D; 5,\text{V}$（钳位限制）</strong></p>
<p>继续积分：</p>
<p>$$<br>U_o &#x3D; 2(t - 2) - 6 &#x3D; 5<br>$$</p>
<p>解得限制开始时间：</p>
<p>$$<br>t_2 &#x3D; 7.5\text{s}<br>$$</p>
<p>输出电压 $U_o$ 的波形图：</p>
<ul>
<li>$t&#x3D;0$ 到 $2,\text{s}$：$U_o$ 线性下降到 $-6\text{V}$</li>
<li>$t&#x3D;2,\text{s}$ 到 $5,\text{s}$：$U_o$ 上升到 $0\text{V}$</li>
<li>$t&#x3D;5,\text{s}$ 到 $7.5,\text{s}$：$U_o$ 上升到 $5\text{V}$</li>
<li>$t\ge 7.5,\text{s}$：钳位，输出恒定 $5\text{V}$</li>
</ul>
<p><img src="/blog/image/IMG_0117.jpg"></p>
<p>结论：</p>
<ul>
<li><strong>过零时间</strong>：$t_1 &#x3D; 5\text{s}$</li>
<li><strong>开始限制时间</strong>：$t_2 &#x3D; 7.5\text{s}$</li>
</ul>
<p><img src="/blog/image/Snipaste_2025-07-07_08-01-56.png"></p>
<p><img src="/blog/image/Snipaste_2025-07-07_08-51-43.png"></p>
<p><img src="/blog/image/Snipaste_2025-07-07_10-17-13.png"></p>
<p><img src="/blog/image/Snipaste_2025-07-07_10-17-23.png"></p>
<p><img src="/blog/image/Snipaste_2025-07-07_10-17-30.png"></p>
<p><img src="/blog/image/Snipaste_2025-07-07_10-17-36.png"></p>
<p><img src="/blog/image/Snipaste_2025-07-07_10-28-36.png"></p>
<h2 id="比较环节、比例、积分、微分等运放电路"><a href="#比较环节、比例、积分、微分等运放电路" class="headerlink" title="比较环节、比例、积分、微分等运放电路"></a>比较环节、比例、积分、微分等运放电路</h2><p><img src="/blog/image/Snipaste_2025-07-07_11-11-21.png"></p>
<p>根据温度控制实验，试根据运放放大电路构建PI调节方式的温度控制电路，要求包括输入信号与反馈信号的<strong>比较环节控制电路</strong>，偏差信号的<strong>PI调节电路</strong>和<strong>信号增益放大电路</strong>？</p>
<p><img src="/blog/image/%E5%9B%BE%E7%89%871.png"></p>
<p><img src="/blog/image/Snipaste_2025-07-07_11-11-34.png"></p>
<h2 id="高性能放大电路"><a href="#高性能放大电路" class="headerlink" title="高性能放大电路"></a>高性能放大电路</h2><p><img src="/blog/image/1231.jpg"></p>
<p><img src="/blog/image/1233.jpg"></p>
<p><img src="/blog/image/1234.jpg"></p>
<p><img src="/blog/image/1232.jpg"></p>
<h2 id="基本桥路放大器"><a href="#基本桥路放大器" class="headerlink" title="基本桥路放大器"></a>基本桥路放大器</h2><p>图4.14为基本桥路放大器</p>
<ul>
<li>用$R+\Delta R$代表<strong>传感器</strong>，</li>
<li>$R$为规定的参考状态下传感器的阻值，</li>
<li>$\Delta R$为偏离参考状态时传感器阻值的变量。</li>
</ul>
<p><img src="/blog/image/Snipaste_2025-05-23_16-15-41.png"></p>
<h3 id="图4-14a（线性输出）"><a href="#图4-14a（线性输出）" class="headerlink" title="图4.14a（线性输出）"></a>图4.14a（线性输出）</h3><p>观察到<br>$$<br>u_+&#x3D;\frac{R}{R+R}U_R&#x3D;u_-<br>$$</p>
<div>

<p>$$<br>\frac{U_R-U_R&#x2F;2}{R}&#x3D; \frac{U_R&#x2F;2-U_0}{R+\Delta R}  \<br>U_o &#x3D; -\frac{\Delta R}{2R} U_R<br>$$</p>
</div>



<h3 id="图4-14b（非线性输出）"><a href="#图4-14b（非线性输出）" class="headerlink" title="图4.14b（非线性输出）"></a>图4.14b（非线性输出）</h3><div>

<p>$$<br>u_+&#x3D;\frac{R+\Delta R}{2R}U_R&#x3D;u_- \<br>U_R-\frac{R+\Delta R}{2R}U_R&#x3D;\frac{R+\Delta R}{2R}U_R-U_0  \<br>U_o &#x3D;  \frac{\Delta R}{2R + \Delta R}U_R<br>$$</p>
</div>



<h3 id="两种电路结构对比"><a href="#两种电路结构对比" class="headerlink" title="两种电路结构对比"></a>两种电路结构对比</h3><table>
<thead>
<tr>
<th><strong>特征</strong></th>
<th><strong>图4.14a（传感器置于反馈支路）</strong></th>
<th><strong>图4.14b（传感器接地）</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>电路结构</strong></td>
<td>传感器作为反馈电阻</td>
<td>传感器接地，与固定电阻组成分压电路</td>
</tr>
<tr>
<td><strong>输出电压公式</strong></td>
<td>$U_o &#x3D; -\frac{\Delta R}{2R} U_R$</td>
<td>$ U_o &#x3D; U_R \cdot \frac{\Delta R}{2R + \Delta R} $</td>
</tr>
<tr>
<td><strong>线性性</strong></td>
<td>随传感器电阻的增加，输出电压减小；$R$ 与 $U_o$ 成线性关系</td>
<td>非线性关系</td>
</tr>
</tbody></table>
<h3 id="关键设计优化"><a href="#关键设计优化" class="headerlink" title="关键设计优化"></a>关键设计优化</h3><p>运放负载能力保护（针对图4.14a）</p>
<ol>
<li><strong>问题</strong>：</li>
</ol>
<p>由于传感器的电流由参考电压$U_R$供给，因此图（ａ）电路流经传感器的电流受运放负载能力的限制，<span style="color:#FF0000">反馈电流 $I &#x3D; \frac{U_R&#x2F;2}{R}$ 可能超过运放最大输出电流 $I_{\text{max}}$。</span></p>
<p><strong>而图(ｂ）电路则不受此限制</strong>  </p>
<p><strong>解决方案</strong>：将反相输入端两臂电阻 $R$ 同时增大 $m$ 倍（即 $R \rightarrow mR$）：</p>
<ul>
<li>调整后电流：$I’ &#x3D; \frac{U_R&#x2F;2}{mR}$</li>
</ul>
<h2 id="三端固定式集成稳压电源"><a href="#三端固定式集成稳压电源" class="headerlink" title="三端固定式集成稳压电源"></a>三端固定式集成稳压电源</h2><h3 id="集成稳压电源的性能指标"><a href="#集成稳压电源的性能指标" class="headerlink" title="集成稳压电源的性能指标"></a>集成稳压电源的性能指标</h3><ul>
<li><p>最大输出电流</p>
</li>
<li><p>输出电压</p>
</li>
<li><p>纹波电压</p>
</li>
<li><p>稳压系数</p>
</li>
<li><p>输出电阻</p>
</li>
</ul>
<p><strong>三端固定式稳压集成电源的产品分类</strong></p>
<ul>
<li><p><strong>CW7800系列</strong>：输出电压为<strong>正极性</strong></p>
</li>
<li><p><strong>CW7900系列</strong>：输出电压为<strong>负极性</strong></p>
</li>
<li><p><strong>输出共 7 个档次电压</strong>：</p>
</li>
</ul>
<p>$$<br>5\text{V},\ 6\text{V},\ 9\text{V},\ 12\text{V},\ 15\text{V},\ 18\text{V},\ 24\text{V}<br>$$</p>
<ul>
<li><strong>输出电流分为 3 个档次</strong>：</li>
</ul>
<p>$$<br>\text{H}:\ 1.5\text{A},\quad \text{L}:\ 0.1\text{A},\quad \text{M}:\ 0.5\text{A}<br>$$</p>
<hr>
<ul>
<li><p><strong>LM78L05</strong>：输出电压 $+5\text{V}$，最大输出电流 $0.1\text{A}$</p>
</li>
<li><p><strong>CW7915</strong>：输出电压 $-15\text{V}$，最大输出电流 $1.5\text{A}$</p>
</li>
</ul>
<h3 id="两种稳压电源的典型应用电路"><a href="#两种稳压电源的典型应用电路" class="headerlink" title="两种稳压电源的典型应用电路"></a>两种稳压电源的典型应用电路</h3><p><img src="/blog/image/1748049757448.jpg"></p>
<ul>
<li><p>其中输入端电容$ C_i$用以<strong>旁路高频干扰脉冲及改善纹波</strong>。</p>
</li>
<li><p>输出端所接电容$C_0$起<strong>改善瞬态响应特性、减小高频输出阻抗</strong>的作用。</p>
</li>
<li><p>一般在输出端无需接入大电解电容器。</p>
</li>
</ul>
<blockquote>
<p><strong>78XX:1入，2出，3地</strong></p>
<p><strong>79XX:1地，2出，3入</strong></p>
<p>（两者都按照电平从高到低排列的）</p>
</blockquote>
<h2 id="集成稳压器"><a href="#集成稳压器" class="headerlink" title="集成稳压器"></a>集成稳压器</h2><p>图 4.19 所示为集成稳压器的实际应用电路。</p>
<ul>
<li>该电路使用 CW78XX 系列三端稳压器，将市电交流电压变换为稳定的直流输出，常用于嵌入式系统、小型电子设备供电。</li>
</ul>
<p><img src="/blog/image/Snipaste_2025-05-24_10-09-19.png"></p>
<p><strong>电路结构说明</strong></p>
<ul>
<li><strong>T</strong>：变压器，将 220V 交流电降压；</li>
<li><strong>整流桥</strong>：由四个二极管组成的桥式整流器，将交流电转换为脉动直流；</li>
<li><strong>C</strong>：滤波电容，作用是平滑整流输出的电压；</li>
<li><strong>$C_i$</strong>：输入旁路电容，减少输入纹波；</li>
<li><strong>CW78XX</strong>：三端固定输出电压的集成稳压器，如 7805、7812 等；</li>
<li><strong>$C_o$</strong>：输出端电容，用于改善负载瞬变响应；</li>
<li><strong>$R_3$</strong>：负载电阻，模拟实际用电器负载。</li>
</ul>
<hr>
<p><strong>稳压器正常工作时的输入电压范围</strong></p>
<p>为了确保稳压器输出稳定电压，其输入电压 $U_i$ 必须满足以下范围：</p>
<span>
$$
U_{omax} + (U_i - U_o) _{min} \leq U_i \leq U_{omin} + (U_i - U_o) _{max}
$$

</span>

<p>其中：</p>
<ul>
<li>$U_{omax}$：最大输出电压；</li>
<li>$U_{omin}$：最小输出电压；</li>
<li>$(U_i - U_o)_{min}$：最小输入输出电压差，一般为 2V 左右；</li>
<li>$(U_i - U_o)_{max}$：最大允许输入输出压差，通常由功耗决定。</li>
</ul>
<p><strong>说明</strong>：</p>
<ul>
<li>若 $U_i$ 过低，会导致输出掉压；</li>
<li>若 $U_i$ 过高，会造成稳压器功耗增加，可能烧毁芯片。</li>
</ul>
<hr>
<p><strong>最大输出电流限制</strong></p>
<p>稳压器内部设有限流保护，输出电流需满足：</p>
<p>$$<br>I_{cm} &lt; I_{omax}<br>$$</p>
<p>其中：</p>
<ul>
<li>$I_{cm}$：负载实际工作电流；</li>
<li>$I_{omax}$：稳压器规格书规定的最大输出电流，通常为 1A 或 1.5A。</li>
</ul>
<h2 id="改变输出电压极性的应用"><a href="#改变输出电压极性的应用" class="headerlink" title="改变输出电压极性的应用"></a>改变输出电压极性的应用</h2><p><img src="/blog/image/Snipaste_2025-07-05_19-40-40.png"></p>
<ul>
<li>7800：将输出端接地，接地端电位下降为<strong>负电平</strong>，成为<strong>负电压输出端</strong></li>
<li>7900：将输出端接地，接地端电位上升为<strong>正电平</strong>，成为<strong>正电压输出端</strong></li>
</ul>
<h2 id="输出电压连续可调的应用"><a href="#输出电压连续可调的应用" class="headerlink" title="输出电压连续可调的应用"></a>输出电压连续可调的应用</h2><p><img src="/blog/image/Snipaste_2025-07-05_20-45-47.png"></p>
<p><strong>图 4.21(a)：正极性连续可调电源（CW7805）</strong></p>
<ul>
<li>使用 CW7805 提供 5V 稳压基准；</li>
<li>通过电位器 $R_w$ 调节其地引脚的等效参考电位；</li>
<li>输出电压范围为：<strong>5V ~15V 连续可调</strong>；</li>
<li>输出电流为 <strong>1A</strong>；</li>
<li>输出电压计算公式为：</li>
</ul>
<p>$$<br>U_o &#x3D; U_{xx} + \left( \frac{U_{xx}}{R} + I_d \right) R_w<br>$$</p>
<p>其中：</p>
<ul>
<li>$U_{xx}$：稳压器自身的输出参考电压（如 5V）；</li>
<li>$I_d$：调整电流；</li>
<li>$R_w$ 增大时，$U_o$ 上升。</li>
</ul>
<hr>
<p><strong>图 4.21(b)：负极性连续可调电源（CW7800）</strong></p>
<p><img src="/blog/image/Snipaste_2025-07-05_20-45-57.png"></p>
<ul>
<li>输入端加入额外负电源</li>
<li>通过 2DW7 稳压管（6.2V）和电阻 $R_3$，提供负电压基准约 $-6\text{V}$；</li>
<li>稳压器地端参考点下移，<strong>实现输出电压从 0V ~15V连续可调</strong>；</li>
<li>若 $R_w &#x3D; 0$，则：</li>
</ul>
<p>$$<br>U_o &#x3D; U_{xx} - 6 &#x3D; -1\text{V}<br>$$</p>
<blockquote>
<ul>
<li>图 4.21(a) 的最低输出电压为 $5\text{V}$；</li>
<li>图 4.21(b) 可通过下移 GND 实现从 $0\text{V}$ 起调；</li>
</ul>
</blockquote>
<h2 id="三极管基础知识"><a href="#三极管基础知识" class="headerlink" title="三极管基础知识"></a>三极管基础知识</h2><p><img src="/blog/image/Snipaste_2025-05-24_16-04-32.png"></p>
<blockquote>
<p>电路符号中其<strong>发射极箭头方向</strong>就是该类型管子<strong>发射极正向电流的方向</strong></p>
</blockquote>
<p><strong>三极管工作在放大状态的条件</strong></p>
<p>三极管放大状态时的外部条件如图所示  </p>
<p><img src="/blog/image/Snipaste_2025-05-24_16-13-40.png"></p>
<p><strong>电流关系</strong></p>
<p>无论是 NPN 型还是PNP 型三极管都满足发射极电流等于基极电流与集电极电流之和<br>$$<br>I_E&#x3D;I_B+I_C<br>$$<br><strong>三极管各电极的电流方向</strong>  </p>
<p><img src="/blog/image/Snipaste_2025-05-24_16-20-37.png"></p>
<blockquote>
<p>如果将三极管看成节点, 三极管各电极间的电流关系应满足节点电流定律: <strong>流入三极管的电流之和等于流出三极管的电流之和</strong>  </p>
</blockquote>
<p>基极电流变化引起集电极电流变化, 但集电极与基极电流之比保持不变<br>$$<br>\beta&#x3D;\frac{I_C}{I_B}<br>$$</p>
<h2 id="扩展输出电流电路"><a href="#扩展输出电流电路" class="headerlink" title="扩展输出电流电路"></a>扩展输出电流电路</h2><p>当所需输出电流超过 $1.5,\text{A}$ 时，可采用外接功率管的办法来扩展电流。CW7800 系列稳压块的外接扩流功率管<strong>只能采用 PNP 型管</strong>。</p>
<p><img src="/blog/image/IMG_0128.jpg"></p>
<p>电阻 $R$ 的阻值由外接功率管的 $U_{BE}$ 值和集成稳压块的输出电流 $I_{REG}$ 来决定，其表达式为：</p>
<p>$$<br>R &#x3D; \frac{U_{BE}}{I_{REG} - \frac{1}{\beta} I_T}<br>$$</p>
<p>其中：</p>
<ul>
<li>$I_{REG}$ 为流入集成稳压块的电流；</li>
<li>$I_T$ 为流过外接功率管 VT 的<strong>集电极电流</strong>；</li>
<li>$U_{BE}$ 为功率管的基极-发射极电压：<ul>
<li>对于锗管取 $0.3,\text{V}$；</li>
<li>对于硅管取 $0.7,\text{V}$；</li>
</ul>
</li>
<li>$\beta$ 为三极管的电流放大倍数</li>
<li>基极电流为 $I_b &#x3D; \dfrac{I_T}{\beta}$；</li>
<li>$R$ 处的压降为 $U_{BE}$，用来判断何时功率管导通。</li>
</ul>
<p><strong>在使用三端固定式集成稳压块时应注意以下问题</strong>  </p>
<ul>
<li><strong>使用固定式三端集成稳压器时，管脚不能接错，公共端不得悬空。</strong></li>
<li>当稳压器输出端使用大电容，且输出电压高于 ６Ｖ 时，应在<strong>输入、输出端跨接保护二极管</strong>，以防输入端短路时，输出电容通过稳压器进行放电使稳压器损坏。</li>
<li>目前三端式大功率稳压器一般采用塑封和金属封装。 <strong>加散热器时耗散功率可达７.５～1５Ｗ 。</strong></li>
<li>一般固定式集成稳压器的最大输入电压在 ３５～４０Ｖ 。 在使用时，<strong>整流电路输出电压的峰值不得超过此值。</strong></li>
</ul>
<h2 id="可调式集成稳压电源设计"><a href="#可调式集成稳压电源设计" class="headerlink" title="可调式集成稳压电源设计"></a>可调式集成稳压电源设计</h2><ul>
<li>３１７ 系列稳压器输出连续可调的正电压，３３７ 系列稳压器输出连续可调的负电压，可调范围为 １.２～３７Ｖ ，最大输出电流$I_{o \max}&#x3D;1.5A$。</li>
<li>稳压器内部含有过流、过热保护电路，具有安全可靠、性能优良、不易损坏、使用方便等优点。</li>
<li>其电压调整率和电流调整率均优于用固定式集成稳压块构成的可调电压稳压电源</li>
</ul>
<p><img src="/blog/image/Snipaste_2025-07-06_08-36-02.png"><br>$$<br>U\text{。}&#x3D;\quad1.:25\Bigg[\begin{array}{cc}1+&amp;\frac{R_{\text{P}_1}}{R_1}\Bigg]\end{array}<br>$$</p>
<ul>
<li>1.25 是集成稳压块输出端与调整端之间的固有参考电压$U_{REF}$ ,此电压加于给定电阻$R_ 1$ 两端，将产生一个恒定电流通过输出电压调节电位器$R_\mathrm{Pl}$。</li>
<li>电阻$R_1$常取值 120~ 240 ,$R_{P1}$一般使用精密电位器，</li>
<li>与$R_{P1}$并联的电容器$C_2$可进一步减小输出电压的纹波。</li>
<li>二极管 VD 的作用是防止输出端与地短路时$C_{2}$ 上的电压损坏稳压块。</li>
</ul>
<h2 id="稳压二极管"><a href="#稳压二极管" class="headerlink" title="稳压二极管"></a>稳压二极管</h2><p><img src="/blog/image/Snipaste_2025-05-25_09-51-04.png"></p>
<p><strong>导通电压</strong>是稳压二极管在正向偏置下的阈值电压，即当正极电压高于负极（$V_P&gt;V_N$）时，二极管开始导通所需的最小电压。</p>
<ul>
<li>例如，硅材料稳压管的导通电压约为 <strong>0.7V</strong>，锗材料约为 <strong>0.3V</strong></li>
</ul>
<p><strong>稳压值</strong>（$V_Z$）是稳压二极管在反向击穿时维持的稳定电压，由PN结的掺杂浓度和结构设计决定。当反向电压达到 $V_Z$时，稳压管进入击穿区，电流大幅增加但电压基本恒定</p>
<p><strong>导通电压与稳压值的对比与联系</strong></p>
<table>
<thead>
<tr>
<th><strong>参数</strong></th>
<th><strong>导通电压（ $V_F$ ）</strong></th>
<th><strong>稳压值（$V_Z$ ）</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>工作状态</strong></td>
<td>正向偏置（$V_P &gt; V_N $）</td>
<td>反向偏置（$V_P &lt; V_N $）</td>
</tr>
<tr>
<td><strong>典型值</strong></td>
<td>硅管0.7V，锗管0.3V</td>
<td>2V~200V（如5.1V、12V、24V等）</td>
</tr>
<tr>
<td><strong>核心功能</strong></td>
<td>不用于稳压，仅作为普通二极管导通</td>
<td>稳定电压，用于电源、保护、限幅等</td>
</tr>
<tr>
<td><strong>设计目标</strong></td>
<td>正向导通时尽量降低压降</td>
<td>反向击穿时维持电压稳定</td>
</tr>
</tbody></table>
<p><img src="/blog/image/100873.jpg"></p>
<p><img src="/blog/image/1747964224927.jpg"></p>
<p><strong>例题</strong></p>
<p><img src="/blog/image/1748049757394_%E7%9C%8B%E5%9B%BE%E7%8E%8B.jpg"></p>
<div>


<p>$$<br>I_2&#x3D;I_1+I_d \<br>I_1&#x3D;\frac {5}{R_1} \<br>6.2&#x3D;5+I_2R_2 \<br>$$</p>
</div>

<p>得到$R_1$和$R_2$有个比例关系，这时取定一个值确定另一个即可</p>
<h2 id="电压比较器"><a href="#电压比较器" class="headerlink" title="电压比较器"></a>电压比较器</h2><p>电压比较器通常用来判断输入信号的相对大小，对信号幅度进行控制或根据输入信号的幅度决定输出信号的极性。 </p>
<ul>
<li>常用的电压比较器有三种：<strong>过零比较器</strong>、<strong>单限比较器</strong>和<strong>迟滞比较器</strong>（滞回比较器）。</li>
</ul>
<h3 id="过零比较器"><a href="#过零比较器" class="headerlink" title="过零比较器"></a>过零比较器</h3><p><span style="color:#FF0000">输入 接在反相端</span></p>
<p><img src="/blog/image/Snipaste_2025-05-26_09-34-00.png"></p>
<p>图4.24(a)所示电路是一个电压比较器，运放在该电路中处于<strong>开环状态</strong>工作。其基本组成包括：</p>
<ul>
<li><strong>$U_i$</strong>：输入电压信号；</li>
<li><strong>$U_R$</strong>：参考电压。</li>
</ul>
<p>根据理想运放的特性，输出电压$U_o$的状态取决于$U_i$与$U_R$的比较结果：</p>
<ul>
<li>当 $U_i &lt; U_R$ 时，输出电压为：<br>$$<br>U_o &#x3D; +U_{om}<br>$$</li>
<li>当 $U_i &gt; U_R$ 时，输出电压为：<br>$$<br>U_o &#x3D; -U_{om}<br>$$</li>
</ul>
<p>因此，可以通过输出电压$U_o$的<strong>极性</strong>判断输入电压$U_i$是否<strong>大于或小于参考电压$U_R$</strong>。</p>
<hr>
<p><strong>过零比较器</strong></p>
<p>若将图4.24(a)中的同相端接地，即 $U_R &#x3D; 0$，则比较器成为<strong>过零比较器</strong>。</p>
<ul>
<li>输入信号 $U_i$ 从负值增加至正值时，在<strong>过零点</strong>，输出电压$U_o$发生<strong>极性变化</strong>，从 $+U_{om}$ 跳变到 $-U_{om}$。</li>
<li>图4.24(b) 展示了输入 $U_i$ 与输出 $U_o$ 的关系曲线，即<strong>输入-输出特性曲线</strong>，呈现明显的跳变特性。</li>
</ul>
<hr>
<p><strong>输出特性分析</strong></p>
<ul>
<li><p>$U_i$作用在同相端，反相输入端接地。其输出特性为：<br>$$<br>U_o &#x3D;<br>\begin{cases}<br>-U_{om}, &amp; U_i &lt; 0 \<br>+U_{om}, &amp; U_i &gt; 0<br>\end{cases}<br>$$<br>这种特性称为<strong>上行特性</strong>。</p>
</li>
<li><p>若反过来，则特性变为：<br>$$<br>U_o &#x3D;<br>\begin{cases}<br>+U_{om}, &amp; U_i &lt; 0 \<br>-U_{om}, &amp; U_i &gt; 0<br>\end{cases}<br>$$<br>此为<strong>下行特性</strong>。(上面图示)</p>
</li>
</ul>
<hr>
<h3 id="单限电压比较器"><a href="#单限电压比较器" class="headerlink" title="单限电压比较器"></a>单限电压比较器</h3><p>参考电压 $U_R \neq 0$ 的比较器称为单限电压比较器  </p>
<p><img src="/blog/image/Snipaste_2025-05-26_09-47-25.png"></p>
<h3 id="迟滞比较器（下行）"><a href="#迟滞比较器（下行）" class="headerlink" title="迟滞比较器（下行）"></a>迟滞比较器（下行）</h3><p>若在过零比较器或单限比较器电路中引入<strong>正反馈</strong>，比较器的输入-输出特性曲线便呈现<strong>迟滞回线形状</strong>，这类比较器称为<strong>迟滞比较器</strong>或<strong>滞回比较器</strong></p>
<blockquote>
<p>图中的$U_R$应该为$U_i$</p>
</blockquote>
<p><img src="/blog/image/Snipaste_2025-05-26_10-00-54.png"></p>
<p>如图4.26(a)，通过电阻 $R_f$ 和 $R_F$ 构成正反馈通路，反馈信号作用于运放的<strong>同相端</strong>。反馈电压$U_f$由输出电压$U_o$分压得到：</p>
<p>$$<br>U_f &#x3D; \frac{R_f}{R_f + R_F} U_o \tag{4-27}<br>$$</p>
<p>此时有：</p>
<p>$$<br>V^+ &#x3D; U_f &#x3D; \frac{R_f}{R_f + R_F} U_o<br>$$</p>
<hr>
<p><strong>迟滞现象分析</strong></p>
<p>若当前输出电压为 $U_o &#x3D; +U_{om}$，要使其从正饱和值变为负饱和值（$-U_{om}$），则反相端电压必须<strong>高于</strong>正相端参考电压 $V^+$，即：</p>
<p>$$<br>U_i &gt; V^+ &#x3D; \frac{R_f}{R_f + R_F} U_{om}<br>$$</p>
<p>因此，称该电压为<strong>上阈值电压（Upper Threshold Voltage）</strong>，记作 $U_{TH1}$：</p>
<p>$$<br>U_{TH1} &#x3D; \frac{R_f}{R_f + R_F} U_{om} \tag{4-28}<br>$$</p>
<p>反之，若当前输出电压为 $U_o &#x3D; -U_{om}$，要使其由负变正，则反相端输入 $U_i$ 必须<strong>低于</strong>下列阈值：</p>
<p>$$<br>U_i &lt; V^+ &#x3D; \frac{R_f}{R_f + R_F} (-U_{om})<br>$$</p>
<p>即定义为<strong>下阈值电压（Lower Threshold Voltage）</strong>，记作 $U_{TH2}$：</p>
<p>$$<br>U_{TH2} &#x3D; \frac{R_f}{R_f + R_F} (-U_{om}) \tag{4-29}<br>$$</p>
<hr>
<p><strong>特性曲线说明（图4.26(b)）</strong></p>
<p>在图4.26(b)中，输出电压$U_o$与输入电压$U_i$的关系曲线呈<strong>迟滞回线</strong>特征，表现为：</p>
<ul>
<li>当 $U_i$ 从低变高并超过 $U_{TH1}$ 时，输出电压从 $+U_{om}$ 跳变到 $-U_{om}$；</li>
<li>当 $U_i$ 从高变低并低于 $U_{TH2}$ 时，输出电压从 $-U_{om}$ 跳变到 $+U_{om}$；</li>
</ul>
<h3 id="迟滞比较器（接入参考电压-U-R-）（下行）"><a href="#迟滞比较器（接入参考电压-U-R-）（下行）" class="headerlink" title="迟滞比较器（接入参考电压$U_R$）（下行）"></a>迟滞比较器（接入参考电压$U_R$）（下行）</h3><p>相比基本迟滞比较器，<strong>将反馈电阻$R_f$通过电源$E_R$接地</strong>。此改动使得输入-输出特性曲线在<strong>水平方向（$U_i$轴）上偏移</strong>，即阈值电压位置发生了改变。该电路依然属于迟滞比较器，但其阈值不再关于零对称。</p>
<p><img src="/blog/image/Snipaste_2025-05-26_10-16-55.png"></p>
<p><strong>电压偏移分析</strong></p>
<p>当电源 $E_R$ 单独作用于运放的同相输入端（$+$端）时，产生的偏置电压为：</p>
<p>$$<br>V^{\prime} &#x3D; \frac{R_F}{R_f + R_F} E_R<br>$$</p>
<p>当输出电压 $U_o$单独作用时</p>
<p>$$<br>V^{\prime\prime} &#x3D; \frac{R_f}{R_f + R_F} U_o<br>$$</p>
<p>因此，同相端最终的电位为：</p>
<p>$$<br>V_+ &#x3D; V^{\prime} + V^{\prime\prime} &#x3D; \frac{R_f}{R_f + R_F} U_o + \frac{R_F}{R_f + R_F} E_R \tag{4-30}<br>$$</p>
<hr>
<p><strong>上阈值电压推导</strong></p>
<p>当 $U_o &#x3D; +U_{om}$ 时，要使输出电压翻转为 $-U_{om}$，输入电压 $U_i$ 必须高于 $V_+$，因此有：</p>
<p>$$<br>U_i &gt; U_{TH1} &#x3D; \frac{R_f}{R_f + R_F} U_{om} + \frac{R_F}{R_f + R_F} E_R \tag{4-31}<br>$$</p>
<p><strong>下阈值电压推导</strong></p>
<p>当 $U_o &#x3D; -U_{om}$ 时，要使输出跳变为正值 $+U_{om}$，此时$U_i$应满足：</p>
<p>$$<br>U_i &lt;U_{TH2} &#x3D; \frac{R_F}{R_f + R_F} E_R + \frac{R_f}{R_f + R_F} (-U_{om})<br>$$</p>
<hr>
<p><strong>特性曲线分析</strong></p>
<ul>
<li>输出翻转点分别为 $U_{TH1}$ 和 $U_{TH2}$，其中 $U_{TH1} &gt; U_{TH2}$。</li>
</ul>
<h3 id="迟滞比较器（接入参考电压-U-R-）（上行）"><a href="#迟滞比较器（接入参考电压-U-R-）（上行）" class="headerlink" title="迟滞比较器（接入参考电压$U_R$）（上行）"></a>迟滞比较器（接入参考电压$U_R$）（上行）</h3><p><img src="/blog/image/Snipaste_2025-05-26_10-23-47.png"></p>
<p>输入信号 $U_i$ 施加于运放的<strong>同相端</strong>，而反相端接参考电压 $E_R$，构成具有<strong>上行特性</strong>的迟滞比较器。</p>
<p><strong>电压分析与偏置电位计算</strong></p>
<p>在该结构中</p>
<ul>
<li><p>反相端的电位为 $V_- &#x3D; E_R$</p>
</li>
<li><p>同相端电位 $V_+$ 可通过叠加法求得：</p>
</li>
</ul>
<p>$$<br>V_+ &#x3D; \frac{R_F}{R_f + R_F} U_i + \frac{R_f}{R_f + R_F} U_o<br>$$</p>
<blockquote>
<ul>
<li><p>当 $V_+ &gt; V_-$ 时，输出电压 $U_o &#x3D; +U_{om}$；</p>
</li>
<li><p>当 $V_+ &lt; V_-$ 时，输出电压 $U_o &#x3D; -U_{om}$。</p>
</li>
</ul>
</blockquote>
<ol>
<li>当 $U_o &#x3D; -U_{om}$ 时，要使其变为 $+U_{om}$，必须使 $V_+ &gt; V_-$，即：</li>
</ol>
<p>$$<br>\frac{R_F}{R_f + R_F} U_i + \frac{R_f}{R_f + R_F} (-U_{om}) &gt; E_R \tag{4-33}<br>$$</p>
<p>由此推出</p>
<p>$$<br>U_i &gt; \frac{R_f + R_F}{R_F} E_R + \frac{R_f}{R_F} U_{om} \tag{4-34}<br>$$</p>
<p>才能使输出从 $-U_{om}$ 跳变至 $+U_{om}$。这一定义为<strong>上阈值电压</strong> $U_{TH1}$。</p>
<p><strong>上阈值电压公式</strong><br>$$<br>U_{TH1} &#x3D; \frac{R_f + R_F}{R_F} E_R + \frac{R_f}{R_F} U_{om}<br>$$</p>
<ol start="2">
<li>当 $U_o &#x3D; +U_{om}$，要使其变为 $-U_{om}$，则必须使 $V_+ &lt; V _-$，即：</li>
</ol>
<p>$$<br>\frac{R_F}{R_f + R_F} U_i + \frac{R_f}{R_f + R_F} U_{om} &lt; E_R \tag{4-35}<br>$$</p>
<p>由此得出，输入信号需满足：</p>
<p>$$<br>U_i &lt; \frac{R_f + R_F}{R_F} E_R - \frac{R_f}{R_F} U_{om} \tag{4-36}<br>$$</p>
<p>该值定义为<strong>下阈值电压</strong> $U_{TH2}$。<br>$$<br>U_{TH2}&#x3D;\frac{R_f + R_F}{R_F} E_R - \frac{R_f}{R_F} U_{om} \tag{4-36}<br>$$</p>
<hr>
<p><strong>特性曲线分析（图4.28(b)）</strong></p>
<ul>
<li>当 $U_i$ 增大并超过 $U_{TH1}$ 时，输出由 $-U_{om}$ 跳变至 $+U_{om}$；</li>
<li>当 $U_i$ 减小并低于 $U_{TH2}$ 时，输出由 $+U_{om}$ 跳变至 $-U_{om}$；</li>
<li>迟滞区间由 $U_{TH1}$ 和 $U_{TH2}$ 确定，特性为<strong>上行型迟滞回线</strong>。</li>
</ul>
<hr>
<h3 id="例题-1"><a href="#例题-1" class="headerlink" title="例题"></a>例题</h3><p><img src="/blog/image/g45eg.jpg"></p>
<blockquote>
<p>图中的线应该往下移一点，比较器输出$+U_{om} \sim -U_{om}$</p>
<p>$U_{om}&#x3D;10V$</p>
<ul>
<li><strong>这就是一个下行的迟滞比较器，抓住两个阈值电压即可解题</strong></li>
</ul>
</blockquote>
<p><strong>例题</strong></p>
<p><img src="/blog/image/1748049757362_%E7%9C%8B%E5%9B%BE%E7%8E%8B.jpg"></p>
<h2 id="电压跟随器"><a href="#电压跟随器" class="headerlink" title="电压跟随器"></a>电压跟随器</h2><blockquote>
<p><strong>电压跟随器（Voltage Follower）工作原理推导</strong></p>
<hr>
<p><strong>1. 电路结构</strong></p>
<p>电压跟随器是一种将<strong>运算放大器输出端</strong>直接连接到其<strong>反相输入端（$-$）<strong>的特殊形式，输入信号加在</strong>同相端（$+$）</strong>。</p>
<blockquote>
<p><strong>记忆</strong>：<span style="color:#FF0000">同相输入，反相输出</span></p>
</blockquote>
<p>其结构特点是：</p>
<ul>
<li>$U_+ &#x3D; U_i$（输入端）</li>
<li>$U_- &#x3D; U_o$（因为反相端与输出端直接相连）</li>
</ul>
<hr>
<p><strong>2. 运算放大器基本关系式</strong></p>
<p>理想运算放大器的基本输出关系为：</p>
<p>$$<br>U_o &#x3D; A(U_+ - U_-)<br>$$</p>
<p>其中：</p>
<ul>
<li>$U_o$：输出电压  </li>
<li>$A$：开环增益（$A \to \infty$）  </li>
<li>$U_+$：同向端电压  </li>
<li>$U_-$：反相端电压</li>
</ul>
<hr>
<p><strong>3. 引入负反馈分析</strong></p>
<p>由于：</p>
<ul>
<li>$U_+ &#x3D; U_i$  </li>
<li>$U_- &#x3D; U_o$</li>
</ul>
<p>将其代入上式：</p>
<p>$$<br>U_o &#x3D; A(U_i - U_o)<br>$$</p>
<p>整理得：</p>
<p>$$<br>U_o + A U_o &#x3D; A U_i<br>$$</p>
<p>$$<br>U_o (1 + A) &#x3D; A U_i<br>$$</p>
<p>$$<br>U_o &#x3D; \frac{A}{1 + A} U_i<br>$$</p>
<p>当 $A \to \infty$ 时：</p>
<p>$$<br>\frac{A}{1 + A} \to 1<br>$$</p>
<p>所以：</p>
<p>$$<br>U_o \approx U_i<br>$$</p>
<p>即输出电压等于输入电压。</p>
<hr>
<p><strong>4. 工作原理总结</strong></p>
<p>电压跟随器依靠运放的高增益特性与强负反馈作用，迫使其输出电压自动调整到与输入电压一致，从而达到：</p>
<p>$$<br>U_o \approx U_i<br>$$</p>
<p>这种“紧随输入”的特性，就是电压跟随器名称的由来。</p>
<hr>
<p><img src="/blog/image/Snipaste_2025-06-30_09-27-45.png"></p>
</blockquote>
<h2 id="V-F电路设计"><a href="#V-F电路设计" class="headerlink" title="V&#x2F;F电路设计"></a>V&#x2F;F电路设计</h2><h3 id="V-F转换电路"><a href="#V-F转换电路" class="headerlink" title="V&#x2F;F转换电路"></a>V&#x2F;F转换电路</h3><p>$\bigstar$<strong>定义</strong><span style="color:#FF0000">（什么是V&#x2F;F转换）</span></p>
<p>V&#x2F;F（电压&#x2F;频率）转换器能把<strong>输入信号电压转换成相应的频率信号</strong>，即它的<strong>输出信号频率与输入信号电压值成比例</strong>，故又称为电压控制（压控）振荡器（VCO）。</p>
<p><strong>应用</strong></p>
<p>在<u>调频（电压调频）</u>，<u>锁相</u>和<u>A&#x2F;D变换</u>等许多技术领域得到非常广泛的应用。</p>
<p><strong>指标</strong></p>
<ul>
<li>额定工作频率和动态范围</li>
<li>灵敏度或变换系数</li>
<li>非线性误差</li>
<li>灵敏度误差和温度系数等</li>
</ul>
<p><strong>最简信号频率输入通道结构</strong></p>
<p><img src="/blog/image/Snipaste_2025-06-25_09-31-37.png"></p>
<ul>
<li>将被测量转换成与被测信号成比例的电压(或电流)脉冲频率(f)、周期(T)或周期数(N)。</li>
</ul>
<p>因此，前向通道只需将代表被测物理量的这些电压脉冲信号通过整形放大成TTL(Transister-Transister-Logic晶体管-晶体管逻辑电平)电平的频率、周期、周期数信号送入计算机应用系统中即可。为了防止噪声侵入，可经过光电耦合后送入。</p>
<p><strong>V&#x2F;F转换信号频率输入通道结构</strong></p>
<p><img src="/blog/image/Snipaste_2025-06-25_09-36-31.png"></p>
<ul>
<li><p>这种输入通道结构与一般A&#x2F;D转换器前向通道结构相似，只不过是将A&#x2F;D转换器改换成V&#x2F;F转换器</p>
</li>
<li><p>传感器一般都是模拟量小信号电流或电压输出，经过信号调节器调节成能满足V&#x2F;F转换器输入要求的大电压信号。</p>
</li>
<li><p>V&#x2F;F转换器把这些模拟输入电压转换成相应的TTL频率信号，经光电耦合后送入计算机。同样可以送入I&#x2F;O口、计数器输入端或中断源输入端上。</p>
</li>
<li><p>在这类通道中，信号调节器及其前端电路皆为模拟电路。</p>
</li>
</ul>
<p><strong>R、L、C&#x2F;F转换信号频率输入通道结构</strong></p>
<p><img src="/blog/image/Snipaste_2025-06-25_09-34-14.png"></p>
<p>这种输入通道中的传感器都是R、L、C类传感器，如热敏电阻、光敏电阻、电感传感器，电容传感器等。</p>
<p>把外界被测物理量变换成R、L、C的变化，这些敏感元件可称为参量变换器。将这些R、L、C参量接入R、L、C振荡电路或脉冲宽度调制器，则振荡电路输出的信号频率f或脉冲宽度调制器输出的信号周期T与相应的R、L、C成正比。</p>
<p><span style="color:#FF0000">  <strong>$ \bigstar$ V&#x2F;F转换原理</strong></span></p>
<p><strong>原理</strong>：利用过零比较器的工作原理，转换器产生<strong>频率</strong>正比于输入电压的<strong>脉冲序列</strong>，然后在固定的时间内对脉冲进行计数。</p>
<p><strong>两种方法：</strong></p>
<ul>
<li>电荷平衡式V&#x2F;F转换器</li>
<li>积分复原型</li>
</ul>
<h3 id="电荷平衡式V-F转换电路"><a href="#电荷平衡式V-F转换电路" class="headerlink" title="电荷平衡式V&#x2F;F转换电路"></a>电荷平衡式V&#x2F;F转换电路</h3><blockquote>
<p>课本图做大概推导，PPT解释具体的电荷转移原理</p>
</blockquote>
<p><img src="/blog/image/Snipaste_2025-07-06_14-13-17.png"></p>
<p><img src="/blog/image/Snipaste_2025-07-06_14-13-33.png"></p>
<p><img src="/blog/image/Snipaste_2025-07-06_14-14-14.png"></p>
<p><img src="/blog/image/Snipaste_2025-07-06_14-14-30.png"></p>
<h3 id="积分复原型V-F转换电路"><a href="#积分复原型V-F转换电路" class="headerlink" title="积分复原型V&#x2F;F转换电路"></a>积分复原型V&#x2F;F转换电路</h3><ul>
<li><p>电路包含积分器、电平检测器、积分复原开关</p>
</li>
<li><p><span style="color:#FF0000">积分复原开关</span>：当积分电容充电到<strong>下限值电平</strong>（图中$u_2$）时，电平检测器使积分复原开关导通，使电容迅速放电，积分器输出复原到<strong>上限阀值电压</strong>（图中$u_1$)，复原开关重新截止，积分器再次积分  </p>
</li>
<li><p>$u_i$越高$u_c$越快达到$u_p$电平，比较器翻转越快</p>
</li>
<li><blockquote>
<p><strong>该电路精度低，适用于精度不高的场合</strong></p>
</blockquote>
</li>
</ul>
<p><img src="/blog/image/Snipaste_2025-07-06_14-15-07.png"></p>
<h2 id="接口设计"><a href="#接口设计" class="headerlink" title="接口设计"></a>接口设计</h2><h3 id="接口分类"><a href="#接口分类" class="headerlink" title="接口分类"></a>接口分类</h3><p><span style="color:#FF0000">接口</span>**：**接口是指计算机系统中一个部件与另一些部件的相互连接。</p>
<p><strong>接口分类</strong></p>
<ul>
<li><p>存储器接口</p>
</li>
<li><p>I&#x2F;O接口</p>
</li>
<li><p>总线接口（通用接口）</p>
</li>
</ul>
<h3 id="电平转换"><a href="#电平转换" class="headerlink" title="电平转换"></a>电平转换</h3><ol>
<li><p><span style="color:#FF0000">为什么要进行电平转换?</span><br>与计算机相连的其它功能单元各<u>自有各自的工作电平</u>， 需要一个<u>媒介</u>与这些功能单元电平之间进行相互转换。</p>
</li>
<li><p><strong>什么是TTL电平?</strong><br>TTL电平信号通常数据表示采用二进制规定，+5V等于逻辑”1”，0V等于逻辑”0”，这被称做TTL（晶体管-晶体管逻辑电平）信号系统，这是计算机处理控制的设备内部各部分之间通信的标准技术。</p>
</li>
<li><p><strong>TTL电平转换</strong></p>
<ul>
<li>TTL——继电器连接</li>
<li>TTL——MOS电平转换</li>
</ul>
</li>
</ol>
<h3 id="TTL——继电器连接"><a href="#TTL——继电器连接" class="headerlink" title="TTL——继电器连接"></a>TTL——继电器连接</h3><ul>
<li><p><strong>继电器</strong>：是一种电控控制器件。它具有控制系统（又称输入回路）和被控制系统（又称输出回路）之间的互动关系。通常应用于自动化的控制电路中，它实际上是用<strong>小电流去控制大电流运作的一种“自动开关”</strong>，故在电路中起着自动调节、安全保护、转换电路等作用。</p>
</li>
<li><p>TTL——继电器连接只适用于<strong>慢变信号</strong>，在TTL信号与继电器连接时往往要经过一个驱动级，用以提供继电器工作所必需的电流。</p>
<p><span style="color:#FF0000">下图为继电器驱动电路</span></p>
</li>
</ul>
<p><img src="/blog/image/Snipaste_2025-06-24_16-39-03.png"></p>
<p><span style="color:#FF0000">图 4.44 及图 4.45 为计算机电平与交流电网之间的电平转换电路。</span></p>
<ul>
<li><p>图 4.44 中，合上开关，与 220V 电网接通，继电器吸合，在计算机输入端得到 TTL 低电平。</p>
</li>
<li><p>电路中的滤波器用以<strong>抑制干扰</strong>。</p>
</li>
</ul>
<p><img src="/blog/image/Snipaste_2025-06-25_09-55-29.png"></p>
<ul>
<li>图 4.45 用一个 TTL 电平信号控制晶闸管（可控硅）整流电路的工作。来自计算机的输入为 TTL 高电平时，继电器闭合，其触点将晶闸管的控制级与控制电路接通，使得与晶闸管相连的负载 $R_L$ 上流过整流电流。</li>
<li>若输入为 TTL 低电平则继电器触点断开，晶闸管控制级得不到相应的点火控制，晶闸管截止，负载上无电流。</li>
</ul>
<p><img src="/blog/image/Snipaste_2025-06-25_09-54-37.png"></p>
<h3 id="例题-2"><a href="#例题-2" class="headerlink" title="例题"></a>例题</h3><p><img src="/blog/image/Snipaste_2025-07-08_20-29-26.png"></p>
<p><img src="/blog/image/Snipaste_2025-07-08_20-29-45.png"></p>
<h3 id="TTL-MOS电平转换"><a href="#TTL-MOS电平转换" class="headerlink" title="TTL-MOS电平转换"></a>TTL-MOS电平转换</h3><p>无论是 <u>TTL 电路驱动 CMOS</u>（Complementary Metal Oxide Semiconductor，互补金属氧化物半导体）电路还是 <u>COMS 电路驱动 TTL 电路</u>，<strong>驱动门</strong>必须为<strong>负载门</strong>提供合乎标准的高、低电平和足够的驱动电流</p>
<ul>
<li>MOS 器件中，除了采用 +5V 电源的 CMOS 器件能与 TTL 电路直接连接外，大部分 MOS 器件与 TTL 电路之间要经过电平转换连接。</li>
<li>一般的 MOS 电路采用大约 <strong>15V</strong> 的电源电压。</li>
</ul>
<p><img src="/blog/image/Snipaste_2025-06-25_10-33-54.png"></p>
<ol>
<li><p>OC型MOS-TTL电平转换</p>
<p>TTL电路的输出级采用集电极开路的电路（OC门）</p>
</li>
<li><p>一般型TTL-CMOS</p>
<p>TTL电路的末级不是 ＯＣ 门，用一<strong>晶体管</strong>来完成电平转换</p>
</li>
</ol>
<blockquote>
<p>用 TTL 门可直接驱动 CMOS 门，而用 CMOS 门却只能驱动低功率肖特基门。</p>
<p><strong>在用CMOS驱动标准TTL门时，要加一级晶体管作驱动级</strong>  </p>
</blockquote>
<p><strong>对于负逻辑（高电平 -12V，低电平 4V）的 MOS，也可用分立元件使它与 TTL 电路相连接。</strong></p>
<ul>
<li><p>晶体管T1实现电平移动，T2提供驱动</p>
<p><img src="/blog/image/Snipaste_2025-06-25_10-44-09.png"></p>
</li>
</ul>
<h3 id="光耦合器的技术特性与应用"><a href="#光耦合器的技术特性与应用" class="headerlink" title="光耦合器的技术特性与应用"></a>光耦合器的技术特性与应用</h3><ul>
<li>光耦合器（optical coupler，英文缩写为OC），也称光电隔离器，简称<strong>光耦</strong>。光耦合器以光为媒介传输电信号，对输入、输出电信号有良好的隔离作用， 所以在各种电路中得到广泛应用。</li>
<li>光耦合器一般由三部分组成：<strong>光的发射、光的接收及信号放大。</strong></li>
<li>光耦合器的发光器件为二极管，光接收器为光敏二极管。当有电流通过发光二极管时，便形成一个光源，照射到光敏二极管表面上，使光敏二极管产生<u>集电极电流</u>。<strong>电流大小与光照的强弱（流过二极管电流的大小）成正比。</strong></li>
<li>为了提高驱动能力，芯片输出级加了一只晶体管</li>
</ul>
<h4 id="光耦合器的主要优点"><a href="#光耦合器的主要优点" class="headerlink" title="光耦合器的主要优点"></a>光耦合器的主要优点</h4><ul>
<li>信号单向传输，输入端与输出端完全实现了电气隔离；</li>
<li>输出信号对输入端无影响，抗干扰能力强；</li>
<li>工作稳定，无触点，使用寿命长，传输效率高。</li>
</ul>
<h4 id="光耦合器的主要应用"><a href="#光耦合器的主要应用" class="headerlink" title="光耦合器的主要应用"></a>光耦合器的主要应用</h4><ul>
<li>广泛应用于电气绝缘、电平转换、驱动电路、开关电路、信号隔离、通讯设备及微机接口中。</li>
</ul>
<p><img src="/blog/image/Snipaste_2025-07-06_16-46-08.png"></p>
<h3 id="继电器、接触器的功率接口"><a href="#继电器、接触器的功率接口" class="headerlink" title="继电器、接触器的功率接口"></a>继电器、接触器的功率接口</h3><ul>
<li><p><strong>接触器</strong>：是指工业电中利用线圈流过电流产生磁场，使触头闭合，以达到控制负载的电器。</p>
<ul>
<li>其原理是当接触器的电磁线圈通电后，会产生很强的磁场，使铁心产生电磁吸力吸引衔铁，并带动触头动作，<span style="color:#FF0000">常闭触头断开</span>，<span style="color:#FF0000">常开触头闭合</span>；当线路断电时，电磁吸力消失，衔铁在弹簧的作用下释放，使触头复原，<span style="color:#FF0000">常闭触头闭合</span>，<span style="color:#FF0000">常开触头断开</span>。</li>
</ul>
</li>
<li><p>继电器、接触器的<strong>供电</strong>系统分为<strong>直流电磁系统</strong>和<strong>交流电磁系统</strong>，工作电压也较高，因此从单片机输出的信号需要经过<strong>驱动</strong>电路进行<strong>转换</strong>，使输出的驱动电压能够适应继电器或接触器线圈的要求。</p>
</li>
<li><p>继电器、接触器动作时，对电源有一定的干扰，为了提高单片机系统的可靠性，在单片机和继电器、接触器之间都用<strong>光电耦合器</strong>隔离。 —些超小型的继电器，由于线圈工作电流较小，对电源的影响不大，也可以不加隔离电路。</p>
</li>
</ul>
<h4 id="直流电磁式继电器功率接口"><a href="#直流电磁式继电器功率接口" class="headerlink" title="直流电磁式继电器功率接口"></a>直流电磁式继电器功率接口</h4><ul>
<li>直流电磁式继电器、接触器一般用<strong>功率接口集成电路</strong>或<strong>晶体管</strong>驱动  </li>
<li>常用的继电器大部分属于<strong>直流电磁式继电器</strong>，也称为<strong>直流继电器</strong>  </li>
<li>一片SN75468可以驱动 ７ 个继电器，驱动电流可达500mA，输出端最大工作电压为100V</li>
</ul>
<p><span style="color:#FF0000">直流继电器接口电路图</span>（图要会画，工作原理要清楚）</p>
<p><img src="/blog/image/Snipaste_2025-07-06_20-03-18.png"></p>
<p><img src="/blog/image/Snipaste_2025-07-06_20-05-22.png"></p>
<p><span style="color:#FF0000">工作原理</span>：</p>
<ul>
<li><p>单片机 <strong>P1.0 输出低电平</strong> 时，光电耦合器 TIL117 导通，为晶体管 9013 提供基极电流，9013 饱和导通，继电器线圈通电吸合；</p>
</li>
<li><p><strong>P1.0 输出高电平</strong> 时，光耦截止，9013 关断，线圈断电释放。（采用这种控制逻辑可以使继电器在上电复位或单片机受控复位时不吸合  ）</p>
</li>
<li><p>二极管 D 在断电瞬间吸收反向感应电动势，保护晶体管 9013</p>
<blockquote>
<p>二极管 Ｄ 的作用是保护晶体管 Ｔ </p>
<p><strong>原理</strong>：</p>
<ul>
<li>当继电器 Ｊ 吸合时，二极管 Ｄ 截止，不影响电路工作</li>
<li>当<strong>继电器释放</strong>时，线圈因电感特性产生 <strong>上负下正的反向感应电动势</strong>，其正端接晶体管 T 的集电极，与电源$V_c$叠加后易超过 T 的集电结反向耐压。此时 <strong>二极管 D 正向导通</strong>，为感应电流提供 <strong>续流回路</strong>，使线圈储能通过 D 缓慢释放，避免感应电压急剧升高，从而保护晶体管 T 免受高压损坏。</li>
</ul>
</blockquote>
<blockquote>
<p>记住二极管的方向，忘了现场推：导通时，继电器电流从上到下，突然断电，感应电动势抑制电流变化，产生从上到下的电流，感应电动势上负下正，二极管电流从下到上导通。</p>
</blockquote>
</li>
</ul>
<blockquote>
<p><strong>例题</strong></p>
<p><img src="/blog/image/IMG_20250606_102808.jpg"></p>
<p><img src="/blog/image/IMG_20250606_103337.jpg"></p>
<p><strong>TTL输入 → 信号调理 → 隔离 → 功率驱动 → 电磁阀</strong></p>
<p><strong>一、设计核心需求</strong></p>
<ol>
<li><p><strong>电气隔离</strong>：TTL 侧（5V）与电磁阀侧（24V、1A）不能直接电连接，需通过 “电→光→电” 转换隔离（光电耦合器是关键）。</p>
</li>
<li><p><strong>驱动能力</strong>：电磁阀工作电流 1A，TTL 电平（mA 级）无法直接驱动，需 <strong>功率放大电路</strong>（三极管）。</p>
</li>
<li><p><strong>感性负载保护</strong>：电磁阀是电感，断电时产生反向电动势，需 <strong>续流二极管</strong> 吸收能量，保护功率管</p>
</li>
</ol>
  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">graph TD</span><br><span class="line">    A[&quot;TTL低电平&quot;] --&gt; B[&quot;U2反相 → 高电平&quot;]</span><br><span class="line">    B --&gt; C[&quot;U1发光二极管导通 → 发光&quot;]</span><br><span class="line">    C --&gt; D[&quot;U1光敏三极管导通&quot;]</span><br><span class="line">    D --&gt; E[&quot;T1基极获电流 → 饱和导通&quot;]</span><br><span class="line">    E --&gt; F[&quot;24V电源 → 电磁阀供电 → 工作&quot;]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">graph TD</span><br><span class="line">    A[&quot;TTL高电平&quot;] --&gt; B[&quot;U2反相 → 低电平&quot;]</span><br><span class="line">    B --&gt; C[&quot;U1发光二极管熄灭&quot;]</span><br><span class="line">    C --&gt; D[&quot;U1光敏三极管截止&quot;]</span><br><span class="line">    D --&gt; E[&quot;T1基极无电流 → 截止&quot;]</span><br><span class="line">    E --&gt; F[&quot;电磁阀断电&quot;]</span><br><span class="line">    F --&gt; G[&quot;续流二极管吸收反向电动势 → 保护T1&quot;]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>元件</th>
<th>名称</th>
<th>核心作用</th>
</tr>
</thead>
<tbody><tr>
<td>U2</td>
<td>反相驱动器</td>
<td>① 缓冲 TTL 输入信号，增强驱动能力；② 反相逻辑，匹配光电耦合器的触发逻辑。</td>
</tr>
<tr>
<td>U1</td>
<td>光电耦合器</td>
<td>实现“电气隔离”：左侧电信号→光信号→右侧电信号，切断两侧电路的直接电连接。</td>
</tr>
<tr>
<td>R1</td>
<td>限流电阻（发光侧）</td>
<td></td>
</tr>
<tr>
<td>R2</td>
<td>限流电阻（三极管基极）</td>
<td></td>
</tr>
<tr>
<td>T1</td>
<td>功率三极管</td>
<td>放大电流：将光电耦合器的微弱信号放大，驱动 1A 的电磁阀。</td>
</tr>
<tr>
<td>续流二极管</td>
<td>保护 T1</td>
<td>吸收电磁阀断电时的反向电动势，保护 T1 不被击穿。</td>
</tr>
</tbody></table>
</blockquote>
<blockquote>
<ol>
<li><strong>隔离层</strong>：光电耦合器 U1 是 “隔离核心”，通过光信号传递，彻底切断两侧电连接。</li>
<li><strong>驱动层</strong>：功率三极管 T1 负责 “大电流放大”，将微弱信号提升至 1A 驱动能力。</li>
<li><strong>保护层</strong>：续流二极管应对感性负载的反向电动势</li>
</ol>
</blockquote>
<h4 id="交流电磁式接触器的功率接口"><a href="#交流电磁式接触器的功率接口" class="headerlink" title="交流电磁式接触器的功率接口"></a>交流电磁式接触器的功率接口</h4><ul>
<li><p>交流电磁式接触器由于线圈的工作<u>电压</u>要求是<u>交流电</u>，所以通常使用<u><strong>双向晶闸管</strong></u>驱动或使用一个<u>直流继电器</u>作为中间继电器控制。</p>
</li>
<li><p>晶闸管是<strong>晶体</strong>闸流管的简称，又可称做<strong>可控硅</strong>整流器，晶闸管是PNPN四层<strong>半导体</strong>结构，它有三个极：<strong>阳极、阴极和门极</strong>。</p>
</li>
<li><p>晶闸管具有硅整流<strong>器件</strong>的特性，能在高电压、大<strong>电流</strong>条件下工作，且其工作过程可以控制，被广泛应用用于可控整流、交流调压、等电子电路中。</p>
</li>
</ul>
<p><img src="/blog/image/Snipaste_2025-07-06_21-17-06.png"></p>
<p><img src="/blog/image/Snipaste_2025-07-06_21-17-31.png"></p>
<p><strong>光电耦合器 Ｍ ＯＣ３０４１ 的作用：</strong></p>
<ul>
<li><p>触发双向晶闸管 ＫＳ </p>
</li>
<li><p>隔离单片机系统和接触器系统</p>
</li>
</ul>
<p><span style="color:#FF0000">工作原理</span>：</p>
<p>P1.0 输出<strong>低电平</strong>时，双向晶闸管KS 导通、接触器 C 吸合；</p>
<p>P1.0 输出<strong>高电平</strong>时，双向晶闸管KS 关断、接触器 C 释放 。</p>
<ul>
<li>这种控制逻辑可以使得单片机复位时，晶闸管 ＫＳ 的状态为关断，不会引起 ＫＳ 误导通</li>
</ul>
<blockquote>
<p><strong>注意</strong>：光电耦合器 Ｍ ＯＣ３０４１ 内部带过零控制电路，使 KS 工作在 <strong>过零触发方式</strong> 。</p>
</blockquote>
<blockquote>
<p><img src="/blog/image/IMG_20250606_103503.jpg"></p>
<p><img src="/blog/image/IMG_20250606_103538.jpg"></p>
<p>一、设计核心需求</p>
<ol>
<li><p><strong>电气隔离</strong>：5V TTL（直流小信号）与 220V 交流（高压强电）必须彻底隔离，防止高压串入控制电路。</p>
</li>
<li><p><strong>交流驱动</strong>：负载是 220V 交流电（正弦波，正负交替），需 <strong>双向导通的开关器件</strong>（应对交流正负半周）。</p>
</li>
<li><p><strong>信号匹配</strong>：TTL 电平需缓冲 &#x2F; 反相，匹配隔离器件的触发逻辑</p>
</li>
</ol>
<p>  二、元件功能解析</p>
<table>
<thead>
<tr>
<th>元件符号</th>
<th>名称</th>
<th>核心作用</th>
</tr>
</thead>
<tbody><tr>
<td>U2</td>
<td>反相驱动器</td>
<td>①缓冲TTL信号,增强驱动能力;②反相逻辑,匹配光控器件的触发电平。</td>
</tr>
<tr>
<td>U1</td>
<td>光控晶闸管（光电耦合器）</td>
<td>实现“电气隔离”:将TTL侧电信号 → 光信号 → 电信号,触发交流侧的双向晶闸管。</td>
</tr>
<tr>
<td>U3</td>
<td>双向晶闸管</td>
<td>作为交流开关:受U1触发后,双向导通220V交流电,控制加热炉通断。</td>
</tr>
<tr>
<td>R1&#x2F;R2&#x2F;R3</td>
<td>限流电阻</td>
<td></td>
</tr>
</tbody></table>
</blockquote>
<blockquote>
<p>三、设计逻辑的关键思考</p>
<ol>
<li><strong>为什么选双向晶闸管（U3）？</strong></li>
</ol>
<p>交流电压是 <strong>正弦波（正负交替）</strong>：</p>
<ul>
<li>普通三极管仅能 <strong>单向导通</strong>（应对直流），无法处理交流负半周；</li>
<li>双向晶闸管可在 <strong>正负半周均触发导通</strong>，完美匹配交流负载的双向特性。</li>
</ul>
<ol start="2">
<li><strong>为什么用 “光控” 实现隔离？</strong></li>
</ol>
<ul>
<li><p>U1（光控晶闸管）或 “光电耦合器 + 晶闸管” 的组合，通过 <strong>“电→光→电” 的信号转换</strong>，彻底切断：</p>
</li>
<li><p>直流控制侧（5V，低电压）与交流高压侧（220V，强电）的直接电连接，实现电气隔离。</p>
</li>
</ul>
<ol start="3">
<li><strong>反相驱动器（U2）的意义？</strong></li>
</ol>
<ul>
<li><strong>逻辑匹配</strong>：TTL 高电平可能与 U1 的触发逻辑冲突（如 U1 需低电平触发），反相器可调整电平逻辑。</li>
<li><strong>驱动增强</strong>：TTL 信号驱动能力弱，反相器可增强带载能力，避免信号失真。</li>
</ul>
</blockquote>
<h3 id="电光、电热型功率接口"><a href="#电光、电热型功率接口" class="headerlink" title="电光、电热型功率接口"></a>电光、电热型功率接口</h3><ul>
<li>电光型功率接口主要用于各类<strong>照明</strong>以及<strong>闪光</strong>指示器等的驱动，电光型功率接口采用<strong>连续</strong>方式控制；</li>
<li>电热型功率接口主要用于各种<strong>电炉和加热器</strong>等的驱动，电热型功率接口采用<strong>连续或断续</strong>方式控制。</li>
</ul>
<h4 id="电光、电子型器件"><a href="#电光、电子型器件" class="headerlink" title="电光、电子型器件"></a>电光、电子型器件</h4><ol>
<li><p><strong>电光型</strong></p>
<ul>
<li>目前应用最广泛的电光源是<strong>白炽灯</strong>。白炽灯的<strong>发光原理</strong>是热辐射原理，利用电流通过钨丝，使钨丝温度升高，达到“白炽”的状态，从而辐射出光能。白炽灯调光时，通常采用<strong>连续控制</strong>，用双向晶闸管作为控制元件，调节双向晶闸管的控制角来控制白炽灯的亮度。</li>
</ul>
</li>
<li><p><strong>电热型</strong></p>
<ul>
<li>电热器件是能把电能转化为热能的各类器件，常用的电热器件有：<strong>电阻丝电热器件</strong>、多孔玻璃态碳电热器件、电热膜；硅钼棒电热器件和PTC半导体电热器件。</li>
</ul>
</li>
</ol>
<h4 id="电光型功率接口"><a href="#电光型功率接口" class="headerlink" title="电光型功率接口"></a>电光型功率接口</h4><p><img src="/blog/image/Snipaste_2025-07-06_21-53-03.png"></p>
<p><strong>工作原理：</strong></p>
<p>MOC3021 由单片机 8031 的 P1.0 端经 7407 控制，</p>
<ul>
<li><p>P1.0 输出低电平时，双向晶闸管 KS 导通，白炽灯 L 发亮；</p>
</li>
<li><p>P1.0 输出高电平时，双向晶闸管 KS 关断，白炽灯 L 不亮。</p>
</li>
<li><blockquote>
<p>这种控制逻辑可以使得单片机复位时，晶闸管 KS 的状态为关断，不会引起 KS 误导通。</p>
</blockquote>
</li>
</ul>
<blockquote>
<p>电光型功率接口通常用<strong>晶闸管</strong>作为控制元件，配上<strong>过零检测</strong>电路后，可以调节输出的电压，控制电光器件的发光程度  </p>
</blockquote>
<h4 id="电热型功率接口"><a href="#电热型功率接口" class="headerlink" title="电热型功率接口"></a>电热型功率接口</h4><blockquote>
<p><strong>电热型功率接口通常用继电器或晶闸管控制</strong>  </p>
</blockquote>
<p><img src="/blog/image/Snipaste_2025-07-07_07-39-02.png"></p>
<ul>
<li>电热器件由双向晶闸管 KS 控制，KS 由光电耦合器 4N25 和晶体管 9013 触发。采用直流脉冲触发。触发电压由变压器 B 的其中一个绕组$L_{2}$提供。经整流滤波后，直流电压为 12V ,触发电流可达 200m A 。</li>
</ul>
<p><span style="color:#FF0000">工作原理：</span></p>
<ol>
<li><strong>触发原理</strong></li>
</ol>
<p>单片机 8031 的 P1.0 端输出的触发信号经 7407 后，送到光电耦合器 4N25。</p>
<ul>
<li><p>P1.0端输出高电平时，4N25 没有电流输人，晶体管 T 截止，双向晶闸管 KS 关断， 电热器不加热。</p>
</li>
<li><p>当 P1. 0端输出低电平时，7407 输出低电平，4N25 导通 ,输出端的电流经晶体管 9013 放大后 ,双向晶闸管导通 ,电热器加热。</p>
<blockquote>
<p>电阻$R$ 3 的作用是限制触发电流，当双向晶闸管 KS 的功率较小时 ,$R$3 可由 30$\Omega$改为 100$\Omega_\circ$</p>
</blockquote>
<ol start="2">
<li><strong>温度检测电路原理</strong></li>
</ol>
<p>温度检测电路由热电偶、运算放大器组成。</p>
<ul>
<li>热电偶产生的毫伏级电压经运算放大器变成 0~5V 的电压后，送到 A&#x2F;D 转换器输入端，经 A&#x2F;D 转换器变成反映温度的数字信号。</li>
</ul>
</li>
</ul>
<ol start="3">
<li><strong>过零检测电路原理</strong></li>
</ol>
<ul>
<li>过零检测电路由变压器 B 的其中一个绕组$L_{3}$和电容器$C_2$组成。$L_3$产生2.5V 的交流电压，通过$C_2$交连到 8031 的 INT1 和 INT0 端。<ul>
<li>INT1 是过零检测端，它可对过零的上升信号检测而产生中断：</li>
</ul>
</li>
<li>INT0 也是过零检测端，它可对过零的下降信号检测而产生中断。<ul>
<li>把 INTl 和 INT 0 产生的中断综合处理，即可得到电源电压过零的时刻。</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>机电一体化分析与建模</tag>
      </tags>
  </entry>
  <entry>
    <title>笼中雀</title>
    <url>/blog/2025/02/25/%E7%AC%BC%E4%B8%AD%E9%9B%80/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>总有些时间，是想写点什么，但又感觉没什么好写的。</p>
<blockquote>
<p>以前总想着如果自己没能做到一些东西，通过逃避是可以躲过去的。但其实现在才发现人生上一个阶段没解决的问题，只会在下一个阶段更加放大，现在好像已经躲不掉了。 或许早该重新梳理一遍曾经的路了，沉下心来先解决 一些曾经没解决的问题！</p>
</blockquote>
<hr>
<p>一路走来，渐渐认识到，我一直是个很难做出决定的人。在每次决定前都会犹豫，所以就习惯拖着，最后发现已经无需做决定了，时间已经排除掉会犹豫的选项了。</p>
<hr>
<blockquote>
<p>2025&#x2F;4&#x2F;21 21:07 小雨 写于光机所研究生部</p>
</blockquote>
<p>前几天的小事有感而发。</p>
<p>对于不喜欢的人，我是一个字都不愿意多说的，所以在外人看来交流时很拘谨，说话的分寸感很强，界限拉满。</p>
<p>对于有些人的敌对感好似并不是因为某件事亦或者某个人突然产生的，而是经过了很长时间，以现在的视角回忆当年的事，慢慢察觉出自己当年的心境和行为并不是很成熟，说了违心的话，做了后悔的事，因此便试着将当年与之相关的人圈定在一起，在心底慢慢琢磨；而随着时间发展，等当年的某些人再次遇到时，这些年的思考以及酝酿的情绪便会因一些奇奇怪怪的事拉扯出来，当年的事便会因为这些年潜意思的思考形成对某些人的固有观感，差的人自然而然就无话可说。</p>
<hr>
<blockquote>
<p>2025&#x2F;5&#x2F;9 晴 写于光机所研究生部宿舍</p>
</blockquote>
<p>在经历了很多事后，发现人跟人之间是很不一样的。一个人在某个阶段的选择会根据当下所处的环境以及周围人的意见而有显著的差别，因为不同的人可接受的沉默成本是不一样。</p>
<hr>
<p>置身其中，好一个笼中雀。</p>
]]></content>
      <categories>
        <category>想法</category>
      </categories>
      <tags>
        <tag>笼中雀</tag>
      </tags>
  </entry>
  <entry>
    <title>数值分析公式记忆汇总</title>
    <url>/blog/2025/06/12/%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90%E5%85%AC%E5%BC%8F%E8%AE%B0%E5%BF%86%E6%B1%87%E6%80%BB/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="拉格朗日插值"><a href="#拉格朗日插值" class="headerlink" title="拉格朗日插值"></a>拉格朗日插值</h1><p><strong>两点一次插值（线性插值）</strong></p>
<p><strong>条件</strong>：2个节点 $(x_0, y_0)$ 和 $(x_1, y_1)$  </p>
<p><strong>多项式</strong>：<br>$$<br>L_1(x) &#x3D; \frac{x - x_1}{x_0 - x_1} y_0 + \frac{x - x_0}{x_1 - x_0} y_1<br>$$</p>
<p><strong>等价形式</strong>：<br>$$<br>L_1(x) &#x3D; y_0 + \frac{y_1 - y_0}{x_1 - x_0}(x - x_0)<br>$$</p>
<hr>
<p><strong>三点二次插值（抛物插值）</strong></p>
<p><strong>条件</strong>：3个节点 $(x_0, y_0)$，$(x_1, y_1)$，$(x_2, y_2)$<br><strong>多项式</strong>：<br>$$<br>L_2(x) &#x3D; \frac{(x - x_1)(x - x_2)}{(x_0 - x_1)(x_0 - x_2)} y_0 + \frac{(x - x_0)(x - x_2)}{(x_1 - x_0)(x_1 - x_2)} y_1 + \frac{(x - x_0)(x - x_1)}{(x_2 - x_0)(x_2 - x_1)} y_2<br>$$</p>
<hr>
<p><strong>多个插值节点</strong><br>$$<br>L_n(x)&#x3D; \sum_{i&#x3D;0}^n l_i(x) y_i&#x3D; \sum_{i&#x3D;0}^n \left[ \prod_{\substack{j&#x3D;0 \ j \neq i}}^n \frac{x - x_j}{x_i - x_j} \right] y_i<br>$$</p>
<hr>
<h2 id="插值余项与误差估计"><a href="#插值余项与误差估计" class="headerlink" title="插值余项与误差估计"></a>插值余项与误差估计</h2><p>对任意 $x \in [a,b]$，插值余项满足：<br>$$<br>R_n(x) &#x3D; f(x) - L_n(x) &#x3D; \frac{f^{(n+1)}(\xi)}{(n+1)!} \prod_{j&#x3D;0}^n (x - x_j) \quad<br>$$<br>其中 $\xi \in (a, b)$，且 $\xi$ 的值依赖于 $x$</p>
<p><strong>n&#x3D;1时，线性插值余项</strong><br>$$<br>R_1(x) &#x3D; \frac{1}{2} f’’(\xi) \omega_2(x) &#x3D; \frac{1}{2} f’’(\xi) (x - x_0)(x - x_1), \quad \xi \in [x_0, x_1]<br>$$</p>
<p><strong>n&#x3D;2时，抛物插值余项</strong><br>$$<br>R_2(x) &#x3D; \frac{1}{6} f’’’(\xi) (x - x_0)(x - x_1)(x - x_2), \quad \xi \in [x_0, x_2]<br>$$</p>
<h1 id="二点三次埃尔米特插值多项式"><a href="#二点三次埃尔米特插值多项式" class="headerlink" title="二点三次埃尔米特插值多项式"></a>二点三次埃尔米特插值多项式</h1><p>**问题描述：**给定区间 $[x_0, x_1]$ 两端点的函数值与导数值：</p>
<table>
<thead>
<tr>
<th>$x$</th>
<th>$x_0$</th>
<th>$x_1$</th>
</tr>
</thead>
<tbody><tr>
<td>$f(x)$</td>
<td>$y_0$</td>
<td>$y_1$</td>
</tr>
<tr>
<td>$f’(x)$</td>
<td>$m_0$</td>
<td>$m_1$</td>
</tr>
</tbody></table>
<ol>
<li><strong>最终表达式</strong><br>$$<br>H_3(x) &#x3D; y_0\left(1 - 2\dfrac{x - x_0}{x_0 -x_1}\right)\left(\dfrac{x - x_1}{x_0 - x_1}\right)^2<br>$$</li>
</ol>
<p>$$<br>+y_1\left(1 - 2\dfrac{x - x_1}{x_1 - x_0}\right)\left(\dfrac{x - x_0}{x_1 - x_0}\right)^2<br>$$</p>
<p>$$<br>+m_0(x - x_0)\left(\dfrac{x - x_1}{x_0 - x_1}\right)^2 + m_1(x - x_1)\left(\dfrac{x - x_0}{x_1 - x_0}\right)^2<br>$$</p>
<h1 id="牛顿插值"><a href="#牛顿插值" class="headerlink" title="牛顿插值"></a>牛顿插值</h1><p>$$<br>N_n(x)&#x3D; f(x_0) + f[x_0, x_1](x - x_0) + \cdots + f[x_0, \ldots, x_n](x - x_0)\cdots(x - x_{n-1})<br>$$</p>
<p><strong>余项公式</strong><br>$$<br>R_n(x)&#x3D;f[x, x_0, \ldots, x_n](x - x_0)\cdots(x - x_{n-1})(x - x_n)&#x3D;f[x, x_0, \ldots, x_n]\omega_{n+1}(x)<br>$$<br><strong>差商表</strong></p>
<table>
<thead>
<tr>
<th align="center">$ x_i $</th>
<th align="center">$ f(x_i) $</th>
<th align="center">一阶差商</th>
<th align="center">二阶差商</th>
<th align="center">三阶差商</th>
</tr>
</thead>
<tbody><tr>
<td align="center">$ x_0 $</td>
<td align="center">$ f(x_0) $</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">$ x_1 $</td>
<td align="center">$ f(x_1) $</td>
<td align="center">$ f[x_0, x_1] $</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">$ x_2 $</td>
<td align="center">$ f(x_2) $</td>
<td align="center">$ f[x_1, x_2] $</td>
<td align="center">$ f[x_0, x_1, x_2] $</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">$ x_3 $</td>
<td align="center">$ f(x_3) $</td>
<td align="center">$ f[x_2, x_3] $</td>
<td align="center">$ f[x_1, x_2, x_3] $</td>
<td align="center">$ f[x_0, x_1, x_2, x_3] $</td>
</tr>
</tbody></table>
<h1 id="差分形式的牛顿插值"><a href="#差分形式的牛顿插值" class="headerlink" title="差分形式的牛顿插值"></a>差分形式的牛顿插值</h1><p><span style="color:rgb(255, 53, 116)">牛顿前插公式：</span><br>设 $ x &#x3D; x_0 + th $（$ 0 \leq t \leq 1 $），则<br>$$<br>N_n(x) &#x3D; N_n(x_0 + th) &#x3D; \sum_{k&#x3D;0}^{n} \binom{t}{k} \Delta^k f(x_0)<br>$$</p>
<p>$$<br>&#x3D; f_0 + t\Delta f_0 + \frac{t(t - 1)}{2!}\Delta^2 f_0 + \dots + \frac{t(t - 1)\dots(t - n + 1)}{n!}\Delta^n f_0<br>$$</p>
<p>余项：<br>$$<br>R_n(x) &#x3D; \frac{f^{(n+1)}(\xi)}{(n+1)!} t(t-1)\cdots(t-n) h^{n+1}, \quad \xi \in (x_0, x_n)<br>$$</p>
<p><span style="color:rgb(255, 53, 116)">牛顿后插公式：</span><br>将节点顺序倒置：<br>$$<br>N_n(x) &#x3D; f(x_n) + f[x_n, x_{n-1}](x - x_n) + \cdots + f[x_n, \ldots, x_0](x - x_n)\cdots(x - x_1)<br>$$<br>设 $ x &#x3D; x_n + th $（$ -1 \leq t \leq 0 $），则<br>$$<br>N_n(x) &#x3D; N_n(x_n + th) &#x3D; \sum_{k&#x3D;0}^{n} (-1)^k \binom{-t}{k} \nabla^k f(x_n)<br>$$</p>
<p>$$<br>&#x3D; f_n + t\nabla f_n + \frac{t(t + 1)}{2!}\nabla^2 f_n + \dots + \frac{t(t + 1)\dots(t + n - 1)}{n!}\nabla^n f_n<br>$$</p>
<p>余项：<br>$$<br>R_n(x) &#x3D; \frac{f^{(n+1)}(\xi)}{(n+1)!} t(t+1)\cdots(t+n) h^{n+1}, \quad \xi \in (x_0, x_n)<br>$$</p>
<p>注：一般当 $ x $ 靠近 $ x_0 $ 时用前插，靠近 $ x_n $ 时用后插，故两种公式亦称为表初公式和表末公式。</p>
<p><strong>差分表</strong></p>
<p><img src="/blog/../image/Snipaste_2025-03-12_16-09-19-17497100633471.png"></p>
<h1 id="三次样条插值"><a href="#三次样条插值" class="headerlink" title="三次样条插值"></a>三次样条插值</h1><h2 id="第一边界条件"><a href="#第一边界条件" class="headerlink" title="第一边界条件"></a>第一边界条件</h2><p><strong>第一种边界条件</strong>(已知两端的<strong>一阶</strong>导数值)<br>$$<br>s^{\prime}\left(x_0\right)&#x3D;y_0^{\prime}\<br>s^{\prime}\left(x_n\right)&#x3D;y_n^{\prime}<br>$$</p>
<span>

<h1 id="题目中所给节点数，就是系数矩阵的阶数-begin-bmatrix-2-lambda-0-mu-1-2-lambda-1-ddots-ddots-ddots-mu-n-1-2-lambda-n-1-mu-n-2-end-bmatrix-begin-bmatrix-M-0-M-1-vdots-M-n-1-M-n-end-bmatrix"><a href="#题目中所给节点数，就是系数矩阵的阶数-begin-bmatrix-2-lambda-0-mu-1-2-lambda-1-ddots-ddots-ddots-mu-n-1-2-lambda-n-1-mu-n-2-end-bmatrix-begin-bmatrix-M-0-M-1-vdots-M-n-1-M-n-end-bmatrix" class="headerlink" title="题目中所给节点数，就是系数矩阵的阶数$$\begin{bmatrix}2 &amp; \lambda_0 &amp; &amp; &amp; \\mu_1 &amp; 2 &amp; \lambda_1 &amp; &amp; \ &amp; \ddots &amp; \ddots &amp; \ddots &amp; \ &amp; &amp; \mu_{n-1} &amp; 2 &amp; \lambda_{n-1} \ &amp; &amp; &amp; \mu_{n} &amp; 2\end{bmatrix}\begin{bmatrix}M_0 \M_1 \\vdots \M_{n-1} \M_n\end{bmatrix}"></a><span style="color:#FF0000">题目中所给节点数，就是系数矩阵的阶数</span><br>$$<br>\begin{bmatrix}<br>2 &amp; \lambda_0 &amp; &amp; &amp; \<br>\mu_1 &amp; 2 &amp; \lambda_1 &amp; &amp; \<br> &amp; \ddots &amp; \ddots &amp; \ddots &amp; \<br> &amp; &amp; \mu_{n-1} &amp; 2 &amp; \lambda_{n-1} \<br> &amp; &amp; &amp; \mu_{n} &amp; 2<br>\end{bmatrix}<br>\begin{bmatrix}<br>M_0 \<br>M_1 \<br>\vdots \<br>M_{n-1} \<br>M_n<br>\end{bmatrix}</h1><p>\begin{bmatrix}<br>d_0 \<br>d_1 \<br>\vdots \<br>d_{n-1} \<br>d_n<br>\end{bmatrix}<br>$$<br></span></p>
<blockquote>
<p>$$<br>\lambda_0 &#x3D; 1\<br>\mu_n &#x3D; 1\<br>\quad h_j&#x3D;x_{j+1}-x_j<br>$$</p>
<p>$$<br>\lambda_{j}&#x3D; \frac{h_j}{h_{j-1}+h_j}\<br>\mu_j &#x3D; \frac{h_{j-1}}{h_{j-1}+h_j}<br>$$</p>
<p><span style="color:#FF0000">可以这样记，系数矩阵中$\lambda$在对角线上，$\mu$在下,故$\lambda_{j}$取大的$h_j$，$\mu_{j}$取小的$h_{j-1}$，二者和为1</span><br>$$<br>d_0 &#x3D; \frac{6}{h_0} \left( f[x_0, x_1] - f’_0 \right)<br>$$</p>
<p>$$<br>d_j &#x3D; 6 \frac{f[x_j, x_{j+1}] - f[x_{j-1}, x_j]}{h_{j-1} + h_j} &#x3D; 6 f[x_{j-1}, x_j, x_{j+1}], \quad j &#x3D; 1, 2, \dots, n-1<br>$$</p>
<p>$$<br>d_n &#x3D; \frac{6}{h_{n-1}} \left( f’_n - f[x _{n-1}, x_n] \right)<br>$$</p>
<p>$$<br>s(x) &#x3D; \frac{\left(x_{j+1}-x\right)^{3}}{6 h_{j}} M_{j} + \frac{\left(x-x_{j}\right)^{3}}{6 h_{j}} M_{j+1} + \left(y_{j}-\frac{M_{j} h_{j}^{2}}{6}\right)\frac{x_{j+1}-x}{h_{j}} + \left(y_{j+1}-\frac{M_{j+1} h_{j}^{2}}{6}\right)\frac{x-x_{j}}{h_{j}}<br>$$</p>
</blockquote>
<h2 id="第二边界条件"><a href="#第二边界条件" class="headerlink" title="第二边界条件"></a>第二边界条件</h2><h1 id="begin-bmatrix-2-lambda-1-mu-2-2-lambda-2-ddots-ddots-ddots-mu-n-1-2-end-bmatrix-begin-bmatrix-M-1-M-2-vdots-M-n-1-end-bmatrix"><a href="#begin-bmatrix-2-lambda-1-mu-2-2-lambda-2-ddots-ddots-ddots-mu-n-1-2-end-bmatrix-begin-bmatrix-M-1-M-2-vdots-M-n-1-end-bmatrix" class="headerlink" title="$$\begin{bmatrix}2 &amp; \lambda_1 &amp; &amp; \\mu_2 &amp; 2 &amp; \lambda_2 &amp; \ &amp; \ddots &amp; \ddots &amp; \ddots \ &amp; &amp; \mu_{n-1} &amp; 2\end{bmatrix}\begin{bmatrix}M_1 \M_2 \\vdots \M_{n-1}\end{bmatrix}"></a>$$<br>\begin{bmatrix}<br>2 &amp; \lambda_1 &amp; &amp; \<br>\mu_2 &amp; 2 &amp; \lambda_2 &amp; \<br> &amp; \ddots &amp; \ddots &amp; \ddots \<br> &amp; &amp; \mu_{n-1} &amp; 2<br>\end{bmatrix}<br>\begin{bmatrix}<br>M_1 \<br>M_2 \<br>\vdots \<br>M_{n-1}<br>\end{bmatrix}</h1><p>\begin{bmatrix}<br>d_1 - \mu_1 f’’<em>0 \<br>d_2 \<br>\vdots \<br>d</em>{n-1} - \lambda_{n-1} f’’_n<br>\end{bmatrix}<br>$$</p>
<p>$$<br>\begin{cases}<br>M_0 &#x3D; f’’_0 \<br>M_n &#x3D; f’’_n<br>\end{cases}<br>$$</p>
<p>$$<br>s(x) &#x3D; \frac{\left(x_{j+1}-x\right)^{3}}{6 h_{j}} M_{j} + \frac{\left(x-x_{j}\right)^{3}}{6 h_{j}} M_{j+1} + \left(y_{j}-\frac{M_{j} h_{j}^{2}}{6}\right)\frac{x_{j+1}-x}{h_{j}} + \left(y_{j+1}-\frac{M_{j+1} h_{j}^{2}}{6}\right)\frac{x-x_{j}}{h_{j}}<br>$$</p>
<h1 id="向量范数"><a href="#向量范数" class="headerlink" title="向量范数"></a>向量范数</h1><p><span style="color:#FF0000">所有的范数无论是比值，或是求和、积分或者其他运算，都是以绝对值进行的</span></p>
<p>设 $x &#x3D; (x_1, \dots, x_n)^T \in \mathbb{R}^n$，定义以下三种常用范数：  </p>
<ol>
<li><p><strong>∞-范数（最大范数）</strong>：<br>$$<br>||x|| _ \infty &#x3D; \max_{1 \leq i \leq n} |x_i|<br>$$</p>
</li>
<li><p><strong>1-范数</strong>：<br>$$<br>||x|| _ 1 &#x3D; \sum_{i&#x3D;1}^n |x_i|<br>$$</p>
</li>
<li><p><strong>2-范数</strong>：<br>$$<br>||x|| _ 2 &#x3D; \left( \sum_{i&#x3D;1}^n x_i^2 \right)^{1&#x2F;2}<br>$$</p>
</li>
</ol>
<hr>
<h1 id="函数范数"><a href="#函数范数" class="headerlink" title="函数范数"></a>函数范数</h1><p>设 $f(x) \in C[a, b]$，定义以下三种常用范数：  </p>
<ol>
<li><p><strong>∞-范数</strong>：<br>$$<br>||f||_ \infty &#x3D; \max_{a \leq x \leq b} |f(x)|<br>$$</p>
</li>
<li><p><strong>1-范数</strong>：<br>$$<br>||f||_1 &#x3D; \int_a^b |f(x)| , dx<br>$$</p>
</li>
<li><p><strong>2-范数</strong>：<br>$$<br>||f||_2 &#x3D; \left( \int_a^b f^2(x) , dx \right)^{1&#x2F;2}<br>$$</p>
</li>
</ol>
<h1 id="矩阵范数"><a href="#矩阵范数" class="headerlink" title="矩阵范数"></a>矩阵范数</h1><blockquote>
<p><strong>常用矩阵范数</strong>(<strong>下面的$x$都指的是向量</strong>)</p>
<ol>
<li><strong>Frobenius范数</strong></li>
</ol>
<p>$$<br>||A||_F &#x3D; \sqrt {\sum _{i&#x3D;1}^n  \sum _{j&#x3D;1}^n |a _{ij}|^2}<br>$$</p>
<p>对于方阵 $A \in \mathbb{R}^{n \times n}$ 和向量 $x \in \mathbb{R}^n$ 有：</p>
<p>$$<br>||Ax||_2 \leq ||A||_F \cdot ||x||_2<br>$$</p>
<ol start="2">
<li><strong>算子范数（Operator Norm）</strong></li>
</ol>
<p>矩阵范数与向量范数的<strong>相容性</strong>（<em>consistent</em>）</p>
<p>$$<br>||A|| _p &#x3D; \max _{x \neq 0} \frac{||Ax|| _p}{||x|| _p} &#x3D; \max _{||x|| _p&#x3D;1} ||Ax|| _p<br>$$</p>
<p>进一步：</p>
<p>$$<br>||Ax||_p \leq ||A||_p ||x||_p<br>$$</p>
<blockquote>
<p><strong>行和范数（∞-范数）</strong><br>$$<br>||A|| _\infty &#x3D; \max _{1 \leq i \leq n} \sum _{j&#x3D;1}^n |a _{ij}|<br>$$</p>
</blockquote>
<blockquote>
<p><strong>列和范数（1-范数）</strong></p>
<p>$$<br>||A||_1 &#x3D; \max _{1 \leq j \leq n} \sum _{i&#x3D;1}^n |a _{ij}|<br>$$</p>
</blockquote>
<blockquote>
<p><strong>谱范数（2-范数）</strong></p>
</blockquote>
<blockquote>
<p>$$<br>||A||_2 &#x3D; \sqrt{\lambda _{\max}(A^T A)}<br>$$</p>
<p>矩阵$A^T A$的最大特征根</p>
</blockquote>
<p><strong>矩阵谱半径定义</strong></p>
<p>设矩阵 $A \in \mathbb{C}^{n \times n}$ 的特征根为 $\lambda_1, \lambda_2, \ldots, \lambda_n$，则矩阵 $A$ 的<strong>谱半径</strong>（<em>spectral radius</em>）定义为：</p>
<p>$$<br>\rho(A) &#x3D; \max_{1 \leq i \leq n} |\lambda_i|<br>$$</p>
</blockquote>
<p><strong>一些定理</strong></p>
<ol>
<li>对于任意算子范数  $||\cdot||$  ，有：</li>
</ol>
<p>$$<br>\rho(A) \leq ||A||<br>$$</p>
<ol start="2">
<li><p>若$A$对称，则有</p>
<p>$$<br>||A||_2 &#x3D; \rho(A)<br>$$</p>
</li>
</ol>
<h1 id="向量内积"><a href="#向量内积" class="headerlink" title="向量内积"></a>向量内积</h1><p>在 $\mathbb{R}^n$ 中，向量 $x &#x3D; (x_1, x_2, \dots, x_n)^T$ 和 $y &#x3D; (y_1, y_2, \dots, y_n)^T$ 的内积定义为：<br>$$<br>(x, y) &#x3D; x_1 y_1 + x_2 y_2 + \dots + x_n y_n \tag{1.5}<br>$$</p>
<h1 id="函数内积"><a href="#函数内积" class="headerlink" title="函数内积"></a>函数内积</h1><p>设 $f(x), g(x) \in C[a, b]$，$\rho(x)$ 是 $[a, b]$ 上的权函数，积分<br>$$<br>(f, g) &#x3D; \int_a^b \rho(x) f(x) g(x) , dx<br>$$<br>称为函数 $f(x)$ 与 $g(x)$ 在 $[a, b]$ 上的<strong>内积</strong>。</p>
<hr>
<p>设函数 $ f(x) \in C[a, b] $，定义量<br>$$<br>|| f ||_2 &#x3D; \sqrt{ \int_a^b \rho(x) f^2(x) , dx } &#x3D; \sqrt{ (f, f) }<br>$$</p>
<p>$$<br>|| f ||_2^2&#x3D;(f, f)<br>$$</p>
<p>称为函数 $ f(x) $ 的<strong>欧氏范数</strong>。</p>
<h1 id="最佳平方逼近"><a href="#最佳平方逼近" class="headerlink" title="最佳平方逼近"></a>最佳平方逼近</h1><p><strong>正规方程组</strong><br>$$<br>\sum_{j&#x3D;0}^{n} (\varphi_j, \varphi_k) a_j &#x3D; (f, \varphi_k), \quad (k &#x3D; 0, 1, \ldots, n)<br>$$<br><strong>误差</strong><br>$$<br>|\delta(x)|^2_2 &#x3D; |f(x)|^2_2 - \sum_{k&#x3D;0}^n a_k^* (\varphi_k(x), f(x)).<br>$$</p>
<h3 id="勒让德多项式作为基函数"><a href="#勒让德多项式作为基函数" class="headerlink" title="勒让德多项式作为基函数"></a>勒让德多项式作为基函数</h3><p>当 $ f(x) \in C[-1, 1] $ 时，可以用勒让德多项式 $ {P_k(x)} $ 作为基函数，即<span> $ {g_k(x)} &#x3D; {P_k(x)} $</span>。此时，最佳平方逼近多项式为：</p>
<span>
$$
s_n^*(x) = a_0^* P_0(x) + a_1^* P_1(x) + \dots + a_n^* P_n(x)
$$

</span>

<p>其中，系数 $ a_k^* $ 的计算公式为：<br>$$<br>a_k^* &#x3D; \frac{(P_k, f)}{(P_k, P_k)} &#x3D; \frac{2k+1}{2} \int_{-1}^1 f(x) P_k(x) , dx \quad(k&#x3D;0,1,\cdots,n)<br>$$</p>
<p>则 $ s_n^<em>(x) $ 是使 $ || f(x) - \sum _{k&#x3D;0}^n a_k^</em>  P_k(x) ||_2^2 $ 最小的最佳平方逼近多项式。</p>
<p><strong>此时的平方误差为</strong>：</p>
<span>
$$
\|\delta_n\|_2^2 = \int_{-1}^{1} [f(x)]^2 \, dx - \sum_{k=0}^{n} \frac{2}{2k+1} a_k^{*2}
$$

</span>

<p><u>如果所给的区间不是 $[-1, 1]$，而是一般的有限区间 $[a, b]$，可以通过变量置换将其转化为区间 $[-1, 1]$ 上的情形来处理</u>。</p>
<p>变量置换公式</p>
<p>通过以下变量置换公式，将区间 $[a, b]$ 转化为 $[-1, 1]$：</p>
<p>$$<br>x &#x3D; \frac{a + b}{2} + \frac{b - a}{2} t<br>$$</p>
<h1 id="勒让德（Legendre）多项式"><a href="#勒让德（Legendre）多项式" class="headerlink" title="勒让德（Legendre）多项式"></a>勒让德（Legendre）多项式</h1><ul>
<li>$ P_0(x) &#x3D; 1 $</li>
<li>$ P_1(x) &#x3D; x $</li>
<li>$ P_2(x) &#x3D; \frac{1}{2}(3x^2 - 1)$</li>
<li>$P3(x)&#x3D;\frac{1}{2}(5x^3 - 3x)$</li>
</ul>
<p>在区间 $[-1, 1]$ 上满足正交性：<br>$$<br>\int_{-1}^1 P_n(x) P_m(x) , dx &#x3D;<br>\begin{cases}<br>0, &amp; m \neq n \<br>\frac{2}{2n+1}, &amp; m &#x3D; n<br>\end{cases}<br>$$</p>
<h1 id="切比雪夫Chebyshev多项式"><a href="#切比雪夫Chebyshev多项式" class="headerlink" title="切比雪夫Chebyshev多项式"></a>切比雪夫Chebyshev多项式</h1><p>当区间为 $[-1, 1]$，权函数 $\rho(x) &#x3D; \dfrac{1}{\sqrt{1 - x^2}}$ 时，由序列 ${1, x, \cdots, x^n, \cdots}$ 正交化得到的正交多项式就是 Chebyshev 多项式，它可表为：</p>
<p>$$<br>T_n(x) &#x3D; \cos(n \arccos x) \quad |x| \leq 1<br>$$<br>若令 $x &#x3D; \cos\theta$，则 $T_n(x) &#x3D; \cos n\theta$，$0 \leq \theta \leq \pi$。</p>
<h2 id="Chebyshev-多项式重要性质"><a href="#Chebyshev-多项式重要性质" class="headerlink" title="Chebyshev 多项式重要性质"></a>Chebyshev 多项式重要性质</h2><p><strong>性质 1</strong>  </p>
<p>Chebyshev 多项式 ${T_n(x)}$ 在区间 $[-1, 1]$ 上带权 $\rho(x) &#x3D; \dfrac{1}{\sqrt{1 - x^2}}$ 正交，<br>$$<br>T_k(x) &#x3D; \cos(k \cdot \arccos x)<br>$$</p>
<p>且：</p>
<span>
$$
\int_{-1}^{1} \dfrac{T_n(x)T_m(x)}{\sqrt{1 - x^2}} \, dx = 
\begin{cases} 
0, & n \neq m \\
\dfrac{\pi}{2}, & n = m \neq 0 \\
\pi, & n = m = 0 
\end{cases}
$$

</span>

<p><strong>性质 2 递推关系</strong>  </p>
<span>
$$
\begin{cases}
T_{n+1}(x) = 2xT_n(x) - T_{n-1}(x) & (n = 1, 2, \cdots), \\
T_0(x) = 1, \\
T_1(x) = x.
\end{cases}
$$

</span>

<p>由递推关系可得：</p>
<span>
$$
T_0(x)= 1 \quad \\
T_1(x)= x \quad  \\
T_2(x)= 2x^2 - 1 \quad \\
T_3(x)= 4x^3 - 3x \quad \\
T_4(x) = 8x^4 - 8x^2 + 1 \quad \\
T_5(x) = 16x^5 - 20x^3 + 5x
$$

</span>



<blockquote>
<p>$T_{n+1}$的根为：<br>$$<br>x_k &#x3D; \cos\left(\frac{(2k+1)\pi}{2(n+1)})\right),\quad k&#x3D;0,1,\ldots,n<br>$$</p>
</blockquote>
<h1 id="最小二乘拟合"><a href="#最小二乘拟合" class="headerlink" title="最小二乘拟合"></a>最小二乘拟合</h1><p>若用 ${\varphi_0, \varphi_1, \ldots, \varphi_m}$ 构成一个 $N \times (m+1)$ 的矩阵 $A$，即：</p>
<span>
$$
A = 
\begin{bmatrix}
\varphi_0(x_1) & \varphi_1(x_1) & \cdots & \varphi_m(x_1) \\
\varphi_0(x_2) & \varphi_1(x_2) & \cdots & \varphi_m(x_2) \\
\vdots & \vdots & \ddots & \vdots \\
\varphi_0(x_N) & \varphi_1(x_N) & \cdots & \varphi_m(x_N)
\end{bmatrix}
$$

</span>

<p>引入向量：</p>
<p>$$<br>\alpha &#x3D; (a_0, a_1, \ldots, a_m)^T, \quad Y &#x3D; (y_1, y_2, \ldots, y_N)^T<br>$$</p>
<p><strong>法方程组</strong>可以写成以下矩阵形式：(权w&#x3D;1)<br>$$<br>A^T A \alpha &#x3D; A^T Y<br>$$</p>
<p>由于 $\varphi_0, \varphi_1, \ldots, \varphi_m$ 线性无关，法方程组存在唯一解：</p>
<p>$$<br>\alpha &#x3D; (a_0^* , a_1^* , \ldots, a_m^* )^T<br>$$</p>
<p>从而得到函数：</p>
<p>$$<br>\varphi^* (x) &#x3D; a_0^*  \varphi_0 + a_1^*  \varphi_1 + \cdots + a_m^*  \varphi_m<br>$$</p>
<p>最小平方误差为：</p>
<p>$$<br>\delta^2 &#x3D; || y - \varphi^*  ||^2_2 &#x3D; (y - \varphi^* , y - \varphi^* ) &#x3D; || y ||^2_2 - \sum_{j&#x3D;0}^m a_j^*  (\varphi_j, y)<br>$$</p>
<h3 id="代数多项式拟合"><a href="#代数多项式拟合" class="headerlink" title="代数多项式拟合"></a>代数多项式拟合</h3><p>若取基函数 $\varphi_0 &#x3D; 1, \varphi_1 &#x3D; x, \ldots, \varphi_m &#x3D; x^m$，则相应的法方程组为：</p>
<span>
$$
\begin{bmatrix}
\sum_{i=1}^{N} \omega_i & \sum_{i=1}^{N} \omega_i x_i & \cdots & \sum_{i=1}^{N} \omega_i x_i^m \\
\sum_{i=1}^{N} \omega_i x_i & \sum_{i=1}^{N} \omega_i x_i^2 & \cdots & \sum_{i=1}^{N} \omega_i x_i^{m+1} \\
\vdots & \vdots & \ddots & \vdots \\
\sum_{i=1}^{N} \omega_i x_i^m & \sum_{i=1}^{N} \omega_i x_i^{m+1} & \cdots & \sum_{i=1}^{N} \omega_i x_i^{2m}
\end{bmatrix}
\begin{bmatrix}
a_0 \\
a_1 \\
\vdots \\
a_m
\end{bmatrix}
=
\begin{bmatrix}
\sum_{i=1}^{N} \omega_i y_i \\
\sum_{i=1}^{N} \omega_i x_i y_i \\
\vdots \\
\sum_{i=1}^{N} \omega_i x_i^m y_i
\end{bmatrix}
$$

</span>

<p>即<br>$$<br>A^T\omega A\alpha&#x3D;A^T\omega Y<br>$$<br><span><br>$$<br>A &#x3D;<br>\begin{bmatrix}<br>1 &amp; x_1 &amp; \cdots &amp; x_1^m \<br>1 &amp; x_2 &amp; \cdots &amp; x_2^m  \<br>1 &amp; x_3 &amp; \cdots &amp; x_3^m  \<br>\vdots &amp; \vdots &amp; \ddots &amp; \vdots \<br>1 &amp; x_N &amp; \cdots &amp; x_N^m<br>\end{bmatrix}<br>$$</p>
</span>   
$$
\omega =\begin{bmatrix}
\omega_1& &  &  \\
 & \omega _2 &  &   \\
 &  & \omega_3 &   \\
 &  &  & \ddots \\
 &  &  &  & \omega _n
\end{bmatrix}
$$


<p>求出法方程组的解 $a_0, a_1, \ldots, a_m$，即可得到拟合多项式：<br>$$<br>\varphi(x) &#x3D; a_0 + a_1 x + \cdots + a_m x^m<br>$$<br><span style="color:#FF0000">PS:当$n\geq3$时候，求解法方程时将出现系数矩阵为病态的问题</span></p>
<h1 id="最佳一次一致逼近多项式"><a href="#最佳一次一致逼近多项式" class="headerlink" title="最佳一次一致逼近多项式"></a>最佳一次一致逼近多项式</h1><p>求 $ p_1(x) &#x3D; a_0 + a_1 x $ 的方法</p>
<p><span style="color:#FF0000">首先判断$f’’(x)$不变号</span></p>
</span>

<p>$$<br>a_1 &#x3D; \frac{f(b) - f(a)}{b - a}<br>$$</p>
<p>$$<br>a_0 &#x3D; \frac{1}{2} \left[ f(a) + f(x_2) \right] - \frac{a+x_2}{2} a_1\<br>f’(x_2) &#x3D; a_1<br>$$</p>
<p>由此得 $ f $ 在 $[a, b]$ 上的最佳一次逼近多项式</p>
<p>$$<br>p_1(x) &#x3D; a_0 + a_1 x.<br>$$<br><strong>偏差</strong><br>$$<br>\Delta(f, P_1) &#x3D; \max_{a \leq x \leq b} |f(x) - P_1| \<br>&#x3D;\max_{a \leq x \leq b} |f(a) - P_1(a)| \<br>&#x3D;\max_{a \leq x \leq b} |f(b) - P_1(b)| \<br>&#x3D;\max_{a \leq x \leq b} |f(x_2) - P_1(x_2)|<br>$$</p>
<h1 id="梯形公式"><a href="#梯形公式" class="headerlink" title="梯形公式"></a>梯形公式</h1><p>$$<br>\int _{a}^{b} f(x) dx \approx \frac{(b - a)}{2} \left[ f(a) + f(b) \right]<br>$$</p>
<p><strong>余项公式</strong>:<br>$$<br>R[f] &#x3D;-\frac{1}{12} (b-a)^3 f’’(\xi)<br>$$</p>
<p>$$<br>\xi \in [a,b]<br>$$</p>
<h1 id="复化梯形公式"><a href="#复化梯形公式" class="headerlink" title="复化梯形公式"></a>复化梯形公式</h1><p> <strong>区间划分</strong></p>
<p>$$<br>h &#x3D; \frac{b - a}{n}, \quad x_k &#x3D; a + kh \quad (k &#x3D; 0, \ldots, n)<br>$$<br><strong>整体复化公式</strong><br>$$<br>\begin{aligned}<br>\int_a^b f(x) dx &amp;\approx \sum_{k&#x3D;1}^n \frac{h}{2} [f(x_{k-1}) + f(x_k)] \<br>&amp;&#x3D; \frac{h}{2} \left[ f(a) + 2\sum_{k&#x3D;1}^{n-1} f(x_k) + f(b) \right] \<br>&amp;&#x3D;T_n<br>\end{aligned}<br>$$</p>
<p><strong>4.误差分析</strong><br>$$<br>\begin{aligned}<br>R[f]<br>&amp;&#x3D; -\frac{(b - a)}{12} h^2 f’’(\xi), \quad \xi \in (a, b)<br>\end{aligned}<br>$$</p>
<h1 id="矩形公式"><a href="#矩形公式" class="headerlink" title="矩形公式"></a>矩形公式</h1><p>$$<br>\int _{a}^{b} f(x) dx \approx (b - a) f\left( \frac{a + b}{2} \right)<br>$$</p>
<h1 id="辛普森公式"><a href="#辛普森公式" class="headerlink" title="辛普森公式"></a>辛普森公式</h1><p>$$<br>\int _{a}^{b} f(x) dx \approx \frac{(b - a)}{6} \left[ f(a) + 4f\left( \frac{a + b}{2} \right) + f(b) \right]<br>$$</p>
<p><strong>余项公式</strong>:<br>$$<br>R[f] &#x3D;-\frac{1}{2880} (b-a)^5 f^{(4)}(\xi)<br>$$</p>
<p>$$<br>\xi \in [a,b]<br>$$</p>
<h1 id="复化Simpson公式"><a href="#复化Simpson公式" class="headerlink" title="复化Simpson公式"></a>复化Simpson公式</h1><p><strong>1. 区间划分</strong></p>
<p>$$<br> h &#x3D; \frac{b - a}{n}<br>$$</p>
<p>$$<br> x_k &#x3D; a + kh \quad (k &#x3D; 0, \ldots, n)<br>$$</p>
<p><strong>2. 整体复化公式</strong><br>$$<br>\begin{aligned}<br>\int_a^b f(x) dx &amp;\approx \frac{h}{6} \left[ f(a) + 4\sum_{k&#x3D;0}^{n-1} f\left(x_{k+\frac{1}{2}}\right) + 2\sum_{k&#x3D;1}^{n-1} f(x_k) + f(b) \right] \<br>&amp;&#x3D; S_n<br>\end{aligned}<br>$$</p>
<p><strong>3.误差分析</strong><br>$$<br>R[f] &#x3D; -\frac{b - a}{2880} h^4 f^{(4)}(\xi), \quad \xi \in (a,b)<br>$$</p>
<h1 id="代数精度"><a href="#代数精度" class="headerlink" title="代数精度"></a>代数精度</h1><p>欲使求积公式有 $m$ 次代数精度，需满足它对 $f(x) &#x3D; 1, x, x^2, \ldots, x^m$ 都能准确成立：<br>$$<br>\sum_{k&#x3D;0}^n A_k x_k^\alpha &#x3D; \int_a^b x^\alpha dx \quad (\alpha &#x3D; 0,1,2,\ldots,m)<br>$$<br>具体表现为：</p>
<span>
$$
\begin{aligned}
\sum_{k=0}^n A_k &= b - a \\
\sum_{k=0}^n A_k x_k &= \frac{1}{2}(b^2 - a^2) \\
\sum_{k=0}^n A_k x_k^2 &= \frac{1}{3}(b^3 - a^3) \\
&\vdots \\
\sum_{k=0}^n A_k x_k^m &= \frac{1}{m+1}(b^{m+1} - a^{m+1})
\end{aligned}
$$

</span>

<h1 id="插值型的求积公式"><a href="#插值型的求积公式" class="headerlink" title="插值型的求积公式"></a>插值型的求积公式</h1><p><strong>最终得到插值型求积公式：</strong><br>$$<br>I _{ n } &#x3D; \sum _{ k&#x3D;0 }^{ n } A _{ k } f ( x _{ k } )<br>$$</p>
<p>求积系数：</p>
<span>
$$
A _{ k } = \int _{ a }^{ b } l _{ k } ( x ) dx=\int _{ a }^{ b }\prod_{\substack{j=0 \\ j \neq k}}^{n} \frac{x - x_j}{x_k - x_j} dx \quad (k = 0,1,\ldots,n) \\
$$
</span>

<p><strong>余项公式</strong></p>
<p>插值型求积公式的余项为：<br>$$<br>R[f] &#x3D; I - I_n &#x3D; \int_a^b \frac{f^{(n+1)}(\xi)}{(n+1)!} \omega_{n+1}(x) dx<br>$$<br>式中 $\xi$ 与变量 $x$ 有关，<br>$$<br>\omega_{n+1}(x) &#x3D; (x - x_0)(x - x_1) \cdots (x - x_n)<br>$$</p>
<h1 id="高斯求积公式"><a href="#高斯求积公式" class="headerlink" title="高斯求积公式"></a>高斯求积公式</h1><p>构造具有2n+1次代数精度的求积公式</p>
<p>$$<br>\int_a^b \rho(x) f(x) dx \approx \sum_{k&#x3D;0}^{n} A_k f(x_k)<br>$$</p>
<ul>
<li><p>节点：$x_0, \ldots, x_n$（共n+1个）</p>
</li>
<li><p>系数：$A_0, \ldots, A_n$（共n+1个）</p>
<p>二者都作为待定系数</p>
</li>
</ul>
<p><strong>精度条件方程</strong>：<br>$$<br>\int \rho(x) \cdot 1 dx &#x3D; \sum_{k&#x3D;0}^{n} A_k \<br>\int \rho(x) x dx &#x3D; \sum_{k&#x3D;0}^{n} A_k x_k \<br>\vdots \<br>\int \rho(x) x^{2n+1} dx &#x3D; \sum_{k&#x3D;0}^{n} A_k x_k^{2n+1}<br>$$</p>
<p><strong>代数精度</strong>：</p>
<blockquote>
<p>当取$f(x)&#x3D;1,x,x^2,\ldots,x^{2n+1}$代入可求解，得到的公式具有<strong>2n+1次代数精度</strong></p>
</blockquote>
<ul>
<li>节点称为<strong>Gauss点</strong></li>
<li>公式称为<strong>Gauss型求积公式</strong></li>
</ul>
<h3 id="高斯求积公式的余项"><a href="#高斯求积公式的余项" class="headerlink" title="高斯求积公式的余项"></a>高斯求积公式的余项</h3><p>$$<br>R_n[f] &#x3D; \int_a^b \rho(x) f(x) , dx - \sum_{k&#x3D;0}^{n} A_k f(x_k) \<br> &#x3D; \frac{f^{(2n+2)}(\eta)}{(2n+2)!} \int_a^b \omega_{n+1}^2(x) \rho(x) , dx, \quad \eta \in [a, b]<br>$$</p>
<h2 id="高斯-勒让德求积公式"><a href="#高斯-勒让德求积公式" class="headerlink" title="高斯-勒让德求积公式"></a>高斯-勒让德求积公式</h2><p>(1) 一个节点时  <strong>$n&#x3D;0$</strong><br>$$<br>\int_{-1}^{1} f(x)dx \approx 2f(0).<br>$$</p>
<p>(2) 两个节点时 <strong>$n&#x3D;1$</strong><br>$$<br>\int_{-1}^{1} f(x)dx \approx<br>f\left(-\frac{1}{\sqrt{3}}\right)+<br>f\left(\frac{1}{\sqrt{3}}\right).<br>$$</p>
<p>(3) 三个节点时 <strong>$n&#x3D;2$</strong><br>$$<br>\int_{-1}^{1} f(x)dx \approx<br>\frac{5}{9}f\left(-\sqrt{\frac{3}{5}}\right)+<br>\frac{8}{9}f(0)+<br>\frac{5}{9}f\left(\sqrt{\frac{3}{5}}\right).<br>$$</p>
<h1 id="高斯-切比雪夫求积公式"><a href="#高斯-切比雪夫求积公式" class="headerlink" title="高斯-切比雪夫求积公式"></a>高斯-切比雪夫求积公式</h1><p>可以得到$n+1$点的Gauss型求积公式：<br>$$<br>\int_{-1}^{1} \frac{f(x)}{\sqrt{1-x^2}} dx \approx \frac{\pi}{n+1} \sum_{k&#x3D;0}^{n} f\left(\cos\frac{2k+1}{2(n+1)}\pi\right) \<br> k&#x3D;0,1,\ldots,n<br>$$</p>
<ul>
<li><p>$n&#x3D;1$<br>$$<br>\int_{-1}^{1} \frac{f(x)}{\sqrt{1-x^2}} dx \approx \frac{\pi}{2} f\left(-\frac{\sqrt{2}}{2}\right) + \frac{\pi}{2} f\left(\frac{\sqrt{2}}{2}\right)<br>$$</p>
</li>
<li><p>$n&#x3D;2$<br>$$<br>\int_{-1}^{1} \frac{f(x)}{\sqrt{1-x^2}} dx \approx \frac{\pi}{3} f\left(\cos(\frac{5}{6}\pi)\right) + \frac{\pi}{3} f\left(\cos(\frac{1}{2}\pi)\right)</p>
<ul>
<li>\frac{\pi}{3} f\left(\cos(\frac{1}{6}\pi)\right)<br>$$</li>
</ul>
</li>
</ul>
<h1 id="道立特分解法（Doolittle-Factorization）"><a href="#道立特分解法（Doolittle-Factorization）" class="headerlink" title="道立特分解法（Doolittle Factorization）"></a>道立特分解法（Doolittle Factorization）</h1><p>通过比较法直接导出L和U的计算公式。</p>
<p><img src="/blog/../image/Snipaste_2025-04-07_20-28-30-17498878480523.png"></p>
<p><strong>方法备注：</strong></p>
<ol>
<li><span style="color:#FF0000">L的对角线元素为1，U的第一行元素$u_{1j}&#x3D;a_{1j}$</span></li>
<li>然后求L的第一列元素，随后求U的第二列，然后L，随后U，交替往复。<strong>（瞪眼法）</strong></li>
</ol>
<h1 id="追赶法"><a href="#追赶法" class="headerlink" title="追赶法"></a>追赶法</h1><span>
$$
A=\begin{bmatrix}b_1&c_1\\a_2&b_2&c_2\\&\ddots&\ddots&\ddots\\&&a_{n-1}&b_{n-1}&c_{n-1}\\&&&a_n&b_n\end{bmatrix}=\begin{bmatrix}\alpha_1\\r_2&\alpha_2\\&\ddots&\ddots\\&&r_n&\alpha_n\end{bmatrix}\begin{bmatrix}1&\beta_1\\&1&\ddots\\&&\ddots&\beta_{n-1}\\&&&1\end{bmatrix}
$$
</span>

<p>并且满足</p>
<ol>
<li><p>$a_i \ne 0\ (i &#x3D; 2, 3, \dots, n),\ c_i \ne 0\ (i &#x3D; 1, 2, \dots, n - 1);$</p>
</li>
<li><p>$|b_1| &gt; |c_1|,\ |b_i| \ge |a_i| + |c_i|\ (i &#x3D; 2, 3, \dots, n - 1),\ |b_n| &gt; |a_n|.$</p>
</li>
</ol>
<p>$$<br>\boxed{<br>\text{条件1保证方程组不能降阶，条件2保证三角分解可做到底。}<br>}<br>$$</p>
<p>$$<br>r_i&#x3D;a_i<br>$$</p>
<p>$$<br>\beta_1&#x3D;\frac{c_1}{b_1}<br>$$</p>
<p>$$<br>\beta_i&#x3D;\frac{c_i}{b_i-a_i \beta_{i-1}}<br>$$</p>
<p>$$<br>\alpha_1&#x3D;b_{1}\quad \<br>\alpha_{i}&#x3D;b_{i}-a_{i}\beta_{i-1}<br>$$</p>
<h1 id="Jacobi-雅可比-迭代法"><a href="#Jacobi-雅可比-迭代法" class="headerlink" title="Jacobi(雅可比)迭代法"></a>Jacobi(雅可比)迭代法</h1><p><strong>Jacobi迭代公式（分量形式）</strong></p>
<p>第i分量迭代式</p>
<p>$$<br>x_i^{(k+1)} &#x3D; \frac{1}{a_{ii}} \left( b_i - \sum_{\substack{j&#x3D;1 \ j \neq i}}^{n} a_{ij}x_j^{(k)} \right)<br>$$</p>
<ol>
<li>第一分量：$x_1 &#x3D; \frac{1}{a_{11}}(-a_{12}x_2 - \cdots - a_{1n}x_n + b_1)$</li>
<li>第二分量：$x_2 &#x3D; \frac{1}{a_{22}}(-a_{21}x_1 - \cdots - a_{2n}x_n + b_2)$</li>
<li>第n分量：$x_n &#x3D; \frac{1}{a_{nn}}(-a_{n1}x_1 - \cdots - a_{nn-1}x_{n-1} + b_n)$</li>
</ol>
<p><strong>Jacobi迭代的矩阵形式</strong></p>
<p><strong>矩阵分解形式</strong></p>
<p><img src="/blog/../image/Snipaste_2025-04-06_16-16-19-17498920634395.png"></p>
<p>$$<br>A\vec{x} &#x3D; \vec{b} \Leftrightarrow (D + L + U)\vec{x} &#x3D; \vec{b}<br>$$</p>
<p>$$<br>\begin{gathered}<br>\boldsymbol{L}&#x3D;\begin{bmatrix}0\a_{21}&amp;0\\vdots&amp;\ddots\\vdots&amp;&amp;\ddots\a_{n-1}&amp;\cdots&amp;\cdots&amp;a_{n,n-1}&amp;0\end{bmatrix}<br>U&#x3D;\begin{bmatrix}<br>0&amp;a_{12}&amp;\cdots&amp;a_{1n}\&amp;\ddots&amp;\ddots&amp;\vdots\&amp;&amp;\ddots&amp;a_{n-1,n}\<br>&amp;&amp;&amp;0<br>\end{bmatrix}<br>\quad<br>\boldsymbol{D}&#x3D;\begin{bmatrix}a_{11}\&amp;a_{22}\&amp;&amp;\ddots\&amp;&amp;&amp;\ddots\&amp;&amp;&amp;&amp;a_{nn}\end{bmatrix}\quad\end{gathered}<br>$$<br><span style="color:#FF0000">Jacobi迭代阵</span><br>$$<br>B_J&#x3D;-D^{-1}(L + U)<br>$$</p>
<h1 id="Gauss-Seidel迭代法"><a href="#Gauss-Seidel迭代法" class="headerlink" title="Gauss-Seidel迭代法"></a>Gauss-Seidel迭代法</h1><p><strong>迭代公式</strong></p>
<ol>
<li>第1分量： $x_1^{(k+1)} &#x3D; \frac{1}{a_{11}} \left( -a_{12}x_2^{(k)} - a_{13}x_3^{(k)} - \cdots - a_{1n}x_n^{(k)} + b_1 \right)$</li>
<li>第2分量： $x_2^{(k+1)} &#x3D; \frac{1}{a_{22}} \left( -a_{21}x_1^{(k+1)} - a_{23}x_3^{(k)} - \cdots - a_{2n}x_n^{(k)} + b_2 \right)$</li>
<li>第3分量： $x_3^{(k+1)} &#x3D; \frac{1}{a_{33}} \left( -a_{31}x_1^{(k+1)} - a_{32}x_2^{(k+1)} - \cdots - a_{3n}x_n^{(k)} + b_3 \right)$</li>
<li>第n分量：  $x_n^{(k+1)} &#x3D; \frac{1}{a_{nn}} \left( -a_{n1}x_1^{(k+1)} - \cdots - a_{n,n-1}x_{n-1}^{(k+1)} + b_n \right)$</li>
</ol>
<p><span style="color:#FF0000">Gauss-Seidel迭代阵</span><br>$$<br>B &#x3D; -(D + L)^{-1}U<br>$$</p>
<hr>
<p><strong>定理</strong></p>
<p>设有方程组</p>
<p>$$<br>x &#x3D; Bx + f<br>$$</p>
<p>对于任意初始向量 $x^{(0)}$ 及任意 $f$，解此方程组的迭代法</p>
<p>$$<br>x^{(k+1)} &#x3D; Bx^{(k)} + f<br>$$</p>
<p>收敛的充要条件是</p>
<p>$$<br>\rho(B) &lt; 1<br>$$</p>
<p>当$\rho(B) &lt; 1$时，迭代过程收敛，且$\rho(B) $越小，迭代收敛越快。</p>
<p><strong>定义</strong></p>
<p>称 $R(B) &#x3D; -\ln \rho(B)$ 为迭代法的<span style="color:#FF0000">收敛速度</span></p>
<p><strong>定理（充分条件）</strong></p>
<p>若存在一个矩阵范数使得 $|B| &#x3D; q &lt; 1$，则迭代收敛，且有下列误差估计：</p>
<p>$$<br>|\vec{x}^* - \vec{x}^{(k)}| \leq \frac{q}{1-q} |\vec{x}^{(k)} - \vec{x}^{(k-1)}|<br>$$</p>
<p>$$<br>|\vec{x}^* - \vec{x}^{(k)}| \leq \frac{q^k}{1-q} |\vec{x}^{(1)} - \vec{x}^{(0)}|<br>$$</p>
<p><strong>注</strong>：因 $\rho(B) \leq |B| &lt; 1$，故收敛性得证。</p>
<hr>
<p><strong>定理（充分条件）：</strong></p>
<p>若A为严格对角占优阵，则解$A \vec x&#x3D; \vec b$的Jacobi和Gauss-Seidel迭代均收敛。</p>
<h1 id="松弛法"><a href="#松弛法" class="headerlink" title="松弛法"></a>松弛法</h1><p>$$<br>x_i^{(k+1)} &#x3D; &#x3D;x_i^{(k)} + \frac{\omega }{a_{ii}}\left [b_i - \sum_{j&lt;i} a_{ij}x_j^{(k+1)} - \sum_{j \geq i} a_{ij}x_j^{(k)} \right ]<br>$$</p>
<p><strong>定理</strong>：设$A$可逆，且$a_{ii} \neq 0$，则松弛法从任意$\vec{x}^{(0)}$出发对某个$\omega$收敛的充要条件为： $\rho(H_\omega) &lt; 1$ 其中<br>$$<br>H_\omega &#x3D; (D + \omega L)^{-1} \left[ (1 - \omega) D - \omega U \right]<br>$$</p>
<p>为迭代矩阵</p>
<p><strong>定理</strong>（必要条件）</p>
<p>设$A$可逆，且$a_{ii} \neq 0$，则松弛法从任意$\vec{x}^{(0)}$出发对某个$\omega$收敛$\Rightarrow 0&lt; \omega&lt;2 $</p>
<hr>
<p><strong>定理（Ostrowski-Reich充分条件）</strong></p>
<p><strong>设</strong> $A$ 为对称正定矩阵，且松弛因子满足 $0 &lt; \omega &lt; 2$，<br><strong>则</strong> 松弛法从任意初始向量 $\vec{x}^{(0)}$ 出发均收敛。</p>
<h1 id="不动点迭代法"><a href="#不动点迭代法" class="headerlink" title="不动点迭代法"></a>不动点迭代法</h1><h3 id="等价变换"><a href="#等价变换" class="headerlink" title="等价变换"></a>等价变换</h3><p>$$<br>f(x) &#x3D; 0 \quad \longleftrightarrow \quad x &#x3D; \varphi(x)<br>$$</p>
<p>$$<br>f(x) &#x3D; 0 \text{ 的根} \quad \longleftrightarrow \quad \varphi(x) \text{ 的不动点}<br>$$</p>
<p>从一个初值 $x_0$ 出发，计算 $x_1 &#x3D; \varphi(x_0)$, $x_2 &#x3D; \varphi(x_1)$, …,<br>若 $ {x_k }_{k&#x3D;0}^{\infty}$ 收敛，即存在 $x^* $ 使得<br>$$<br>\lim _{k \to \infty} x_k &#x3D; x^*<br>$$</p>
<p>且 $\varphi$ 连续，则由<br>$$<br>\lim_{k \to \infty} x_{k+1} &#x3D; \lim_{k \to \infty} \varphi(x_k)<br>$$<br>可知 $x^*  &#x3D; \varphi(x^* )$，即 $x^*$ 是 $\varphi$ 的不动点，也就是 $f &#x3D; 0$ 的根。</p>
<blockquote>
<p>迭代法是一种逐次逼近法，其基本思想是将隐式方程归结为一组显式的计算公式，即说，迭代过程实际上是一个逐步显示化的过程。</p>
</blockquote>
<h2 id="迭代法收敛定理"><a href="#迭代法收敛定理" class="headerlink" title="迭代法收敛定理"></a>迭代法收敛定理</h2><blockquote>
<p><strong>定理1</strong> 如果迭代函数 $\varphi(x) \in C[a,b]$，并且  </p>
<ol>
<li>$\forall x \in [a,b]$，都有 $\varphi(x) \in [a,b]$，  </li>
<li>$\exists 0 \leq \text{常数 } L &lt; 1$，使得 $\forall x,y \in [a,b]$，都有</li>
</ol>
<p>$$<br> |\varphi(x) - \varphi(y)| \leq L |x - y|;<br>$$</p>
<p>那么 $\varphi(x)$ 在 $[a,b]$ 上存在唯一的不动点 $x^*$。</p>
<p><strong>定理2</strong> 考虑方程 $x &#x3D; \varphi(x)$, $\varphi(x) \in C^1[a, b]$，若：</p>
<p>(I) 当 $x \in [a, b]$ 时，$\varphi(x) \in [a, b]$；</p>
<p>(II) 存在$0 \leq L &lt; 1$，使得 $|\varphi’(x)| \leq L &lt; 1$ 对 $\forall x \in [a, b]$ 成立。</p>
<p>则任取 $x_0 \in [a, b]$，由 $x_{k+1} &#x3D; \varphi(x_k)$ 得到的序列 ${x_k}_{k&#x3D;0}^{\infty}$ 收敛于 $\varphi(x)$ 在 $[a, b]$ 上的<strong>唯一</strong>不动点，并且有误差估计式：</p>
<p>$$<br>|x^* - x_k| \leq \frac{1}{1 - L} |x_{k+1} - x_k|<br>$$</p>
<p>$$<br>|x^* - x_k| \leq \frac{L^k}{1 - L} |x_1 - x_0| \quad (k &#x3D; 1, 2, \dots)<br>$$</p>
<p>并且存在极限：</p>
<p>$$<br>\lim_{k \to \infty} \frac{x^* - x_{k+1}}{x^* - x_k} &#x3D; \varphi’(x^*)<br>$$</p>
</blockquote>
<h2 id="迭代法的收敛阶"><a href="#迭代法的收敛阶" class="headerlink" title="迭代法的收敛阶"></a>迭代法的收敛阶</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>设迭代 $x_{k+1} &#x3D; \varphi(x_k)$ 收敛到 $\varphi(x)$ 的不动点 $x^*$。</p>
<p>设 $e_k &#x3D; x_k - x^*$，若</p>
<p>$$<br>\lim_{k \to \infty}  \frac{e_{k+1}}{e_k^p} &#x3D; C<br>$$</p>
<p>则称该迭代为 <strong>$p$ 阶收敛</strong>，其中 $C$ 称为渐近误差常数（$C \neq0$）。</p>
<blockquote>
<ul>
<li>$p &#x3D; 1$ 时称作<strong>线性收敛</strong></li>
<li>$p &gt; 1$ 时称作<strong>超线性收敛</strong></li>
<li>p &#x3D; 2 时称作<strong>平方收敛</strong></li>
</ul>
</blockquote>
<h3 id="定理"><a href="#定理" class="headerlink" title="定理"></a>定理</h3><p>设 $x^* $ 为方程 $x &#x3D; \varphi(x)$ 的不动点，若 $\varphi \in C^p(R(x^*))$ 且 $p \geq 2$；</p>
<p>$$<br>\varphi’(x^* ) &#x3D; \dots &#x3D; \varphi^{(p-1)}(x^* ) &#x3D; 0, \quad \varphi^{(p)}(x^* ) \neq 0,<br>$$</p>
<p>则 $x_{k+1} &#x3D; \varphi(x_k)$ 在 $R(x^*)$ 内 $p$ 阶收敛。</p>
<h3 id="定理-1"><a href="#定理-1" class="headerlink" title="定理"></a>定理</h3><p>设 $x^* $ 为方程 $x &#x3D; \varphi(x)$ 的不动点，若 $\varphi \in C^p(R(x^*))$ 且 $p \geq 2$；</p>
<p>$$<br>\varphi’(x^* ) &#x3D; \dots &#x3D; \varphi^{(p-1)}(x^* ) &#x3D; 0, \quad \varphi^{(p)}(x^* ) \neq 0,<br>$$</p>
<p>则 $x_{k+1} &#x3D; \varphi(x_k)$ 在 $R(x^*)$ 内 $p$ 阶收敛。</p>
<p><strong>证明</strong>：<br>$$<br>x_{k+1} &#x3D; \varphi(x_k) &#x3D; \varphi(x^* ) + \varphi’(x^* ) (x_k - x^* ) + \dots + \frac{\varphi^{(p)}(\xi_k)}{p!} (x_k - x^* )^p<br>$$</p>
<p>其中 $\xi_k \to x^<em>$ as $k \to \infty$，极限值为 $C$。<br>$$<br>\lim <em>{k\rightarrow\infty}\frac{e</em>{k+1}}{e_k^p}&#x3D; \lim <em>{k\rightarrow\infty}\frac{x</em>{k+1}-x^{</em>}}{\left(x_{k}-x^{<em>}\right)^{p}}&#x3D;\frac{\varphi^{(p)}\left(x^{</em>}\right)}{p !}<br>$$</p>
<h1 id="牛顿法"><a href="#牛顿法" class="headerlink" title="牛顿法"></a>牛顿法</h1><h3 id="牛顿迭代法"><a href="#牛顿迭代法" class="headerlink" title="牛顿迭代法"></a>牛顿迭代法</h3><p>牛顿迭代法是一种特殊的不动点迭代法，其计算公式为：</p>
<p>$$<br>x_{k+1} &#x3D; x_k - \frac{f(x_k)}{f’(x_k)}, \quad k &#x3D; 0, 1, 2, \cdots<br>$$</p>
<p>其迭代函数为：</p>
<p>$$<br>\varphi(x) &#x3D; x - \frac{f(x)}{f’(x)}<br>$$<br><strong>牛顿迭代法的收敛速度</strong></p>
<p>当 $f(x^* ) &#x3D; 0, f’(x^* ) \neq 0$ 时，容易证明，$\varphi’(x^* ) &#x3D; 0, \varphi’’(x^* ) &#x3D;  \frac{f’’(x^* )}{f’(x^* )}$，由定理 7.4 知，牛顿迭代法是平方收敛的，且</p>
<p>$$<br>\lim_{k \to \infty} \frac{e_{k+1}}{e_k^2} &#x3D; \frac{f’’(x^* )}{2f’(x^* )}<br>$$</p>
<p>其中，$e_k &#x3D; x_k - x^*$ 为误差。</p>
<h3 id="简化牛顿法"><a href="#简化牛顿法" class="headerlink" title="简化牛顿法"></a>简化牛顿法</h3><p>$$<br>x_{k+1} &#x3D; x_k - \frac{f(x_k)}{f’(x_0)}<br>$$</p>
<h3 id="牛顿下山法："><a href="#牛顿下山法：" class="headerlink" title="牛顿下山法："></a>牛顿下山法：</h3><p>$$<br>x_{k+1} &#x3D; x_k - \lambda \frac{f(x_k)}{f’(x_k)}, \quad k &#x3D; 0, 1, 2, \dots<br>$$</p>
<p>其中下山因子 $\lambda &#x3D; 1$，逐次减半直至满足 $|f(x_{k+1})| &lt; |f(x_k)|$。</p>
<h3 id="牛顿法的重根情形"><a href="#牛顿法的重根情形" class="headerlink" title="牛顿法的重根情形"></a>牛顿法的重根情形</h3><p><strong>方法1</strong>（知道重数）<br>$$<br>x_{k+1} &#x3D; x_k - m \frac{f(x_k)}{f’(x_k)}, \quad k &#x3D; 0, 1, 2, \dots<br>$$<br><strong>方法2</strong><br>$$<br>x_{k+1} &#x3D; x_k - \frac{f(x_k) f’(x_k)}{[f’(x_k)]^2 - f(x_k) f’’(x_k)}, \quad (k &#x3D; 0, 1, 2, \dots)<br>$$</p>
<h2 id="弦截法"><a href="#弦截法" class="headerlink" title="弦截法"></a>弦截法</h2><p>$$<br>x_{k+1} &#x3D; x_k -  \frac{f(x_k)}{f(x_k)-f(x_{k-1})} (x_k-x_{k-1}), \quad k &#x3D;  1, 2, \dots<br>$$</p>
<blockquote>
<p><strong>欧拉法</strong><br>$$<br>y_{n+1} &#x3D; y_n + h f(x_n, y_n)<br>$$<br><strong>隐式欧拉法</strong><br>$$<br>y_{n+1} &#x3D; y_n + h f(x_{n+1}, y_{n+1}) \quad (n &#x3D; 0, \dots, N-1)<br>$$</p>
<p><strong>改进欧拉法</strong><br>$$<br>y_{n+1} &#x3D; y_n + \frac{h}{2} \left[ f(x_n, y_n) + f(x_{n+1}, y_n + h f(x_n, y_n)) \right]<br>$$</p>
<p><strong>四阶经典R-K方法</strong><br>$$<br>y_{n+1} &#x3D; y_n + \frac{h}{6} (K_1 + 2K_2 + 2K_3 + K_4)<br>$$</p>
<p>$$<br>K_1 &#x3D; f(x_n, y_n)<br>$$</p>
<p>$$<br>K_2 &#x3D; f(x_n + \frac{h}{2}, y_n + \frac{h}{2} K_1)<br>$$</p>
<p>$$<br>K_3 &#x3D; f(x_n + \frac{h}{2}, y_n + \frac{h}{2} K_2)<br>$$</p>
<p>$$<br>K_4 &#x3D; f(x_n + h, y_n + h K_3)<br>$$</p>
<p><strong>稳定区间</strong></p>
<ol>
<li>欧拉法</li>
</ol>
 <div>


<p>$$<br> E(h\lambda)&#x3D;1+h\lambda \<br> -2 &lt; \lambda h &lt; 0<br>$$</p>
 </div>

<ol start="2">
<li>改进欧拉法</li>
</ol>
 <div>


<p>$$<br> E(h\lambda)&#x3D;1 + h\lambda + \frac{(h\lambda)^2}{2} \<br> -2 &lt; h\lambda &lt; 0<br>$$</p>
 </div>

<ol start="3">
<li>4阶经典龙格库塔方法</li>
</ol>
<p>$$<br> E(h\lambda) &#x3D; 1 + h\lambda + \frac{(h\lambda)^2}{2!} + \frac{(h\lambda)^3}{3!} + \frac{(h\lambda)^4}{4!}.<br>$$</p>
<p>$$<br> -2.78 &lt; h\lambda &lt; 0<br>$$</p>
</blockquote>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>数值分析</tag>
      </tags>
  </entry>
  <entry>
    <title>机电一体化分析与建模（二）</title>
    <url>/blog/2025/06/29/%E6%9C%BA%E7%94%B5%E4%B8%80%E4%BD%93%E5%8C%96%E5%88%86%E6%9E%90%E4%B8%8E%E5%BB%BA%E6%A8%A1%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="第五章-微机测控系统设计"><a href="#第五章-微机测控系统设计" class="headerlink" title="第五章 微机测控系统设计"></a>第五章 微机测控系统设计</h1><ol>
<li><strong>微机测控系统的硬件</strong></li>
</ol>
<p>按各部分在系统中的作用,该系统可分为</p>
<ul>
<li><strong>主机</strong></li>
<li><strong>输入输出通道</strong>：过程输入输出通道，又称过程通道。是微机与外部物理世界建立信息传递与转换的<u>链接渠道</u></li>
<li>常规外部设备</li>
<li><strong>接口电路：在过程通道与外部设备间，接口电路起着媒介作用，使主机与过程通道及外部</strong><br><strong>设备之间的<u>信息交换</u>得以顺利实现</strong></li>
<li>运行操作台</li>
<li>系统总线等</li>
</ul>
<ol start="2">
<li><p><strong>测控系统软件组成</strong></p>
<p>软件通常分为两大类，一类是<u>系统软件</u>，另一类为<u>应用软件</u></p>
</li>
<li><p><strong>模拟量输入通道的一般组成</strong></p>
<p>一般由<u>信号调理电路</u>、<u>多路转换器</u>、<u>放大器</u>和<u>模／数转换器</u>组成</p>
</li>
</ol>
<p><img src="/blog/image/Snipaste_2025-06-29_14-52-43.png"></p>
<p>显然，该通道中的<span style="color:#FF0000">核心</span>是模&#x2F;数转换器，也就是<strong>A&#x2F;D转换器</strong><br>通常把模拟量输入通道称为<strong>A&#x2F;D通道</strong></p>
<blockquote>
<p><strong>采样-保持器作用 &#x2F; 为什么使用采样-保持器 &#x2F; 采样-保持器原理？</strong></p>
<p>当被测信号变化较快时,要求通道也能及时反应,而模<u>&#x2F;数转换需要一定的时间才能完成</u>｡</p>
<p>如在转换过程中模拟输入发生显著变化,使得转换得到的数字量不能真正代表发出命令的那一瞬间所要转换的数据电平｡为了克服这一缺点,在模&#x2F;数转换器前面往往采用一个采样-保持器｡</p>
<p>（<strong>PPT版</strong>：当某一通道进行A&#x2F;D转换时，由于A&#x2F;D转换需要一定的时间，如果输入信号变化较快，就会引起较大的转换误差。为了保证A&#x2F;D转换的精度，需要应用采样保持器。）</p>
<p><strong>采样-保持器对变化的模拟信号进行快速“采样”,并在转换过程中“保持”该信号｡</strong></p>
</blockquote>
<blockquote>
<p><strong>放大器作用？</strong></p>
<p>为使模&#x2F;数转换达到应有的<strong>精度</strong>,需将各路传感器来的信号放大到模&#x2F;数转换器所要求的输入电平值(如满度为10V或5V)</p>
<ul>
<li><p>当所用的传感器很多时,可多路共用一个放大器｡</p>
</li>
<li><p>如果各路信号要求的放大倍数不同,则可设计一个可编程的放大器,由计算机控制它的闭环增益｡</p>
</li>
</ul>
</blockquote>
<blockquote>
<p>采样保持器和放大器背诵时都关于<strong>精度</strong></p>
</blockquote>
<h2 id="多路转换器"><a href="#多路转换器" class="headerlink" title="多路转换器"></a>多路转换器</h2><p><span style="color:#FF0000">多路转换器又称多路开关，利用它可将各个输入信号<strong>依次</strong>或<strong>随机</strong>地接到公用放大器或模／数转换器上  </span></p>
<ul>
<li>应用</li>
</ul>
<p>目前，计算机控制系统使用的多路开关种类很多，(<strong>多为集成多路电子开关</strong>)并具有不同的功能和用途。</p>
<p>如集成电路芯片CD4051(双向、单端、8路)、CD4052(单向、双端、4路)、AD7506(单向、单端、16路)等。</p>
<blockquote>
<p><strong>双向</strong>:就是芯片既可以实现多到一的切换，也可以完成一到多的切换；</p>
<p><strong>单向</strong>:只能完成多到一的切换。<br><strong>双端</strong>:是指芯片内的一对开关同时动作，从而完成<strong>差动输入信号</strong>的切换，以满足抑制共模干扰的需要。</p>
</blockquote>
<h3 id="CD4051结构原理"><a href="#CD4051结构原理" class="headerlink" title="CD4051结构原理"></a>CD4051结构原理</h3><p><img src="/blog/image/Snipaste_2025-06-29_15-51-48.png"></p>
<ul>
<li><p>CD4051就是一种单端8通道多路开关，它带有<strong>三个输入端A、B、C</strong>，和一个<strong>禁止输入端INH。</strong></p>
</li>
<li><p>从A、B、C输入的信号来选择8个通道中的一个。</p>
</li>
<li><p>当INH&#x3D;1时，通道断开，禁止模拟量输入；当INH&#x3D;0时，通道接通，允许模拟量输入，通过改变输入端C、B、A的值，就可以选通S0~S7中的一路通道。</p>
</li>
</ul>
<p><strong>CD4051工作过程</strong></p>
<ul>
<li>INH输入为0时，译码器正常工作，此时若<br>C&#x3D;0, B&#x3D;0, A&#x3D;0, 译码器Y0端输出1，通道S0接通。<br>C&#x3D;0, B&#x3D;0, A&#x3D;1, 译码器Y1端输出1，通道S1接通。<br>C&#x3D;0, B&#x3D;1, A&#x3D;0, 译码器Y2端输出1，通道S2接通。<br>C&#x3D;0, B&#x3D;1, A&#x3D;1, 译码器Y3端输出1，通道S3接通。<br>C&#x3D;1, B&#x3D;0, A&#x3D;0, 译码器Y4端输出1，通道S4接通。<br>C&#x3D;1, B&#x3D;0, A&#x3D;1, 译码器Y5端输出1，通道S5接通。<br>C&#x3D;1, B&#x3D;1, A&#x3D;0, 译码器Y6端输出1，通道S6接通。<br>C&#x3D;1, B&#x3D;1, A&#x3D;1, 译码器Y7端输出1，通道S7接通。</li>
</ul>
<blockquote>
<p><span style="color:#FF0000"><strong>多路开关注意事项</strong></span>(简答题)</p>
<ul>
<li><p>在自动数据采集中，应选用“<strong>先断后通</strong>”的多路开关，否则，就会发生<strong>两个通道短接</strong>的现象，严重时会损坏信号源或多路开关自身。  </p>
</li>
<li><p>然而，在程控增益放大器中，若用多路开关来改变集成运算放大器的反馈电阻，以改变放大器的增益，就不宜选用“先断后通”的多路开关。否则，放大器就会出现<strong>开环状态</strong>。放大器的开环增益极高，易破坏电路的正常工作，甚至损坏元器件，一般应予避免</p>
</li>
</ul>
<table>
<thead>
<tr>
<th><strong>应用场景</strong></th>
<th>对多路开关的需求</th>
<th>原因</th>
</tr>
</thead>
<tbody><tr>
<td>普通信号通道切换</td>
<td>需 “先断后通”（避免通道短路）</td>
<td>通道短接，损坏信号源</td>
</tr>
<tr>
<td>程控增益放大器</td>
<td>需 “先通后断”（避免反馈断裂）</td>
<td>反馈断裂会导致运放开环，损坏电路</td>
</tr>
</tbody></table>
</blockquote>
<blockquote>
<p><strong>差动输入的CD4051</strong></p>
<p><img src="/blog/image/Snipaste_2025-06-29_16-21-40.png"></p>
<p><span style="color:#FF0000">备注</span>：</p>
<ul>
<li><p>$D_0D_1D_2D_3$与$Q_3Q_0Q_1Q_2$是一一对应的。</p>
</li>
<li><p>$$<br> D_0\leftrightarrow Q_3,D_1\leftrightarrow Q_0,D_2\leftrightarrow Q_1,D_3\leftrightarrow Q_2<br> $$</p>
</li>
</ul>
<p> 例如CPU总线输出1100，$Q_3Q_0Q_1Q_2$为1100</p>
<ul>
<li><p>$Q_3$为1时：0号和1号的INH&#x3D;1，<strong>通道断开</strong>，$Q_3$经非门后，2号和3号的INH&#x3D;0，<strong>通道接通</strong></p>
</li>
<li><p>$Q_0 \quad Q_1 \quad Q_2$分别连接$A \quad B \quad C$</p>
</li>
</ul>
</blockquote>
<blockquote>
<p><strong>例题</strong></p>
<p><img src="/blog/image/IMG_20250628_182022.jpg"></p>
<p><img src="/blog/image/IMG_20250628_182102.jpg"></p>
</blockquote>
<h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><p>（1）试设计虚线框内16通道差动输入CD4051电路图，设2号和3号CD4051芯片的<br>X1通道为差动输入第9通道</p>
<p>（2）试分析CPU数据总线D0～D3数字位应输入信号值?</p>
<p><img src="/blog/image/IMG_0197.jpg"></p>
<h2 id="采样保持器"><a href="#采样保持器" class="headerlink" title="采样保持器"></a>采样保持器</h2><p><span style="color:#FF0000">当某一通道进行A&#x2F;D转换时，由于A&#x2F;D转换需要一定的时间，如果输入信号变化较快，就会引起较大的转换误差。为了保证A&#x2F;D转换的精度，需要应用采样保持器。</span></p>
<h3 id="采样器常用术语"><a href="#采样器常用术语" class="headerlink" title="采样器常用术语"></a>采样器常用术语</h3><p>① 采样器（采样开关）：执行采样动作的装置。<br>② 采样时间（采样宽度 $\tau$）：采样开关每次闭合的时间。<br>③ 采样周期 $T$：采样开关每次通断的时间间隔。</p>
<h3 id="采样-保持器原理"><a href="#采样-保持器原理" class="headerlink" title="采样-保持器原理"></a>采样-保持器原理</h3><p><strong>采样保持器在两次采样的间隔时间内，一直保持采样值不变直到下一个采样时刻。</strong></p>
<p><strong>构成：</strong></p>
<p>采样保持器由输入输 xz出放大器<strong>A1</strong>、<strong>A2</strong>和采样开关<strong>S</strong>、保持电容**$C_H$**等组成。</p>
<p><span style="color:#FF0000">图要会画：①电压跟随器：同相端输入，反相端接输出②符号：</span></p>
<p><img src="/blog/image/Snipaste_2025-06-30_08-35-22.png"></p>
<p><strong>原理：</strong></p>
<ol>
<li><p>采样期间，开关S闭合，输入电压$V_{IN}$通过A1对$C_H$快速充电，输出电压$V_{OUT}$跟随$V_{IN}$变化；</p>
</li>
<li><p>保持期间，开关S断开，由于A2的输入阻抗很高，理想情况下电容CH将保持电压$V_{CH}$不变，因而输出电压$V_{OUT}$&#x3D;$V_{CH}$也保持恒定。</p>
</li>
</ol>
<h3 id="两项指标"><a href="#两项指标" class="headerlink" title="两项指标"></a>两项指标</h3><ul>
<li><strong>捕获时间</strong>定义: <u>跟随输入信号</u>到达所规定的的<u>百分比误差</u>之内需要的<strong>最小时间</strong>。</li>
</ul>
<p>捕获时间主要是<u>电容器充电时间常数</u>、<u>放大器摆率</u>及<u>建立时间</u>的函数。</p>
<ul>
<li><p><strong>电压下降率</strong>定义: 为<strong>保持阶段</strong>存储电容的<strong>放电速度</strong>。</p>
<p>它是<u>电容的容量</u>、<u>漏电阻</u>、<u>缓冲放大器的输入电阻</u>及<u>开关的断开电阻</u>的函数。</p>
</li>
</ul>
<hr>
<ul>
<li><strong>注摆率</strong>: <u>运算放大器输出电压的转换速率,</u> 它反映的是一个运算放大器在速度方面的指标, 表示<u>运放对信号变化速度的适应能力</u>, 单位有通常有V&#x2F;s, V&#x2F;ms和V&#x2F;µs三种。</li>
</ul>
<h3 id="转换精度"><a href="#转换精度" class="headerlink" title="转换精度"></a>转换精度</h3><p>A&#x2F;D转换器的转换精度可以用绝对误差和相对误差来表示。</p>
<ul>
<li><p><strong>绝对误差</strong>: 是指对应于一个给定数字量A&#x2F;D转换器的误差，其误差的大小由<strong>实际模拟量输入值和理论值之差</strong>来度量。绝对误差包括增益误差，零点误差和非线性误差等。</p>
</li>
<li><p><strong>相对误差</strong>: 指<strong>绝对误差与满刻度值之比</strong>，一般用百分数来表示，对A&#x2F;D转换器常用最低有效值的位数LSB (Least Significant Bit)) 来表示，$1 \mathrm{LSB} &#x3D; 1&#x2F;2^n$。</p>
</li>
</ul>
<h3 id="模数转换器接口"><a href="#模数转换器接口" class="headerlink" title="模数转换器接口"></a>模数转换器接口</h3><p>集成A&#x2F;D转换芯片都具有如下功能引脚：<strong>数据输出</strong>、<strong>启动转换</strong>（输入）、<strong>转换结束</strong>（输出）。</p>
<h4 id="连接A-D芯片时，注意事项"><a href="#连接A-D芯片时，注意事项" class="headerlink" title="连接A&#x2F;D芯片时，注意事项"></a>连接A&#x2F;D芯片时，注意事项</h4><p><span style="color:#FF0000">①  A&#x2F;D芯片能否与微处理机总线直接兼容：</span></p>
<p>所谓直接兼容是指A&#x2F;D芯片的<u>数据输出线</u>可以直接挂在<u>CPU的数据总线</u>上。这不仅要求A&#x2F;D芯片的数据输出具有TTL电平，更重要的是要求A&#x2F;D芯片的数据输出寄存器具有可控的<strong>三态</strong>输出功能。（三态包含 <strong>高电平（逻辑 1）、低电平（逻辑 0）、高阻态（浮空态，记为 Z）</strong>）</p>
<p><span style="color:#FF0000">②  启动A&#x2F;D转换的方式：</span></p>
<p>A&#x2F;D转换电路需要外加启动转换信号才能开始工作，这一信号往往由CPU给出。一般有<u>脉冲启动信号及电平控制信号</u>两种形式。通常用CPU的$\overline{WR}$或$\overline{RD}$信号、地址译码器的输出信号等直接控制A&#x2F;D转换器的启动转换端。</p>
<p><span style="color:#FF0000">③  转换结束信号的应用方式：</span></p>
<p>A&#x2F;D转换结束时，A&#x2F;D芯片输出一个转换结束标志电平，通知CPU读取转换结果数据（即控制EOC端）。</p>
<h2 id="8位A-D转换器与微机接口设计"><a href="#8位A-D转换器与微机接口设计" class="headerlink" title="8位A&#x2F;D转换器与微机接口设计"></a>8位A&#x2F;D转换器与微机接口设计</h2><h3 id="text-ADC0809-管脚"><a href="#text-ADC0809-管脚" class="headerlink" title="$$\text{ADC0809 管脚}$$"></a>$$\text{ADC0809 管脚}$$</h3><ul>
<li><p><strong>EOC</strong>:转换结束信号。当 A&#x2F; D 转换完毕之后发出一个正脉冲，表示 A&#x2F; D 转换结束，此信号可用作 A&#x2F; D 转换是否结束的检测信号或中断申请信号(加一个反相器)。</p>
</li>
<li><p>OUTPUT ENABLE(<strong>OE</strong>):输出允许信号，当此信号被选中时，允许从A&#x2F;D 转换器锁存器中读取数字量，此信号即为 ADC0809 片选信号，高电平有效。</p>
</li>
</ul>
<h3 id="text-ADC0809-转换器与微机接口硬件电路设计"><a href="#text-ADC0809-转换器与微机接口硬件电路设计" class="headerlink" title="$$\text{ADC0809 转换器与微机接口硬件电路设计}$$"></a>$$\text{ADC0809 转换器与微机接口硬件电路设计}$$</h3><p><img src="/blog/image/Snipaste_2025-06-30_10-40-44.png"></p>
<blockquote>
<p>可以把 <strong>ADC0809 与单片机的交互过程</strong> 拆解为 <strong>“启动转换→转换过程→读取结果”</strong> 三个阶段</p>
<p>**一、阶段 1：启动转换（写操作，对应 **<code>P2.3 + WR</code><strong>低电平</strong>)</p>
<ul>
<li><p><code>P2.3</code>：单片机的<strong>片选信号</strong>（选中 ADC0809 芯片）。</p>
</li>
<li><p><code>WR</code>：单片机的<strong>写信号</strong>（表示当前是 “写操作”，向 ADC 发命令）。</p>
</li>
<li><p><code>ALE</code>（地址锁存允许）：把单片机地址总线中的 <code>C、B、A</code> 信号**（低 3 位，用于选择 ADC 的 8 个通道，如 <code>C=0,B=0,A=0</code> 选 <code>IN0</code> 通道）**锁存到 ADC 内部，避免地址变化影响通道选择。</p>
</li>
<li><p><code>START</code>（启动转换）：触发 ADC 开始工作。</p>
</li>
</ul>
<p> <span style="color:#FF0000">硬件动作</span>：</p>
<p> 当 <code>P2.3</code> 和 <code>WR</code> <strong>同时为低电平时</strong>：ADC0809 检测到这两个信号，使 <code>ALE</code> 和 <code>START</code> 有效。<code>ALE</code> 先锁存 <code>C、B、A</code>，选定要采集的模拟通道（比如温度传感器接 <code>IN3</code>，则 <code>C=0,B=1,A=1</code>）。<code>START</code> 随后产生<strong>下降沿</strong>（从高变低），正式启动 <strong>逐次逼近转换</strong>（ADC 的核心工作模式）。</p>
<p><strong>二、阶段 2：转换过程（逐次逼近，</strong><code>EOC</code><strong>低电平</strong>）</p>
<blockquote>
<p>ADC 内部有一个 <strong>逐次逼近寄存器（SAR）</strong>，像 “猜数字游戏” 一样<strong>从最高位到最低位逐位尝试</strong></p>
</blockquote>
<ul>
<li><p><code>START</code> 下降沿后，<code>EOC</code>（转换结束信号）立即<strong>变低电平</strong>（表示 “正在转换，忙！”）。</p>
</li>
<li><p>转换期间，<strong>模拟输入必须保持稳定</strong>（通常由采样保持器实现），否则比较结果会出错；比较器持续工作，不断调整 SAR 的值。</p>
</li>
</ul>
<p>**三、阶段 3：读取结果（读操作，对应 **<code>P2.3 + RD</code><strong>低电平</strong>）</p>
<ol>
<li><strong>转换结束的信号通知</strong>：</li>
</ol>
<ul>
<li><p>当 8 位都比较完成后，<code>EOC</code> <strong>变高电平</strong>（表示 “转换结束，数据 ready！”）。</p>
</li>
<li><p><code>EOC</code> 经反向器（非门）连接到单片机的 <code>P3.3</code>（外部中断引脚）(这里<code>p3.3</code>复用<code>INT1</code>引脚)，高电平的 <code>EOC</code> 会被反转为<strong>低电平</strong>，触发单片机中断（告诉 CPU：“数据好了，快来读！”）。</p>
</li>
</ul>
<ol start="2">
<li><strong>读取数据的硬件动作</strong>：&#xA;</li>
</ol>
<p>单片机响应中断后，使 <code>P2.3</code>（片选仍有效）和 <code>RD</code>（读信号，低电平）<strong>同时为低</strong>：</p>
<ul>
<li><p>这会触发 ADC0809 的 <code>OE</code><strong>（输出允许）</strong> 有效。</p>
</li>
<li><p>ADC 内部的锁存器将转换好的数字量（如 <code>0110 0100</code>）送到<strong>数据总线</strong>，单片机通过读操作将数据读入内存。</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;graph TD</span><br><span class="line">   A[&quot;单片机发出：P2.3+WR低电平&quot;] --&gt; B[&quot;启动脉冲START和地址锁存允许ALE有效：ADC锁存C/B/A&quot;]</span><br><span class="line">   B --&gt; C[&quot;在START下降沿的作用下开始逐次逼近+EOC变低电平&quot;]</span><br><span class="line">   C --&gt; D[&quot;转换完成，EOC变高，向单片机申请中断→P3.3=0&quot;]</span><br><span class="line">   D --&gt; E[&quot;单片机发出输出允许信号：P2.3+RD低电平&quot;] --&gt; F[&quot;OE高电平有效，允许从A/D转换器锁存器读取数字量&quot;]</span><br></pre></td></tr></table></figure>

</blockquote>
<p><strong>实现A&#x2F;D转换</strong>所需的软件设计方式不同，目前常用的控制方式有：</p>
<p><strong>程序查询方式、定时采样方式、中断方式</strong></p>
<h2 id="12位A-D转换器微机接口技术"><a href="#12位A-D转换器微机接口技术" class="headerlink" title="12位A&#x2F;D转换器微机接口技术"></a>12位A&#x2F;D转换器微机接口技术</h2><h3 id="内部寄存器控制输入管脚（-A-0-和-12-overline-8-）"><a href="#内部寄存器控制输入管脚（-A-0-和-12-overline-8-）" class="headerlink" title="内部寄存器控制输入管脚（$A_0$和$12&#x2F; \overline{8}$）"></a>内部寄存器控制输入管脚（$A_0$和$12&#x2F; \overline{8}$）</h3><ul>
<li><p>$A_0($字节选择)和 12&#x2F;$\bar{8}($数字形式)输人端一起用来控制<strong>输出数据</strong>和<strong>转换脉冲</strong>。</p>
</li>
<li><p>当 12&#x2F;$\bar{8}$接高电平时，允许 12 位输出。当 12&#x2F;$\bar{8}$接低电平时，作为 8 位接口。在<br>这种状态下，当$A_0$被选中时一次只允许高 8 位和低 4 位输入。当$A_0$是低电平状态<br>时允许高 8 位输入，当$A_0$为高电平时允许低 4 位输人(高 8 位被禁止)。</p>
</li>
</ul>
<table>
<thead>
<tr>
<th><strong><code>12/8</code> 电平</strong></th>
<th><strong><code>A₀</code> 电平</strong></th>
<th><strong>输出有效位</strong></th>
<th><strong>数据意义</strong></th>
<th><strong>核心逻辑</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>高电平</strong></td>
<td>任意（0&#x2F;1）</td>
<td><em>D</em>11∼<em>D</em>0（12 位）</td>
<td>完整 12 位转换结果</td>
<td>12 位总线直接读取，<code>A₀</code> 此模式下无效</td>
</tr>
<tr>
<td><strong>低电平</strong></td>
<td><strong>低电平（0）</strong></td>
<td><em>D</em>11∼<em>D</em>4（8 位）</td>
<td>12 位结果的<strong>高 8 位</strong></td>
<td>8 位总线 “第一次读”，获取高位数据</td>
</tr>
<tr>
<td><strong>低电平</strong></td>
<td><strong>高电平（1）</strong></td>
<td><em>D</em>3∼<em>D</em>0（4 位，总线低 4 位补 0 成 8 位）</td>
<td>12 位结果的<strong>低 4 位</strong>（扩展为 8 位）</td>
<td>8 位总线 “第二次读”，获取低位数据（需与高 8 位拼接）</td>
</tr>
</tbody></table>
<ol>
<li><strong><code>12/8</code> 高→12 位并行出</strong>（适配 12 位总线，一步到位）；</li>
<li><strong><code>12/8</code> 低 +<code>A₀</code> 低→读高 8 位</strong>（先抓高位，占总线前 8 位）；</li>
<li><strong><code>12/8</code> 低 +<code>A₀</code> 高→读低 4 位</strong>（后补低位，总线低 4 位有效，高 4 位补 0）。</li>
</ol>
<blockquote>
<p>要理解AD574 中 <strong><code>12/8</code> 和 <code>A₀</code> 引脚的功能</strong>，需结合 <strong>“12 位数据与 8 位总线的兼容性矛盾”</strong> 分析，拆解如下：  </p>
<h3 id="一、12-8-引脚：决定数据输出模式（12-位并行-vs-8-位分时）"><a href="#一、12-8-引脚：决定数据输出模式（12-位并行-vs-8-位分时）" class="headerlink" title="一、12/8 引脚：决定数据输出模式（12 位并行 vs 8 位分时）"></a><strong>一、<code>12/8</code> 引脚：决定数据输出模式（12 位并行 vs 8 位分时）</strong></h3><p>AD574 是 <strong>12 位 ADC</strong>（可输出 0~4095 的数字量，对应 12 位二进制），但多数单片机是 <strong>8 位数据总线</strong>（一次只能传输 8 位）。<code>12/8</code> 引脚用于解决这个矛盾：  </p>
<table>
<thead>
<tr>
<th>12&#x2F;8</th>
<th>功能</th>
<th>数据输出方式</th>
<th>适用场景</th>
</tr>
</thead>
<tbody><tr>
<td><strong>高电平</strong></td>
<td>12 位并行输出模式</td>
<td>12 位数据（<code>D₁₁~D₀</code>）同时输出</td>
<td>具备 12 位总线的系统（如 DSP）</td>
</tr>
<tr>
<td><strong>低电平</strong></td>
<td>8 位分时输出模式</td>
<td>12 位数据拆分为 <strong>高 8 位</strong>（<code>D₁₁~D₄</code>）和 <strong>低 4 位</strong>（<code>D₃~D₀</code>），分两次传输</td>
<td>8 位单片机系统（如 8051）</td>
</tr>
</tbody></table>
<h3 id="二、A₀-引脚：8-位模式下的“高低位切换开关”"><a href="#二、A₀-引脚：8-位模式下的“高低位切换开关”" class="headerlink" title="二、A₀ 引脚：8 位模式下的“高低位切换开关”"></a><strong>二、<code>A₀</code> 引脚：8 位模式下的“高低位切换开关”</strong></h3><p>当 <code>12/8</code> 接 <strong>低电平</strong>（8 位模式）时，<code>A₀</code> 用于控制 <strong>哪部分数据输出</strong>（高 8 位或低 4 位）：  </p>
<h4 id="1-A₀-低电平：输出高-8-位（D₁₁-D₄）"><a href="#1-A₀-低电平：输出高-8-位（D₁₁-D₄）" class="headerlink" title="1. A₀ = 低电平：输出高 8 位（D₁₁~D₄）"></a>1. <strong><code>A₀ = 低电平</code>：输出高 8 位（<code>D₁₁~D₄</code>）</strong></h4><ul>
<li>此时，AD574 将 12 位数据的 <strong>高 8 位</strong>（第 4<del>11 位，共 8 位）放到数据总线，**低 4 位（&#96;D₃</del>D₀&#96;）呈高阻态**（相当于“断开”，避免干扰总线）。</li>
</ul>
<h4 id="2-A₀-高电平：输出低-4-位（D₃-D₀）"><a href="#2-A₀-高电平：输出低-4-位（D₃-D₀）" class="headerlink" title="2. A₀ = 高电平：输出低 4 位（D₃~D₀）"></a>2. <strong><code>A₀ = 高电平</code>：输出低 4 位（<code>D₃~D₀</code>）</strong></h4><ul>
<li>此时，AD574 将 12 位数据的 <strong>低 4 位</strong>（第 0<del>3 位）放到数据总线，**高 8 位（&#96;D₁₁</del>D₄&#96;）呈高阻态**。</li>
</ul>
<h3 id="三、实例演示：12-位数据如何拆分传输？"><a href="#三、实例演示：12-位数据如何拆分传输？" class="headerlink" title="三、实例演示：12 位数据如何拆分传输？"></a><strong>三、实例演示：12 位数据如何拆分传输？</strong></h3><p>假设 AD574 转换结果为 <strong>12 位二进制 <code>1001 0001 1010</code></strong>（十进制 2330，十六进制 <code>0x91A</code>）：  </p>
<ul>
<li><strong>高 8 位</strong>：<code>1001 0001</code>（<code>D₁₁~D₄</code>，对应 <code>0x91</code>）；  </li>
<li><strong>低 4 位</strong>：<code>1010</code>（<code>D₃~D₀</code>，对应 <code>0x0A</code>）。</li>
</ul>
<h4 id="8-位单片机的读取流程："><a href="#8-位单片机的读取流程：" class="headerlink" title="8 位单片机的读取流程："></a>8 位单片机的读取流程：</h4><ol>
<li><strong>第一步：读高 8 位</strong></li>
</ol>
<ul>
<li>置 <code>A₀ = 低电平</code>，AD574 输出 <code>1001 0001</code>（<code>0x91</code>），单片机读取该值并暂存。</li>
</ul>
<ol start="2">
<li><strong>第二步：读低 4 位</strong></li>
</ol>
<ul>
<li>置 <code>A₀ = 高电平</code>，AD574 输出 <code>0000 1010</code>（低 4 位补 0 凑 8 位，即 <code>0x0A</code>），单片机读取该值。</li>
</ul>
<ol start="3">
<li><strong>第三步：拼接数据</strong></li>
</ol>
<ul>
<li>将高 8 位（<code>0x91</code>）左移 4 位，加上低 4 位（<code>0x0A</code>），得到完整 12 位数据 <code>0x91A</code>（<code>1001 0001 1010</code>）。</li>
</ul>
<p><code>A₀</code> 的“高&#x2F;低”控制，本质是 <strong>避免两次读取时的总线冲突</strong>（若高低位同时输出，会导致数据混乱甚至短路）。  </p>
<p><strong>总结</strong>：<code>12/8</code> 决定“是否拆分 12 位数据”，<code>A₀</code> 决定“拆分后读高 8 位还是低 4 位”，两者配合让 AD574 灵活适配不同位数的 CPU 总线，是模拟→数字转换中 <strong>“硬件兼容性设计”的经典案例</strong>。</p>
</blockquote>
<blockquote>
<p><strong>例题</strong></p>
<p><strong>下列关于 AD574 中 12&#x2F;8 和 A₀ 引脚功能的描述，正确的有（   ）</strong><br>选项：<br>A. 当 12&#x2F;8 接高电平时，AD574 可直接输出 12 位并行数据，A₀ 引脚此模式下功能无效<br>B. 当 12&#x2F;8 接低电平、A₀ 接低电平时，数据总线输出 12 位结果的低 4 位（补 0 为 8 位）<br>C. 8 位接口模式下，A₀ 为高电平时，12 位结果的 高 8 位会被禁止输出（呈高阻态）<br>D. 若需适配 8 位单片机总线，应将 12&#x2F;8 接低电平，通过 A₀ 分两次读取高 8 位和低 4 位<br>答案解析：<br>✅ A：12&#x2F;8 高→12 位并行输出，A₀ 仅在 8 位模式生效，此模式下无意义。<br>❌ B：12&#x2F;8 低 +A₀ 低→输出 高 8 位（D₁₁<del>D₄），而非低 4 位（干扰项颠倒高低位）。<br>✅ C：A₀ 高→高 8 位（D₁₁</del>D₄）高阻（禁止），仅低 4 位（D₃~D₀，补 0 为 8 位）输出。<br>✅ D：8 位模式通过 12&#x2F;8 低 +A₀ 切换，分两次读取并拼接，适配 8 位总线。</p>
<hr>
<p><strong>简述 AD574 中 12&#x2F;8 和 A₀ 引脚的作用，并说明 8 位接口模式 下的工作逻辑。</strong><br>12&#x2F;8 引脚：<br>高电平：启用 12 位并行输出模式，12 位数据（D₁₁<del>D₀）同时上总线，适配 12 位宽系统。<br>低电平：启用 8 位分时模式，12 位数据拆分为 高 8 位（D₁₁</del>D₄） 和 低 4 位（D₃<del>D₀），分两次传输。<br>A₀ 引脚（仅 12&#x2F;8 低电平时有效）：<br>低电平：选通 高 8 位（D₁₁</del>D₄）输出，低 4 位呈高阻态。<br>高电平：选通 低 4 位（D₃~D₀，补 0 为 8 位）输出，高 8 位呈高阻态。<br>8 位模式流程：通过控制 A₀ 电平，分 “读高 8 位→读低 4 位” 两步获取数据，最终软件拼接为 12 位结果。</p>
</blockquote>
<p>对于 Ａ Ｄ５７４ 的输入端一般可接成<strong>单极性输入</strong>和<strong>双极性输入</strong>两种工作方式  </p>
<h2 id="微机频率测量技术"><a href="#微机频率测量技术" class="headerlink" title="微机频率测量技术"></a>微机频率测量技术</h2><ul>
<li><p><strong>频率量</strong>是相对来说比较<u>容易</u>实现<u>精密测量</u>的一种电量  </p>
</li>
<li><p>频率信号与计算机的接口也比电压信号更容易实现</p>
</li>
</ul>
<h3 id="计数测频法（闸门时间法）"><a href="#计数测频法（闸门时间法）" class="headerlink" title="计数测频法（闸门时间法）"></a>计数测频法（闸门时间法）</h3><p>计数测频法的<strong>基本思想</strong>就是在某一选定的时间间隔内对被测信号进行<u>计数</u>，然后将<u>计数值</u>除以<u>时间间隔（时基）</u>就得到所测频率</p>
<h4 id="工作原理"><a href="#工作原理" class="headerlink" title="工作原理"></a>工作原理</h4><p>被测信号经过一个可控闸门输给计数器，<span style="color:#FF0000">该闸门实际上就是一个<u>与门</u>或<u>与非门</u></span>，与门的另一输入端由微型计算机的一根输出线($P_1)$控制，<span style="color:#FF0000">当此线为“**高”**时，<u>闸门打开</u>，被测信号经闸门进入计数器使计数器计数；如此线为“<strong>低</strong>”则<u>闸门关闭</u> ,计数停止</span>。利用微机内部的定时器 ,可控制闸门按要求的时间间隔打开或关闭.从而实现频率测量。</p>
<p><img src="/blog/image/Snipaste_2025-06-30_15-49-27.png"></p>
<p>设所选的闸门开启时时间间隔为 $t$,在此间隔内计得的计数值为$N$ ,则测得的</p>
<p>频率为</p>
<p>$$<br>f:&#x3D;:N&#x2F;:t<br>$$</p>
<p>选取$t&#x3D;$ 1s ,则$f&#x3D;N($Hz),如$t&#x3D;0.1$s,则$f&#x3D;10N($Hz)。</p>
<h4 id="测频方法的误差分析"><a href="#测频方法的误差分析" class="headerlink" title="测频方法的误差分析"></a>测频方法的误差分析</h4><p>测频方法的误差主要有两类:</p>
<ol>
<li><strong>量化误差 (±1误差)</strong>: 将模拟量转化为数字量所产生的误差叫量化误差**。是由于用于计数的时标脉冲与控制主门的被测周期不同步而引起的**。</li>
<li><strong>标准频率误差 (时基误差)</strong>: 电子计数器在测量时, 都是以晶振产生的各种时基和时标信号作为基准的, 晶体振荡器不稳定将引起误差。</li>
</ol>
<blockquote>
<p><strong>±1误差原理</strong></p>
<p>$\pm 1$误差在测频时，闸门的开启时刻与计数脉冲的时间关系是不相关的，所以它们在时间轴上的相对位置是随机的。这样，在相同的闸门开启时间内，计数器所计得的数却不一定相同，当闸门开启时间$T$接近甚至等于被测信号周期$T_x$的整数$N$倍时，此项误差为最大。</p>
<ul>
<li><p>$T_S$为计数器的闸门开启时间</p>
</li>
<li><p>$T_x$为被测信号周期</p>
</li>
<li><p>$\Delta t_1$为闸门开启时刻至第一个计数脉冲前的时间（<strong>假设计数脉冲前沿使计数器翻转计数</strong>） $0 \leq \Delta t_1 \leq T_x$</p>
</li>
<li><p>$\Delta t_2$为闸门关闭时刻至下一个计数脉冲前沿的时间   $0 \leq \Delta t_2 \leq T_x$</p>
</li>
<li><p>设计数值为$N$，计数值误差为$\Delta N$</p>
</li>
</ul>
<p><img src="/blog/image/Snipaste_2025-06-30_16-58-28.png"></p>
<p>为作图方便，图中$N$取6</p>
<p>由图可见</p>
<p>$$<br>T_S &#x3D; NT_{x} + \Delta t_{1} - \Delta t_{2} &#x3D; \left[ N + \frac{ \left( \Delta t_{1} - \Delta t_{2} \right) }{ T_{x} } \right] T_{x}<br>$$</p>
<p>显然，计数器的计数值$N$为正整数，它通常不能准确地反映频率关系式，即$ N \neq f_{x} T_s $，这就造成了计数误差：</p>
<p>$$<br>\Delta N &#x3D; f_{x} T_S-N   &#x3D; f_x\left[ N + \frac{ \left( \Delta t_{1} - \Delta t_{2} \right) }{ T_{x} } \right] T_{x}-N<br>$$</p>
<p>得</p>
<p>$$<br>\Delta N &#x3D; \frac{ \left( \Delta t_{1} - \Delta t_{2} \right) }{ T_{x} }<br>$$</p>
<ol>
<li>当$\Delta t_{1} &#x3D; \Delta t_{2}$时，$\Delta N &#x3D; 0$  </li>
<li>当$\Delta t_{1} &#x3D; 0$，$\Delta t_{2} &#x3D; T_{x}$时，$\Delta N &#x3D; -1$  </li>
<li>当$\Delta t_{1} &#x3D; T_{x}$，$\Delta t_{2} &#x3D; 0$时，$\Delta N &#x3D; 1$</li>
</ol>
<p><strong>即最大计数误差为$\pm 1$个数</strong></p>
<p><span style="color:#FF0000">低频时，误差主要由±1误差引起</span></p>
<ul>
<li><p>由“±１”误差造成的计数误差是随被测频率变化的相对误差，该误差的影响随着被测频率的下降而急骤增大  </p>
</li>
<li><p>相对误差（误差占测量值的比例）定义为：</p>
</li>
<li><p>$$<br>\text{相对误差} E &#x3D; \frac{|\text{绝对误差}|}{\text{测量值}} &#x3D; \frac{|\Delta N|}{N}&#x3D;\frac{1}{N} &#x3D; \frac{1}{f_x \cdot T_s}<br>$$</p>
</li>
<li><p>当 $T_s$固定时，<strong>相对误差与被测频率 $f_x$ 成反比</strong>$(f_x \downarrow \Rightarrow \text{相对误差} \uparrow) $</p>
</li>
</ul>
<p>以 $T_s &#x3D; 1,\text{秒}$ 为例，对比不同频率下的相对误差：</p>
<table>
<thead>
<tr>
<th>被测频率 f（Hz）</th>
<th>闸门内脉冲数 $N &#x3D; f \cdot T_s$</th>
<th>相对误差$ \dfrac{1}{N}$</th>
</tr>
</thead>
<tbody><tr>
<td>1M</td>
<td>1M</td>
<td>$10^{-6}$</td>
</tr>
<tr>
<td>100</td>
<td>100</td>
<td>1%</td>
</tr>
<tr>
<td>10</td>
<td>10</td>
<td>10%</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>100%</td>
</tr>
</tbody></table>
</blockquote>
<ul>
<li>对于闸门时间为 １ｓ 的情况，当频率超过 １Ｍ Ｈｚ 时，测量误差主要由时基误差来决定。 这一误差要比“±１”在低频时引起的误差小得多。</li>
</ul>
<p><img src="/blog/image/IMG_20250628_184645.jpg"></p>
<h3 id="周期测量法"><a href="#周期测量法" class="headerlink" title="周期测量法"></a>周期测量法</h3><p><img src="/blog/image/Snipaste_2025-07-01_10-54-08.png"></p>
<blockquote>
<p>周期测量中，改用固定频率很高的参考脉冲**$f_{r}$作计数器的脉冲源**，而让**被测信号$f_{m}$**经放大整形后再经过一个门控双稳去控制闸门。</p>
</blockquote>
<p>其电路原理图如图5.18所示，在门控双稳输入B的两个下降沿之间（<span style="color:#FF0000">保证一个周期</span>），触发器输出高电平使闸门打开，计数器对$f_{r}$进行计数。闸门开启的时间就是被测信号的周期。</p>
<p>门控双稳输出的下降沿表示一次计数完毕，此信号引入微型计算机通知它取走计数器的数值。</p>
<blockquote>
<p>**注意：**由于计数器不清零，与被测周期对应的数值应为两次相邻读数之差。如出现第三次读数小于前一次时，表明计数器已出现过满量程进位，<strong>应将第二次读数加上计数器的满量程值再相减</strong>。通过所获得的周期值，微型计算机很容易计算其倒数，即对应的频率值。</p>
</blockquote>
<ul>
<li>计数器的计数结果为$N$</li>
</ul>
<p>$$<br>T_m&#x3D;NT_r \<br>f_m&#x3D;\frac {f_r}{N}<br>$$</p>
<p>周期测量法中，“±1”所引起的相对误差为</p>
<p>$$<br> E&#x3D;\frac {1}{T_{m}\cdot f_{r}}&#x3D;\frac {f_{m}}{f_{r}}<br>$$<br><span style="color:#FF0000">参考脉冲的频率越高则相对误差越小，并且相对误差与被测频率成正比，对低频测量，周期法有较高的精度，随着被测频率的增高，其相对误差逐渐增大  </span></p>
<p><img src="/blog/image/IMG_20250628_185302.jpg"></p>
<h3 id="多倍周期测量法"><a href="#多倍周期测量法" class="headerlink" title="多倍周期测量法"></a>多倍周期测量法</h3><p><span style="color:#FF0000">为了克服1KHZ附近误差大的缺点，可应用多倍周期测量法  </span></p>
<p>多倍周期法的基本做法是利用微型计算机自动控制计数闸门开启 𝑚个被测信号周期的时间使得计数器在一次测量中得到的读数值接近满量程。</p>
<p>当被测频率较高时,自动选取较大的 𝑚值,频率转低时,则选用较小的 𝑚值,保证每次得到的读数值都在满量程值附近,从而使得对各种被测频率误差都很小。</p>
<p><img src="/blog/image/Snipaste_2025-07-01_14-44-29.png"></p>
<ul>
<li><p>计数器$CT_1$累计闸门开启时间内的<strong>参考脉冲数</strong>；</p>
</li>
<li><p>$CT_2$为<strong>周期数计数器</strong>，它对被测信号进行计数  </p>
</li>
<li><p>$CT_1$计数器的计数结果为$N$</p>
</li>
<li><p>$m$为被测信号周期数</p>
</li>
<li><p><strong>$f_{r}$为计数器的脉冲源</strong></p>
</li>
<li><p><strong>$f_{m}$为被测信号</strong></p>
</li>
</ul>
<p>$$<br>mT_m&#x3D;NT_r \<br>f_m&#x3D;\frac {mf_r}{N}<br>$$</p>
<blockquote>
<p><span style="color:#FF0000">测量方法本质</span></p>
<ul>
<li><strong>计数法</strong>:是一种积分方法,在闸门时间内由计数器对被测信号进行脉冲累计。  低频误差的原因是指,在确定的闸门时间内,累计得到的脉冲数远小于计数器的满量程,致使“±1”引起的误差增大。</li>
<li><strong>周期法</strong>:也是一种积分方法,只不过计数器累计的不是被测信号而是参考脉冲。  高频时,由于受被测信号周期控制的闸门开启时间过短,使得计数值也远小于计数器的满量程,造成相对误差增大。  </li>
<li><strong>多倍周期法</strong>:是利用计算机自动控制计数闸门开启m个被测信号周期的时间,使得计数器在一次测量中得到的读数值接近满量程。当被测频率较高时,自动选取较大的m值,频率转低时,则选用较小的m值,保证每次得到的读数值都在满量程值附近,从而使得对各种被测频率</li>
</ul>
</blockquote>
<h2 id="模拟量输出技术"><a href="#模拟量输出技术" class="headerlink" title="模拟量输出技术"></a>模拟量输出技术</h2><h3 id="模拟量输出通道的结构组成"><a href="#模拟量输出通道的结构组成" class="headerlink" title="模拟量输出通道的结构组成"></a>模拟量输出通道的结构组成</h3><ul>
<li><p>模拟量输出通道的任务 —— 把计算机处理后的<span style="color:#FF0000">数字量信号</span>转换成<span style="color:#FF0000">模拟量（电压或电流信号）</span>，去驱动相应的执行器，从而达到控制的目的；</p>
</li>
<li><p>模拟量输出通道（D&#x2F;A通道或AO通道）构成： 一般是由<u>接口电路</u>（核心部分）、<span style="color:#FF00FF"><u>数&#x2F;模转换器</u>（简称D&#x2F;A或DAC）</span>和<u>电压&#x2F;电流变换器</u>等；</p>
</li>
</ul>
<hr>
<blockquote>
<p>⚠️ <strong>注意：</strong> 并非所有的DAC的数据输入都能直接挂在微处理机数据总线上。</p>
</blockquote>
<blockquote>
<p>🔍 <strong>原因：</strong> 实际应用中，转换后的模拟信号需要保持一段时间，便于测量或控制，而 CPU 在执行向外设给输出数据的指令时，数据在数据总线上的存在时间只维持一个时钟周期。因此，对于不带<strong>输入数据寄存器</strong>的 DAC 芯片，其<strong>数据输入端</strong>须经<strong>锁存器</strong>与 CPU 数据总线相连</p>
</blockquote>
<h3 id="不带输入数据寄存器的D-A转换器接口"><a href="#不带输入数据寄存器的D-A转换器接口" class="headerlink" title="不带输入数据寄存器的D&#x2F;A转换器接口"></a>不带输入数据寄存器的D&#x2F;A转换器接口</h3><p><img src="/blog/image/Snipaste_2025-07-01_15-45-39.png"></p>
<ul>
<li>LS273为<strong>数据锁存器</strong></li>
<li>若图片中的D&#x2F;A转换器输出类型为电流输出，后接运放可实现<strong>电流-电压的转换</strong></li>
</ul>
<h3 id="微机总线兼容型D-A转换器接口"><a href="#微机总线兼容型D-A转换器接口" class="headerlink" title="微机总线兼容型D&#x2F;A转换器接口"></a>微机总线兼容型D&#x2F;A转换器接口</h3><ul>
<li><p>微机总线兼容型 Ｄ／Ａ 转换器芯片内部带有<strong>输入数据寄存器</strong>  </p>
</li>
<li><p>拥有一个数据寄存器的叫<strong>单缓冲型</strong>，带有两个数据寄存器的叫<strong>双缓冲型</strong>  </p>
</li>
<li><p><span style="color:#FF0000"><strong>双缓冲型优点(简答)</strong> </span>：当一个数字量送入 DAC 进行转换输出同时，能输入下一个数字量，从而提高转换速度。</p>
</li>
</ul>
<h3 id="原码、反码、补码、移码"><a href="#原码、反码、补码、移码" class="headerlink" title="原码、反码、补码、移码"></a>原码、反码、补码、移码</h3><h4 id="原码"><a href="#原码" class="headerlink" title="原码"></a>原码</h4><ul>
<li>符号位（最高位）+ 数值位</li>
<li><strong>规则</strong>：<code>0</code>表正，<code>1</code>表负，数值位为绝对值的二进制。</li>
</ul>
<h4 id="反码"><a href="#反码" class="headerlink" title="反码"></a>反码</h4><ul>
<li><strong>规则</strong>：正数反码同原码；负数反码是符号位不变，数值位逐位取反。</li>
</ul>
<h4 id="补码"><a href="#补码" class="headerlink" title="补码"></a>补码</h4><ul>
<li><strong>规则</strong>：正数补码同原码；负数补码是<strong>反码 + 1</strong>（符号位自动调整）。</li>
</ul>
<h4 id="偏移二进制码（移码）"><a href="#偏移二进制码（移码）" class="headerlink" title="偏移二进制码（移码）"></a>偏移二进制码（移码）</h4><p>$n$**(不包含符号位的真值位)**位二进制数$\pm D_i$的偏移二进制代码为<br>$$<br>D_m &#x3D; D_i + 2^n<br>$$</p>
<blockquote>
<p>$  D_i&#x3D;+110  $(十进制为+6)：$  D_m&#x3D; +110+1000&#x3D;1110(&#x3D;6+8&#x3D;14)  $ <span style="color:#FF0000">这里的移码没有符号位</span></p>
<p>$  D_i&#x3D;-110  $(十进制为-6)：$  D_m&#x3D;-110+1000&#x3D;0010(&#x3D;-6+8&#x3D;2)  $ (-110原码为1110，反码为1001，补码为1010；1010+1000&#x3D;10010取4位)</p>
</blockquote>
<p><span style="color:rgb(116, 219, 38)"><strong>将补码的符号位取反</strong></span>（<strong>推荐</strong>）</p>
<table>
<thead>
<tr>
<th>真值 $D_i$</th>
<th>原码(字节长度4位)&#xA;</th>
<th>反码&#xA;</th>
<th>补码&#xA;</th>
</tr>
</thead>
<tbody><tr>
<td>$+6$</td>
<td><code>0110</code></td>
<td><code>0110</code></td>
<td><code>0110</code></td>
</tr>
<tr>
<td>$-6$</td>
<td><code>1110</code></td>
<td><code>1001</code></td>
<td><code>1010</code></td>
</tr>
<tr>
<td>$+0$</td>
<td><code>0000</code></td>
<td><code>0000</code></td>
<td><code>0000</code></td>
</tr>
<tr>
<td>$-0$</td>
<td><code>1000</code></td>
<td><code>1111</code></td>
<td><code>0000</code></td>
</tr>
<tr>
<td>$-8$</td>
<td>无&#xA;</td>
<td>无&#xA;</td>
<td><code>1000</code></td>
</tr>
</tbody></table>
<blockquote>
<p><strong>例题</strong></p>
<p>分别求+78和-78的原码、反码、补码、移码</p>
<table>
<thead>
<tr>
<th></th>
<th align="center">+78</th>
<th align="center">-78</th>
</tr>
</thead>
<tbody><tr>
<td>原码（<strong>短除法</strong>）</td>
<td align="center">01001110</td>
<td align="center">11001110</td>
</tr>
<tr>
<td>反码</td>
<td align="center">01001110</td>
<td align="center">10110001</td>
</tr>
<tr>
<td>补码</td>
<td align="center">01001110</td>
<td align="center">10110010</td>
</tr>
<tr>
<td>移码（<strong>补码符号位取反</strong>）</td>
<td align="center">11001110</td>
<td align="center">00110010</td>
</tr>
</tbody></table>
</blockquote>
<h3 id="权电阻型D-A转换器"><a href="#权电阻型D-A转换器" class="headerlink" title="权电阻型D&#x2F;A转换器"></a>权电阻型D&#x2F;A转换器</h3><table>
<thead>
<tr>
<th align="center">$n$ 位二进制数</th>
<th>$D_{n-1}$</th>
<th>$D_{n-2}$</th>
<th>$\cdots$</th>
<th>$D_1$</th>
<th>$D_0$</th>
</tr>
</thead>
<tbody><tr>
<td align="center"></td>
<td>最高位（MSB）</td>
<td>⟵⟶</td>
<td>⟵⟶</td>
<td>⟵⟶</td>
<td>最低位（LSB）</td>
</tr>
<tr>
<td align="center"><strong>权</strong></td>
<td>$2^{n-1}$</td>
<td>$2^{n-2}$</td>
<td>$\cdots$</td>
<td>$2^1$</td>
<td>$2^0$</td>
</tr>
</tbody></table>
<p>转换为十进制数<br>$$<br>D_n &#x3D; D_{n-1} \cdot 2^{n-1} + D_{n-2} \cdot 2^{n-2} + \cdots + D_1 \cdot 2^1 + D_0 \cdot 2^0<br>$$<br><img src="/blog/image/Snipaste_2025-07-01_20-47-17.png"><br>$$<br>i_0&#x3D;\frac {U_{REF}}{R}D_0 \Rightarrow i_i&#x3D;\frac {U_{REF}}{\frac{R}{2^i}}D_i<br>$$</p>
<p>$$<br>I_{REF}&#x3D;<br> \frac{ U_{REF}}{R} \sum_{i&#x3D;0}^{n-1} D_i , 2^i<br>$$</p>
<p>$$<br>u_0&#x3D;-I_{REF}, R_f&#x3D; -\frac{R_f, U_{REF}}{R} \sum_{i&#x3D;0}^{n-1} D_i , 2^i \<br>\text{$D_i$ 取0或1}<br>$$</p>
<blockquote>
<p><strong>输出电压除了与输入的二进制数有关，还与运算放大器的反馈电阻$R_f$以及基准电压$U_{REF}$有关</strong></p>
</blockquote>
<h3 id="倒T型电阻网络D-A转换器"><a href="#倒T型电阻网络D-A转换器" class="headerlink" title="倒T型电阻网络D&#x2F;A转换器"></a>倒T型电阻网络D&#x2F;A转换器</h3><p><img src="/blog/image/20250702085853.png"></p>
<h3 id="单极性输出的DAC转换器"><a href="#单极性输出的DAC转换器" class="headerlink" title="单极性输出的DAC转换器"></a>单极性输出的DAC转换器</h3><p><img src="/blog/image/IMG_20250628_191911.jpg"></p>
<ul>
<li><p>DAC0832自带反馈电阻，且$n&#x3D;8$</p>
</li>
<li><p>$$<br>V_{\mathrm{OUT}}&#x3D;-B\times\frac{V_{\mathrm{REF}}}{2^8} \<br>B&#x3D;D_{7}\times2^{7}+D_{6}\times2^{6}+\cdots+D_{1}\times2^{1}+D_{0}\times2^{0}<br>$$</p>
</li>
</ul>
<blockquote>
<p><strong>几个注意事项</strong></p>
<ul>
<li>DAC是否自带反馈电阻</li>
<li>DAC是几位芯片</li>
<li>$V_{OUT}$电压是负数（由上面的电路决定的）</li>
<li>上面的二进制数为无符号数</li>
</ul>
</blockquote>
<h3 id="双极性输出的D-A转换器"><a href="#双极性输出的D-A转换器" class="headerlink" title="双极性输出的D&#x2F;A转换器"></a>双极性输出的D&#x2F;A转换器</h3><p><img src="/blog/image/20250702093204.png"></p>
<hr>
<p><span style="color:#FF0000">总结：</span></p>
<p>构成双极性输出D&#x2F;A转换器的一般方法：</p>
<ul>
<li>只要在求和放大器的输入端接入一个偏移电流，使输入最高位为1而其他各位输入为0时的输出$v_{out2}&#x3D;0$，</li>
<li>同时将输入的符号位反相后接到一般的D&#x2F;A转换器的输入，就得到了双极性输出的D&#x2F;A转换器。</li>
</ul>
<blockquote>
<p>举例：DAC0832为8位芯片，取$V_{REF}&#x3D;2^7&#x3D;128V$，$V_{out2}:-128 \sim 127V$</p>
<p>如果希望输出为120V，其原码为<strong>01111000</strong>，补码<strong>01111000</strong>，补码首位反相<strong>11111000</strong>，(<strong>这个就是DAC0832的输入量</strong>)$D_8&#x3D;248$，$\frac{248-128}{128} \cdot128&#x3D;120$</p>
</blockquote>
<p><img src="/blog/image/IMG_20250628_190618.jpg"></p>
<blockquote>
<p>右下角的条件其实就是为了保证输入数字量10000000时，$V_{out2}&#x3D;0$,这个不重要</p>
</blockquote>
<p>$$<br>v_{out1} &#x3D; -\frac{V_{\mathrm{REF}}}{2^n} D_n<br>$$</p>
<p>$$<br>v_{out2} &#x3D; -2R(I_1 + I_2) \<br>&#x3D; -2R\left(\frac{V_{\mathrm{REF}}}{2R}+ \frac{v_{out1}}{R}  \right) \<br>&#x3D; \frac{V_{\mathrm{REF}}}{2^{n-1}} D_n - V_{\mathrm{REF}} \<br>&#x3D; \frac {D_n -2^{n-1}}{2^{n-1}} V_{\mathrm{REF}}<br>$$</p>
<blockquote>
<p>如果是DAC0832这种<strong>8</strong>位的芯片<br>$$<br>v_{out2} &#x3D;\frac {D_n -128}{128} V_{\mathrm{REF}}<br>$$</p>
</blockquote>
<blockquote>
<p><strong>例题</strong></p>
<p><img src="/blog/image/IMG_20250628_192000.jpg"><br>$$<br>D_n &#x3D; \left(1 + \frac{V_{out2}}{V_{\mathrm{ref}}} \right) \cdot 2^{n-1}<br>&#x3D; 128D &#x3D; 80H &#x3D; 10000000B<br>$$</p>
</blockquote>
<table>
<thead>
<tr>
<th><strong>数制</strong></th>
<th>后缀</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>十进制</td>
<td>D</td>
<td></td>
</tr>
<tr>
<td>二进制</td>
<td>B</td>
<td></td>
</tr>
<tr>
<td>八进制</td>
<td>o</td>
<td></td>
</tr>
<tr>
<td>十六进制</td>
<td>H</td>
<td>位值：A&#x3D;10，B&#x3D;11，C&#x3D;12，D&#x3D;13，E&#x3D;14，F&#x3D;15</td>
</tr>
</tbody></table>
<blockquote>
<table>
<thead>
<tr>
<th><strong>转换方向</strong></th>
<th>方法核心</th>
<th>关键逻辑</th>
</tr>
</thead>
<tbody><tr>
<td>十六进制 → 十进制</td>
<td>位权展开（$\sum \text{位值} \times 16^n$）</td>
<td>基数 16 的幂次计算</td>
</tr>
</tbody></table>
</blockquote>
<p><strong>示例 1：1AH 转十进制</strong></p>
<ul>
<li>位分解：第 1 位（左）是 <code>1</code>，第 0 位（右）是 <code>A</code>（10）。</li>
<li>位权计算：$1 \times 16^1 + 10 \times 16^0 &#x3D; 16 + 10 &#x3D; 26$</li>
</ul>
<p><strong>示例 2：FFH 转十进制</strong></p>
<ul>
<li>位分解：第 1 位是 <code>F</code>（15），第 0 位是 <code>F</code>（15）。</li>
<li>位权计算：$15 \times 16^1 + 15 \times 16^0 &#x3D; 240 + 15 &#x3D; 255$</li>
</ul>
<h2 id="步进电机基本控制技术"><a href="#步进电机基本控制技术" class="headerlink" title="步进电机基本控制技术"></a>步进电机基本控制技术</h2><h3 id="步进电机结构与工作原理"><a href="#步进电机结构与工作原理" class="headerlink" title="步进电机结构与工作原理"></a>步进电机结构与工作原理</h3><p>步进电机是一种将<span style="color:#FF0000">电脉冲信号</span>转换成机械位移的机电执行元件。每当一个脉冲信号施加于电机的控制绕组时，其转轴就转过一个固定的角度（<span style="color:#FF0000">步距角</span>）。顺序连续地发给脉冲，则电机轴<span style="color:#FF0000">一步接一步地运转</span>。</p>
<p><img src="/blog/image/Snipaste_2025-07-02_10-28-28.png"></p>
<ul>
<li><p>在实际应用中，<strong>脉冲分配回路</strong>有各种构成的办法。最常用的是环形分配器电路，现在渐渐已采用微型计算机取代旧式的环形分配器，功率放大电路的结构对步进电机的性能有着十分重要的作用。</p>
</li>
<li><p>功率放大电路有<strong>单电压</strong>、<strong>双电压</strong>、<strong>斩波型</strong>、<strong>调频调压型</strong>和<strong>细分型</strong>等型式的电路。</p>
</li>
</ul>
<h3 id="驱动电源的组成"><a href="#驱动电源的组成" class="headerlink" title="驱动电源的组成"></a>驱动电源的组成</h3><p><img src="/blog/image/Snipaste_2025-07-02_10-49-45.png"></p>
<p>步进电机的运行要求足够功率的电脉冲信号按一定的顺序分配到各相绕组。所以，与其它旋转电机不同的是步进电机的工作需要专门的驱动。</p>
<ul>
<li>步进电机的驱动包含<span style="color:#0000FF">脉冲分配（环行分配）</span>和<span style="color:#0000FF">功率放大</span>两部分。</li>
</ul>
<h3 id="步进电机功率放大电路"><a href="#步进电机功率放大电路" class="headerlink" title="步进电机功率放大电路"></a>步进电机功率放大电路</h3><p>步进电动机的功率驱动电路实际上是一种脉冲放大电路，使脉冲具有一定的功率驱动能力。</p>
<h4 id="单电压驱动电路"><a href="#单电压驱动电路" class="headerlink" title="单电压驱动电路"></a>单电压驱动电路</h4><p><img src="/blog/image/Snipaste_2025-07-02_10-57-34.png"></p>
<p>$$<br>T_d &#x3D; \frac{L}{R_L + R_C + R_d}<br>$$</p>
<p>其中：</p>
<ul>
<li>$T_d$回路放电时间</li>
<li>$L$ —— 是电动机绕组</li>
</ul>
<hr>
<p><span style="color:#0000FF">两点改进：</span></p>
<ol>
<li><p>电阻 $R_C$ 两端<span style="color:#FF0000">并联电容 $C$</span>，是由于电容两端的电压不能突变，在绕组由<strong>截止到导通</strong>瞬间，电源电压全部降落到绕组上，使电流上升更快，所以，电容 $C$ 又称为<span style="color:#FF0000">加速电容</span>。</p>
</li>
<li><p>在续流二极管 $D$ 回路中<span style="color:#FF0000">串联了一个电阻 $R_D$</span>，对回路的放电时间 $T_d$ 有较大改善功能。续流二极管 $D$ 在晶体管 $T$ 截止时起<span style="color:#0000FF">续流和保护作用</span>，以防止晶体管截止瞬间绕组产生的反电动势对管子造成损坏。串联电阻也使电流下降更快，从而使绕组中电流脉冲的后沿变陡。</p>
</li>
</ol>
<h4 id="例题-1"><a href="#例题-1" class="headerlink" title="例题"></a>例题</h4><p><strong>综合题</strong></p>
<p>已知电动自行车系统构成结构简图如图所示，当该自行车以单片机作为控制器，并能实时进行速度控制时，<br>（1）试绘制自行车匀速运动的工作原理框图？<br>（2）若该轮毂电机采用单电压控制方式，试设计出单电压改进型功率放大电路，  并说明该改进型电路的优点？：</p>
<p><img src="/blog/image/845883_003335729142_2.jpg"></p>
<p><img src="/blog/image/Snipaste_2025-07-09_14-14-46.png"></p>
<hr>
<p>1、下图为遥控无人车结构简图。采用单片机作为主控制器，</p>
<p>（1）试画出车轮驱动系统的速度闭环的工作原理框图？</p>
<p>（2）设遥控无人车的 6-车轮驱动系统采用单电压基本型改进功率放大电路，<br>试画出该电路图并说明该电路改进后的特点？</p>
<p><img src="/blog/image/Snipaste_2025-07-09_14-37-09.png"></p>
<p><img src="/blog/image/Snipaste_2025-07-09_14-36-03.png"></p>
<h4 id="高低压切换型驱动电路（双电压驱动电路）"><a href="#高低压切换型驱动电路（双电压驱动电路）" class="headerlink" title="高低压切换型驱动电路（双电压驱动电路）"></a>高低压切换型驱动电路（<span style="color:#FF0000">双电压驱动电路</span>）</h4><p><span style="color:#0000FF">驱动电路的基本思想</span>：</p>
<p>无论电机的工作频率如何，在导通相的前沿用高电压供电，提高电流的前沿上升率；而在前沿过后用低压来维持绕组的电流。</p>
<hr>
<p><img src="/blog/image/Snipaste_2025-07-02_14-26-20.png"></p>
<p><strong>元件说明：</strong></p>
<ul>
<li>$VT_1$：高压电源的开关管  </li>
<li>$VT_2$：低压侧功率驱动管  </li>
<li>$V_1$：续流二极管  </li>
<li>$V_2$：钳位二极管  </li>
<li>$L$：步进电机绕组电感  </li>
<li>$R$：串联电阻</li>
<li><strong>$U_{b1}$：步进控制信号</strong></li>
<li><strong>$U_{b2}$：高压电源开关控制信号</strong></li>
</ul>
<hr>
<p><strong>要求：</strong></p>
<p><span style="color:#FF0000">一、</span> $U_{b1}$ 和 $U_{b2}$ 上升沿的上 升时刻一致；</p>
<p><span style="color:#FF0000">二、</span> 有 $U_{b2}的脉宽 &lt; U_{b1}的脉宽$</p>
<hr>
<blockquote>
<p> 高低压驱动线路的<strong>优点</strong>是：启动力矩大、突跳频率和工作频率高。<br><strong>缺点</strong>是：低频振荡加剧，大功率管的数量多用一倍，增加了驱动电路复杂度。</p>
</blockquote>
<blockquote>
<p><span style="color:#FF0000">调频调压驱动电源的基本原理是：</span></p>
<ul>
<li>当步进电机在低频运行时，供电电压降低，当运行在高频段时，供电电压也升高，即供电电压随着步进电机转速的增加而升高。 </li>
<li>这样既解决了低频振荡问题，也保证了高频运行时的输出转矩。</li>
<li>实现调频调压控制的硬件电路可由软件配合适当硬件电路实现</li>
<li>$U_{CP} $是步进控制脉冲信号，$U_{CT} $是开关调压信号。</li>
</ul>
</blockquote>
<p><img src="/blog/image/Snipaste_2025-07-02_14-38-46.png"></p>
<h2 id="直流电动机脉宽（PWM）调速系统"><a href="#直流电动机脉宽（PWM）调速系统" class="headerlink" title="直流电动机脉宽（PWM）调速系统"></a>直流电动机脉宽（PWM）调速系统</h2><h3 id="直流电动机的脉宽调制工作原理"><a href="#直流电动机的脉宽调制工作原理" class="headerlink" title="直流电动机的脉宽调制工作原理"></a>直流电动机的脉宽调制工作原理</h3><p><span style="color:#FF0000">PWM</span>（<span style="color:#FF0000">Pulse Width Modulation</span>）——利用<u>大功率晶体管的开关特性</u>来调制固定电压的<span style="color:#0000FF">直流电源</span>，按一个固定的<span style="color:#0000FF">频率</span>来<span style="color:#0000FF">接通</span>和<span style="color:#0000FF">断开</span>，并根据需要改变一个周期内<span style="color:#0000FF">接通</span>与<span style="color:#0000FF">断开</span>时间的<span style="color:#0000FF">长短</span>，通过改变直流电动机电枢上电压的<span style="color:#0000FF">占空比</span>来改变平均电压的大小，从而控制电动机的转速。</p>
<hr>
<p><img src="/blog/image/Snipaste_2025-07-03_08-36-27.png"></p>
<p>周期为 $T$，导通时间为 $t_{\text{on}}$，关断时间为 $t_{\text{off}}$，满足：</p>
<p>$$<br>T &#x3D; t_{\text{on}} + t_{\text{off}}<br>$$</p>
<p>平均电压（有效控制量）为：</p>
<p>$$<br>U_{as} &#x3D; U_s \cdot \frac{t_{\text{on}}}{T}<br>$$</p>
<hr>
<blockquote>
<p>以晶体管的开关特性满足电机的周期通断</p>
</blockquote>
<p><strong>改变占空比的两种调制方法</strong></p>
<table>
<thead>
<tr>
<th><strong>维度</strong></th>
<th><strong>脉冲宽度调制（PWM）</strong></th>
<th><strong>脉冲频率调制（PFM）</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>实现方式</strong></td>
<td>固定 <strong>开关周期 T</strong>，改变 <strong>导通脉冲宽度$t_{on}$</strong></td>
<td>固定 <strong>导通脉冲宽度</strong>，改变 <strong>开关周期 T</strong>（即改变频率 $f&#x3D;1&#x2F;T$)</td>
</tr>
<tr>
<td><strong>关键特性</strong></td>
<td>频率固定，仅脉宽变化。</td>
<td>脉宽固定，仅频率变化。</td>
</tr>
<tr>
<td><strong>缺陷</strong></td>
<td></td>
<td>若遇到 <strong>特定频率的机械谐振</strong>，会引发 <strong>系统振荡、音频啸叫声</strong></td>
</tr>
<tr>
<td><strong>应用场景</strong></td>
<td></td>
<td>因谐振问题，<strong>伺服系统中不适用</strong></td>
</tr>
</tbody></table>
<h3 id="直流电动机的调速方式"><a href="#直流电动机的调速方式" class="headerlink" title="直流电动机的调速方式"></a>直流电动机的调速方式</h3><p>直流速度控制系统常采用晶体管脉冲调制方式（<span style="color:#FF0000">PWM</span>）。</p>
<p><span style="color:#FF0000">PWM</span>方式是在大功率开关晶体管的基极上，加上脉冲宽度可调的方波电压，控制开关管的导通时间 $t$，改变占空比，达到控制目的。</p>
<p>图5.35 是直流<span style="color:#FF0000">PWM</span>系统原理框图。这是一个双闭环系统，有电流环和速度环。</p>
<ul>
<li>核心部分是<strong>脉冲功率放大器和脉宽调制器。</strong></li>
</ul>
<p><img src="/blog/image/Snipaste_2025-07-03_08-57-06.png"></p>
<h4 id="脉冲功率放大器（PWM-系统主回路）"><a href="#脉冲功率放大器（PWM-系统主回路）" class="headerlink" title="脉冲功率放大器（ＰＷＭ 系统主回路）"></a>脉冲功率放大器（ＰＷＭ 系统主回路）</h4><p><img src="/blog/image/Snipaste_2025-07-03_09-21-51.png"></p>
<ul>
<li>$VT_1 \sim VT_4$ 为大功率晶体管；</li>
<li>$VD_1 \sim VD_4$ 为续流二极管，用于保护 $VT_1 \sim VT_4$；</li>
<li>$SM$ 为直流伺服电动机。</li>
</ul>
<p><span style="color:#FF0000">工作原理</span></p>
<p><img src="/blog/../image/image-20250703095332404.png"></p>
<p>4 个功率管分为<strong>两组基极电压</strong></p>
<ul>
<li><p>$U_{b1} &#x3D; U_{b4}$（同相）</p>
</li>
<li><p>$U_{b2} &#x3D; U_{b3} &#x3D; -U_{b1}$(反相，与前一组互补）</p>
</li>
</ul>
<p><span style="color:#FF0000">当$0 \leq t \leq t_1$</span></p>
<ul>
<li><strong>基极电压</strong>：</li>
</ul>
<p>$U_{b1}、U_{b4}$为正（驱动 VT₁、VT₄导通）；$U_{b2}、U_{b3}$为负（ VT₂、VT₃截止）。</p>
<ul>
<li><strong>电流路径</strong>:（虚线 1）</li>
<li><strong>电机电压</strong>：两端加正向电压 <strong>$U_{AB} &#x3D; U_s$</strong>，电枢电流 $i_a$沿正向（A→B）增大</li>
</ul>
<hr>
<p><span style="color:#FF0000">$t_1 \leq t \leq T$</span></p>
<ul>
<li><p><strong>基极电压</strong>：$U_{b1}$、$U_{b4}$ 为负（$VT_1$、$VT_4$ 截止）；$U_{b2}$、$U_{b3}$ 为正（ $VT_2$、$VT_3$ 不能立即导通）。</p>
</li>
<li><p><strong>管子状态矛盾</strong>：$VT_1$、$VT_4$ 已截止，但 $VT_2$、$VT_3$ <span style="color:#FF0000">不能立即导通</span> —— 因为 <span style="color:#FF0000">电机电枢电感的反电动势</span> 阻碍电流突变：</p>
<ul>
<li>电感试图维持原电流方向（$A \rightarrow B$），产生 <span style="color:#FF0000">反向电动势</span>，迫使电流经 <span style="color:#FF0000">续流二极管 $VD_2$, $VD_3$</span> 形成回路。</li>
</ul>
</li>
<li><p><strong>续流路径（虚线 2）</strong>：</p>
<p>续流时，$VD_2$、$VD_3$ 的正向压降使 $VT_2$、$VT_3$ 承受 <span style="color:#FF0000">反向电压</span>，因此暂时无法导通。</p>
</li>
</ul>
<blockquote>
<p><strong>负半周的两种发展（决定电机转向）</strong></p>
</blockquote>
<p><strong>① 续流未断（负半周时间短）</strong></p>
<ul>
<li><p><strong>条件</strong>：$t_1 \sim T$ 时间短（负半周窄），或续流电流 $i_a$ 大→续流未降至零，<span style="color:#FF0000">下一个正半周已到来</span>（$U_{b1}$、$U_{b4}$ 又变正）。</p>
</li>
<li><p><strong>结果</strong>：$VT_1$、$VT_4$ 再次导通，电流沿回路 1 重新上升，$i_a$ 在 <span style="color:#FF0000">正值附近波动</span>。（对应图 5.37 (b) 的 $i_a$ 波形）</p>
</li>
</ul>
<p><strong>② 续流中断，电流反转（负半周时间长）</strong></p>
<ul>
<li><p><strong>条件</strong>：$t_1 \sim T$ 时间长（负半周宽），或续流电流 $i_a$ 小→续流降至零，此时 $U_{b2}$、$U_{b3}$ 的正电压驱动 $VT_2$、$VT_3$ 导通。</p>
</li>
<li><p><strong>反转电流路径（虚线 3）</strong>：<br>$$<br>+U_s \rightarrow VT_3 \rightarrow B \rightarrow SM \ (\text{电机}) \rightarrow A \rightarrow VT_2 \rightarrow \text{地}<br>$$</p>
</li>
</ul>
<p>电流方向 <span style="color:#FF0000">反向（$B \rightarrow A$）</span>（对应图 5.37 (c) 的 $i_a$ 波形）。</p>
<blockquote>
<p><span style="color:#FF0000"><strong>转向与转速的控制逻辑</strong></span></p>
<p>通过 <span style="color:#FF0000">正半周宽度 $t_1$</span> 和 <span style="color:#FF0000">负半周宽度 $T - t_1$</span> 的对比，决定电机的 <span style="color:#FF0000">转向和转速</span>：</p>
<ol>
<li><strong>正转</strong>：$t_1 &gt; T - t_1 \Rightarrow$ 电压平均值 $U_{AB} &gt; 0$，<strong>电机正转</strong>，正转转速随 $t_1$ 增大而升高（正脉冲越宽，平均电压越高）。</li>
<li><strong>反转</strong>：$t_1 &lt; T - t_1 \Rightarrow$ 电压平均值 $U_{AB} &lt; 0$，<strong>电机反转</strong>，反转转速随 $T - t_1$ 增大而升高（负脉冲越宽，反向平均电压越高）。</li>
<li><strong>停转</strong>：$t_1 &#x3D; T - t_1 \Rightarrow$ 正负脉冲对称，平均电压 $U_{AB} &#x3D; 0$，电机停止。</li>
</ol>
<blockquote>
<p>在一个开关周期内，$AB$ 端的<strong>平均电压</strong>为：</p>
<p>当 $0 \leq t &lt; t_1$ 时，$U_{AB} &#x3D; U_s$；</p>
<p>当 $t_1 \leq t &lt;T $ 时，$U_{AB} &#x3D; -U_s$；<br>$$<br>U_{AB} &#x3D; \frac{t_1}{T} U_s - \frac{T - t_1}{T} U_s<br>$$</p>
<p>$$<br>&#x3D; \left( \frac{2t_1}{T} - 1 \right) U_s<br>$$</p>
<p>$$<br>&#x3D; \rho U_s<br>$$</p>
<p>$$<br>U_{AB} &#x3D; \left( \frac{2t_1}{T} - 1 \right) U_s<br>$$</p>
<p><strong>占空比</strong><br>$$<br>\rho &#x3D; \frac{2t_1}{T} - 1 \quad (-1 \leq \rho \leq 1)<br>$$</p>
</blockquote>
</blockquote>
<h3 id="脉宽调制器（PWM系统控制回路）"><a href="#脉宽调制器（PWM系统控制回路）" class="headerlink" title="脉宽调制器（PWM系统控制回路）"></a>脉宽调制器（PWM系统控制回路）</h3><ul>
<li><p>能将电压信号（代表速度）转换为脉冲宽度的调节变换装置称为<strong>脉宽调制器</strong>。</p>
</li>
<li><p>脉宽调制器的调制信号有两种：<strong>锯齿波和三角波</strong></p>
</li>
</ul>
<p>脉宽调制器的<strong>优点</strong>如下：</p>
<p>1）响应快。<br>2）电源利用率高。<br>3）动态特性好，响应频带宽。<br>4）稳速精度高。<br>5）损耗小。</p>
<p><strong>缺点</strong>：功率晶体管承受高峰值电流的能力较差。</p>
<p>脉宽调制的<strong>任务</strong>是将连续控制信号变成方波控制信号，加在主回路上功率晶体管的基极，作为输入信号，来控制直流电动机的转速和转矩。</p>
<p><img src="/blog/image/Snipaste_2025-07-03_14-15-41.png"></p>
<p> <strong>针对此图的补充</strong>：<span style="color:#FF0000">PWM</span> 晶体管功率放大器的工作原理是：三角波发生器产生对称三角波载波 $U_T$，与转速控制电压 $U_I$ 经过加法器叠加后，输入比较器与 0 电位比较，生成占空比随 $U_I$ 变化的 PWM 方波 $U_S$；</p>
<p>该方波经功率放大器放大为驱动信号 $U_P$，借助 PWM 脉宽的平均电压特性调控伺服电动机转速，通过三角波对称性和控制滤波，实现“电压指令 → 脉宽调制 → 功率驱动 → 转速控制”的精准闭环。</p>
<p>核心是利用载波与指令的融合，将模拟电压转换为脉宽信号，最终驱动电机运行。</p>
<h2 id="放大电路中的反馈"><a href="#放大电路中的反馈" class="headerlink" title="放大电路中的反馈"></a>放大电路中的反馈</h2><p><img src="/blog/image/20250705085329.png"></p>
<h1 id="第六章-电液伺服控制系统"><a href="#第六章-电液伺服控制系统" class="headerlink" title="第六章 电液伺服控制系统"></a>第六章 电液伺服控制系统</h1><h2 id="电液比例流量控制"><a href="#电液比例流量控制" class="headerlink" title="电液比例流量控制"></a>电液比例流量控制</h2><p><u>电液比例流量控制系统</u>用<u>电液比例流量阀</u>来控制<u>系统的速度</u>，也称电液比例速度控制系统，是一种阀控比例系统。</p>
<p> <strong>电液比例速度调节</strong>有三种方式：  </p>
<ul>
<li><p>比例节流调速</p>
</li>
<li><p>比例容积调速</p>
</li>
<li><p>比例容积节流调速</p>
</li>
</ul>
<h3 id="闭环同步调速系统"><a href="#闭环同步调速系统" class="headerlink" title="闭环同步调速系统"></a>闭环同步调速系统</h3><p><img src="/blog/image/Snipaste_2025-07-03_16-13-32.png"></p>
<p><span style="color:#FF0000">采用两个电液比例调速阀实现闭环同步控制速度系统</span></p>
<h4 id="系统结构框图描述："><a href="#系统结构框图描述：" class="headerlink" title="系统结构框图描述："></a>系统结构框图描述：</h4><ul>
<li>主动液压缸：$1$</li>
<li>随动液压缸：$2$</li>
<li>位移传感器$L_1$、$L_2$输出：$U_1$、$U_2$</li>
<li>电压比较差值：$\Delta U &#x3D; U_2 - U_1$</li>
<li>放大器：$A_1$, $A_2$</li>
<li>比例调速阀：$BQ(1)$, $BQ(2)$</li>
<li>电流信号：$I_1$, $I_2$</li>
<li>基准速度电压：$U_0$</li>
</ul>
<hr>
<p><strong>工作过程</strong>：</p>
<ol>
<li><p>当 $1$ 和 $2$ 双缸同步，则：</p>
<p>$$<br>U_1 &#x3D; U_2, \quad \Delta U &#x3D; U_2 - U_1 &#x3D; 0<br>$$</p>
<p>两缸速度相等。</p>
</li>
<li><p>当 $1$ 和 $2$ 不同步时，则：</p>
<p>$$<br>\Delta U &#x3D; U_2 - U_1 \neq 0<br>$$</p>
<p>若 $U_2 &gt; U_1$，即 2 缸运行较快：</p>
<ul>
<li>此时 $U_0 - \Delta U$ 输入到 $A_2$ 放大器中。</li>
<li>原速度信号 $U_0$ 不变，但 $A_2$ 输出的 $I_2$ 要相应减小。</li>
<li>使得 $BQ_2$ 输出流量比例减小，导致 2 缸速度降低。</li>
<li>当速度再次与缸1相等时，$\Delta U &#x3D; 0$，$I_2$ 恢复。</li>
</ul>
</li>
</ol>
<p>由于 $U_0$ 不变、$I_1$ 不变，因此缸1速度始终不变。</p>
<blockquote>
<p><strong>例题</strong></p>
<p>下图是油缸闭环同步调速系统示意图，图中 $U_1$、$U_2$ 分别是油缸 1 和油缸 2 的速度输出信号，幅度为 $0,V \sim 5,V$。当两缸不同步时，则：$\Delta U &#x3D; U_1 - U_2 \ne 0$作为控制器输出，幅度为 $-5,V \sim 5,V$。</p>
<p>$U_1$、$U_2$ 作为控制器输入，用运算放大器、电阻等元件设计该比例控制器的电路图。可不必标具体参数值。</p>
<p><img src="/blog/../image/Snipaste_2025-07-03_16-13-32.png"></p>
<p><strong>要求完成：</strong></p>
<p>“输入 $U_1$ 与 输入 $U_2$” 构成减法关系。</p>
<p><strong>说明</strong>：答案不唯一，电路图只要完成上述功能即可。</p>
<p><img src="/blog/image/Snipaste_2025-07-03_17-02-39.png"></p>
<p><img src="/blog/image/Snipaste_2025-07-09_09-41-34.png"></p>
</blockquote>
<h2 id="比例控制放大器主要电路的构成、原理及功能"><a href="#比例控制放大器主要电路的构成、原理及功能" class="headerlink" title="比例控制放大器主要电路的构成、原理及功能"></a>比例控制放大器主要电路的构成、原理及功能</h2><h3 id="电源电路"><a href="#电源电路" class="headerlink" title="电源电路"></a>电源电路</h3><p><span style="color:#0000FF">① 主要作用</span></p>
<p>从标准电源中获得和分离出比例控制放大器正常工作所需的各种直流稳定电源，并且在电网电压、负载电流及环境温度允许范围内变化时，保证输出直流电压的稳定性。</p>
<p><span style="color:#FF0000">✔</span> 同时，还兼具电源电压极性反接、过流、短路自保护自恢复等非熔断式保护功能，以保证比例控制放大器的工作可靠性。</p>
<hr>
<p><span style="color:#0000FF">② 构成</span></p>
<p>包括<strong>滤波、稳压和过载保护</strong>等部分。</p>
<h3 id="输入接口单元"><a href="#输入接口单元" class="headerlink" title="输入接口单元"></a>输入接口单元</h3><p>用来满足各种外设需要，增强适应性。（包括<u>模拟量接口</u>、<u>数字量接口</u>、<u>遥控接口</u>等）。</p>
<h3 id="信号处理电路"><a href="#信号处理电路" class="headerlink" title="信号处理电路"></a>信号处理电路</h3><p>为适应各种不同控制对象和工况的要求， 比例控制放大器中还有各种信号处理电路，对输入信号进行相应的处理。</p>
<p>最常见的有<u>斜坡信号发生器</u>，<u>阶跃函数发生器</u>，<u>双路平衡电路</u>，<u>初始电流设定电路</u>等。</p>
<h4 id="斜坡信号发生器"><a href="#斜坡信号发生器" class="headerlink" title="斜坡信号发生器"></a><span style="color:#FF0000">斜坡信号发生器</span></h4><ul>
<li><p>以一个设定值<strong>阶跃</strong>作输入信号，斜坡发生器产生一个线慢上升或下降的输出信号。</p>
</li>
<li><p>输出信号的<strong>变化速率</strong>可通过电位器调节。</p>
</li>
</ul>
<p><span style="color:#FF0000">斜坡发生器的作用原理：</span><br>在输入阶跃信号情况下，由于电容C充电的阻滞现象，可使输出电压缓慢连续地变化。<br>调节电阻R能够改变输出电压的斜率，也就是决定电容C的充电速度。</p>
<p><img src="/blog/image/Snipaste_2025-07-04_09-39-32.png"></p>
<h4 id="阶跃函数发生器"><a href="#阶跃函数发生器" class="headerlink" title="阶跃函数发生器"></a>阶跃函数发生器</h4><p>阶跃函数发生器，在设定值电压<strong>大于</strong>一个较小的电压值 $u_i$ 时产生一个恒定的输出信号，其大小可由 $P_1, P_2$ 调节。当设定值电压<strong>小于</strong> $u_i$ 时，输出信号为零。</p>
<p><img src="/blog/image/Snipaste_2025-07-04_10-05-37.png"></p>
<h4 id="双路平衡电路"><a href="#双路平衡电路" class="headerlink" title="双路平衡电路"></a><span style="color:#FF0000">双路平衡电路</span></h4><p>在双路比例控制放大器中，为使两个比例电磁铁分别正常动作，且在两个比例电磁铁参数有所不同的情况下仍能得到对称的控制特性，常采用双路平衡电路，</p>
<p>如图 6.18 所示。调节电位器 $P$，使 $B$ 路比例电磁铁控制通道的增益与 $A$ 路比例电磁铁控制通道的增益相同，同时使 $B$ 路控制信号反相，保证比例电磁铁 $A$ 和 $B$ 实现<strong>差动</strong>工作。</p>
<p><img src="/blog/image/Snipaste_2025-07-04_10-27-41.png"></p>
<h4 id="初始电流设定电路"><a href="#初始电流设定电路" class="headerlink" title="初始电流设定电路"></a>初始电流设定电路</h4><p>主要用于产生比例电磁铁的预激磁电流，调整比例阀的零位死区大小，或避开死区。 使比例阀在设定值输入时，从起始位置迅速启动  </p>
<h4 id="颤振信号发生器"><a href="#颤振信号发生器" class="headerlink" title="颤振信号发生器"></a>颤振信号发生器</h4><p><span style="color:#FF0000">为降低比例电磁铁的摩擦滞环，往往采用在控制信号上叠加颤振信号的方法  </span></p>
<p><img src="/blog/image/Snipaste_2025-07-04_14-27-46.png"></p>
<ul>
<li><span style="color:#FF0000">调节$R$可改变颤振信号频率，调节$R_1$可改变颤振信号的幅值  </span></li>
<li>图中 $A_1$ 组成同相施密特触发器，$A_2$ 组成反相积分器。</li>
<li>通过 $R_2$ 构成正反馈，形成自激振荡，由 $A_1$ 输出方波，$A_2$ 输出三角波，</li>
<li>方波发生器由三角波触发，积分器 $A_2$ 对方波输出电压积分。</li>
</ul>
<p>为求出三角波的最大值，设方波电压为 $-V_z$，负的电压输入积分器，使它的输出电压为 $u_o$，<br>形成正的斜坡电压。利用叠加原理得：<br>$$<br>\frac{u_o-V_+}{ R_2} &#x3D; \frac{V_+-(-V_z)}{R_1}  \tag{6-1}<br>$$</p>
<p>$$<br>V_+ &#x3D; \frac{R_1}{R_1 + R_2} u_o - \frac{R_2}{R_1 + R_2} V_z \tag{6-1}<br>$$</p>
<p>因 $V_+ &#x3D; 0$ 时，由于比较器负端接地，$A_1$ 改变状态，所以$u_0$最大值出现在 $V_+ &#x3D; 0$ 时，</p>
<blockquote>
<p><span style="color:#FF0000">三角波电压 $u_0$的最大值为何出现在 $V_+ &#x3D; 0$的位置?</span></p>
<ul>
<li><strong>运放 A₁</strong>：输出 <strong>方波</strong>（幅度 $  \pm V_z  $），反相端接地（$  V_- &#x3D; 0  $），同相端 $  V_+  $ 接收两路反馈：</li>
</ul>
<p>支路 1：三角波 $  u_0  $（运放 A₂输出）经电阻 $  R_2  $ 连接到 $  V_+  $；</p>
<p>支路 2：方波（A₁自身输出）经电阻 $  R_1  $ 连接到 $  V_+  $。</p>
<ul>
<li><strong>运放 A₂（积分器）</strong>：对方波积分，输出 **三角波 **（线性上升 &#x2F; 下降），再反馈到 A₁的同相端，形成闭环振荡。</li>
</ul>
<hr>
<p>A1输出状态由 **同相端 与反相端 **的电位关系 决定：</p>
<ul>
<li><p>当 $  \boldsymbol{V_+ &gt; 0}  $：A₁输出 **正饱和电平 **</p>
</li>
<li><p>当 $  \boldsymbol{V_+ &lt; 0}  $：A₁输出 **负饱和电平 **</p>
</li>
<li><p>当 $  \boldsymbol{V_+ &#x3D; 0}  $：是状态切换的 <strong>临界点</strong>（从 “$  V_+ &lt; 0  $” 跳变到 “$  V_+ &gt; 0  $”，或反之）。</p>
</li>
<li><p>本质上是一种电压比较器</p>
</li>
</ul>
<hr>
<ul>
<li>A₁输出 **（负方波），A₂的积分器对 $-V_z$ 积分，使三角波 $  u_0  $ **线性上升（积分输入为负，输出反向增大，即从负向向正向上升）。</li>
</ul>
<p>$$<br>u_0&#x3D;-\frac{1}{RC} \int u_{o1} dt&#x3D;\frac{1}{RC} \int V_z dt<br>$$</p>
<ul>
<li><p>随着 $  u_0  $ 上升，支路 1 的反馈使 $  V_+  $ 逐渐升高。$V_+ &#x3D; \frac{R_1}{R_1 + R_2} u_o - \frac{R_2}{R_1 + R_2} V_z \tag{6-1}$</p>
</li>
<li><p>当 $  u_0  $ 上升到某一值时，$  V_+  $ 恰好等于 <strong>0</strong>：</p>
</li>
<li><p>此前，$  V_+ &lt; 0  $，A₁保持输出 $-V_z$，$  u_0  $ 持续上升；</p>
</li>
<li><p>当 $  V_+ &#x3D; 0  $ 瞬间，**继续上升的$u_0$ 会使 触发 A₁ **状态翻转（输出从 $-V_z$ 跳变为 $+V_z$）。</p>
</li>
<li><p>A₁输出跳变为 $+V_z$ 后，积分器的输入极性反转（从 “积分 $-V_z$” 变为 “积分 $+V_z$”），导致三角波 $  u_0  $ <strong>从上升转为下降</strong>。因此：</p>
<ul>
<li>$V_+&#x3D;0$是上升阶段的终点**，此时 $  u_0  $ 达到 **正向最大值</li>
</ul>
</li>
</ul>
</blockquote>
<p>由式 (6-1) 得：<br>$$<br>u_{o\max} &#x3D; \frac{R_2}{R_1} V_z \tag{6-2}<br>$$</p>
<p>同理，三角波的<strong>最低电压</strong>为：</p>
<p>(方波电压为 $V_z$,  $V_+ &#x3D; \frac{R_1}{R_1 + R_2} u_o + \frac{R_2}{R_1 + R_2} V_z \tag{6-1}$  $V_+&#x3D;0$时有$u_{o\min}$ )<br>$$<br>u_{o\min} &#x3D; -\frac{R_2}{R_1} V_z<br>$$</p>
<p><strong>最大振幅</strong>为：<br>$$<br>u_{o\max} - u_{o\min} &#x3D; 2 \frac{R_2}{R_1} V_z \tag{6-3}<br>$$<br><strong>可见，改变 $R_2$ 与 $R_1$ 的比值，可改变它的振幅</strong>。下面计算三角波的周期和频率。</p>
<p>当 $t &#x3D; 0$ 时，设积分器的输入电压为 $-V_z$，则 $A_2$ 的输出电压为：</p>
<p>$$<br>u_o(t) &#x3D; -\frac{1}{RC} \int_0^t (-V_z) , dt + u_o(t)\big|_{t&#x3D;0}<br>$$</p>
<p>积分后得：</p>
<p>$$<br>u_o(t) &#x3D; \frac{V_z}{RC} t - V_z \frac{R_2}{R_1} \tag{6-4}<br>$$</p>
<p>当 $t &#x3D; \frac{T}{2}$ 时，方波发生器翻转，此时应有 $V_+ &#x3D; 0$，<br>$u_o\left[\frac{T}{2}\right] &#x3D; u_{o\max} &#x3D; \frac{R_2}{R_1} V_z$，将 $t &#x3D; \frac{T}{2}$ 代入式 (6-4)，得：</p>
<p>$$<br>T &#x3D; \frac{4 R_2 RC}{R_1} \tag{6-5}<br>$$<br>振荡频率为：</p>
<p>$$<br>f &#x3D; \frac{1}{T} &#x3D; \frac{R_1}{4RC R_2} \tag{6-6}<br>$$</p>
<p>可见频率与幅值无关，改变 $R, C$ 或 $R_1&#x2F;R_2$ 均可改变频率。<br>然而，改变 $R_1 &#x2F; R_2$ 虽不影响方波的输出幅值，但会影响三角波的幅值。<br>方波的幅值由下式确定：<br>$$<br>u_{o1} &#x3D; 2(E_w + V_D) \tag{6-7}<br>$$</p>
<h4 id="测量放大电路"><a href="#测量放大电路" class="headerlink" title="测量放大电路"></a>测量放大电路</h4><p>在位移电反馈比例控制放大器中，为了通过装在比例阀上的位移传感器构成电反馈闭环，往往附加有与传感器匹配的测量放大电路  </p>
<h4 id="功率放大级"><a href="#功率放大级" class="headerlink" title="功率放大级"></a>功率放大级</h4><ul>
<li><p>功率放大级主要由<u>信号放大</u>和<u>功率驱动电路</u>组成  </p>
</li>
<li><p>根据功率放大级工作原理的不同，比例控制放大器有<u>模拟式</u>和<u>开关式</u>之分  </p>
</li>
<li><p>模拟式功率放大级：这种功率放大级技术比较成熟，结构简单，稳态控制性能较好，但功耗较大  </p>
</li>
<li><p>开关式功率放大级有<u>脉宽调制、脉频调制、脉幅调制、脉码调制</u>等多种方式  ，以<strong>脉宽调制（ＰＷＭ ）式最为常用</strong>  </p>
</li>
<li><p><strong>脉宽调制功率放大级</strong>  ：由脉宽调制器、功率驱动电路、电流负反馈单元、电流调节器等组成</p>
</li>
</ul>
<p><span style="color:#FF0000"><strong>脉宽调制式功率放大级</strong></span></p>
<p><img src="/blog/image/Snipaste_2025-07-04_15-03-01.png"></p>
<table>
<thead>
<tr>
<th>运放</th>
<th>角色</th>
<th>核心贡献</th>
</tr>
</thead>
<tbody><tr>
<td>A₁</td>
<td>电流调节器</td>
<td>放大误差信号</td>
</tr>
<tr>
<td>A₂</td>
<td>比较器</td>
<td>电压→脉冲信号</td>
</tr>
<tr>
<td>A₃</td>
<td>施密特触发器</td>
<td>生成方波</td>
</tr>
<tr>
<td>A₄</td>
<td>反相积分器</td>
<td>方波→三角波</td>
</tr>
<tr>
<td>A₃+A₄</td>
<td>三角波调制信号发生器</td>
<td>生成三角波</td>
</tr>
<tr>
<td>A₂+A₃+A₄</td>
<td>脉宽调制器</td>
<td><strong>将连续变化信号转换成脉宽调制信号</strong></td>
</tr>
<tr>
<td>A₅</td>
<td>差动电压放大器</td>
<td>对电流采样信号进行综合、滤波和放大，构成电流负反馈</td>
</tr>
</tbody></table>
<ul>
<li><p>当输入电压 $u_i \leq 0$ 时，$A_1$ 正向饱和，$A_2$ 负向饱和，<strong>功率驱动电路各功放管截止</strong>，输出电流 $i &#x3D; 0$。</p>
</li>
<li><p>当 $u_i &gt; 0$ 时，$u_i$ 与反馈信号 $u_f$ 相比较，其差值经过电流调节器 $A_1$ 运算放大后输给脉宽调制器，<strong>脉宽调制器</strong><u>将电流调节器输出的连续信号转换成脉冲宽度与其大小成比例的脉冲信号</u>，该脉冲信号经过功率驱动电路功率放大，在比例电磁铁线圈两端产生与之同相的脉冲电压 $u_s$，当开关频率远高于三角电磁线圈的截止频率时，由于比例电磁铁线圈的惯性，在线圈上就可得到平均值与脉宽成比例的、带有交流纹波分量的直流电流  </p>
</li>
<li><p>与此同时，输出电流经过采样电阻 $R_f$ 检测，滤波及放大，反馈到输入端，构成输出电流平均值的闭环调节  。此闭环削弱了前向放大环节非线性，增益变化，负载阻抗变化以及电源电压波动对输出电流的影响。</p>
</li>
</ul>
<blockquote>
<p><span style="color:#FF0000">脉宽调制式功率放大级的工作原理为：</span></p>
<ol>
<li>当 $u_i \leq 0$ 时，$A_1$、$A_2$ 处于饱和状态，电磁铁电流 $i &#x3D; 0$；</li>
<li>当 $u_i &gt; 0$ 时，$u_i$ 与反馈信号 $u_f$ 相比较，其差值经过电流调节器 $A_1$ 运算放大后输给由$A_2,A_3, A_4$ 构成的脉宽调制器，</li>
<li><strong>脉宽调制器</strong><u>将电流调节器输出的连续信号转换成脉冲宽度与其大小成比例的脉冲信号</u>，该脉冲信号经过功率驱动电路功率放大，在比例电磁铁线圈两端产生与之同相的脉冲电压 $u_s$，当开关频率远高于三角电磁线圈的截止频率时，由于比例电磁铁线圈的惯性，在线圈上就可得到<u>平均值与脉宽成比例的、带有交流纹波分量的直流电流</u></li>
<li>输出电流经过采样电阻 $R_f$ 检测，滤波及放大，反馈到输入端，构成输出电流平均值的闭环调节</li>
</ol>
</blockquote>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>机电一体化分析与建模</tag>
      </tags>
  </entry>
  <entry>
    <title>机电一体化分析与建模（二）</title>
    <url>/blog/2025/06/29/%E7%AC%AC%E4%BA%94%E7%AB%A0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="第六章-电液伺服控制系统"><a href="#第六章-电液伺服控制系统" class="headerlink" title="第六章 电液伺服控制系统"></a>第六章 电液伺服控制系统</h1><h2 id="电液比例流量控制"><a href="#电液比例流量控制" class="headerlink" title="电液比例流量控制"></a>电液比例流量控制</h2><p><u>电液比例流量控制系统</u>用<u>电液比例流量阀</u>来控制<u>系统的速度</u>，也称电液比例速度控制系统，是一种阀控比例系统。</p>
<p> <strong>电液比例速度调节</strong>有三种方式：  </p>
<ul>
<li><p>比例节流调速</p>
</li>
<li><p>比例容积调速</p>
</li>
<li><p>比例容积节流调速</p>
</li>
</ul>
<h3 id="闭环同步调速系统"><a href="#闭环同步调速系统" class="headerlink" title="闭环同步调速系统"></a>闭环同步调速系统</h3><p><img src="/blog/../image/Snipaste_2025-07-03_16-13-32-17520423721791.png"></p>
<p><span style="color:#FF0000">采用两个电液比例调速阀实现闭环同步控制速度系统</span></p>
<h4 id="系统结构框图描述："><a href="#系统结构框图描述：" class="headerlink" title="系统结构框图描述："></a>系统结构框图描述：</h4><ul>
<li>主动液压缸：$1$</li>
<li>随动液压缸：$2$</li>
<li>位移传感器$L_1$、$L_2$输出：$U_1$、$U_2$</li>
<li>电压比较差值：$\Delta U &#x3D; U_2 - U_1$</li>
<li>放大器：$A_1$, $A_2$</li>
<li>比例调速阀：$BQ(1)$, $BQ(2)$</li>
<li>电流信号：$I_1$, $I_2$</li>
<li>基准速度电压：$U_0$</li>
</ul>
<hr>
<p><strong>工作过程</strong>：</p>
<ol>
<li><p>当 $1$ 和 $2$ 双缸同步，则：</p>
<p>$$<br>U_1 &#x3D; U_2, \quad \Delta U &#x3D; U_2 - U_1 &#x3D; 0<br>$$</p>
<p>两缸速度相等。</p>
</li>
<li><p>当 $1$ 和 $2$ 不同步时，则：</p>
<p>$$<br>\Delta U &#x3D; U_2 - U_1 \neq 0<br>$$</p>
<p>若 $U_2 &gt; U_1$，即 2 缸运行较快：</p>
<ul>
<li>此时 $U_0 - \Delta U$ 输入到 $A_2$ 放大器中。</li>
<li>原速度信号 $U_0$ 不变，但 $A_2$ 输出的 $I_2$ 要相应减小。</li>
<li>使得 $BQ_2$ 输出流量比例减小，导致 2 缸速度降低。</li>
<li>当速度再次与缸1相等时，$\Delta U &#x3D; 0$，$I_2$ 恢复。</li>
</ul>
</li>
</ol>
<p>由于 $U_0$ 不变、$I_1$ 不变，因此缸1速度始终不变。</p>
<blockquote>
<p><strong>例题</strong></p>
<p>下图是油缸闭环同步调速系统示意图，图中 $U_1$、$U_2$ 分别是油缸 1 和油缸 2 的速度输出信号，幅度为 $0,V \sim 5,V$。当两缸不同步时，则：$\Delta U &#x3D; U_1 - U_2 \ne 0$作为控制器输出，幅度为 $-5,V \sim 5,V$。</p>
<p>$U_1$、$U_2$ 作为控制器输入，用运算放大器、电阻等元件设计该比例控制器的电路图。可不必标具体参数值。</p>
<p><img src="/blog/../image/Snipaste_2025-07-03_16-13-32.png"></p>
<p><strong>要求完成：</strong></p>
<p>“输入 $U_1$ 与 输入 $U_2$” 构成减法关系。</p>
<p><strong>说明</strong>：答案不唯一，电路图只要完成上述功能即可。</p>
<p><img src="/blog/../image/Snipaste_2025-07-03_17-02-39-17520423721805.png"></p>
<p><img src="/blog/../image/Snipaste_2025-07-09_09-41-34.png"></p>
</blockquote>
<h2 id="比例控制放大器主要电路的构成、原理及功能"><a href="#比例控制放大器主要电路的构成、原理及功能" class="headerlink" title="比例控制放大器主要电路的构成、原理及功能"></a>比例控制放大器主要电路的构成、原理及功能</h2><h3 id="电源电路"><a href="#电源电路" class="headerlink" title="电源电路"></a>电源电路</h3><p><span style="color:#0000FF">① 主要作用</span></p>
<p>从标准电源中获得和分离出比例控制放大器正常工作所需的各种直流稳定电源，并且在电网电压、负载电流及环境温度允许范围内变化时，保证输出直流电压的稳定性。</p>
<p><span style="color:#FF0000">✔</span> 同时，还兼具电源电压极性反接、过流、短路自保护自恢复等非熔断式保护功能，以保证比例控制放大器的工作可靠性。</p>
<hr>
<p><span style="color:#0000FF">② 构成</span></p>
<p>包括<strong>滤波、稳压和过载保护</strong>等部分。</p>
<h3 id="输入接口单元"><a href="#输入接口单元" class="headerlink" title="输入接口单元"></a>输入接口单元</h3><p>用来满足各种外设需要，增强适应性。（包括<u>模拟量接口</u>、<u>数字量接口</u>、<u>遥控接口</u>等）。</p>
<h3 id="信号处理电路"><a href="#信号处理电路" class="headerlink" title="信号处理电路"></a>信号处理电路</h3><p>为适应各种不同控制对象和工况的要求， 比例控制放大器中还有各种信号处理电路，对输入信号进行相应的处理。</p>
<p>最常见的有<u>斜坡信号发生器</u>，<u>阶跃函数发生器</u>，<u>双路平衡电路</u>，<u>初始电流设定电路</u>等。</p>
<h4 id="斜坡信号发生器"><a href="#斜坡信号发生器" class="headerlink" title="斜坡信号发生器"></a><span style="color:#FF0000">斜坡信号发生器</span></h4><ul>
<li><p>以一个设定值<strong>阶跃</strong>作输入信号，斜坡发生器产生一个线慢上升或下降的输出信号。</p>
</li>
<li><p>输出信号的<strong>变化速率</strong>可通过电位器调节。</p>
</li>
</ul>
<p><span style="color:#FF0000">斜坡发生器的作用原理：</span><br>在输入阶跃信号情况下，由于电容C充电的阻滞现象，可使输出电压缓慢连续地变化。<br>调节电阻R能够改变输出电压的斜率，也就是决定电容C的充电速度。</p>
<p><img src="/blog/../image/Snipaste_2025-07-04_09-39-32-17520423721803.png"></p>
<h4 id="阶跃函数发生器"><a href="#阶跃函数发生器" class="headerlink" title="阶跃函数发生器"></a>阶跃函数发生器</h4><p>阶跃函数发生器，在设定值电压<strong>大于</strong>一个较小的电压值 $u_i$ 时产生一个恒定的输出信号，其大小可由 $P_1, P_2$ 调节。当设定值电压<strong>小于</strong> $u_i$ 时，输出信号为零。</p>
<p><img src="/blog/../image/Snipaste_2025-07-04_10-05-37-17520423721802.png"></p>
<h4 id="双路平衡电路"><a href="#双路平衡电路" class="headerlink" title="双路平衡电路"></a><span style="color:#FF0000">双路平衡电路</span></h4><p>在双路比例控制放大器中，为使两个比例电磁铁分别正常动作，且在两个比例电磁铁参数有所不同的情况下仍能得到对称的控制特性，常采用双路平衡电路，</p>
<p>如图 6.18 所示。调节电位器 $P$，使 $B$ 路比例电磁铁控制通道的增益与 $A$ 路比例电磁铁控制通道的增益相同，同时使 $B$ 路控制信号反相，保证比例电磁铁 $A$ 和 $B$ 实现<strong>差动</strong>工作。</p>
<p><img src="/blog/../image/Snipaste_2025-07-04_10-27-41-17520423721804.png"></p>
<h4 id="初始电流设定电路"><a href="#初始电流设定电路" class="headerlink" title="初始电流设定电路"></a>初始电流设定电路</h4><p>主要用于产生比例电磁铁的预激磁电流，调整比例阀的零位死区大小，或避开死区。 使比例阀在设定值输入时，从起始位置迅速启动  </p>
<h4 id="颤振信号发生器"><a href="#颤振信号发生器" class="headerlink" title="颤振信号发生器"></a>颤振信号发生器</h4><p><span style="color:#FF0000">为降低比例电磁铁的摩擦滞环，往往采用在控制信号上叠加颤振信号的方法  </span></p>
<p><img src="/blog/../image/Snipaste_2025-07-04_14-27-46-17520423721806.png"></p>
<ul>
<li><span style="color:#FF0000">调节$R$可改变颤振信号频率，调节$R_1$可改变颤振信号的幅值  </span></li>
<li>图中 $A_1$ 组成同相施密特触发器，$A_2$ 组成反相积分器。</li>
<li>通过 $R_2$ 构成正反馈，形成自激振荡，由 $A_1$ 输出方波，$A_2$ 输出三角波，</li>
<li>方波发生器由三角波触发，积分器 $A_2$ 对方波输出电压积分。</li>
</ul>
<p>为求出三角波的最大值，设方波电压为 $-V_z$，负的电压输入积分器，使它的输出电压为 $u_o$，<br>形成正的斜坡电压。利用叠加原理得：<br>$$<br>\frac{u_o-V_+}{ R_2} &#x3D; \frac{V_+-(-V_z)}{R_1}  \tag{6-1}<br>$$</p>
<p>$$<br>V_+ &#x3D; \frac{R_1}{R_1 + R_2} u_o - \frac{R_2}{R_1 + R_2} V_z \tag{6-1}<br>$$</p>
<p>因 $V_+ &#x3D; 0$ 时，由于比较器负端接地，$A_1$ 改变状态，所以$u_0$最大值出现在 $V_+ &#x3D; 0$ 时，</p>
<blockquote>
<p><span style="color:#FF0000">三角波电压 $u_0$的最大值为何出现在 $V_+ &#x3D; 0$的位置?</span></p>
<ul>
<li><strong>运放 A₁</strong>：输出 <strong>方波</strong>（幅度 $  \pm V_z  $），反相端接地（$  V_- &#x3D; 0  $），同相端 $  V_+  $ 接收两路反馈：</li>
</ul>
<p>支路 1：三角波 $  u_0  $（运放 A₂输出）经电阻 $  R_2  $ 连接到 $  V_+  $；</p>
<p>支路 2：方波（A₁自身输出）经电阻 $  R_1  $ 连接到 $  V_+  $。</p>
<ul>
<li><strong>运放 A₂（积分器）</strong>：对方波积分，输出 **三角波 **（线性上升 &#x2F; 下降），再反馈到 A₁的同相端，形成闭环振荡。</li>
</ul>
<hr>
<p>A1输出状态由 **同相端 与反相端 **的电位关系 决定：</p>
<ul>
<li><p>当 $  \boldsymbol{V_+ &gt; 0}  $：A₁输出 **正饱和电平 **</p>
</li>
<li><p>当 $  \boldsymbol{V_+ &lt; 0}  $：A₁输出 **负饱和电平 **</p>
</li>
<li><p>当 $  \boldsymbol{V_+ &#x3D; 0}  $：是状态切换的 <strong>临界点</strong>（从 “$  V_+ &lt; 0  $” 跳变到 “$  V_+ &gt; 0  $”，或反之）。</p>
</li>
<li><p>本质上是一种电压比较器</p>
</li>
</ul>
<hr>
<ul>
<li>A₁输出 **（负方波），A₂的积分器对 $-V_z$ 积分，使三角波 $  u_0  $ **线性上升（积分输入为负，输出反向增大，即从负向向正向上升）。</li>
</ul>
<p>$$<br>u_0&#x3D;-\frac{1}{RC} \int u_{o1} dt&#x3D;\frac{1}{RC} \int V_z dt<br>$$</p>
<ul>
<li><p>随着 $  u_0  $ 上升，支路 1 的反馈使 $  V_+  $ 逐渐升高。$V_+ &#x3D; \frac{R_1}{R_1 + R_2} u_o - \frac{R_2}{R_1 + R_2} V_z \tag{6-1}$</p>
</li>
<li><p>当 $  u_0  $ 上升到某一值时，$  V_+  $ 恰好等于 <strong>0</strong>：</p>
</li>
<li><p>此前，$  V_+ &lt; 0  $，A₁保持输出 $-V_z$，$  u_0  $ 持续上升；</p>
</li>
<li><p>当 $  V_+ &#x3D; 0  $ 瞬间，**继续上升的$u_0$ 会使 触发 A₁ **状态翻转（输出从 $-V_z$ 跳变为 $+V_z$）。</p>
</li>
<li><p>A₁输出跳变为 $+V_z$ 后，积分器的输入极性反转（从 “积分 $-V_z$” 变为 “积分 $+V_z$”），导致三角波 $  u_0  $ <strong>从上升转为下降</strong>。因此：</p>
<ul>
<li>$V_+&#x3D;0$是上升阶段的终点**，此时 $  u_0  $ 达到 **正向最大值</li>
</ul>
</li>
</ul>
</blockquote>
<p>由式 (6-1) 得：<br>$$<br>u_{o\max} &#x3D; \frac{R_2}{R_1} V_z \tag{6-2}<br>$$</p>
<p>同理，三角波的<strong>最低电压</strong>为：</p>
<p>(方波电压为 $V_z$,  $V_+ &#x3D; \frac{R_1}{R_1 + R_2} u_o + \frac{R_2}{R_1 + R_2} V_z \tag{6-1}$  $V_+&#x3D;0$时有$u_{o\min}$ )<br>$$<br>u_{o\min} &#x3D; -\frac{R_2}{R_1} V_z<br>$$</p>
<p><strong>最大振幅</strong>为：<br>$$<br>u_{o\max} - u_{o\min} &#x3D; 2 \frac{R_2}{R_1} V_z \tag{6-3}<br>$$<br><strong>可见，改变 $R_2$ 与 $R_1$ 的比值，可改变它的振幅</strong>。下面计算三角波的周期和频率。</p>
<p>当 $t &#x3D; 0$ 时，设积分器的输入电压为 $-V_z$，则 $A_2$ 的输出电压为：</p>
<p>$$<br>u_o(t) &#x3D; -\frac{1}{RC} \int_0^t (-V_z) , dt + u_o(t)\big|_{t&#x3D;0}<br>$$</p>
<p>积分后得：</p>
<p>$$<br>u_o(t) &#x3D; \frac{V_z}{RC} t - V_z \frac{R_2}{R_1} \tag{6-4}<br>$$</p>
<p>当 $t &#x3D; \frac{T}{2}$ 时，方波发生器翻转，此时应有 $V_+ &#x3D; 0$，<br>$u_o\left[\frac{T}{2}\right] &#x3D; u_{o\max} &#x3D; \frac{R_2}{R_1} V_z$，将 $t &#x3D; \frac{T}{2}$ 代入式 (6-4)，得：</p>
<p>$$<br>T &#x3D; \frac{4 R_2 RC}{R_1} \tag{6-5}<br>$$<br>振荡频率为：</p>
<p>$$<br>f &#x3D; \frac{1}{T} &#x3D; \frac{R_1}{4RC R_2} \tag{6-6}<br>$$</p>
<p>可见频率与幅值无关，改变 $R, C$ 或 $R_1&#x2F;R_2$ 均可改变频率。<br>然而，改变 $R_1 &#x2F; R_2$ 虽不影响方波的输出幅值，但会影响三角波的幅值。<br>方波的幅值由下式确定：<br>$$<br>u_{o1} &#x3D; 2(E_w + V_D) \tag{6-7}<br>$$</p>
<h4 id="测量放大电路"><a href="#测量放大电路" class="headerlink" title="测量放大电路"></a>测量放大电路</h4><p>在位移电反馈比例控制放大器中，为了通过装在比例阀上的位移传感器构成电反馈闭环，往往附加有与传感器匹配的测量放大电路  </p>
<h4 id="功率放大级"><a href="#功率放大级" class="headerlink" title="功率放大级"></a>功率放大级</h4><ul>
<li><p>功率放大级主要由<u>信号放大</u>和<u>功率驱动电路</u>组成  </p>
</li>
<li><p>根据功率放大级工作原理的不同，比例控制放大器有<u>模拟式</u>和<u>开关式</u>之分  </p>
</li>
<li><p>模拟式功率放大级：这种功率放大级技术比较成熟，结构简单，稳态控制性能较好，但功耗较大  </p>
</li>
<li><p>开关式功率放大级有<u>脉宽调制、脉频调制、脉幅调制、脉码调制</u>等多种方式  ，以<strong>脉宽调制（ＰＷＭ ）式最为常用</strong>  </p>
</li>
<li><p><strong>脉宽调制功率放大级</strong>  ：由脉宽调制器、功率驱动电路、电流负反馈单元、电流调节器等组成</p>
</li>
</ul>
<p><span style="color:#FF0000"><strong>脉宽调制式功率放大级</strong></span></p>
<p><img src="/blog/../image/Snipaste_2025-07-04_15-03-01-17520423721807.png"></p>
<table>
<thead>
<tr>
<th>运放</th>
<th>角色</th>
<th>核心贡献</th>
</tr>
</thead>
<tbody><tr>
<td>A₁</td>
<td>电流调节器</td>
<td>放大误差信号</td>
</tr>
<tr>
<td>A₂</td>
<td>比较器</td>
<td>电压→脉冲信号</td>
</tr>
<tr>
<td>A₃</td>
<td>施密特触发器</td>
<td>生成方波</td>
</tr>
<tr>
<td>A₄</td>
<td>反相积分器</td>
<td>方波→三角波</td>
</tr>
<tr>
<td>A₃+A₄</td>
<td>三角波调制信号发生器</td>
<td>生成三角波</td>
</tr>
<tr>
<td>A₂+A₃+A₄</td>
<td>脉宽调制器</td>
<td><strong>将连续变化信号转换成脉宽调制信号</strong></td>
</tr>
<tr>
<td>A₅</td>
<td>差动电压放大器</td>
<td>对电流采样信号进行综合、滤波和放大，构成电流负反馈</td>
</tr>
</tbody></table>
<ul>
<li><p>当输入电压 $u_i \leq 0$ 时，$A_1$ 正向饱和，$A_2$ 负向饱和，<strong>功率驱动电路各功放管截止</strong>，输出电流 $i &#x3D; 0$。</p>
</li>
<li><p>当 $u_i &gt; 0$ 时，$u_i$ 与反馈信号 $u_f$ 相比较，其差值经过电流调节器 $A_1$ 运算放大后输给脉宽调制器，<strong>脉宽调制器</strong><u>将电流调节器输出的连续信号转换成脉冲宽度与其大小成比例的脉冲信号</u>，该脉冲信号经过功率驱动电路功率放大，在比例电磁铁线圈两端产生与之同相的脉冲电压 $u_s$，当开关频率远高于三角电磁线圈的截止频率时，由于比例电磁铁线圈的惯性，在线圈上就可得到平均值与脉宽成比例的、带有交流纹波分量的直流电流  </p>
</li>
<li><p>与此同时，输出电流经过采样电阻 $R_f$ 检测，滤波及放大，反馈到输入端，构成输出电流平均值的闭环调节  。此闭环削弱了前向放大环节非线性，增益变化，负载阻抗变化以及电源电压波动对输出电流的影响。</p>
</li>
</ul>
<blockquote>
<p><span style="color:#FF0000">脉宽调制式功率放大级的工作原理为：</span></p>
<ol>
<li>当 $u_i \leq 0$ 时，$A_1$、$A_2$ 处于饱和状态，电磁铁电流 $i &#x3D; 0$；</li>
<li>当 $u_i &gt; 0$ 时，$u_i$ 与反馈信号 $u_f$ 相比较，其差值经过电流调节器 $A_1$ 运算放大后输给由$A_2,A_3, A_4$ 构成的脉宽调制器，</li>
<li><strong>脉宽调制器</strong><u>将电流调节器输出的连续信号转换成脉冲宽度与其大小成比例的脉冲信号</u>，该脉冲信号经过功率驱动电路功率放大，在比例电磁铁线圈两端产生与之同相的脉冲电压 $u_s$，当开关频率远高于三角电磁线圈的截止频率时，由于比例电磁铁线圈的惯性，在线圈上就可得到<u>平均值与脉宽成比例的、带有交流纹波分量的直流电流</u></li>
<li>输出电流经过采样电阻 $R_f$ 检测，滤波及放大，反馈到输入端，构成输出电流平均值的闭环调节</li>
</ol>
</blockquote>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>机电一体化分析与建模</tag>
      </tags>
  </entry>
  <entry>
    <title>markdown和latex语法写作笔记</title>
    <url>/blog/2025/01/27/%E8%AF%AD%E6%B3%95%E5%86%99%E4%BD%9C%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="引用块"><a href="#引用块" class="headerlink" title="引用块"></a>引用块</h1><p>引用块用&gt; 中间有个空格，引用块里可以接二级引用块<br><em><strong>&#x3D;&#x3D;示例&#x3D;&#x3D;</strong></em></p>
<blockquote>
<p>一级引用块</p>
<blockquote>
<p>二级引用块</p>
<blockquote>
<p>三级引用块</p>
</blockquote>
</blockquote>
</blockquote>
<h1 id="代码段"><a href="#代码段" class="headerlink" title="代码段"></a>代码段</h1><p><strong>记住符号是键盘数字1左边的那个，不是enter左边的那个</strong></p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="code">`中间的就是代码段`</span></span><br></pre></td></tr></table></figure>



<p><code>中间的就是代码段</code></p>
<p><code>hello world</code></p>
<p>hello world</p>
<h1 id="代码块"><a href="#代码块" class="headerlink" title="代码块"></a>代码块</h1><p>用3个&#96;和3个包围代码，前面的3个后面可接使用的代码语言，即可自动识别高亮</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">File</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,create_time=<span class="string">&#x27;today&#x27;</span></span>): <span class="comment">#对create_time设置默认值</span></span><br><span class="line">        <span class="variable language_">self</span>.name=name</span><br><span class="line">        <span class="variable language_">self</span>.create_time=create_time</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_info</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.name+<span class="string">&#x27;is created at&#x27;</span>+<span class="variable language_">self</span>.create_time</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Video</span>(<span class="title class_ inherited__">File</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,window_size=(<span class="params"><span class="number">640</span>,<span class="number">480</span></span>)</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__(name=name,create_time=<span class="string">&#x27;today&#x27;</span>)</span><br><span class="line">        <span class="variable language_">self</span>.window_size=window_size</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Text</span>(<span class="title class_ inherited__">File</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,laguage=<span class="string">&#x27;zh-cn&#x27;</span></span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__(name=name,create_time=<span class="string">&#x27;today&#x27;</span>)</span><br><span class="line">        <span class="variable language_">self</span>.laguage=laguage</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_more_info</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.get_info()+<span class="string">&#x27;,using laguage of &#x27;</span>+<span class="variable language_">self</span>.laguage</span><br><span class="line">v = Video(<span class="string">&quot;my_video&quot;</span>)   <span class="comment">#定义v的时候必须要输入__init__的参数，否则会报错</span></span><br><span class="line">t = Text(<span class="string">&quot;my_text&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(v.get_info())     <span class="comment"># 调用父类的功能</span></span><br><span class="line"><span class="built_in">print</span>(t.create_time)    <span class="comment"># 调用父类的属性</span></span><br><span class="line"><span class="built_in">print</span>(t.laguage)       <span class="comment"># 调用自己的属性</span></span><br><span class="line"><span class="built_in">print</span>(t.get_more_info()) <span class="comment"># 调用自己加工父类的功能</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="公式段和公式块（latex语法）"><a href="#公式段和公式块（latex语法）" class="headerlink" title="公式段和公式块（latex语法）"></a>公式段和公式块（latex语法）</h1><p>段：两个$$中间用latex语法</p>
<p>块：$$$$中间用latex语法</p>
<p>$\beta x$</p>
<p>$\beta$</p>
<p>$试试$</p>
<p>$ \beta $<br>$$<br>\beta \times x \geq 30<br>$$</p>
<p>$$<br>\varepsilon_r * &#x3D; \frac{1}{2(a_1 + 1)} \times 10^{-n+1}<br>$$</p>
<h2 id="一些latex代码"><a href="#一些latex代码" class="headerlink" title="一些latex代码"></a>一些latex代码</h2><h3 id="varepsilon"><a href="#varepsilon" class="headerlink" title="$\varepsilon$"></a>$\varepsilon$</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">\varepsilon</span><br></pre></td></tr></table></figure>

<h3 id="上下标"><a href="#上下标" class="headerlink" title="上下标"></a>上下标</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">_&#123;下标内容&#125;^&#123;上标内容&#125; 或 ^&#123;上标内容&#125;_&#123;下标内容&#125;</span><br><span class="line">如果下标或上标的内容多于一个字符，需要用 &#123;&#125; 包裹，例如 x_&#123;ij&#125; 而不是 x_ij</span><br><span class="line">$$x_i^2 + y_j^3 = z_&#123;ij&#125;^&#123;n+1&#125;$$</span><br></pre></td></tr></table></figure>

<p>$$x_i^2 + y_j^3 &#x3D; z_{ij}^{n+1}$$</p>
<h3 id="绝对值"><a href="#绝对值" class="headerlink" title="绝对值"></a>绝对值</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">|x|</span><br></pre></td></tr></table></figure>

<p>$|x|$</p>
<h3 id="小于等于，大于等于"><a href="#小于等于，大于等于" class="headerlink" title="小于等于，大于等于"></a>小于等于，大于等于</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">小于等于：\leq</span><br><span class="line">大于等于：\geq</span><br><span class="line">$$a \leq b \geq c$$</span><br></pre></td></tr></table></figure>

<p>$$a\leq b \geq c$$</p>
<h3 id="xi"><a href="#xi" class="headerlink" title="$\xi$"></a>$\xi$</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">\xi</span><br></pre></td></tr></table></figure>

<h3 id="中间的的顿号"><a href="#中间的的顿号" class="headerlink" title="中间的的顿号"></a>中间的的顿号</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">\cdots</span><br></pre></td></tr></table></figure>

<p>$1 \cdots 100$</p>
<h3 id="求积符号-prod"><a href="#求积符号-prod" class="headerlink" title="求积符号$\prod$"></a>求积符号$\prod$</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$\prod$</span><br></pre></td></tr></table></figure>

<p>$\prod$</p>
<h3 id="求和符号-sum"><a href="#求和符号-sum" class="headerlink" title="求和符号$\sum$"></a>求和符号$\sum$</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">\sum</span><br></pre></td></tr></table></figure>

<h3 id="公式间距调整"><a href="#公式间距调整" class="headerlink" title="公式间距调整"></a>公式间距调整</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">\quad</span><br><span class="line">\qquad：是 \quad 的两倍宽度</span><br></pre></td></tr></table></figure>

<p>$$<br>a \quad b<br>a \qquad b<br>$$</p>
<h3 id="箭头"><a href="#箭头" class="headerlink" title="箭头"></a>箭头</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">\rightarrow：生成向右的单线箭头（→）。</span><br><span class="line">\leftarrow：生成向左的单线箭头（←）。</span><br><span class="line">\Leftarrow：生成向左的双线箭头（⇐）。</span><br><span class="line">\leftrightarrow：生成双向的单线箭头（↔）。</span><br><span class="line">\Leftrightarrow：生成双向的双线箭头（⇔）。</span><br><span class="line">\Rightarrow :用于生成向右的双线箭头（⇒）</span><br></pre></td></tr></table></figure>

<p>$$<br>如果  A \Rightarrow B ，那么  B  是  A 的必要条件。<br>$$</p>
<h1 id="语法冲突示例"><a href="#语法冲突示例" class="headerlink" title="语法冲突示例"></a>语法冲突示例</h1><blockquote>
<p>1.\max、\sum需要下标时候，与下划线_不能放在一起,中间要有空格。后续验证只要是字母后接下划线也要空格。有时候空一格反而不好用了</p>
</blockquote>
<p>$$<br>|X|_\infty &#x3D; \max _{1 \leq i \leq n} |x_i|<br>$$</p>
<p>$$<br>|X|<em>\infty &#x3D; \max</em>{1 \leq i \leq n} |x_i|<br>$$</p>
<blockquote>
<p>2.加粗的时候不要把冒号：加进去</p>
</blockquote>
<p><strong>定义</strong>：向量序列 ${X^{(k)}}$ 收敛于向量 $ X^* $  是指对每一个 $ 1 \leq i \leq n $ 都有  —（正常显示）</p>
<p>**定义：*<em>向量序列 ${X^{(k)}}$ 收敛于向量 $ X^</em> $  是指对每一个 $ 1 \leq i \leq n $ 都有  —（异常显示）</p>
<blockquote>
<p>3.*和$符号不要连在一起，中间加空格</p>
</blockquote>
<h1 id="分隔符"><a href="#分隔符" class="headerlink" title="分隔符"></a>分隔符</h1><p>—后面不能接东西</p>
<hr>
<h1 id="表格"><a href="#表格" class="headerlink" title="表格"></a>表格</h1><p>建议用typora自带的&#x3D;&#x3D;<strong>Ctrl T</strong>&#x3D;&#x3D;快捷键</p>
<h1 id="分点"><a href="#分点" class="headerlink" title="分点"></a>分点</h1><h2 id="无序分点"><a href="#无序分点" class="headerlink" title="无序分点"></a>无序分点</h2><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="bullet">-</span> 后面接文本</span><br></pre></td></tr></table></figure>

<ul>
<li><p>后面接文本</p>
<h2 id="有序分点"><a href="#有序分点" class="headerlink" title="有序分点"></a>有序分点</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1. 中间有空格</span><br><span class="line">2.</span><br></pre></td></tr></table></figure>

<ol>
<li>中间有空格</li>
<li>记住句号后面有空格</li>
</ol>
</li>
</ul>
<p>-英文这个符号后面接一个空格</p>
<ul>
<li>第一</li>
<li>第二</li>
</ul>
<h1 id="插入视频"><a href="#插入视频" class="headerlink" title="插入视频"></a>插入视频</h1><h1 id="文字样式"><a href="#文字样式" class="headerlink" title="文字样式"></a>文字样式</h1><h2 id="下划线"><a href="#下划线" class="headerlink" title="下划线"></a>下划线</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;u&gt;下划线演示&lt;/u&gt;</span><br></pre></td></tr></table></figure>

<p><u>试试下划线</u></p>
<p>这个不方便建议用<u>typora</u>的&#x3D;&#x3D;ctrl+u&#x3D;&#x3D;</p>
<h2 id="斜体"><a href="#斜体" class="headerlink" title="斜体"></a>斜体</h2><p>_ 要斜的字体（没有空格）_<br><em>斜体</em><br><strong>&#x3D;&#x3D;备注&#x3D;&#x3D;</strong>：斜体和加粗可以同时使用，如：<em><strong>字体</strong></em></p>
<p>建议用typora的&#x3D;&#x3D;Ctrl I&#x3D;&#x3D;</p>
<h2 id="加粗"><a href="#加粗" class="headerlink" title="加粗"></a>加粗</h2><p>** 要加粗的字体（星号与字体之间没有空格）**</p>
<p><em><strong>示例</strong></em></p>
<p><strong>加粗</strong></p>
<p>建议用&#x3D;&#x3D;Ctrl B&#x3D;&#x3D;快捷键</p>
<h2 id="高亮"><a href="#高亮" class="headerlink" title="高亮"></a>高亮</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">文本`高亮`演示</span><br><span class="line">==高亮部分==</span><br><span class="line">typora适用，markdown不适用，网页端无法正常显示</span><br></pre></td></tr></table></figure>

<p><code>高亮</code></p>
<p>&#x3D;&#x3D;两个等号夹中间&#x3D;&#x3D;</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hello</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Hello World&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="文本删除线"><a href="#文本删除线" class="headerlink" title="文本删除线"></a>文本删除线</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">文本~~删除~~线演示</span><br></pre></td></tr></table></figure>

<p><del>两个波浪线</del></p>
<h2 id="大小"><a href="#大小" class="headerlink" title="大小"></a>大小</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;font-size:60px&quot;</span>&gt;</span>大小<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><span style="font-size:40px">大小</span></p>
<h2 id="颜色"><a href="#颜色" class="headerlink" title="颜色"></a>颜色</h2><p>&#x3D;&#x3D;字体颜色支持16进制颜色与RGB颜色表，或者简单的red,blue这种&#x3D;&#x3D;</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;color:blue&quot;</span>&gt;</span>文本<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;color:rgb(116, 219, 38)&quot;</span>&gt;</span>文本<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;color:#FF0000&quot;</span>&gt;</span>文本<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><span style="color:blue">文本</span></p>
<p><span style="color:rgb(116, 219, 38)">文本</span></p>
<p><span style="color:#FF0000">文本</span></p>
<h2 id="字体"><a href="#字体" class="headerlink" title="字体"></a>字体</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;font-family:Simsun&quot;</span>&gt;</span>文本<span class="tag">&lt;/<span class="name">span</span>&gt;</span> #宋体</span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;font-family: &#x27;Microsoft YaHei&#x27;&quot;</span>&gt;</span>文本<span class="tag">&lt;/<span class="name">span</span>&gt;</span> #微软雅黑</span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;font-family: &#x27;Times New Roman&#x27;&quot;</span>&gt;</span>文本<span class="tag">&lt;/<span class="name">span</span>&gt;</span> #新罗马</span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;font-family: &#x27;SimHei&#x27;&quot;</span>&gt;</span>文本<span class="tag">&lt;/<span class="name">span</span>&gt;</span> #黑体</span><br></pre></td></tr></table></figure>

<p><span style="font-family:Simsun">文本</span></p>
<p><span style="font-family: 'Microsoft YaHei'">文本</span> </p>
<p><span style="font-family: 'Times New Roman'">文本</span></p>
<h2 id="字体位置"><a href="#字体位置" class="headerlink" title="字体位置"></a>字体位置</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;div style=&quot;text-align: center;&quot;&gt;文本居中&lt;/div&gt;</span><br><span class="line">&lt;div style=&quot;text-align: right;&quot;&gt;文本居右&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<div style="text-align: center;">文本居中</div>

<div style="text-align: right;">文本居右</div>

<h1 id="跳转"><a href="#跳转" class="headerlink" title="跳转"></a>跳转</h1><p><a href="#%E8%A1%A8%E6%A0%BC">跳转</a></p>
<p><a href="##%E4%B8%8B%E5%88%92%E7%BA%BF">跳转到高亮</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">英文中括号+英文小括号，括号里是要跳转的地方</span><br><span class="line">[跳转链接名字，随意取](#大纲标题)  PS:#后面不接空格</span><br></pre></td></tr></table></figure>

<p><a href="##%E6%96%9C%E4%BD%93">跳转到斜体</a></p>
<p>建议用&#x3D;&#x3D;Ctrl K&#x3D;&#x3D;快捷键</p>
<h1 id="任务列表"><a href="#任务列表" class="headerlink" title="任务列表"></a>任务列表</h1><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line"><span class="bullet">-</span> [ ] 记得取快递(-和[]间有空格，[ ]中间也有空格，[]和后面的文本也有空格)</span><br></pre></td></tr></table></figure>

<ul>
<li><ul>
<li><input checked="" disabled="" type="checkbox"> 记得取快递</li>
</ul>
</li>
</ul>
<h1 id="文章置顶"><a href="#文章置顶" class="headerlink" title="文章置顶"></a>文章置顶</h1><ul>
<li>你可以直接在文章的<code>front-matter</code>区域里添加<code>sticky: 1</code>属性来把这篇文章置顶。数值越大，置顶的优先级越大。</li>
</ul>
<h1 id="Post-Front-matter"><a href="#Post-Front-matter" class="headerlink" title="Post Front-matter"></a>Post Front-matter</h1><figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">---</span><br><span class="line">title:</span><br><span class="line">date:</span><br><span class="line">updated:</span><br><span class="line">tags:</span><br><span class="line">categories:</span><br><span class="line">keywords:</span><br><span class="line">description:</span><br><span class="line">top<span class="emphasis">_img:</span></span><br><span class="line"><span class="emphasis">comments:</span></span><br><span class="line"><span class="emphasis">cover:</span></span><br><span class="line"><span class="emphasis">toc:</span></span><br><span class="line"><span class="emphasis">toc_</span>number:</span><br><span class="line">toc<span class="emphasis">_style_</span>simple:</span><br><span class="line">copyright:</span><br><span class="line">copyright<span class="emphasis">_author:</span></span><br><span class="line"><span class="emphasis">copyright_</span>author<span class="emphasis">_href:</span></span><br><span class="line"><span class="emphasis">copyright_</span>url:</span><br><span class="line">copyright<span class="emphasis">_info:</span></span><br><span class="line"><span class="emphasis">mathjax:</span></span><br><span class="line"><span class="emphasis">katex:</span></span><br><span class="line"><span class="emphasis">aplayer:</span></span><br><span class="line"><span class="emphasis">highlight_</span>shrink:</span><br><span class="line"><span class="section">aside:</span></span><br><span class="line"><span class="section">---</span></span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>写法</th>
<th align="center">解释</th>
</tr>
</thead>
<tbody><tr>
<td>title</td>
<td align="center">【必需】文章标题</td>
</tr>
<tr>
<td>date</td>
<td align="center">【必需】文章创建日期</td>
</tr>
<tr>
<td>updated</td>
<td align="center">【可选】文章更新日期</td>
</tr>
<tr>
<td>tags</td>
<td align="center">【可选】文章标籤</td>
</tr>
<tr>
<td>categories</td>
<td align="center">【可选】文章分类</td>
</tr>
<tr>
<td>keywords</td>
<td align="center">【可选】文章关键字</td>
</tr>
<tr>
<td>description</td>
<td align="center">【可选】文章描述</td>
</tr>
<tr>
<td>top_img</td>
<td align="center">【可选】文章顶部图片</td>
</tr>
<tr>
<td>cover</td>
<td align="center">【可选】文章缩略图(如果没有设置top_img,文章页顶部将显示缩略图，可设为false&#x2F;图片地址&#x2F;留空)</td>
</tr>
<tr>
<td>comments</td>
<td align="center">【可选】显示文章评论模块(默认 true)</td>
</tr>
<tr>
<td>toc</td>
<td align="center">【可选】显示文章TOC(默认为设置中toc的enable配置)</td>
</tr>
<tr>
<td>toc_number</td>
<td align="center">【可选】显示toc_number(默认为设置中toc的number配置)</td>
</tr>
<tr>
<td>toc_style_simple</td>
<td align="center">【可选】显示 toc 简洁模式</td>
</tr>
<tr>
<td>copyright</td>
<td align="center">【可选】显示文章版权模块(默认为设置中post_copyright的enable配置)</td>
</tr>
<tr>
<td>copyright_author</td>
<td align="center">【可选】文章版权模块的文章作者</td>
</tr>
<tr>
<td>copyright_author_href</td>
<td align="center">【可选】文章版权模块的文章作者链接</td>
</tr>
<tr>
<td>copyright_url</td>
<td align="center">【可选】文章版权模块的文章连结链接</td>
</tr>
<tr>
<td>copyright_info</td>
<td align="center">【可选】文章版权模块的版权声明文字</td>
</tr>
<tr>
<td>mathjax</td>
<td align="center">【可选】显示mathjax(当设置mathjax的per_page: false时，才需要配置，默认 false)</td>
</tr>
<tr>
<td>katex</td>
<td align="center">【可选】显示katex(当设置katex的per_page: false时，才需要配置，默认 false)</td>
</tr>
<tr>
<td>aplayer</td>
<td align="center">【可选】在需要的页面加载aplayer的js和css,请参考文章下面的音乐 配置</td>
</tr>
<tr>
<td>highlight_shrink</td>
<td align="center">【可选】配置代码框是否展开(true&#x2F;false)(默认为设置中highlight_shrink的配置)</td>
</tr>
<tr>
<td>aside</td>
<td align="center">【可选】显示侧边栏 (默认 true)</td>
</tr>
</tbody></table>
<h1 id="图片插入"><a href="#图片插入" class="headerlink" title="图片插入"></a>图片插入</h1><p><img src="/blog/image/street.png"></p>
]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>markdown语法</tag>
      </tags>
  </entry>
  <entry>
    <title>深度学习相关知识</title>
    <url>/blog/2025/02/27/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="准确度-accuracy-、精确率（precision-、召回率（recall）、F1值"><a href="#准确度-accuracy-、精确率（precision-、召回率（recall）、F1值" class="headerlink" title="准确度(accuracy)、精确率（precision)、召回率（recall）、F1值"></a>准确度(accuracy)、精确率（precision)、召回率（recall）、F1值</h1><p>TP（True Positives)：真正例，预测为正例而且实际上也是正例；</p>
<p>FP（False Positives)：假正例，预测为正例然而实际上却是负例；</p>
<p>FN（false Negatives)：假负例，预测为负例然而实际上却是正例；</p>
<p>TN（True Negatives)：真负例，预测为负例而且实际上也是负例。</p>
<p><img src="/blog/image/TP.PNG"></p>
<h2 id="准确率-Accuracy"><a href="#准确率-Accuracy" class="headerlink" title="准确率 Accuracy"></a>准确率 Accuracy</h2><blockquote>
<p><strong>准确度</strong>：正例和负例中预测正确数量占总数量的比例。</p>
</blockquote>
<p>用公式表示：<br>$$<br>ACC&#x3D;\frac{TP+TN}{TP+FP+FN+TN}<br>$$</p>
<h2 id="精确度-Precision"><a href="#精确度-Precision" class="headerlink" title="精确度 Precision"></a>精确度 Precision</h2><p>精确度：以<strong>预测结果</strong>为判断依据，<strong>预测为正例的样本中预测正确的比例</strong>。预测为正例的结果分两种，要么实际是正例TP，要么实际是负例FP，则可用公式表示:<br>$$<br>precision&#x3D;\frac{TP}{TP+FP}<br>$$<br>精确度还有一个名字，叫做**“查准率”<strong>，我们关心的主要部分是正例，所以查准率就是相对正例的预测结果而言，正例预测的准确度。直白的意思就是模型预测为正例的样本中，其中真正的正例占预测为正例样本的比例，用此标准来</strong>评估预测正例的准确度**。</p>
<h2 id="召回率-Recall"><a href="#召回率-Recall" class="headerlink" title="召回率 Recall"></a>召回率 Recall</h2><p>召回率：以<strong>实际样本</strong>为判断依据，<strong>实际为正例的样本中，被预测正确的正例占总实际正例样本的比例</strong>。实际为正例的样本中，要么在预测中被预测正确TP，要么在预测中预测错误FN，用公式表示：<br>$$<br>recall&#x3D;\frac{TP}{TP+FN}<br>$$<br>召回率的另一个名字，叫做**“查全率”**，评估所有实际正例是否被预测出来的覆盖率占比多少</p>
<h2 id="F1分数（F1-Score）"><a href="#F1分数（F1-Score）" class="headerlink" title="F1分数（F1-Score）"></a>F1分数（F1-Score）</h2><p><strong>定义</strong>：精确率与召回率的<strong>调和平均数</strong>，平衡两者性能<br>$$<br>F1&#x3D;\frac{2 \times Precision \times Recall}{Precision+Recall}<br>$$</p>
<h1 id="Batch-Normalization（批量归一化）-和-Layer-Normalization（层归一化）"><a href="#Batch-Normalization（批量归一化）-和-Layer-Normalization（层归一化）" class="headerlink" title="Batch Normalization（批量归一化） 和 Layer Normalization（层归一化）"></a>Batch Normalization（批量归一化） 和 Layer Normalization（层归一化）</h1><hr>
<h2 id="1-核心概念对比"><a href="#1-核心概念对比" class="headerlink" title="1. 核心概念对比"></a>1. <strong>核心概念对比</strong></h2><h3 id="Batch-Normalization-BN"><a href="#Batch-Normalization-BN" class="headerlink" title="Batch Normalization (BN)"></a><strong>Batch Normalization (BN)</strong></h3><ul>
<li><p><strong>归一化方向</strong>：对 <strong>同一特征维度</strong> 跨所有样本和空间位置归一化。</p>
</li>
<li><p><strong>核心公式</strong>：</p>
<p>假设输入张量形状为 <code>(N, C, H, W)</code>（Batch Size, Channels, Height, Width），则对每个通道 <code>c</code> 计算均值和方差：<br>$$<br>\mu_c &#x3D; \frac{1}{N \cdot H \cdot W} \sum_{n&#x3D;1}^N \sum_{h&#x3D;1}^H \sum_{w&#x3D;1}^W x_{n,c,h,w}, \quad \sigma_c^2 &#x3D; \frac{1}{N \cdot H \cdot W} \sum_{n&#x3D;1}^N \sum_{h&#x3D;1}^H \sum_{w&#x3D;1}^W (x_{n,c,h,w} - \mu_c)^2<br>$$</p>
</li>
<li><p><strong>适用场景</strong>：图像处理（CNN）、固定长度的结构化数据。</p>
</li>
</ul>
<h3 id="Layer-Normalization-LN"><a href="#Layer-Normalization-LN" class="headerlink" title="Layer Normalization (LN)"></a><strong>Layer Normalization (LN)</strong></h3><ul>
<li><p><strong>归一化方向</strong>：对 <strong>同一样本</strong> 的所有特征维度归一化。</p>
</li>
<li><p><strong>核心公式</strong>：</p>
<p>假设输入张量形状为 <code>(N, C, H, W)</code>，对每个样本 <code>n</code> 计算均值和方差：<br>$$<br>\mu_n &#x3D; \frac{1}{C \cdot H \cdot W} \sum_{c&#x3D;1}^C \sum_{h&#x3D;1}^H \sum_{w&#x3D;1}^W x_{n,c,h,w}, \quad \sigma_n^2 &#x3D; \frac{1}{C \cdot H \cdot W} \sum_{c&#x3D;1}^C \sum_{h&#x3D;1}^H \sum_{w&#x3D;1}^W (x_{n,c,h,w} - \mu_n)^2<br>$$</p>
</li>
<li><p><strong>适用场景</strong>：序列数据（RNN、Transformer）、动态长度输入。</p>
</li>
</ul>
<hr>
<h2 id="2-公式符号解释"><a href="#2-公式符号解释" class="headerlink" title="2. 公式符号解释"></a>2. <strong>公式符号解释</strong></h2><h3 id="输入张量形状"><a href="#输入张量形状" class="headerlink" title="输入张量形状"></a><strong>输入张量形状</strong></h3><p>假设输入为 <code>(N, C, H, W)</code>：</p>
<ul>
<li><code>N</code>: 批次大小（Batch Size）</li>
<li><code>C</code>: 通道数（特征维度）</li>
<li><code>H</code>: 高度（空间维度）</li>
<li><code>W</code>: 宽度（空间维度）</li>
</ul>
<h3 id="BN-公式符号"><a href="#BN-公式符号" class="headerlink" title="BN 公式符号"></a><strong>BN 公式符号</strong></h3><ul>
<li><code>μₐ</code>: 第 <code>c</code> 个通道的均值（跨所有样本和空间位置）。</li>
<li><code>σₐ²</code>: 第 <code>c</code> 个通道的方差。</li>
<li><code>xₙ,ₐ,ₕ,ᵥ</code>: 第 <code>n</code> 个样本、第 <code>c</code> 个通道、位置 <code>(h, w)</code> 的像素值。</li>
</ul>
<h3 id="LN-公式符号"><a href="#LN-公式符号" class="headerlink" title="LN 公式符号"></a><strong>LN 公式符号</strong></h3><ul>
<li><code>μₙ</code>: 第 <code>n</code> 个样本的均值（跨所有特征和空间位置）。</li>
<li><code>σₙ²</code>: 第 <code>n</code> 个样本的方差。</li>
<li><code>xₙ,ₐ,ₕ,ᵥ</code>: 同上。</li>
</ul>
<hr>
<h2 id="3-具体示例对比"><a href="#3-具体示例对比" class="headerlink" title="3. 具体示例对比"></a>3. <strong>具体示例对比</strong></h2><h3 id="输入数据"><a href="#输入数据" class="headerlink" title="输入数据"></a><strong>输入数据</strong></h3><ul>
<li><code>N=2</code>（2张图像），<code>C=3</code>（RGB三通道），<code>H=2</code>, <code>W=2</code>（2x2像素）。</li>
<li><strong>样本1</strong>：<ul>
<li>通道0（红）：<code>[[1, 3], [5, 7]]</code></li>
<li>通道1（绿）：<code>[[2, 4], [6, 8]]</code></li>
<li>通道2（蓝）：<code>[[3, 5], [7, 9]]</code></li>
</ul>
</li>
<li><strong>样本2</strong>：<ul>
<li>通道0（红）：<code>[[2, 4], [6, 8]]</code></li>
<li>通道1（绿）：<code>[[3, 5], [7, 9]]</code></li>
<li>通道2（蓝）：<code>[[4, 6], [8, 10]]</code></li>
</ul>
</li>
</ul>
<hr>
<h3 id="BN-计算示例（以通道0为例）"><a href="#BN-计算示例（以通道0为例）" class="headerlink" title="BN 计算示例（以通道0为例）"></a><strong>BN 计算示例（以通道0为例）</strong></h3><ol>
<li><strong>计算均值 <code>μ₀</code></strong>：<br>$$<br>\mu_0 &#x3D; \frac{(1+3+5+7) + (2+4+6+8)}{8} &#x3D; \frac{16 + 20}{8} &#x3D; 4.5<br>$$</li>
<li><strong>计算方差 <code>σ₀²</code></strong>：<br>$$<br>\sigma_0^2 &#x3D; \frac{(1-4.5)^2 + (3-4.5)^2 + \cdots + (8-4.5)^2}{8} &#x3D; \frac{21 + 21}{8} &#x3D; 5.25<br>$$</li>
<li><strong>归一化后</strong>：每个像素值变为 <code>(x - 4.5) / √(5.25 + ε)</code>。</li>
</ol>
<hr>
<h3 id="LN-计算示例（以样本1为例）"><a href="#LN-计算示例（以样本1为例）" class="headerlink" title="LN 计算示例（以样本1为例）"></a><strong>LN 计算示例（以样本1为例）</strong></h3><ol>
<li><strong>计算均值 <code>μ₁</code></strong>：<br>$$<br>\mu_1 &#x3D; \frac{1+3+5+7 + 2+4+6+8 + 3+5+7+9}{12} &#x3D; \frac{60}{12} &#x3D; 5<br>$$</li>
<li><strong>计算方差 <code>σ₁²</code></strong>：<br>$$<br>\sigma_1^2 &#x3D; \frac{(1-5)^2 + (3-5)^2 + \cdots + (9-5)^2}{12} &#x3D; \frac{84}{12} &#x3D; 7<br>$$</li>
<li><strong>归一化后</strong>：每个像素值变为 <code>(x - 5) / √(7 + ε)</code>。</li>
</ol>
<hr>
<h2 id="4-对比总结表格"><a href="#4-对比总结表格" class="headerlink" title="4. 对比总结表格"></a>4. <strong>对比总结表格</strong></h2><table>
<thead>
<tr>
<th><strong>特性</strong></th>
<th>Batch Normalization (BN)</th>
<th>Layer Normalization (LN)</th>
</tr>
</thead>
<tbody><tr>
<td><strong>归一化维度</strong></td>
<td>同一特征维度跨样本和空间位置</td>
<td>同一样本的所有特征维度</td>
</tr>
<tr>
<td><strong>参数数量</strong></td>
<td><code>2C</code>（每通道独立参数）</td>
<td><code>2</code>（全局共享参数）</td>
</tr>
<tr>
<td><strong>依赖条件</strong></td>
<td>需大 Batch Size（如32+）</td>
<td>不依赖 Batch Size</td>
</tr>
<tr>
<td><strong>适用场景</strong></td>
<td>图像（CNN）、静态数据</td>
<td>文本（Transformer）、动态序列数据</td>
</tr>
<tr>
<td><strong>训练&#x2F;测试差异</strong></td>
<td>测试时用全局移动平均统计量</td>
<td>测试时直接计算当前样本统计量</td>
</tr>
</tbody></table>
<hr>
<h2 id="5-注意事项"><a href="#5-注意事项" class="headerlink" title="5. 注意事项"></a>5. <strong>注意事项</strong></h2><ol>
<li><p><strong>BN 的局限性</strong>：</p>
<ul>
<li>小 Batch Size 时性能下降（方差估计不准确）。</li>
<li>对序列数据（如变长文本）不友好。</li>
</ul>
</li>
<li><p><strong>LN 的优势</strong>：</p>
<ul>
<li>适用于单样本推理（如实时生成文本）。</li>
<li>对特征维度间的动态变化更鲁棒。</li>
</ul>
</li>
</ol>
<hr>
<h2 id="6-代码示例（PyTorch）"><a href="#6-代码示例（PyTorch）" class="headerlink" title="6. 代码示例（PyTorch）"></a>6. <strong>代码示例（PyTorch）</strong></h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Batch Normalization（图像任务）</span></span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line">bn = nn.BatchNorm2d(num_features=<span class="number">3</span>)  <span class="comment"># 输入通道数 C=3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Layer Normalization（NLP任务）</span></span><br><span class="line">ln = nn.LayerNorm(normalized_shape=<span class="number">256</span>)  <span class="comment"># 输入特征维度=256</span></span><br></pre></td></tr></table></figure>



<h1 id="上采样（Upsampling）与下采样（Downsampling）详解"><a href="#上采样（Upsampling）与下采样（Downsampling）详解" class="headerlink" title="上采样（Upsampling）与下采样（Downsampling）详解"></a>上采样（Upsampling）与下采样（Downsampling）详解</h1><hr>
<h2 id="核心区别"><a href="#核心区别" class="headerlink" title="核心区别"></a><strong>核心区别</strong></h2><ul>
<li><strong>上采样</strong>：放大特征图尺寸，<strong>恢复细节信息</strong>（如目标边缘、小物体位置）。  </li>
<li><strong>下采样</strong>：缩小特征图尺寸，<strong>提取抽象语义</strong>（如目标类别、整体形状）。  </li>
<li><strong>协作关系</strong>：两者结合实现多尺度检测（如同时识别近处大车和远处小车）。</li>
</ul>
<hr>
<h2 id="1-下采样（Downsampling）"><a href="#1-下采样（Downsampling）" class="headerlink" title="1. 下采样（Downsampling）"></a><strong>1. 下采样（Downsampling）</strong></h2><h3 id="作用"><a href="#作用" class="headerlink" title="作用"></a><strong>作用</strong></h3><ul>
<li>压缩特征图，减少计算量。</li>
<li>捕获高层语义信息（例如“这是一辆车”）。</li>
</ul>
<h3 id="实现方式"><a href="#实现方式" class="headerlink" title="实现方式"></a><strong>实现方式</strong></h3><table>
<thead>
<tr>
<th>方法</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><strong>跨步卷积</strong></td>
<td>增大卷积步长（如<code>stride=2</code>），跳过部分像素，直接缩小特征图尺寸。</td>
</tr>
<tr>
<td><strong>池化（Pooling）</strong></td>
<td>取局部区域的最大值（Max Pooling）或平均值（Average Pooling）。</td>
</tr>
</tbody></table>
<h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a><strong>特点</strong></h3><ul>
<li><strong>输出尺寸</strong>：缩小（例如输入<code>256x256</code> → 输出<code>128x128</code>）。</li>
<li><strong>信息保留</strong>：丢弃细节，保留整体特征。</li>
<li><strong>类比</strong>：眯眼看照片，忽略纹理细节，只关注轮廓。</li>
</ul>
<hr>
<h2 id="2-上采样（Upsampling）"><a href="#2-上采样（Upsampling）" class="headerlink" title="2. 上采样（Upsampling）"></a><strong>2. 上采样（Upsampling）</strong></h2><h3 id="作用-1"><a href="#作用-1" class="headerlink" title="作用"></a><strong>作用</strong></h3><ul>
<li>扩大特征图尺寸，辅助精确定位（如车轮、车灯位置）。</li>
<li>与浅层特征融合，增强小目标检测能力。</li>
</ul>
<h3 id="实现方式-1"><a href="#实现方式-1" class="headerlink" title="实现方式"></a><strong>实现方式</strong></h3><table>
<thead>
<tr>
<th>方法</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><strong>插值（Interpolation）</strong></td>
<td>通过双线性插值、最近邻插值等算法填充像素（类似图像放大）。</td>
</tr>
<tr>
<td><strong>转置卷积（Transposed Convolution）</strong></td>
<td>反向卷积操作，通过可学习参数生成更大特征图。</td>
</tr>
</tbody></table>
<h3 id="特点-1"><a href="#特点-1" class="headerlink" title="特点"></a><strong>特点</strong></h3><ul>
<li><strong>输出尺寸</strong>：放大（例如输入<code>128x128</code> → 输出<code>256x256</code>）。</li>
<li><strong>信息保留</strong>：补充细节，但可能引入噪声。</li>
<li><strong>类比</strong>：放大模糊图片，猜测缺失的像素。</li>
</ul>
<hr>
<h2 id="对比总结"><a href="#对比总结" class="headerlink" title="对比总结"></a><strong>对比总结</strong></h2><table>
<thead>
<tr>
<th><strong>特性</strong></th>
<th>下采样</th>
<th>上采样</th>
</tr>
</thead>
<tbody><tr>
<td><strong>目的</strong></td>
<td>提取抽象特征，减少计算量</td>
<td>恢复细节，精确定位</td>
</tr>
<tr>
<td><strong>典型操作</strong></td>
<td>池化、跨步卷积</td>
<td>插值、转置卷积</td>
</tr>
<tr>
<td><strong>信息流</strong></td>
<td>从细节到语义</td>
<td>从语义到细节</td>
</tr>
<tr>
<td><strong>应用阶段</strong></td>
<td>Backbone（特征提取层）</td>
<td>Neck（特征融合层）</td>
</tr>
</tbody></table>
<h2 id="实际例子"><a href="#实际例子" class="headerlink" title="实际例子"></a><strong>实际例子</strong></h2><ul>
<li><strong>场景</strong>：检测一张包含“近处行人”和“远处车辆”的图像。</li>
<li><strong>下采样</strong>：深层特征图（20x20）捕获“远处车辆”的抽象轮廓。</li>
<li><strong>上采样</strong>：将该特征图放大到40x40，与浅层特征（包含“近处行人”细节）融合，实现多尺度检测。</li>
</ul>
<h1 id="消融实验"><a href="#消融实验" class="headerlink" title="消融实验"></a>消融实验</h1><h1 id="空洞卷积（Dilated-Convolution）详解"><a href="#空洞卷积（Dilated-Convolution）详解" class="headerlink" title="空洞卷积（Dilated Convolution）详解"></a>空洞卷积（Dilated Convolution）详解</h1><h2 id="1-概述"><a href="#1-概述" class="headerlink" title="1. 概述"></a>1. 概述</h2><p><strong>空洞卷积</strong>（Dilated Convolution），又称<strong>膨胀卷积</strong>或<strong>扩张卷积</strong>，是一种通过<strong>插入“空洞”</strong>（间隔）来扩大感受野的卷积操作。它能在<strong>不增加参数量</strong>的前提下捕捉更大范围的上下文信息，常用于图像分割、语音合成等任务。</p>
<h2 id="2-为什么需要空洞卷积？"><a href="#2-为什么需要空洞卷积？" class="headerlink" title="2. 为什么需要空洞卷积？"></a>2. 为什么需要空洞卷积？</h2><p><strong>问题背景</strong>：</p>
<ul>
<li>传统卷积神经网络（CNN）通过堆叠卷积层和池化层（下采样）逐步扩大感受野，但池化会<strong>降低图像分辨率</strong>（丢失细节），导致小目标（如红外弱小目标）难以识别。</li>
<li>如果直接去掉池化层（降低下采样率），后续层的<strong>感受野会变小</strong>，模型无法捕捉全局特征，导致性能下降。</li>
</ul>
<p><strong>空洞卷积的解决方案</strong>：</p>
<ul>
<li><p><strong>保持分辨率</strong>：不进行下采样（保留细节）。</p>
</li>
<li><p><strong>扩大感受野</strong>：通过空洞卷积核覆盖更大区域，避免池化带来的信息损失。</p>
<table>
<thead>
<tr>
<th>类型</th>
<th align="center">卷积核</th>
<th align="center">感受野（3层后）</th>
<th>分辨率</th>
<th>适用场景</th>
</tr>
</thead>
<tbody><tr>
<td><strong>普通卷积</strong>（3×3）</td>
<td align="center">连续像素</td>
<td align="center">7×7</td>
<td>逐渐降低（需池化）</td>
<td>常规目标检测</td>
</tr>
<tr>
<td><strong>空洞卷积</strong>（3×3，rate&#x3D;2）</td>
<td align="center">间隔1像素</td>
<td align="center">15×15</td>
<td><strong>保持原始分辨率</strong></td>
<td>小目标检测、图像分割</td>
</tr>
</tbody></table>
</li>
</ul>
<h2 id="3-优点"><a href="#3-优点" class="headerlink" title="3. 优点"></a>3. 优点</h2><h2 id=""><a href="#" class="headerlink" title=""></a></h2><table>
<thead>
<tr>
<th>优势</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><strong>更大的感受野</strong></td>
<td>捕捉长距离依赖，适合分割&#x2F;检测任务</td>
</tr>
<tr>
<td><strong>保持分辨率</strong></td>
<td>无需下采样即可扩大感受野，减少信息损失</td>
</tr>
<tr>
<td><strong>参数量不变</strong></td>
<td>相比堆叠卷积层或增大核尺寸更高效</td>
</tr>
</tbody></table>
<h2 id="4-缺点"><a href="#4-缺点" class="headerlink" title="4. 缺点"></a>4. 缺点</h2><table>
<thead>
<tr>
<th>缺点</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><strong>网格效应（Gridding）</strong></td>
<td>高扩张率可能导致局部信息丢失</td>
</tr>
<tr>
<td><strong>优化难度</strong></td>
<td>需平衡扩张率与任务需求</td>
</tr>
</tbody></table>
<h2 id="-1"><a href="#-1" class="headerlink" title=""></a></h2>]]></content>
      <categories>
        <category>学习</category>
      </categories>
      <tags>
        <tag>深度学习</tag>
      </tags>
  </entry>
  <entry>
    <title>照片</title>
    <url>/blog/Gallery/index.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src="/blog/image/1.jpg"></p>
]]></content>
  </entry>
  <entry>
    <title>电影</title>
    <url>/blog/movies/index.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script>]]></content>
  </entry>
  <entry>
    <title>分类</title>
    <url>/blog/tags/index.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script>]]></content>
  </entry>
  <entry>
    <title>音乐</title>
    <url>/blog/music/index.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script>]]></content>
  </entry>
  <entry>
    <title>分类</title>
    <url>/blog/categories/index.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script>]]></content>
  </entry>
  <entry>
    <title>写给你的小作文</title>
    <url>/blog/movies/%E5%86%99%E7%BB%99%E9%82%B5%E8%89%BA%E5%8D%9A%E7%9A%84%E5%B0%8F%E4%BD%9C%E6%96%87.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="一"><a href="#一" class="headerlink" title="一"></a>一</h1><p><u>感觉我和你没什么好说的。</u><br><img src="/blog/image/sy1.jpg"></p>
<p>那就从这句话开始说吧。其实这张纸我一直有好好留着，从确山带到了秦皇岛，后来又带去了深圳，现在又让我带来了长春。</p>
<h1 id="二"><a href="#二" class="headerlink" title="二"></a>二</h1><p>高中的有些事情我一直记得，记得跟你说我喜欢你，但是当初你好像并没有给我答案，没有接受，也没有拒绝。</p>
<p>但至那以后咱俩好像话就越来越少，后来也就没在做同桌了。其实当时我是很难过的，看到你天天和别的男同学有说有笑我其实更难过（）。</p>
<p>高中有段时间我成绩不好，应该是高二，要说跟你没关系，那就是自欺欺人。后来我就慢慢想开了，大抵是你真的不喜欢我，觉得这段不会有结果的关系就这样了吧。</p>
<p>后来便是大学的时候你偶尔找我聊会天，我也觉得这样就好，只是有时候做梦会梦到你。</p>
<p>至于去年为什么要送你吃，我觉得应当送你，所以我送了。</p>
<p>后来的后来就是现在了。</p>
<p>有些事是好的，但又不是足够好的。</p>
<h1 id="三"><a href="#三" class="headerlink" title="三"></a>三</h1><p>关于表达欲的问题我一直有在想。</p>
<p><img src="/blog/image/sy2.jpg"></p>
<p>之前做过MBTI测试，不出所料结果是INFJ，因为这种性格的描述真的太像我了。</p>
<p>后来慢慢了解到我可能是回避型依恋人格。</p>
<p>但是我又觉得自己可能又可能是纯纯犯贱。</p>
<p>之前发了条朋友圈是希望你能看到的，但既然想让你看到，应该由我亲口告诉你，可却没有，所以说自己有点贱。<br><img src="/blog/image/sy3.jpg"></p>
<h1 id="四"><a href="#四" class="headerlink" title="四"></a>四</h1><p>有些时候会莫名其妙想一些事情，现在如何，未来如何，如果现在做了将来又会如何，所以会遇到事情会下意识犹豫。很多事情都习惯拖着，拖到不能拖了才会下定决心回应。可时间又是不等人的，就像两个人聊天，当你还在想如何回复时，可能下个问题就来了，先前的问题就被永远搁置了。</p>
<p>之前你问我要不要找你去玩，我真的一直在想，一直在犹豫，我感觉像我这种人对于某些事下定决心是一件很难的事情。</p>
<p>之前没告诉你，其实我的车票已经改了好几次。<br><img src="/blog/image/sy4.jpg"></p>
<p><img src="/blog/image/sy5.jpg"></p>
<p>（今天为啥去驻马店坐高铁，因为卧铺票真的很难候补啊～～捏麻麻的，我是真的腰疼屁股疼）</p>
<h1 id="五"><a href="#五" class="headerlink" title="五"></a>五</h1><p>之前读到过一句话，我觉得非常适合我—我这样胆小慢热的人，需要别人千百次的主动和回应才愿意相信那才是真的。</p>
<p>你问我喜不喜欢你，说不喜欢这是不可能。</p>
<p>但是如果你问是否像高中那般喜欢，给出确凿无疑的答案那又是自欺欺人了。</p>
<p>没有人能比得过我回忆的那个你，即便是现在的你。</p>
<h1 id="六"><a href="#六" class="headerlink" title="六"></a>六</h1><p>你关心我，我真的很开心。</p>
<h1 id="七"><a href="#七" class="headerlink" title="七"></a>七</h1><p>记得高中下晚自习你习惯对我摆手说再见，我老是沉默不语，你后来逗我说怎么不说“再见”。</p>
<p>不说“再见”，是因为希望再见。</p>
<hr>
<p>写于2025年2月14日，于长春的高铁上。修改上传于宿舍。</p>
<hr>
<p>“怎么一回来就在敲代码”<br> “额，没有”<br> “那在写什么”<br> “小作文”<br> “嗯？”<br> “嗯”</p>
]]></content>
  </entry>
  <entry>
    <title>心想事成</title>
    <url>/blog/movies/%E5%BF%83%E6%83%B3%E4%BA%8B%E6%88%90.html</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\blog\assets\css\APlayer.min.css"><script src="\blog\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="心想事成"><a href="#心想事成" class="headerlink" title="心想事成"></a>心想事成</h1><p>还是写点不想让认识的人瞧见，但又想倾述的事吧。</p>
<p>一个人在野地里坐到黄昏，等天空把夕阳吹成一朵炽热的花，风轻轻而来，也把泪水带离脸颊，我甚至不知道为什么而哭，或许只是对这人世间的理解偏差，这样的寂寞太漫长了，一条河流怎么能盛装得下，我捡起一颗将死的野草，告诉它，这个夏天就此作罢！</p>
<p>相见的人，不想见的人。<br>讨厌的人，麻烦的事。<br><img src="/blog/image/1738159231727.jpg"></p>
]]></content>
  </entry>
</search>
